---
layout: default
title: Escolha o melhor tipo de disco virtual para o seu cenário (pt-BR) - TechNet Articles - United States (English) - TechNet Wiki
weight: 3
---

<div class="post-content user-defined-markup">

<p><strong><span style="line-height:115%;font-size:12pt;">Conteúdo:</span></strong></p>
<ul>
<li><a href="#introdução">Introdução</a> </li><li><a href="#objetivo">Objetivo</a> </li><li><a href="#videopratico">Vídeo Prático</a> </li><li><a href="#tipos%20de%20discos">Tipos de discos:</a>
<ul>
<li><a href="#discos%20fixos">Discos Fixos</a> </li><li><a href="#discos%20dinamicos">Discos Dinâmicos</a> </li><li><a href="#discos%20diferenciais">Discos Diferenciais</a> </li></ul>
</li><li><a href="#comparativo%20de%20desempenho">Comparativo de Desempenho</a> </li><li><a href="#conslusao">Conclusão Final</a> </li></ul>
<p><strong><span style="line-height:115%;font-size:12pt;"><a name="introdução">Introdução</a>:</span></strong></p>
<p><span>Quando você abre o wizard para a criação de um disco virtual no Hyper-V, é exibida a janela abaixo:</span></p>
<br />
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/5516.tipos-de-discos.PNG"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/5516.tipos-de-discos.PNG" style="border-width:0px;border-style:solid;" /></a><br />
<br />
<p><span>E então, qual tipo de disco escolher? Qual pode trazer mais benefícios ao seu cenário?</span></p>
<p><strong><span style="line-height:115%;font-size:12pt;"><a name="objetivo">Objetivo</a>:</span></strong></p>
<p><span>Uma visão geral sobre os principais tipos de discos virtuais presentes no Hyper-V , para lhe ajudar a decidir qual o melhor modelo para o seu cenário de virtualização.</span></p>
<h1><a name="videopratico">Vídeo Prático:</a></h1>
<br />
<script src="https://i1.social.s-msft.com/wiki/rrcontent/18839adc85fee1b0971fa3728f8f3979-b1af1b7835ad549c70d465c5efb07b5e-RequestReducedScript.js" type="text/javascript" ></script><div id="video_9479b24a-f9fa-4b83-8c3e-c4d217bfb062"><noscript><embed src="https://www.youtube.com/v/rp-P7fqgkG4?fs=1&amp;rel=0" type="application/x-shockwave-flash" wmode="transparent" width="550" height="330" allowfullscreen="true"></embed></noscript></div><script type="text/javascript">
cs_setInnerHtml('video_9479b24a-f9fa-4b83-8c3e-c4d217bfb062','<embed src=\"https:\/\/www.youtube.com\/v\/rp-P7fqgkG4?fs=1&amp;rel=0\" type=\"application\/x-shockwave-flash\" wmode=\"transparent\" width=\"550\" height=\"330\" allowfullscreen=\"true\"><\/embed>');
</script><br />
<p><strong><span style="line-height:115%;font-size:12pt;"><a name="tipos%20de%20discos">Os tipos de discos</a>:</span></strong></p>
<p><span>São listados três tipos: Fixo, Dinâmico e Diferencial. Primeiro vamos explicar cada um deles.</span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><strong><span style="line-height:115%;font-size:12pt;"><a name="discos%20fixos">Discos Fixos</a>:</span></strong></p>
<p><span>Nesse modo o arquivo .VHD vai ser alocado imediatamente com o tamanho definido durante a sua criação. Por exemplo, se definir que o disco fixo terá 80Gb de tamanho, será alocado um arquivo .VHD com o tamanho de 80Gb.</span></p>
<p><span>Esse tipo de disco pode ser aumentado. Caso tenha subdimensionado um disco virtual, você pode aumentar o tamanho dele através do console do Hyper-V. Para isso clique em “Editar Disco” no menu lateral do Hyper-V.</span></p>
<p><span>Pode ser uma boa ideia começar com discos pequenos e depois crescer conforme a demanda, já que o disco fixo pode trazer um problema de espaço devido a sua alocação imediata. Por exemplo, qual seria o tamanho ideal para uma partição de sistema? Ou qual
 o tamanho ideal para um disco que vai hospedar logs? Talvez você não possua essa informação durante o setup dos discos.</span></p>
<p><span>Porém, essa técnica pode ter uma falha. O disco virtual é expandido facilmente, mas o sistema operacional da máquina virtual tem que ter a habilidade de reconhecer isso e&nbsp; realocar o tamanho disponível. Se a máquina virtual for um Windows 2008 ou superior,
 isso não será um problema. Mas se for um cliente, por exemplo, &nbsp;Linux ou Windows XP, pode ser necessário o uso de ferramentas de terceiros para conseguir completar a configuração desejada do disco.<span><br />
<br />
</span></span></p>
<p><strong><span style="font-size:16px;"><a name="discos%20dinamicos">Discos Dinâmicos</a>:</span></strong></p>
<p><span>Para criar um disco dinâmico você terá que definir um tamanho máximo para ele. Por exemplo, se criar um disco de 2040Mb (o tamanho máximo para um .VHD até o momento) o arquivo .VHD será criado com apenas 3.98Mb. Conforme a máquina virtual for necessitando
 de mais espaço ele irá crescer.</span></p>
<p><span>Uma técnica muito utilizada para quem usa disco dinâmico é definir o tamanho máximo para 2040Gb, mesmo não tendo esse tamanho disponível fisicamente.
</span></p>
<p><span>Por exemplo, vamos supor que está montando o ambiente virtual de sua empresa em seu computador. Você não tem o espaço que o seu storage pode oferecer então você define o disco virtual dinâmico para o tamanho desejado final, mesmo que seu HD não tenha
 todo o espaço disponível e começa a trabalhar no ambiente. Após o transporte para o storage, a máquina virtual já vai estar preparada para o ambiente final. Essa técnica não poderia ser aplicada a discos fixos, pois todo o tamanho necessário teria que ser
 alocado imediatamente.</span></p>
<p><span>O disco dinâmico pode também diminuir, mas ele não faz isso automaticamente. Se você gravar 1Tb de dados em um disco virtual dinâmico e depois apagar esses 1Tb, vai perceber que o arquivo .VHD ainda está do mesmo tamanho. Para reduzir o disco virtual
 dinâmico ao mínimo possível, primeiro realize uma desfragmentação dentro do sistema operacional da máquina virtual e depois vá em “Editar Disco” no menu lateral do Hyper-V.</span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><strong><span style="font-size:16px;"><a name="discos%20diferenciais">Discos Diferenciais</a>:</span></strong></p>
<p><span>O disco diferencial é composto de um disco “PAI” e um ou vários discos “FILHO”. Esse modelo é utilizado para poupar tempo e espaço em instalações de múltiplas máquinas virtuais.</span></p>
<p><span>Por exemplo: Você cria um disco virtual e realiza a instalação do Windows. Após isso, pode realizar as atualizações e padronizações que quiser. Então desliga a máquina virtual, desanexa o disco virtual e o transforma em “Disco PAI”.</span></p>
<p><span>A partir daí, você cria outro disco virtual, já definido como DIFERENCIAL. Uma das etapas da criação de um disco virtual diferencial é selecionar o disco PAI.</span></p>
<p><span>O disco FILHO criado é uma diferenciação do disco PAI. Nada será gravado no disco PAI a partir desse momento. Todas as alterações serão gravadas nos seus respectivos discos FILHO ou diferenciais.</span></p>
<p><span>No exemplo acima, os discos FILHO já estarão com o Windows e as atualizações instalados. Somente as seguintes personalizações e gravações serão registradas no disco FILHO.</span></p>
<p><span>Isso pode poupar tempo de implementação, pois as máquinas virtuais serão instantaneamente ativadas com o sistema operacional. E também espaço, pois você evitou de ter várias instalações do sistema em diferentes discos virtuais.
</span></p>
<p><span>A economia de espaço pode chegar a 80%, pois cada instalaç��o do Windows pode ter até 10Gb, se tiver 10 máquinas virtuais com discos dinâmicos ou fixos, terá no mínimo 100Gb gastos somente com sistema operacional. Se utilizar um disco diferencial,
 você irá gastar somente 10Gb de um sistema e cerca de 500Mb para cada máquina virtual ativada (espaço necessário para o término das configurações do Windows), &nbsp;nesse exemplo, totalizando cerca de 15Gb ao invés dos 100Gb citados acima.</span></p>
<p>&nbsp;</p>
<p><span><strong><span style="font-size:16px;"><a name="comparativo%20de%20desempenho">Comparativo de desempenho</a>:</span></strong></span></p>
<p><span>Se for perguntar a Microsoft qual é a recomendação para discos virtuais em ambiente de produção a resposta será: Discos Fixos.</span></p>
<p><span>Porém essa resposta já foi: Discos Pass-Through. Que é um modelo onde o disco real é apresentado de forma integral a máquina virtual. Hoje os discos fixos ter desempenho praticamente igual a esse tipo de disco, porém com benefícios extras.</span></p>
<p><span>As coisas mudam, e os discos dinâmicos estão com desempenho cada vez melhor. Um disco dinâmico tem excelente desempenho para a leitura. Se somado a um array físico RAID 5 em um storage, pode ser uma ótima opção para uma base de dados SQL, que na maioria
 dos casos é exigido muito desempenho de leitura.</span></p>
<p><span>O disco dinâmico tem desempenho de escrita mediano, por causa de sua expansão, mas ao atingir um tamanho estável ele pode apresentar também uma ótima taxa de escrita.</span></p>
<p><span>O disco diferencial também não pode ser descartado, principalmente em ambiente de virtualização de desktops. O principal temor é quanto ao disco PAI, pois ser perder esse disco vai comprometer todos os discos diferenciais anexados a ele.</span></p>
<p><span>O disco fixo é recomendo por oferecer melhor desempenho em diferentes cenários. Se não tiver problemas de espaço, pode ser a melhor opção.
</span></p>
<p><span>Mas também não descarte a opção de somar, por exemplo, partições de sistema operacional virtuais dinâmicos e discos fixos para as partições de dados.</span></p>
<p><span>Não depende só da estrutura virtual, mas sim da soma: storage&#43;RAID&#43;virtual. Sempre verificando o IOPS que irá conseguir com a configuração. (IOPS é a medição padrão para definir o desempenho de discos)</span></p>
<p><span>Seguem alguns gráficos tirados da internet para avaliação (a vontade para acrescentar mais caso tenham alguns interessantes):</span></p>
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/8272.grafico1.png"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/8272.grafico1.png" style="border-width:0px;border-style:solid;" /></a><br />
<br />
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/4314.grafico2.png"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/4314.grafico2.png" style="border-width:0px;border-style:solid;" /></a><br />
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/4188.grafico3.jpg"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/4188.grafico3.jpg" style="border-width:0px;border-style:solid;" /></a><br />
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/2475.grafico4.jpg"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/2475.grafico4.jpg" style="border-width:0px;border-style:solid;" /></a><br />
<br />
<p><span><strong><span style="font-size:16px;"><a name="conslusao">Conclusão</a>:</span></strong></span></p>
<p><span>Não fiquem vedados e céticos quanto ao que se houve por aí. Realize seus próprios testes.</span></p>
<p><span>Pode ser que a melhor opção para o seu caso não seja o padrão imposto por grandes marcas. Lembre-se que as grandes marcas tem que se precaver, sugerindo as configurações mais triviais e simples.<br />
<br />
Assista ao vídeo prático para ver todos os discos em ação.</span></p>

</div>
    
    