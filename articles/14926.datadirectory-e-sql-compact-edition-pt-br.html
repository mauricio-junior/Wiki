---
layout: default
title: DataDirectory e SQL Compact Edition (pt-BR) - TechNet Articles - United States (English) - TechNet Wiki
weight: 3
---

<div class="post-content user-defined-markup">

<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;Caro(a) Leitor(a), hoje eu gostaria de falar rapidamente sobre o
<em>DataDirectory</em> para conexão com o banco de dados local. O banco de dados local pode ser usado para web site, desktop ou serviços do Windows.
</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Antigamente tínhamos o banco de dados Access com extensão “mdb” para guardar, salvar, editar e excluir informações. Agora temos o
<em>SQL Compact Edition,</em> o famoso ntent-fragSQLCE com extensão “sdf”. </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Esse banco parece muito o SQL Express, porém pode ser usado localmente como o antigo Access. A ferramenta de desenvolvimento Visual Studio 2012 já possui ferramentas para criação dese banco e código.</p>
<p><strong>Utilizado:</strong></p>
<p>Ferramenta&nbsp; Visual Studio 2012</p>
<p>Linguagem C#</p>
<p>Banco de dados local SQL Compact Edition</p>
<p>Importe: System.Data.SqlServerCe</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A <em>string</em> de conexão do banco de dados possui geralmente um parâmetro chamado
<em>DataDirectory</em> entre “paipe” = |DataDirectory|. Listagem 1.</p>
<p style="text-align:center;">Listagem 1 – Conexão com o banco</p>
<p><span style="font-size:9.5pt;line-height:115%;background-color:white;font-family:Consolas;color:red;">connectionString</span><span style="font-size:9.5pt;line-height:115%;background-color:white;font-family:Consolas;color:blue;">=</span><span style="font-size:9.5pt;line-height:115%;background-color:white;font-family:Consolas;">&quot;</span><span style="font-size:9.5pt;line-height:115%;background-color:white;font-family:Consolas;color:blue;">Data
 Source=|DataDirectory|\AppData\MyDatabase.sdf</span><span style="font-size:9.5pt;line-height:115%;background-color:white;font-family:Consolas;">&quot;</span>
</p>
<p><span>&nbsp;</span></p>
<p><strong><span>Criar o banco de dados</span></strong></p>
<p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Para criar um banco de dados local basta adicionar um novo item clicando com o botão direito em cima do projeto, escolha a opção Add, depois New Item. Imagem 1.</p>
<p><a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/0602.connection_2D00_1.jpg"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/0602.connection_2D00_1.jpg" style="border-width:0px;border-style:solid;" /></a></p>
<p><span>Imagem 1 – Criando novo item.</span></p>
<p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Procure dentro do <em>template</em> o nome <em>Local DataBase</em>. Digite o nome que achar melhor e clique no botão Add. &nbsp;Imagem 2.</p>
<p><a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/0027.connection_2D00_2.jpg"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/0027.connection_2D00_2.jpg" style="border-width:0px;border-style:solid;" /></a></p>
<p><span>Imagem 2 – Adicionando banco local</span></p>
<p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Criando o banco, a <em>string</em> de conexão é criada dentro do arquivo de configuração do projeto. No caso deste projeto, a
<em>string </em>é criada dentro do arquivo App.config. Listagem 2. </p>
<p style="text-align:center;">Listagem 2 – String de conexão criada.</p>
<p><span style="font-size:9.5pt;background-color:white;font-family:Consolas;color:blue;">&nbsp;&nbsp;&nbsp; &lt;</span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;color:#a31515;">connectionStrings</span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;color:blue;">&gt;</span>
</p>
<p><span style="font-size:9.5pt;background-color:white;font-family:Consolas;color:blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;</span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;color:#a31515;">add</span>
<span style="font-size:9.5pt;background-color:white;font-family:Consolas;color:red;">
name</span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;color:blue;">=</span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;">&quot;</span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;color:blue;">MyDatabaseConnectionString</span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;">&quot;</span></p>
<p><span style="font-size:9.5pt;background-color:white;font-family:Consolas;color:blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;color:red;">connectionString</span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;color:blue;">=</span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;">&quot;</span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;color:blue;">Data
 Source=|DataDirectory|\AppData\MyDatabase.sdf</span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;">&quot;</span></p>
<p><span style="font-size:9.5pt;background-color:white;font-family:Consolas;color:blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;color:red;">providerName</span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;color:blue;">=</span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;">&quot;</span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;color:blue;">Microsoft.SqlServerCe.Client.4.0</span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;">&quot;</span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;color:blue;">
 /&gt;</span> </p>
<p><span style="font-size:9.5pt;line-height:115%;background-color:white;font-family:Consolas;color:blue;">&nbsp;&nbsp;&nbsp; &lt;/</span><span style="font-size:9.5pt;line-height:115%;background-color:white;font-family:Consolas;color:#a31515;">connectionStrings</span><span style="font-size:9.5pt;line-height:115%;background-color:white;font-family:Consolas;color:blue;">&gt;</span>
</p>
<p><span>&nbsp;</span></p>
<p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Note que existe depois do <em>Data Source</em> o nome
<em>DataDirectory</em> , o nome da pasta que escolheu e o nome do banco de dados. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</p>
<p><strong>Utilizando DataDirectory</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Para utilizar este caminho |DataDirectory| basta precisa atribuir um parâmetro no início do seu projeto, ou seja, depois de abrir o programa com dois cliques.
</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Alguns desenvolvedores tiram esse parâmetro |DataDirectory| da
<em>string</em> de conexão, porque não sabem usar ou não sabem pra que serve. Vamos dizer que o seu programa pode ser instalado em qualquer lugar do computador e o seu progrlue;">&gt;</span>
</p>
<p><span>&nbsp;</span></p>
<p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Note que existe depois do <em>Data Source</em> o nome
<em>DataDirectory</em> , o nome da pasta que escolheu e o nome do banco de dados. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</p>
<p><strong>Utilizando DataDirectory</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Para utilizar este caminho |DataDirectory| basta precisa atribuir um parâmetro no início do seu projeto, ou seja, depois de abrir o programa com dois cliques.
</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbama precisa encontrar o banco de dados.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Para resolver este problema, busquei o endereço corrente do programa e indiquei o endereço do
<em>DataDirectory</em>. Listagem 3.</p>
<p style="text-align:center;">Listagem 3 – Adicionando o DataDirectory</p>
<p><span style="font-size:9.5pt;background-color:white;font-family:Consolas;color:blue;">public</span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;"> Form1()</span></p>
<p><span style="font-size:9.5pt;background-color:white;font-family:Consolas;">{</span></p>
<p><span style="font-size:9.5pt;background-color:white;font-family:Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; InitializeComponent();</span></p>
<p><span style="font-size:9.5pt;background-color:white;font-family:Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;color:#2b91af;">AppDomain</span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;">.CurrentDomain.SetData(</span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;color:maroon;">&quot;DataDirectory&quot;</span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;">,
</span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;color:#2b91af;">Environment</span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;">.CurrentDirectory);</span></p>
<p><span style="font-size:9.5pt;line-height:115%;background-color:white;font-family:Consolas;">}</span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Coloquei o comando de <em>Domain</em> atribuindo o nome <em>DataDirectory</em> e o diretório corrente da aplicação. Com a linha de comando adicionado na listagem 3 o caminho da aplicação é pego.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; O próximo passo para conectar o banco de dados com a <em>string</em> escrito
<em>DataDirectory</em> é simples, mostrado nos próximos passos.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Criei um botão no <em>form</em> e cliquei duas vezes para gerar o código. Imagem 3.</p>
<p><a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/8400.connection_2D00_3.jpg"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/8400.connection_2D00_3.jpg" style="border-width:0px;border-style:solid;" /></a></p>
<p>Imagem 3 – Criação de <em>form</em> com um botão.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dentro do método, busquei a classe responsável pela conexão e <em>
driver</em> com o banco de dados local, informei de onde pegar a <em>string</em> de conexão e chamei o
<em>Open</em>. Listagem 4.</p>
<p style="text-align:center;">Listagem 4 – Conectando no banco de dados.</p>
<p><span style="font-size:9.5pt;background-color:white;font-family:Consolas;color:blue;">private</span>
<span style="font-size:9.5pt;background-color:white;font-family:Consolas;color:blue;">
void</span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;"> cmdConnection_Click(</span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;color:blue;">object</span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;">
 sender, </span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;color:#2b91af;">EventArgs</span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;"> e)</span></p>
<p><span style="font-size:9.5pt;background-color:white;font-family:Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>
<p><span style="font-size:9.5pt;background-color:white;font-family:Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;color:#2b91af;">SqlCeConnection</span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;"> c =
</span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;color:blue;">new</span>
<span style="font-size:9.5pt;background-color:white;font-family:Consolas;color:#2b91af;">
SqlCeConnection</span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;">(System.Configuration.</span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;color:#2b91af;">ConfigurationManager</span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;">.ConnectionStrings[</span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;color:maroon;">&quot;MyDatabaseConnectionString&quot;</span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;">].ToString());</span></p>
<p><span style="font-size:9.5pt;background-color:white;font-family:Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style="font-size:9.5pt;background-color:white;font-family:Consolas;">c.Open();</span></p>
<p><span style="font-size:9.5pt;line-height:115%;background-color:white;font-family:Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Note que o nome da <em>connectionString</em> é <em>MyDatabaseConnectionString</em> localizada dentro do arquivo de configuração do projeto/aplicação. Para finalizar, a conexão com o banco funcionou sem qualquer problema.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Lembro que, a melhor forma de utilizar conexão com o banco de dados é utilizar classes internas ou privadas e em projetos diferentes, ou seja, na camada de dados (DAL ou DAO).</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Espero que tenha gostado e qualquer dúvida pode entrar em contato pelo site
<a href="http://www.mauriciojunior.org/">www.mauriciojunior.org</a>. </p>

</div>
    
    