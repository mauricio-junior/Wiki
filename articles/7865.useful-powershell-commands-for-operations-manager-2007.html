---
layout: default
title: Useful PowerShell Commands for Operations Manager 2007 - TechNet Articles - United States (English) - TechNet Wiki
weight: 3
---

<div class="post-content user-defined-markup">

<p style="margin:0in;font-family:calibri;font-size:11pt;"><span class="RadEDomMouseOver" style="font-size:medium;color:#0000ff;"><strong><span style="font-size:16px;">Useful PowerShell Commands for Operations Manager 2007<br />
<span style="font-size:10px;">Last Update on 14-03-2012</span></span></strong></span></p>
<p style="margin:0in;font-family:calibri;fonr3 fiji-r3"></div><div class="r4 fiji-r4"></div></div></div></div>
<div class="content-fragment page no-wrapper" id="fragment-6615">
<div class="content-fragment-inner fiji-content-fragment-inner"><div class="content-fragment-top fiji-content-fragment-top"><div class="r1 fiji-r1"></div><div class="r2 fiji-r2"></div><dt-size:11pt;"><span style="font-size:medium;"><strong><span style="font-size:16px;color:#ff0000;"></span></strong></span></p>
<p style="margin:0in;font-family:calibri;font-size:11pt;"><span style="font-size:16px;"><span style="font-size:medium;text-decoration:underline;color:#ff0000;"><br />
<br />
Get list Operations Manager Commands</span><span style="font-size:medium;color:#ff0000;">
</span><span style="font-size:12px;color:#c0c0c0;">on 29-02-2012</span></span></p>
<p style="margin:0in;font-family:calibri;font-size:11pt;"><span style="font-size:16px;"></span></p>
<p style="margin:0in;font-family:calibri;font-size:11pt;">Get-OperationsManagerCommand
</p>
<p style="margin:0in;font-family:calibri;font-size:11pt;">&nbsp;</p>
<p style="margin:0in;font-family:calibri;font-size:11pt;"><span class="RadEDomMouseOver" style="font-size:16px;"><span style="font-size:medium;text-decoration:underline;color:#ff0000;"><br />
Get list of unavailable/unresponsive agents</span><span style="font-size:12px;color:#c0c0c0;"> on 28-02-2012</span></span></p>
<p style="margin:0in;font-family:calibri;font-size:11pt;"><span style="font-size:16px;"></span></p>
<p style="margin:0in;font-family:calibri;font-size:11pt;">Get-Monitoringclass -name &quot;Microsoft.Windows.Computer&quot; | Get-MonitoringObject | Where-Object {$_.IsAvailable -eq $False} | Select-Object&nbsp; DisplayName, IsAvailable | Format-Table</p>
<p style="margin:0in;font-family:calibri;font-size:11pt;">&nbsp;</p>
<p style="margin:0in;font-family:calibri;font-size:11pt;"><span style="font-size:medium;color:#ff0000;"><strong></strong></span></p>
<p style="margin:0in;font-family:calibri;font-size:11pt;"><span class="RadEDomMouseOver" style="font-size:16px;"><span style="font-size:medium;text-decoration:underline;color:#ff0000;"><br />
Resolve the <em>healthserviceid</em> to Agent Name</span><span style="font-size:12px;color:#c0c0c0;"> on 28-02-2012</span></span></p>
<p style="margin:0in;font-family:calibri;font-size:11pt;"><span style="font-size:16px;"></span></p>
<p style="margin:0in;font-family:calibri;font-size:11pt;"><span style="color:#000000;">Get-Agent | Where-Object {$_.hostedHealthService.id -eq &quot;</span><span style="font-style:italic;color:#ff0000;">healthserviceid</span><span style="color:#000000;">&quot;} | Select-Object
 name</span></p>
<p style="margin:0in;font-family:calibri;font-size:11pt;"><span style="color:#000000;"></span></p>
<p style="margin:0in;font-family:calibri;font-size:11pt;">&nbsp;</p>
<p style="margin:0in;font-family:calibri;font-size:11pt;"><span class="RadEDomMouseOver" style="font-size:16px;"><span style="font-size:medium;text-decoration:underline;color:#ff0000;"><br />
Export All Unsealed Management Packs</span><span style="font-size:12px;color:#c0c0c0;"> on 28-02-2012</span></span></p>
<p style="margin:0in;font-family:calibri;font-size:11pt;"><span style="font-size:16px;"></span></p>
<p style="margin:0in;font-family:calibri;font-size:11pt;"><span style="color:#000000;"></span><span style="color:#000000;">md C:\UnsealedMPBackup<br />
Get-ManagementPack | where {$_.Sealed -eq $false} | Export-Managementpack -path C:\UnsealedMPBackup
</span></p>
<p style="margin:0in;font-family:calibri;font-size:11pt;"><span style="font-size:medium;text-decoration:underline;color:#ff0000;"></span></p>
<p style="margin:0in;font-family:calibri;font-size:11pt;"><span style="font-size:medium;text-decoration:underline;color:#ff0000;"></span></p>
<p style="margin:0in;font-family:calibri;font-size:11pt;"><span class="RadEDomMouseOver" style="font-size:16px;"><span style="font-size:medium;text-decoration:underline;color:#ff0000;"><br />
<br />
Get the Management Server information including the Management Server Action Account identity</span><span style="font-size:12px;color:#c0c0c0;"> on 29-02-2012</span></span></p>
<p style="margin:0in;font-family:calibri;font-size:11pt;"><span style="font-size:16px;"></span></p>
<p style="margin:0in;font-family:calibri;font-size:11pt;">Get-ManagementServer | Select-Object DisplayName, IsRootManagementServer, ActionAccountIdentity, HealthState | Format-Table -autosize<br />
<br />
<br />
</p>
<p style="margin:0in;font-family:calibri;font-size:11pt;"><span style="font-size:medium;text-decoration:underline;color:#ff0000;">Get the User Roles and its Members</span><span style="font-size:medium;color:#ff0000;">
</span><span style="background-color:#ffffcc;font-size:13px;color:#c0c0c0;">on 14-03-2012</span></p>
<p style="margin:0in;font-family:calibri;font-size:11pt;">Get-Userrole | Select-Object DisplayName, Users</p>

</div>
    
    