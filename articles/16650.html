---
layout: default
title: '设计村民常住户口登记信息管理系统 - TechNet文章 - 中国（简体中文） - TechNet Wiki'
weight: 3
---

<div class="post-content user-defined-markup">

<p style="text-align:center;"><b><span style="font-size:14pt;">VB.NET2008&#43;ACCESS2007</span></b><b><span style="font-size:14pt;">设计村民常住户口登记信息管理系统</span></b><b>
</b></p>
<p></p>
<p><b><span style="font-size:12pt;">摘要：</span></b><span style="font-size:12pt;">通过</span><b><span style="font-size:12pt;">VB.NET2008</span></b><span style="font-size:12pt;">开发窗体应用程序来实现数据动态更新式的模糊查询；</span>
</p>
<p></p>
<p><span style="font-size:12pt;">每户家庭中以户主为中心的关系查询；以及报表制作的实现</span>
</p>
<p></p>
<p><b><span style="font-size:12pt;">关键词：</span></b><b><span style="font-size:12pt;">VB.NET2008</span></b><b><span style="font-size:12pt;">、</span></b><b><span style="font-size:12pt;">ACCESS2007</span></b><b><span style="font-size:12pt;">、</span></b><span style="font-size:12pt;">数据库、查询、</span>
</p>
<p></p>
<p><span style="font-size:12pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>&nbsp;TreevView</b></span><span style="font-size:12pt;">控件、</span><b><span style="font-size:12pt;">DataGridView</span></b><span style="font-size:12pt;">控件</span>
</p>
<p></p>
<p><span style="font-size:12pt;">一、<b>概述：</b></span> </p>
<p></p>
<p><span style="font-size:12pt;">随着信息技术在农村的大力普及，通过数据库管理系统（</span><b><span style="font-size:12pt;">DBMS</span></b><span style="font-size:12pt;">）将村民常住人口登记信息录入数据库，再配合数据库应用程序对数据实现的动态更新式模糊查询，方便的将现有数据进行增、删、减、改操作；通过每户家庭中以户主为中心的关系建立，来对数据库相应表中的数据进行组织；通过窗体应用程序中</span><span style="font-size:12pt;">
<b>DataGridView</b></span><span style="font-size:12pt;">控件中的查询结果导入到</span><b><span style="font-size:12pt;">Excel</span></b><span style="font-size:12pt;">中，来自动化生成《常住人口登记表》，轻松实现对该报表机型浏览、打印。</span>
</p>
<p></p>
<p><span style="font-size:12pt;">通过该信息管理系统的实现，不仅使村级行政单位摆脱了人工管理带来的一系列弊端，更重要的是提高了工作效率，使村级行政信息管理发生了质的飞跃。</span><span style="font-size:12pt;">&nbsp;&nbsp;
</span></p>
<p></p>
<p><b></b></p>
<p></p>
<p><b><span style="font-size:12pt;">二、方法：</span></b><b> </b></p>
<p></p>
<p><b><span style="font-size:12pt;">1</span></b><b><span style="font-size:12pt;">、动态更新式模糊查询的实现</span></b><b>
</b></p>
<p></p>
<p><span style="font-size:12pt;">首先要实现</span><b><span style="font-size:12pt;">SQL</span></b><span style="font-size:12pt;">语句的模糊查询。通过使用数据适配器配置向导来生成</span><b><span style="font-size:12pt;">SQL</span></b><span style="font-size:12pt;">语句，这里只生成</span><b><span style="font-size:12pt;">SELECT</span></b><span style="font-size:12pt;">语句，在</span><b><span style="font-size:12pt;">WHERE</span></b><span style="font-size:12pt;">子句中使用</span><span style="font-size:12pt;">LIKE</span><span style="font-size:12pt;">关键字搜索与指定模式匹配的字符串&amp;#20540;，模式包含要搜索的字符串和代表任意数目字符的通配符“</span><span style="font-size:12pt;">%</span><span style="font-size:12pt;">”</span>
<span style="font-size:12pt;">。所生成的</span><b><span style="font-size:12pt;">SELECT</span></b><span style="font-size:12pt;">语句与</span><b><span style="font-size:12pt;">TableAdapter</span></b><span style="font-size:12pt;">对象中指定的</span><b><span style="font-size:12pt;">Fill</span></b><span style="font-size:12pt;">方法相对应。该方法通过生成的</span><b><span style="font-size:12pt;">SQL</span></b><span style="font-size:12pt;">语句从指定的数据库表中提取数据来填充指定的</span><b><span style="font-size:12pt;">DataSet</span></b><span style="font-size:12pt;">对象中的</span><b><span style="font-size:12pt;">DataTable</span></b><span style="font-size:12pt;">对象。该对象中的</span><b><span style="font-size:12pt;">Rows</span></b><span style="font-size:12pt;">和</span><b><span style="font-size:12pt;">Columns</span></b><span style="font-size:12pt;">集合会自动填充并更新</span><b><span style="font-size:12pt;">DataGridView</span></b><span style="font-size:12pt;">控件中的</span><b><span style="font-size:12pt;">Rows</span></b><span style="font-size:12pt;">和</span><b><span style="font-size:12pt;">Columns</span></b><span style="font-size:12pt;">集合。</span>
</p>
<p></p>
<p><span style="font-size:12pt;">其次实现动态更新，将</span><b><span style="font-size:12pt;">TableAdapter</span></b><span style="font-size:12pt;">对象中指定的</span><b><span style="font-size:12pt;">Fill</span></b><span style="font-size:12pt;">方法放在输入查询内容的</span><span style="font-size:12pt;">Textbox</span><span style="font-size:12pt;">空间中的</span><span style="font-size:12pt;">TextChange</span><span style="font-size:12pt;">实践当中。这样就可以随查询内容的更新来动态更新显示模糊查询结果。</span>
</p>
<p></p>
<p><b><span style="font-size:12pt;">2</span></b><b><span style="font-size:12pt;">、每户家庭中以户主为中心的关系查询的实现</span></b><b>
</b></p>
<p></p>
<p><span style="font-size:12pt;">通过数据库管理系统建立数据库，并新建两张表</span><b><span style"font-size:12pt;">集合会自动填充并更新</span><b><span style="font-size:12pt;">DataGridView</span></b><span style="font-size:12pt;">控件中的</span><b><span style="font-size:12pt;">Rows</span></b><span style="font-size:12pt;">和</span><b><span style="font-size:12pt;">Columns</span></b><span style="font-size:12pt;">集合。</span>
</p>
<p></p>
<p><span style="font-size:12pt;">其次实现动态更新，将</span><b><span style="font-size:12pt;">TableAdapter</span></b><span style="font-size:12pt;">对象中指定的</span><b><span style="font-size:12pt;">Fill</span></b><span style="font-size:12pt;">方法放在输入查询内容的</span><span style="font-size:12pt;">Textbox</span><span style="font-size:12pt;">空间中的</span><span style="font-size:12pt;">TextChange</span><span style="font-size:12pt;">实践当中。这样就可以随查询内容的更新来动态更新显示模糊查询结果。</span>
</p>
<p></p>
<p><b><span style="font-size:12pt;">2</span></b><b><span style="font-size:12pt;">、每户家庭中以户主为中心的关系查询的实现</span></b><b>
</b></p>
<="font-size:12pt;">Sheet1</span></b><span style="font-size:12pt;">和</span><b><span style="font-size:12pt;">Sheet2</span></b><span style="font-size:12pt;">（如表</span><span style="font-size:12pt;">1</span><span style="font-size:12pt;">所示）其中</span><b><span style="font-size:12pt;">Sheet1</span></b><span style="font-size:12pt;">表包含编号和户主姓名两列。对于单个家庭来说，编号要求唯一且被互助及其家庭成员所共享，并且还要求编号与</span><b><span style="font-size:12pt;">TreevView</span></b><span style="font-size:12pt;">控件显示的户主姓名的每个节点（</span><b><span style="font-size:12pt;">Node</span></b><span style="font-size:12pt;">）的索引号（</span><b><span style="font-size:12pt;">Index</span></b><span style="font-size:12pt;">）建立一一对应关系。这样做不仅可以通过引用索引号将同名同姓的户主及家庭成员区分开来，还可以只是用一个简单的</span><b><span style="font-size:12pt;">SQL</span></b><span style="font-size:12pt;">语句在点击某个</span><b><span style="font-size:12pt;">TreevView</span></b><span style="font-size:12pt;">控件的户主姓名节点时，将其本人及家庭成员的信息一并显示在</span><b><span style="font-size:12pt;">TreevView</span></b><span style="font-size:12pt;">控件上。</span>
</p>
<p></p>
<p><b><span style="font-size:12pt;">Sheet2</span></b><span style="font-size:12pt;">表保存着录入数据库的村民常住人口的各项信息，其中每一列代表其中一项信息，要求表中列的顺序与通过将</span><b><span style="font-size:12pt;">DataGridView</span></b><span style="font-size:12pt;">控件中的查询结果导入到</span><b><span style="font-size:12pt;">Excel</span></b><span style="font-size:12pt;">相应单元&amp;#26684;中（</span><b><span style="font-size:12pt;">Range</span></b><span style="font-size:12pt;">）的顺序相同。此举可以以连贯的方式将</span><b><span style="font-size:12pt;">DataGridView</span></b><span style="font-size:12pt;">控件相应的网各种的数据导入</span><b><span style="font-size:12pt;">Excel</span></b><span style="font-size:12pt;">报表中指定的单元&amp;#26684;中。</span>
</p>
<p></p>
<p><b><span style="font-size:12pt;">3</span></b><b><span style="font-size:12pt;">、将</span></b><b><span style="font-size:12pt;">DataGridView</span></b><b><span style="font-size:12pt;">控件中的查询结果导入到</span></b><b><span style="font-size:12pt;">Excel</span></b><b><span style="font-size:12pt;">中，来自动化生成《常住人口登记表》的实现</span></b><b>
</b></p>
<p></p>
<p><span style="font-size:12pt;">首先通过</span><b><span style="font-size:12pt;">Excel</span></b><span style="font-size:12pt;">来建立一个《常住人口登记表》，该报表与纸质媒介的《常住人口登记表》的样式保持一致。表&amp;#26684;的每一项都对应一个单元&amp;#26684;进行数据填充。</span>
</p>
<p></p>
<p><span style="font-size:12pt;">其次通过编程的方式将</span><b><span style="font-size:12pt;">DataGridView</span></b><span style="font-size:12pt;">控件中相应行列表&amp;#26684;中的数据导入到</span><b><span style="font-size:12pt;">Excel</span></b><span style="font-size:12pt;">报表中指定的单元&amp;#26684;中，方法如下：</span>
</p>
<p></p>
<p><span style="font-size:12pt;">1.<span>&nbsp;
</span></span><span style="font-size:12pt;">在引用的COM中找到<b>Microsoft Excel
</b></span><b><span>１２.０</span></b><b><span style="font-size:12pt;"> Object Library，</span></b><span style="font-size:12pt;">并进行添加。<b>
</b></span></p>
<p></p>
<p><span style="font-size:12pt;">2.<span>&nbsp;
</span></span><span style="font-size:12pt;">建立</span><b><span style="font-size:12pt;">Excel</span></b><span style="font-size:12pt;">应用程序对象并启动一个新的</span><b><span style="font-size:12pt;">Excel</span></b><span style="font-size:12pt;">应用程序进程。通过该应用程序对象打开指定路径的工作簿对象。</span>
</p>
<p></p>
<p><span style="font-size:12pt;">3.<span>&nbsp;
</span></span><span style="font-size:12pt;">通过</span><b><span style="font-size:12pt;">Excel</span></b><span style="font-size:12pt;">应用程序对象引用</span><b><span style="font-size:12pt;">Excel</span></b><span style="font-size:12pt;">报表中需要填充数据的单元&amp;#26684;，将</span><b><span style="font-size:12pt;">DataGridView</span></b><span style="font-size:12pt;">控件中相应行列表&amp;#26684;中的数据填充进去。</span>
</p>
<p></p>
<p><b><span style="font-size:12pt;">注意：</span></b><span style="font-size:12pt;">需要指出的是：为在公民身份证编号一列录入数据方便，所录入的每项数据类型均为数&amp;#20540;型。在导入</span><b><span style="font-size:12pt;">Excel</span></b><span style="font-size:12pt;">报表中相应的单元&amp;#26684;中时，不仅将</span><b><span style="font-size:12pt;">DataGridView</span></b><span style="font-size:12pt;">控件中相应行列表&amp;#26684;中的数据转化为数字字符串，还要在字符串前面加上“</span><b><span style="font-size:12pt;">’</span></b><span style="font-size:12pt;">”</span>
<span style="font-size:12pt;">。</span> </p>
<p></p>
<p><b><span style="font-size:12pt;">表</span></b><b><span style="font-size:12pt;">1&nbsp;&nbsp;
</span></b><b><span style="font-size:12pt;">数据表结构</span></b><b> </b>
</p>
<p></p>
<table border="1" cellspacing="0" cellpadding="0" style="margin:auto auto auto 50.4pt;border:currentColor;border-collapse:collapse;">
<tbody>
<tr style="height:22.6pt;">
<td style="padding:0cm 5.4pt;border:1p style="font-size:12pt;">控件中相应行列表&amp;#26684;中的数据填充进去。</span>
</p>
<p></p>
<p><b><span style="font-size:12pt;">注意：</span></b><span style="font-size:12pt;">需要指出的是：为在公民身份证编号一列录入数据方便，所录入的每项数据类型均为数&amp;#20540;型。在导入</span><b><span style="font-size:12pt;">Excel</span></b><span style="font-size:12pt;">报表中相应的单元&amp;#26684;中时，不仅将</span><b><span style="font-size:12pt;">DataGridView</span></b><span style="font-size:12pt;">控件中相应t solid windowtext;width:108pt;height:22.6pt;background-color:transparent;">
<p style="text-align:center;"><b><span style="font-size:12pt;">表名</span></b><b>
</b></p>
</td>
<td style="border-width:1pt 1pt 1pt 0px;border-style:solid solid solid none;padding:0cm 5.4pt;width:108pt;height:22.6pt;background-color:transparent;">
<p style="text-align:center;"><b><span style="font-size:12pt;">解释</span></b><b>
</b></p>
</td>
<td style="border-width:1pt 1pt 1pt 0px;border-style:solid solid solid none;padding:0cm 5.4pt;width:108pt;height:22.6pt;background-color:transparent;">
<p style="text-align:center;"><b><span style="font-size:12pt;">字段名</span></b><b>
</b></p>
</td>
</tr>
<tr>
<td rowspan="2" style="border-width:0px 1pt 1pt;border-style:none solid solid;padding:0cm 5.4pt;width:108pt;background-color:transparent;">
<p style="text-align:center;"><b><span style="font-size:12pt;">Sheet1</span></b></p>
</td>
<td rowspan="2" style="border-width:0px 1pt 1pt 0px;border-style:none solid solid none;padding:0cm 5.4pt;width:108pt;background-color:transparent;">
<p style="text-align:center;"><b><span style="font-size:12pt;">户主姓名列表</span></b><b>
</b></p>
</td>
<td style="border-width:0px 1pt 1pt 0px;border-style:none solid solid none;padding:0cm 5.4pt;width:108pt;background-color:transparent;">
<p style="text-align:center;"><b><span style="font-size:12pt;">编号</span></b><b>
</b></p>
</td>
</tr>
<tr>
<td style="border-width:0px 1pt 1pt 0px;border-style:none solid solid none;padding:0cm 5.4pt;width:108pt;background-color:transparent;">
<p style="text-align:center;"><b><span style="font-size:12pt;">户主姓名</span></b><b>
</b></p>
</td>
</tr>
<tr>
<td rowspan="8" style="border-width:0px 1pt 1pt;border-style:none solid solid;padding:0cm 5.4pt;width:108pt;background-color:transparent;">
<p style="text-align:center;"><b><span style="font-size:12pt;">Sheet2</span></b></p>
</td>
<td rowspan="8" style="border-width:0px 1pt 1pt 0px;border-style:none solid solid none;padding:0cm 5.4pt;width:108pt;background-color:transparent;">
<p style="text-align:center;"><b><span style="font-size:12pt;">村民常住人口的各项信息</span></b><b>
</b></p>
</td>
<td style="border-width:0px 1pt 1pt 0px;border-style:none solid solid none;padding:0cm 5.4pt;width:108pt;background-color:transparent;">
<p style="text-align:center;"><b><span style="font-size:12pt;">户别</span></b><b>
</b></p>
</td>
</tr>
<tr>
<td style="border-width:0px 1pt 1pt 0px;border-style:none solid solid none;padding:0cm 5.4pt;width:108pt;background-color:transparent;">
<p style="text-align:center;"><b><span style="font-size:12pt;">户主姓名</span></b><b>
</b></p>
</td>
</tr>
<tr>
<td style="border-width:0px 1pt 1pt 0px;border-style:none solid solid none;padding:0cm 5.4pt;width:108pt;background-color:transparent;">
<p style="text-align:center;"><b><span style="font-size:12pt;">与户主关系</span></b><b>
</b></p>
</td>
</tr>
<tr>
<td style="border-width:0px 1pt 1pt 0px;border-style:none solid solid none;padding:0cm 5.4pt;width:108pt;background-color:transparent;">
<p style="text-align:center;"><b><span style="font-size:12pt;">姓名</span></b><b>
</b></p>
</td>
</tr>
<tr>
<td style="border-width:0px 1pt 1pt 0px;border-style:none solid solid none;padding:0cm 5.4pt;width:108pt;background-color:transparent;">
<p style="text-align:center;"><b><span style="font-size:12pt;">性别</span></b><b>
</b></p>
</td>
</tr>
<tr>
<td style="border-width:0px 1pt 1pt 0px;border-style:none solid solid none;padding:0cm 5.4pt;width:108pt;background-color:transparent;">
<p style="text-align:center;"><b><span style="font-size:12pt;">民族</span></b><b>
</b></p>
</td>
</tr>
<tr>
<td style="border-width:0px 1pt 1pt 0px;border-style:none solid solid none;padding:0cm 5.4pt;width:108pt;background-color:transparent;">
<p style="text-align:center;"><b><span style="font-size:12pt;">……</span></b></p>
</td>
</tr>
<tr>
<td style="border-width:0px 1pt 1pt 0px;border-style:none solid solid none;padding:0cm 5.4pt;width:108pt;background-color:transparent;">
<p style="text-align:center;"><b><span style="font-size:12pt;">备注</span></b><b>
</b></p>
</td>
</tr>
</tbody>
</table>
<p></p>
<p><b></b></p>
<p></p>
<p><b><span style="font-size:12pt;">二、实现：</span></b><b> </b></p>
<p></p>
<p><span style="font-size:12pt;">1.</span><span style="font-size:12pt;">在使用</span><b><span style="font-size:12pt;">VB.NET2008</span></b><span style="font-size:12pt;">所创建的</span><b><span style="font-size:12pt;">WINDOWS</span></b><span style="font-size:12pt;">应用程序项目中，新建一个查询窗体。查询窗体控件上所用主要控件见表</span><span style="font-size:12pt;">2</span><span style="font-size:12pt;">。</span>
</p>
<p></p>
<p style="text-align:center;"><b><span style="font-size:12pt;">表</span></b><b><span style="font-size:12pt;">2&nbsp;&nbsp;
</span></b><b><span style="font-size:12pt;">主要控件列表</span></b><b> </b>
</p>
<p></p>
<p style="text-align:center;"><b></b></p>
<p></p>
<div style="text-align:center;">
<table width="433" border="1" cellspacing="0" cellpadding="0" style="border:currentColor;width:324.85pt;border-collapse:collapse;">
<tbody>
<tr style="height:22pt;">
<td style="padding:0cm 5.4pt;border:1pt solid windowtext;width:108.25pt;height:22pt;background-color:transparent;">
<p style="text-align:center;"><b><span style="font-size:12pt;">控件类型</span></b><b>
</b></p>
</td>
<td style="border-width:1pt 1pt 1pt 0px;border-style:solid solid solid none;padding:0cm 5.4pt;width:108.3pt;height:22pt;background-color:transparent;">
<p style="text-align:center;"><b><span style="font-size:12pt;">控件名称</span></b><b>
</b></p>
</td>
<td style="border-width:1pt 1pt 1pt 0px;border-style:solid solid solid none;padding:0cm 5.4pt;width:108.3pt;height:22pt;background-color:transparent;">
<p style="text-align:center;"><b><span style="font-size:12pt;">功能</span></b><b>
</b></p>
</td>
</tr>
<tr>
<td valign="top" style="border-width:0px 1pt 1pt;border-style:none solid solid;padding:0cm 5.4pt;width:108.25pt;background-color:transparent;">
<p style="text-align:center;"><b><span style="font-size:12pt;">Form</span></b></p>
</td>
<td valign="top" style="border-width:0px 1pt 1pt 0px;border-style:none solid solid none;padding:0cm 5.4pt;width:108.3pt;background-color:transparent;">
<p style="text-align:center;"><b><span style="font-size:12pt;">Form1</span></b></p>
</td>
<td valign="top" style="border-width:0px 1pt 1pt 0px;border-style:none solid solid none;padding:0cm 5.4pt;width:108.3pt;background-color:transparent;">
<p style="text-align:center;"><b><span style="font-size:12pt;">程序主窗体</span></b><b>
</b></p>
</td>
</tr>
<tr>
<td valign="top" style="border-width:0px 1pt 1pt;border-style:none solid solid;padding:0cm 5.4pt;width:108.25pt;background-color:transparent;">
<p style="text-align:center;"><b><span style="font-size:12pt;">ComboBox</span></b></p>
</td>
<td valign="top" style="border-width:0px 1pt 1pt 0px;border-style:none solid solid none;padding:0cm 5.4pt;width:108.3pt;background-color:transparent;">
<p style="text-align:center;"><b><span style="font-size:12pt;">ComboBox1</span></b></p>
</td>
<td valign="top" style="border-width:0px 1pt 1pt 0px;border-style:none solid solid none;padding:0cm 5.4pt;width:108.3pt;background-color:transparent;">
<p style="text-align:center;"><b><span style="font-size:12pt;">选择检索方式</span></b><b>
</b></p>
</td>
</tr>
<tr>
<td valign="top" style="border-width:0px 1pt 1pt;border-style:none solid solid;padding:0cm 5.4pt;width:108.25pt;background-color:transparent;">
<p style="text-align:center;"><b><span style="font-size:12pt;">TextBox</span></b></p>
</td>
<td valign="top" style="border-width:0px 1pt 1pt 0px;border-style:none solid solid none;padding:0cm 5.4pt;width:108.3pt;background-color:transparent;">
<p style="text-align:center;"><b><span style="font-size:12pt;">TextBox1</span></b></p>
</td>
<td valign="top" style="border-width:0px 1pt 1pt 0px;border-style:none solid solid none;padding:0cm 5.4pt;width:108.3pt;background-color:transparent;">
<p style="text-align:center;"><b><span style="font-size:12pt;">输入检索内容</span></b><b>
</b></p>
</td>
</tr>
<tr>
<td valign="top" style="border-width:0px 1pt 1pt;border-style:none solid solid;padding:0cm 5.4pt;width:108.25pt;background-color:transparent;">
<p style="text-align:center;"><b><span style="font-size:12pt;">TreeView</span></b></p>
</td>
<td valign="top" style="border-width:0px 1pt 1pt 0px;border-style:none solid solid none;padding:0cm 5.4pt;width:108.3pt;background-color:transparent;">
<p style="text-align:center;"><b><span style="font-size:12pt;">TreeView1</span></b></p>
</td>
<td valign="top" style="border-width:0px 1pt 1pt 0px;border-style:none solid solid none;padding:0cm 5.4pt;width:108.3pt;background-color:transparent;">
<p style="text-align:center;"><b><span style="font-size:12pt;">显示户主姓名列表</span></b><b>
</b></p>
</td>
</tr>
<tr>
<td valign="top" style="border-width:0px 1pt 1pt;border-style:none solid solid;padding:0cm 5.4pt;width:108.25pt;background-color:transparent;">
<p style="text-align:center;"><b><span style="font-size:12pt;">DataGridView</span></b></p>
</td>
<td valign="top" style="border-width:0px 1pt 1pt 0px;border-style:none solid solid none;padding:0cm 5.4pt;width:108.3pt;background-color:transparent;">
<p style="text-align:center;"><b><span style="font-size:12pt;">DataGridView1</span></b></p>
</td>
<td valign="top" style="border-width:0px 1pt 1pt 0px;border-style:none solid solid none;padding:0cm 5.4pt;width:108.3pt;background-color:transparent;">
<p style="text-align:center;"><b><span style="font-size:12pt;">显示查询结果</span></b><b>
</b></p>
</td>
</tr>
</tbody>
</table>
</div>
<p></p>
<p style="text-align:center;"><b></b></p>
<p></p>
<p><span style="font-size:12pt;">2.</span><span style="font-size:12pt;">在窗体模块中声明全局变量，过程如下：</span>
</p>
<p></p>
<p style="text-align:left;"><span style="font-size:12pt;">Dim NumColumn(1000) As String //</span><span style="font-size:12pt;">该数组用来存储编号</span>
</p>
<p></p>
<p><span style="font-size:12pt;">Dim NameColumn(1000) As String //</span><span style="font-size:12pt;">该数组用来存储户主姓名</span>
</p>
<p></p>
<p></p>
<p></p>
<p><span style="font-size:12pt;">3.</span> solid none;padding:0cm 5.4pt;width:108.3pt;background-color:transparent;">
<p style="text-align:center;"><b><span style="font-size:12pt;">DataGridView1</span></b></p>
</td>
<td valign="top" style="border-width:0px 1pt 1pt 0px;border-style:none solid solid none;padding:0cm 5.4pt;width:108.3pt;background-color:transparent;">
<p style="text-align:center;"><b><span style="font-size:12pt;">显示查询结果</span></b><b>
</b></p>
</td>
</tr>
</tbody>
</table>
</div>
<p></p>
<p style="text-align:center;"><b></b></p>
<p></p>
<p><span style="font-size:12pt;">2.</span><span style="font-size:12pt;">在窗体模块中声明全局变量，过程如下：</span>
</p>
<p></p>
<p style="text-align:left;"><span style="font-size:12pt;">Dim NumColumn(1000) As String //</span><span style="font-size:12pt;">该数组用来存储编号</span>
</p>
<span style="font-size:12pt;">动态更新式模糊查询的实现过程的代码如下：</span>
</p>
<p></p>
<p style="text-align:left;"><span style="font-size:12pt;">Private Sub TextBox1_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TextBox1.TextChanged</span></p>
<p></p>
<p style="text-align:left;"><span style="font-size:12pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim mystr As String</span></p>
<p></p>
<p style="text-align:left;"><span style="font-size:12pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If ComboBox1.Text =
</span><span style="font-size:12pt;">“按文字方式检索”</span><span style="font-size:12pt;"> Then</span></p>
<p></p>
<p style="text-align:left;"><span style="font-size:12pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mystr = TextBox1.Text &amp; &quot;%&quot;</span></p>
<p></p>
<p style="text-align:left;"><span style="font-size:12pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Try</span></p>
<p></p>
<p style="text-align:left;"><span style="font-size:12pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Me.Sheet2TableAdapter.FillBy1(Me.Database1DataSet1.Sheet2, mystr)</span></p>
<p></p>
<p style="text-align:left;"><span style="font-size:12pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;Catch ex As System.Exception</span></p>
<p></p>
<p style="text-align:left;"><span style="font-size:12pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.Windows.Forms.MessageBox.Show(ex.Message)</span></p>
<p></p>
<p style="text-align:left;"><span style="font-size:12pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Try</span></p>
<p></p>
<p style="text-align:left;"><span style="font-size:12pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If</span></p>
<p></p>
<p style="text-align:left;"><span style="font-size:12pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If ComboBox1.Text =&nbsp;
</span><span style="font-size:12pt;">“按拼音方式检索”</span><span style="font-size:12pt;">Then</span></p>
<p></p>
<p style="text-align:left;"><span style="font-size:12pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mystr = TextBox1.Text &amp; &quot;%&quot;</span></p>
<p></p>
<p style="text-align:left;"><span style="font-size:12pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Try</span></p>
<p></p>
<p style="text-align:left;"><span style="font-size:12pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Me.Sheet2TableAdapter.FillBy2(Me.Database1DataSet1.Sheet2, mystr)</span></p>
<p></p>
<p style="text-align:left;"><span style="font-size:12pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Catch ex As System.Exception</span></p>
<p></p>
<p style="text-align:left;"><span style="font-size:12pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.Windows.Forms.MessageBox.Show(ex.Message)</span></p>
<p></p>
<p style="text-align:left;"><span style="font-size:12pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Try</span></p>
<p></p>
<p style="text-align:left;"><span style="font-size:12pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If</span></p>
<p></p>
<p style="text-align:left;"><span style="font-size:12pt;">&nbsp;&nbsp;&nbsp; End Sub</span></p>
<p></p>
<p><span style="font-size:12pt;">4.<b> </b></span><span style="font-size:12pt;">每户家庭中以户主为中心的关系查询的实现过程的代码如下：</span>
</p>
<p></p>
<p style="text-align:left;"><span style="font-size:9pt;">&nbsp;</span><span style="font-size:12pt;">&nbsp;Private Sub TreeView1_AfterSelect(ByVal sender As System.Object, ByVal e As System.Windows.Forms.TreeViewEventArgs) Handles TreeView1.AfterSelect</span></p>
<p></p>
<p style="text-align:left;"><span style="font-size:12pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Try</span></p>
<p></p>
<p style="text-align:left;"><span style="font-size:12pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Me.Sheet2TableAdapter.FillBy(Me.Database1DataSet1.Sheet2, NumColumn(e.Node.Index))</span></p>
<p></p>
<p style="text-align:left;"><span style="font-size:12pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Catch ex As System.Exception</span></p>
<p></p>
<p style="text-align:left;"><span style="font-size:12pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.Windows.Forms.MessageBox.Show(ex.Message)</span></p>
<p></p>
<p style="text-align:left;"><span style="font-size:12pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Try</span></p>
<p></p>
<p style="text-align:left;"></p>
<p></p>
<p><span style="font-size:12pt;">&nbsp;&nbsp;&nbsp; End Sub</span><b> </b></p>
<p></p>
<p><span style="font-size:12pt;">5.</span><span style="font-size:12pt;">将</span><span style="font-size:12pt;">DataGridView</span><span style="font-size:12pt;">控件中的查询结果导入到</span><span style="font-size:12pt;">Excel</span><span style="font-size:12pt;">中，来自动化生成《常住人口登记表》的实现过程的代码如下：</span>
</p>
<p></p>
<p style="text-align:left;"><span style="font-size:12pt;">Dim xApp As Microsoft.Office.Interop.Excel.Application = New Microsoft.Office.Interop.Excel.Application</span></p>
<p></p>
<p><span>Dim xBook As Microsoft.Office.Interop.Excel.Workbook = xApp.Workbooks.Open(&quot;D:\My Documents\Visual Studio 2008\WindowsApplication1\WindowsApplication1\.”</span><span>常住人口登记表</span><span>”.xl.MessageBox.Show(ex.Message)</span></p>
<p></p>
<p style="text-align:left;"><span style="font-size:12pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Try</span></p>
<p></p>
<p style="text-align:left;"></p>
<p></p>
<p><span style="font-size:12pt;">&nbsp;&nbsp;&nbsp; End Sub</span><b> </b></p>
<p></p>
<p><span style="font-size:12pt;">5.</span><span style="font-size:12pt;">将</span><span style="font-size:12pt;">DataGridView</span><span style="font-size:12pt;">控件中的查询结果导入到</span><span style="font-sizes&quot;)</span>
</p>
<p></p>
<p style="text-align:left;"><span style="font-size:12pt;">xApp.Cells(2, 1) = gridView(1, i).Value.ToString</span></p>
<p></p>
<p style="text-align:left;"><span style="font-size:12pt;">xApp.Cells(2, 7) = gridView(2, 1).Value.ToString</span></p>
<p></p>
<p style="text-align:left;"><span style="font-size:12pt;">xApp.Cells(2, 8) = gridView(3, i).Value.ToString</span></p>
<p></p>
<p><span style="font-size:12pt;">xApp.Cells(3, 2) = gridView(4, i).Value.ToString</span>
</p>
<p></p>
<p><span style="font-size:12pt;">&nbsp; <b>&nbsp;……&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ……</b></span></p>
<p></p>
<p><span style="font-size:12pt;">xApp.Cells(11, 2) = <span>
&quot;&#39;&quot;</span> &amp; gridView(17, i).Value.ToString</span> </p>
<p></p>
<p><span style="font-size:12pt;">//</span><span>不仅将</span><b>DataGridView</b><span>控件中相应行列表&amp;#26684;中的数据转化为数字字符串，还要在字符串前面加上“</span><b><span style="font-size:12pt;">’</span></b><span style="font-size:12pt;">”</span>
</p>
<p></p>
<p><b><span style="font-size:12pt;">……&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;……</span></b></p>
<p></p>
<p><b><span style="font-size:12pt;">四、结语：</span></b><b> </b></p>
<p></p>
<p><span style="font-size:12pt;">1.</span><span style="font-size:12pt;">本程序在</span><b><span style="font-size:12pt;">Windows XP SP2</span></b><b><span style="font-size:12pt;">，</span></b><b><span style="font-size:12pt;">Visual Studio2008</span></b><b><span style="font-size:12pt;">，</span></b><b><span style="font-size:12pt;">Access2007</span></b><b><span style="font-size:12pt;">，</span></b><b><span style="font-size:12pt;">Excel2007</span></b><span style="font-size:12pt;">下调是通过。</span><span style="font-size:12pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></p>
<p></p>
<p><span style="font-size:12pt;">2.</span><span style="font-size:12pt;">本文以实际村民常住人口登记信息管理系统为例，重点介绍开发数据库应用程序所涉及的对数据查询、组织、导出的三个通用基本操作的技术实现。希望对学习数据库管路系统开发的初学者有所裨益。</span>
</p>
<p></p>
<p style="text-align:center;"></p>
<p></p>
<p style="text-align:center;"><b><span style="font-size:12pt;">参</span></b><b>
</b><b><span style="font-size:12pt;">考</span></b><b> </b><b><span style="font-size:12pt;">文</span></b><b>
</b><b><span style="font-size:12pt;">献</span></b><b> </b></p>
<p></p>
<p><b><span style="font-size:12pt;">[1] </span></b><span style="font-size:12pt;">明日科技</span><span style="font-size:12pt;">
<b>Visual Basic</b></span><span style="font-size:12pt;">数据库系统开发完全手册</span><span style="font-size:12pt;">&nbsp;
</span><span style="font-size:12pt;">人民邮电出版社，</span><span style="font-size:12pt;">2006</span></p>
<p></p>
<p><b><span style="font-size:12pt;">[2]</span></b><span style="font-size:12pt;"> <b>
Microsoft corporation MSDN Library for Visual Studio2008</b></span></p>
<p></p>
<p>&nbsp;</p>

</div>
    
    
