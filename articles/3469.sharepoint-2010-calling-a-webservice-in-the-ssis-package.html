---
layout: default
title: SharePoint 2010&#58; Calling a Webservice in the SSIS Package - TechNet Articles - United States (English) - TechNet Wiki
weight: 3
---

<div class="post-content user-defined-markup">

<h3 class="post-title entry-title" style="margin:0px;letter-spacing:-1px;"><a name="SharePoint_provides_a_large_number_of_web_services_and_you_just_need_to_create_proxy_of_the_web_service_that_you_want_to_use_You_can_create_a_proxy_using_wsdl_exe_tool_in_the_Visual_Studio_command_prompt_The_syntax_for_wsdl_exe_is_wsdl_exe_http_lt_your_site_name_gt_vti_bin_lt_service_name_gt_asmx_wsdl_o_lt_location_gt_lt_proxy_file_name_gt_cs_l_CS_You_can_choose_between_VB_and_C_and_modify_the_command_accordingly_Create_a_SSIS_project_and_add_the_Data_flow_task_In_the_data_flow_task_add_Script_Component_as_a_source_In_the_script_component_double_click_gt_edit_script_add_the_proxy_created_in_the_first_step_to_the_project_as_existing_item_by_browsing_through_the_proxy_location_Add_the_reference_of_System_Web_Services_through_References_gt_Add_Reference_Add_using_System_Web_Services_and_using_System_XML_to_the_script_component_code_Now_create_an_instance_of_the_web_service_that_you_are_using_and_all_the_methods_of_that_web_service_are_available_for_use_through_that_instance_For_accessing_a_particular_list_we_can_use_lt_instance_name_gt_GetListItems_params_method_You_will_have_to_use_some_XML_techniques_to_get_the_required_data_from_the_list_returned_by_the_web_method_in_a_XML_document_and_then_filtering_the_required_columns_using_Collaborative_Application_Markup_Language_CAML_which_is_specifically_used_for_SharePoint_You_can_google_for_more_information_on_CAML_The_code_for_taking_the_data_in_XML_is_available_in_the_Windows_SharePoint_Services_WSS_3_0_SDK_again_some_googling_will_give_you_the_code_Create_the_relevant_output_columns_in_the_SSIS_script_component_and_assign_the_appropriate_column_values_available_in_the_XML_node_list_Now_use_the_SSIS_destination_task_to_take_the_columns_provided_by_the_script_component_to_the_database_table_Given_the_variety_of_web_services_provided_by_SharePoint_you_can_access_the_information_for_any_level_that_includes_document_library_subsites_subsites_of_subsites_etc_This_is_indeed_the_easiest_way_to_get_the_SharePoint_data_in_the_SQL_database"></a>
<a name="SharePoint_provides_a_large_number_of_web_services_and_you_just_need_to_create_proxy_of_the_web_service_that_you_want_to_use_You_can_create_a_proxy_using_wsdl_exe_tool_in_the_Visual_Studio_command_prompt_The_syntax_for_wsdl_exe_is_wsdl_exe_http_lt_your_site_name_gt_vti_bin_lt_service_name_gt_asmx_wsdl_o_lt_location_gt_lt_proxy_file_name_gt_cs_l_CS_You_can_choose_between_VB_and_C_and_modify_the_command_accordingly_Create_a_SSIS_project_and_add_the_Data_flow_task_In_the_data_flow_task_add_Script_Component_as_a_source_In_the_script_component_double_click_gt_edit_script_add_the_proxy_created_in_the_first_step_to_the_project_as_existing_item_by_browsing_through_the_proxy_location_Add_the_reference_of_System_Web_Services_through_References_gt_Add_Reference_Add_using_System_Web_Services_and_using_System_XML_to_the_script_component_code_Now_create_an_instance_of_the_web_service_that_you_are_using_and_all_the_methods_of_that_web_service_are_available_for_use_through_that_instance_For_accessing_a_particular_list_we_can_use_lt_instance_name_gt_GetListItems_params_method_You_will_have_to_use_some_XML_techniques_to_get_the_required_data_from_the_list_returned_by_the_web_method_in_a_XML_document_and_then_filtering_the_required_columns_using_Collaborative_Application_Markup_Language_CAML_which_is_specifically_used_for_SharePoint_You_can_google_for_more_information_on_CAML_The_code_for_taking_the_data_in_XML_is_available_in_the_Windows_SharePoint_Services_WSS_3_0_SDK_again_some_googling_will_give_you_the_code_Create_the_relevant_output_columns_in_the_SSIS_script_component_and_assign_the_appropriate_column_values_available_in_the_XML_node_list_Now_use_the_SSIS_destination_task_to_take_the_columns_provided_by_the_script_component_to_the_database_table_Given_the_variety_of_web_services_provided_by_SharePoint_you_can_access_the_information_for_any_level_that_includes_document_library_subsites_subsites_of_subsites_etc_This_is_indeed_the_easiest_way_to_get_the_SharePoint_data_in_the_SQL_database_Give_it_a_try"></a><a name="SharePoint_provides_a_large_number_of_web_services_and_you_just_need_to_create_proxy_of_the_web_service_that_you_want_to_use_You_can_create_a_proxy_using_wsdl_exe_tool_in_the_Visual_Studio_command_prompt_The_syntax_for_wsdl_exe_is_wsdl_exe_http_lt_your_site_name_gt_vti_bin_lt_service_name_gt_asmx_wsdl_o_lt_location_gt_lt_proxy_file_name_gt_cs_l_CS_You_can_choose_between_VB_and_C_and_modify_the_command_accordingly_middot_Create_a_SSIS_project_and_add_the_Data_flow_task_In_the_data_flow_task_add_Script_Component_as_a_source_middot_In_the_script_component_double_click_gt_edit_script_add_the_proxy_created_in_the_first_step_to_the_project_as_existing_item_by_browsing_through_the_proxy_location_Add_the_reference_of_System_Web_Services_through_References_gt_Add_Reference_middot_Add_using_System_Web_Services_and_using_System_XML_to_the_script_component_code_middot_Now_create_an_instance_of_the_web_service_that_you_are_using_and_all_the_methods_of_that_web_service_are_available_for_use_through_that_instance_For_accessing_a_particular_list_we_can_use_lt_instance_name_gt_GetListItems_params_hellip_method_middot_You_will_have_to_use_some_XML_techniques_to_get_the_required_data_from_the_list_returned_by_the_web_method_in_a_XML_document_and_then_filtering_the_required_columns_using_Collaborative_Application_Markup_Language_CAML_which_is_specifically_used_for_SharePoint_You_can_google_for_more_information_on_CAML_The_code_for_taking_the_data_in_XML_is_available_in_the_Windows_SharePoint_Services_WSS_3_0_SDK_again_some_googling_will_give_you_the_code_middot_Create_the_relevant_output_columns_in_the_SSIS_script_component_and_assign_the_appropriate_column_values_available_in_the_XML_node_list_middot_Now_use_the_SSIS_destination_task_to_take_the_columns_provided_by_the_script_component_to_the_database_table_Given_the_variety_of_web_services_provided_by_SharePoint_you_can_access_th_the_web_service_that_you_are_using_and_all_the_methods_of_that_web_service_are_available_for_use_through_that_instance_For_accessing_a_particular_list_we_can_use_lt_instance_name_gt_GetListItems_params_hellip_method_middot_You_will_have_to_use_some_XML_techniques_to_get_the_required_data_from_the_list_returned_by_the_web_method_in_a_XML_document_and_then_filtering_the_required_columns_using_Collaborative_Application_Markup_Language_CAML_which_is_specifically_used_for_SharePoint_You_can_google_for_more_information_on_CAML_The_code_for_taking_the_data_in_XML_is_available_in_the_Winde_information_for_any_level_that_includes_document_library_subsites_subsites_of_subsites_etc_This_is_indeed_the_easiest_way_to_get_the_SharePoint_data_in_the_SQL_database_Give_it_a_try"></a><a name="SharePoint_provides_a_large_number_of_web_services_and_you_just_need_to_create_proxy_of_the_web_service_that_you_want_to_use_You_can_create_a_proxy_using_wsdl_exe_tool_in_the_Visual_Studio_command_prompt_The_syntax_for_wsdl_exe_is_wsdl_exe_http_lt_your_site_name_gt_vti_bin_lt_service_name_gt_asmx_wsdl_o_lt_location_gt_lt_proxy_file_name_gt_cs_l_CS_You_can_choose_between_VB_and_C_and_modify_the_command_accordingly_middot_Create_a_SSIS_project_and_add_the_Data_flow_task_In_the_data_flow_task_add_Script_Component_as_a_source_middot_In_the_script_component_double_click_gt_edit_script_add_the_proxy_created_in_the_first_step_to_the_project_as_existing_item_by_browsing_through_the_proxy_location_Add_the_reference_of_System_Web_Services_through_References_gt_Add_Reference_middot_Add_using_System_Web_Services_and_using_System_XML_to_the_script_component_code_middot_Now_create_an_instance_of_the_web_service_that_you_are_using_and_all_the_methods_of_that_web_service_are_available_for_use_through_that_instance_For_accessing_a_particular_list_we_can_use_lt_instance_name_gt_GetListItems_params_hellip_method_middot_You_will_have_to_use_some_XML_techniques_to_get_the_required_data_from_the_list_returned_by_the_web_method_in_a_XML_document_and_then_filtering_the_required_columns_using_Collaborative_Application_Markup_Language_CAML_which_is_specifically_used_for_SharePoint_You_can_google_for_more_information_on_CAML_The_code_for_taking_the_data_in_XML_is_available_in_the_Windows_SharePoint_Services_WSS_3_0_SDK_again_some_googling_will_give_you_the_code_middot_Create_the_relevant_output_columns_in_the_SSIS_script_component_and_assign_the_appropriate_column_values_available_in_the_XML_node_list_middot_Now_use_the_SSIS_destination_task_to_take_the_columns_provided_by_the_script_component_to_the_database_table_Given_the_variety_of_web_services_provided_by_SharePoint_you_can_access_the_information_for_any_level_that_includes_document_library_subsites_subsites_of_subsites_etc_This_is_indeed_the_easiest_way_to_get_the_SharePoint_data_in_the_SQL_database_Give_it_a_try"></a>
<p><span style="font-weight:normal;">SharePoint provides a large number of web services and you just need to create proxy of the web service that you want to use. You can create a proxy using wsdl.exe tool in the Visual Studio command prompt. The syntax for
 wsdl.exe is&nbsp;</span><br />
&nbsp;&nbsp;<br />
<span style="font-weight:normal;">wsdl.exe</span>&nbsp;<a href="http://%3cyour/">http://&lt;your</a>&nbsp;<span style="font-weight:normal;">site name&gt;/_vti_bin/&lt;service name&gt;.asmx?wsdl /o:&lt;location&gt;\&lt;proxy file name&gt;.cs /l:CS&nbsp;</span><br />
<span style="font-weight:normal;">You can choose between VB and C# and modify the command&nbsp;&nbsp; accordingly.&nbsp;<br />
</span>&nbsp;&nbsp;<br />
<span style="font-weight:normal;">Â·&nbsp;Create a SSIS project and add the Data flow task. In the data flow task add Script Component as a source.&nbsp;<br />
</span>&nbsp;&nbsp;<br />
<span style="font-weight:normal;">Â·&nbsp;In the script component (double click - &gt; edit script) add the proxy (created in the first step) to the project as existing item by browsing through the proxy location. Add the reference of System.Web.Services through References
 -&gt; Add Reference.&nbsp;<br />
</span>&nbsp;&nbsp;<br />
<span style="font-weight:normal;">Â·&nbsp;Add using System.Web.Services and using System.XML to the script component code.&nbsp;<br />
&nbsp;&nbsp;<br />
</span>Â·&nbsp;<span style="font-weight:normal;">Now create an instance of the web service that you are using and all the methods of that web service are available for use through that instance. For accessing a particular list we can use &lt;instance name&gt;.GetListItems
 (paramsâ¦) method.&nbsp;<br />
&nbsp;&nbsp;<br />
Â·&nbsp;You will have to use some XML techniques to get the required data from the list (returned by the web method) in a XML document and then filtering the required columns using Collaborative Application Markup Language (CAML) which is specifically used for SharePoint.
 You can google for more information on CAML.&nbsp; The code for taking the data in XML is available in the Windows SharePoint Services (WSS) 3.0 SDK (again some googling will give you the code)&nbsp;<br />
&nbsp;&nbsp;<br />
Â·&nbsp;Create the relevant output columns in the SSIS script component and assign the appropriate column values available in the XML node list.&nbsp;<br />
&nbsp;&nbsp;</span><br />
Â·&nbsp;<span style="font-weight:normal;">Now use the SSIS destination task to take the columns provided by the script component to the database table.</span></p>
<p><span style="font-weight:normal;">Given the variety of web services provided by SharePoint you can access the information for any level that includes document library, subsites, subsites of subsites etc. This is indeed the easiest way to get the SharePoint
 data in the SQL database.</span></p>
</h3>

</div>
    
    