---
layout: default
title: 'Client Object Model para Silverlight (pt-BR) - TechNet Articles - United States (English) - TechNet Wiki'
weight: 3
---

<div class="post-content user-defined-markup">

<strong><span style="font-size:18px;"><span style="font-size:12px;"><br />
<strong style="line-height:18px;">
<div class="table-of-contents" style="padding:10px;display:inline-block;">
<h2 class="title" style="line-height:25px;padding-top:0px;font-size:1.65em;margin-bottom:0.inner fiji-content-fragment-inner"><div class="content-fragment-top fiji-content-fragment-top"><div class="r1 fiji-r1"></div><div class="r2 fiji-r2"></div><div class="r3 fiji-r3"></div><div class="r4 fiji-r4"></div></div><div class="content-fragment-content">

<div class="full-post-header"></div>
<div class="full-post">
    <h1 class="post-name">Client Ob25em;border-bottom-width:medium;border-bottom-style:none;">
<a name="Table_of_Contents"></a>Table of Contents</h2>
<div class="hierarchy-list-header"></div>
<ul class="hierarchy-list" style="margin:0px;padding:0px;border-bottom-width:1px;border-bottom-style:dotted;list-style-type:none;">
<li class="hierarchy-item" style="margin:0px;padding:0px;border-top-width:1px;border-top-style:dotted;border-bottom-style:none;position:relative;">
<a href="http://social.technet.microsoft.com/wiki/contents/articles/4872.aspx#Introdu_ccedil_atilde_o" style="padding:2px 0px;display:block;">Introdução</a>
</li><li class="hierarchy-item" style="margin:0px;padding:0px;border-top-width:1px;border-top-style:dotted;border-bottom-style:none;position:relative;">
<a href="http://social.technet.microsoft.com/wiki/contents/articles/4872.aspx#Solu_ccedil_otilde_es_em_Sandbox" style="padding:2px 0px;display:block;">Solução</a>
</li><li class="hierarchy-item" style="margin:0px;padding:0px;border-top-width:1px;border-top-style:dotted;border-bottom-style:none;position:relative;">
<a href="http://social.technet.microsoft.com/wiki/contents/articles/4872.aspx#Sandbox_Web_Part" style="padding:2px 0px;display:block;">Arquitetura do Client Object Model&nbsp;</a>
</li><li class="hierarchy-item" style="margin:0px;padding:0px;border-top-width:1px;border-top-style:dotted;border-bottom-style:none;position:relative;">
<a href="http://social.technet.microsoft.com/wiki/contents/articles/4872.aspx#SharePoint_Ribbons" style="padding:2px 0px;display:block;">Exemplo</a>
</li><li class="hierarchy-item" style="margin:0px;padding:0px;border-top-width:1px;border-top-style:dotted;border-bottom-style:none;position:relative;">
<a href="http://social.technet.microsoft.com/wiki/contents/articles/4872.aspx#Criar_uma_Solu_ccedil_atilde_o_em_SharePoint" style="padding:2px 0px;display:block;">SharePoint SilverLight Web Part</a>
</li><li class="hierarchy-item" style="margin:0px;padding:0px;border-top-width:1px;border-top-style:dotted;border-bottom-style:none;position:relative;">
<a href="http://social.technet.microsoft.com/wiki/contents/articles/4872.aspx#Refer_ecirc_ncias" style="padding:2px 0px;display:block;">Referências</a>
</li></ul>
<div class="hierarchy-list-footer"></div>
</div>
</strong><br />
</span><br />
Introdução</span><br />
</strong><br />
O SharePoint tem tido um sucesso a nível mundial na sua adopção como uma das ferramenta empressariais de Portais e Colaboração, este artigo tem como prespectiva a sua demostração como ferramenta de desenvolvimento para Soluções empresariais.<br />
<br />
Neste artigo irei ainda dar atenção a um dos novos serviços disponibilizados pelo SharePoint 2010 que é o Client Object Model para Silverlight, com a criação de um projecto e chamada de métodos para demostrar a sua capacidade de acesso a conteudos existente
 nos sites em SharePoint.<br />
<br />
<strong><span style="font-size:18px;">Solução</span></strong><br />
<br />
A plataforma SharePoint é um conjunto integrado de recursos que pode ajudar a melhorar a eficácia organizacional fornecendo uma gestão de conteúdo abrangente e pesquisa empresarial, acelerando os processos comerciais compartilhados e facilitando a partilha
 de informações para uma melhor visão dos negócios.<br />
<br />
Os serviços disponibilizados vão desde Gestão de Conteúdos, Gestão Documental, Business Intelligence, Comunidades, Integração de Plataforma externas a Microsoft através dos BCS(Business Connectivity Services), Workflows, Office Web app (Integração das ferramentas
 Microsoft Office em formato Web),&nbsp;<a href="http://www.microsoft.com/download/en/details.aspx?id=16573" target="_blank">SharePoint Designer 2010</a>, Gestão de Projectos, Serviços de Pesquisa de Portal e Conteúdos Externo, com diversos tipos de autenticação
 utilização de federações entre outros serviços. Enfim uma plataforma bastante completa.<br />
<br />
Durante os últimos anos a plataforma tem crescido a nível de serviço e a nível de importância nas instituições empresariais, tornando uma aposta mais que decisiva da Microsoft, com a sua implementação e integração de todos os seus produtos nesta plataforma,
 tornando-se o sistema operativo das empresas.<br />
<br />
Uma das sua vantagens é a capacidade de integração entre as diversas tecnologias Microsoft e a capacidade de integrações de plataformas externas, como SAP, Oracle entre outras, de forma a torna um ponto de partilha única da Informação da empresa, sendo construido
 numa plataforma Web o que torna bastante acessível o seu acesso.<br />
<br />
No próximo quadro encontram-se os serviços que estão disponíveis para o SharePoint 2010.
<p style="text-align:center;"><a href="http://aaclage.files.wordpress.com/2010/11/8f613e0ed52c7627af08f23d6d8ab06b.png" rel="WLPP"><img alt=" " src="http://aaclage.files.wordpress.com/2010/11/8f613e0ed52c7627af08f23d6d8ab06b.png?w=300" style="border-width:0px;border-style:solid;" /></a></p>
Com o lançamento do SharePoint 2010 foram disponibilizados múltiplos novos serviços como LINQ, novas API’s para acesso a dados (utilizando o Client Object Model), utilização de REST – ADO.NET Data Services e utilização de Ajax em webParts com processos Asynchronous
 (sem utilização de postback nas páginas) entre outros novos serviços.<br />
O SharePoint 2010 apresenta 3 novas Client API’s para interagir com conteúdos dos sites de SharePoint:
<ul>
<li>A partir de aplicações .Net “nunca inferiores a Framework 3.5”; </li><li>A partir de aplicações Silverlight “nunca inferiores a Silverlight 2.0” </li><li>A partis de ECMAScript ou seja de Javascript, Jscript </li></ul>
<p style="text-align:center;"><a href="http://aaclage.files.wordpress.com/2010/11/41a042f01664e7167a38faf6ad09b428.png" rel="WLPP"><img alt=" " src="http://aaclage.files.wordpress.com/2010/11/41a042f01664e7167a38faf6ad09b428.png?w=295" style="border-width:0px;border-style:solid;" /></a></p>
<strong>Arquitectura do Client Object Model</strong><br />
<br />
Estas novas API em Client Object Model fornecem um sistema orientado a objectos para interagir com os dados do SharePoint remotamente, sendo bastante fáceis de utilizar porque a sua nomenclatura é bastante parecida do Server Object Model do SharePoint.<br />
<br />
Para demostrar a forma de acesso aos Objectos da API na próxima tabela mostra a diferentes API’s para as diversas plataformas e a forma idêntica da utilização do Object Model.
<p style="text-align:center;"><a href="http://aaclage.files.wordpress.com/2010/11/f626b0061c2ab991719d9eb8d473d035.png" rel="WLPP"><img alt=" " src="http://aaclage.files.wordpress.com/2010/11/f626b0061c2ab991719d9eb8d473d035.png?w=300" style="border-width:0px;border-style:solid;" /></a></p>
<span style="font-size:18px;"><strong>Exemplo</strong></span><br />
Neste exemplo, irei criar um pequeno Projecto no Visual Studio 2010, com uma aplicação em Silverlight 4, utilizando a API do SharePoint e integrando do SharePoint 2010.<br />
<br />
Para suporte da nossa solução em SharePoint eu criei uma Lista chamada “Geral” com um conjunto de dados para teste.
<p style="text-align:center;"><a href="http://aaclage.files.wordpress.com/2010/11/2109812732eb8f9d098ca5687445a7a8.png" rel="WLPP"><img alt=" " src="http://aaclage.files.wordpress.com/2010/11/2109812732eb8f9d098ca5687445a7a8.png?w=300" style="border-width:0px;border-style:solid;" /></a><br />
<br />
Criar um novo Projecto com o Visual Studio 2010 no Template “Silverlight”http://aaclage.files.wordpress.com/2010/11/f626b0061c2ab991719d9eb8d473d035.png" rel="WLPP"><img alt=" " src="http://aaclage.files.wordpress.com/2010/11/f626b0061c2ab991719d9eb8d473d035.png?w=300" style="border-width:0px;border-style:solid;" /></a></p>
<span style="font-size:18px;"><strong>Exemplo</strong></span><br />
Neste exemplo, irei criar um pequeno Projecto no Visual Studio 2010, com uma aplicação em Silverlight 4, utilizando a API do SharePoint e integrando do Shar e seleccionar a opção para associar a um novo Web site com a versão do Silverlight 4:</p>
<blockquote><br />
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td valign="top" style="width:288px;">
<p style="text-align:center;"><a href="http://aaclage.files.wordpress.com/2010/11/b56ae32c04aa109d1ade1ee4ae6ccf83.jpg" rel="WLPP"><img alt=" " src="http://aaclage.files.wordpress.com/2010/11/b56ae32c04aa109d1ade1ee4ae6ccf83.jpg?w=300" style="border-width:0px;border-style:solid;" /></a></p>
</td>
<td valign="top" style="width:288px;">
<p style="text-align:center;"><a href="http://aaclage.files.wordpress.com/2010/11/58761ac3f5f79f514f0b4b0f71fab127.png" rel="WLPP"><img alt=" " src="http://aaclage.files.wordpress.com/2010/11/58761ac3f5f79f514f0b4b0f71fab127.png?w=300" style="border-width:0px;border-style:solid;" /></a></p>
</td>
</tr>
</tbody>
</table>
</blockquote>
<p>Para realizar as chamadas ao conteúdo do SharePoint, através da API em Silverlight, será necessário adicionar como referencias as DLL’s que se encontram na pasta da instalação do SharePoint 2010 (Microsoft.SharePoint.Client.Silverlight e Microsoft.SharePoint.Client.Silverlight.Runtime),
 tipicamente em C:\Program Files\Common Files\Microsoft Shared\Web Server Extensions\14\TEMPLATE\LAYOUTS\ClientBin.</p>
<p style="text-align:center;"><a href="http://aaclage.files.wordpress.com/2010/11/8ff040a705fd76e61af9cb530beb8bd3.png" rel="WLPP"><img alt=" " src="http://aaclage.files.wordpress.com/2010/11/8ff040a705fd76e61af9cb530beb8bd3.png?w=283" style="border-width:0px;border-style:solid;" /></a></p>
<p>A Microsoft disponibilizou um package com as DLLs em SharePoint .NET Client Object Model, onde se poderá realizar o download e a sua distribuição ao cliente.</p>
<p>SharePoint Foundation 2010 Client Object Model Redistributable</p>
<p><a href="http://www.microsoft.com/downloads/en/details.aspx?FamilyID=b4579045-b183-4ed4-bf61-dc2f0deabe47">http://www.microsoft.com/downloads/en/details.aspx?FamilyID=b4579045-b183-4ed4-bf61-dc2f0deabe47</a></p>
<p>Com a utilização do Visual Studio 2010 existe a possibilidade de integrar o Microsoft Expression Blend 4 com as nossas aplicações desenvolvidas em Silverlight.</p>
<p style="text-align:center;"><a href="http://aaclage.files.wordpress.com/2010/11/b123f76861066172bc1be05f1eec08fc.png" rel="WLPP"><img alt=" " src="http://aaclage.files.wordpress.com/2010/11/b123f76861066172bc1be05f1eec08fc.png?w=300" style="border-width:0px;border-style:solid;" /></a></p>
<p>Depois de termos realizado a nossa customização podemos voltar à nossa solução em Visual Studio 2010 e começar a criar os nosso métodos para retornar conteúdo do Site. Para isso criei 2 métodos, um para retornar a listas do nosso site em SharePoint e outro
 para retornar o conteúdo de uma Lista numa Datagrid.</p>
<p><strong>Método 1</strong>:</p>
<p>Retorna o nome das Listas existentes no site de SharePoint utilizando o Client Object Mode. Foi utilizado uma expressão Lambda para retornar as listas e o Titulo associado.<strong></strong></p>
<div>
<div><span><code></code></span></div>
<div class="reCodeBlock" style="overflow-y:auto;">
<div><span><code style="font-weight:bold;">private</code>
<code style="font-weight:bold;">void</code> <code>
LoadLists()</code></span></div>
<div><span><code>{</code></span></div>
<div><span><code>ClientContext clientContext =
</code><code style="font-weight:bold;">new</code> <code>
ClientContext(“http:</code><code>//[Site]“);</code></span></div>
<div><span><code>oWebsite = clientContext.Web;</code></span></div>
<div><span><code>collList = oWebsite.Lists;</code></span></div>
<div><span><code>clientContext.Load(oWebsite,</code></span></div>
<div><span><code>website =&gt; website.Title);</code></span></div>
<div><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div><span><code>//Lambda expression para retornar as Listas</code></span></div>
<div><span><code>listInfo = clientContext.LoadQuery(</code></span></div>
<div><span><code>collList.Include(</code></span></div>
<div><span><code>list =&gt; list.Title,</code></span></div>
<div><span><code>list =&gt; list.Fields.Include(</code></span></div>
<div><span><code>field =&gt; field.Title).Where(</code></span></div>
<div><span><code>field =&gt; field.Required ==
</code><code style="font-weight:bold;">true</code></span></div>
<div><span><code>&amp;&amp; field.Hidden !=
</code><code style="font-weight:bold;">true</code><code>)));</code></span></div>
<div><span><code>clientContext.ExecuteQueryAsync(onQuerySucceeded, onQueryFailed);</code></span></div>
<div><span><code>}</code></span></div>
</div>
<div><span><code></code></span></div>
</div>
<pre><div><div><span><code></code></span></div><div class="reCodeBlock" style="overflow-y:auto;"><div><span><code style="font-weight:bold;">private</code> <code style="font-weight:bold;">void</code> <code>onQuerySucceeded(</code><code style="font-weight:bold;">object</code> <code>sender, ClientRequestSucceededEventArgs args)</code></span></div><div><span><code>{&nbsp;&nbsp;&nbsp;&nbsp; 
      UpdateUIMethod updateUI = DisplayInfo;&nbsp;&nbsp;&nbsp;&nbsp; 
</code><code style="font-weight:bold;">      this</code><code>.Dispatcher.BeginInvoke(updateUI);</code></span></div><div><span><code>}</code></span></div><div><span><code>&nbsp;</code><span>&nbsp;</span></span></div><div><span><code style="font-weight:bold;">private</code> <code style="font-weight:bold;">void</code> <code>onQueryFailed(</code><code style="font-weight:bold;">object</code> <code>sender, ClientRequestFailedEventArgs args)</code></span></div><div><span><code>{&nbsp;&nbsp;&nbsp;&nbsp; MessageBox.Show(</code><code style="color:blue;">&quot;Request failed. &quot;</code> <code>&#43; args.Message &#43; </code><code style="color:blue;">&quot;\n&quot;</code> <code>&#43; args.StackTrace);</code></span></div><div><span><code>}</code></span></div><div><span><code>&nbsp;</code><span>&nbsp;</span></span></div><div><span><code style="font-weight:bold;">private</code> <code style="font-weight:bold;">void</code> <code>DisplayInfo()</code></span></div><div><span><code>{&nbsp;&nbsp;&nbsp;&nbsp; 
      collList = oWebsite.Lists;&nbsp;&nbsp;&nbsp;&nbsp; 
      listBox1.ItemsSource = listInfo;&nbsp;&nbsp;&nbsp;&nbsp; 
      listBox1.DisplayMemberPath = </code><code style="color:blue;">&quot;Title&quot;</code><code>;</code></span></div><div><span><code>}</code></span></div><div><span><code style="font-weight:bold;">private</code> <code style="font-weight:bold;">delegate</code> <code style="font-weight:bold;">void</code> <code>UpdateUIMethod();</code></span></div></div><div><span><code></code></span></div></div></pre>
<p>Exemplo:</p>
<p><a href="http://msdn.microsoft.com/en-us/library/ee538971.aspx">http://msdn.microsoft.com/en-us/library/ee538971.aspx</a></p>
<p><strong>Método 2</strong>:</p>
<p>Retorna dados da Lista “Geral” para uma DataGrid utilizando CAML para realizar os filtros dos conteúdos a retornar:</p>
<pre><div><div><span><code></code></span></div><div class="reCodeBlock" style="overflow-y:auto;"><div><span><code style="font-weight:bold;">private</code> <code style="font-weight:bold;">void</code> <code>LoadGrid()</code></span></div><div><span><code>{&nbsp;&nbsp;&nbsp;&nbsp; </code></span></div><div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code>//Contexto do site em SharePoint a chamar&nbsp;&nbsp;&nbsp;&nbsp; </code></span></span></div><div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code>var context = </code><code style="font-weight:bold;">new</code> <code>ClientContext(</code><code style="color:blue;">&quot;<a href="http://social.technet.microsoft.com/wiki/contents/articles/4887/edit.aspx">http://</a>[Site]&quot;</code><code>);&nbsp;&nbsp;&nbsp;&nbsp; </code></span></span></div><div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code>context.Load(context.Web);</code></span></span></div><div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code>//retornar o objecto List com o nome “Geral”&nbsp;&nbsp;&nbsp;&nbsp; </code></span></span></div><div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code>List projects = context.Web.Lists.GetByTitle(</code><code style="color:blue;">&quot;Geral&quot;</code><code>);&nbsp;&nbsp;&nbsp;&nbsp; </code></span></span></div><div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code>context.Load(projects);</code></span></span></div><div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code>//CAML Query para Filtar os valores da nossa Lista</code></span></span></div><div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code>CamlQuery camlQuery = </cnet.microsoft.com/wiki/contents/articles/4887/edit.aspx">http://</a>[Site]&quot;</code><code>);&nbsp;&nbsp;&nbsp;&nbsp; </code></span></span></div><div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code>context.Load(context.Web);</code></span></span></div><div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&ode><code style="font-weight:bold;">new</code> <code>CamlQuery();&nbsp;&nbsp;&nbsp;&nbsp; </code></span></span></div><div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code>camlQuery.ViewXml = </code><code style="color:blue;">&quot;&lt;View&gt;&lt;Query&gt;&lt;Where&gt;&lt;Geq&gt;&lt;FieldRef Name=&#39;ID&#39;/&gt;&quot;</code> <code>&#43;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></span></span></div><div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:blue;">&quot;&lt;Value Type=&#39;Number&#39;&gt;0&lt;/Value&gt;&lt;/Geq&gt;&lt;/Where&gt;&lt;/Query&gt;&lt;RowLimit&gt;100&lt;/RowLimit&gt;&lt;/View&gt;&quot;</code><code>;</code></span></span></div><div><span><code>&nbsp;</code><span>&nbsp;</span></span></div><div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code>_projectItems = projects.GetItems(camlQuery);&nbsp;&nbsp;&nbsp;&nbsp; </code></span></span></div><div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code>context.Load(_projectItems);&nbsp;&nbsp;&nbsp;&nbsp; </code></span></span></div><div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code>context.ExecuteQueryAsync(OnRequestSucceeded, </code><code style="font-weight:bold;">null</code><code>);</code></span></span></div><div><span><code>}</code></span></div></div><div><span><code></code></span></div></div>

</pre>
<div>
<div><span><code></code></span></div>
<div class="reCodeBlock" style="overflow-y:auto;">
<div><span><code style="color:gray;">#region Methods</code></span></div>
<div><span><code>&nbsp;</code><span><code style="font-weight:bold;">private</code>
<code style="font-weight:bold;">void</code> <code>
OnRequestSucceeded(Object sender, ClientRequestSucceededEventArgs args) </code></span></span></div>
<div><span><code>{&nbsp;&nbsp;&nbsp;&nbsp;
</code></span></div>
<div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code>Dispatcher.BeginInvoke(BindData);</code></span></span></div>
<div><span><code>}
</code></span></div>
<div><span><code style="font-weight:bold;">private</code>
<code style="font-weight:bold;">void</code> <code>
BindData() </code></span></div>
<div><span><code>{&nbsp;&nbsp;&nbsp;&nbsp;
</code></span></div>
<div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code>//Utilizando o conteúdo numa lista de Objecto do tipo Geral como a Lista&nbsp;&nbsp;&nbsp;&nbsp;
</code></span></span></div>
<div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code>var list =
</code><code style="font-weight:bold;">new</code> <code>
List&lt;Geral&gt;();&nbsp;&nbsp;&nbsp;&nbsp; </code></span></span></div>
<div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="font-weight:bold;">foreach</code>
<code>(var li </code><code style="font-weight:bold;">in</code>
<code>_projectItems)&nbsp;&nbsp;&nbsp;&nbsp; </code></span></span></div>
<div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code>{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</code></span></span></div>
<div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code>list.Add(</code><code style="font-weight:bold;">new</code>
<code>Geral&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></span></span></div>
<div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code>{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</code></span></span></div>
<div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code>Title = li[</code><code style="color:blue;">&quot;Title&quot;</code><code>].ToString(),&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</code></span></span></div>
<div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code>Nome = li[</code><code style="color:blue;">&quot;Nome&quot;</code><code>].ToString(),&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</code></span></span></div>
<div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code>Activo = Convert.ToBoolean(li[</code><code style="color:blue;">&quot;Activo&quot;</code><code>].ToString())&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</code></span></span></div>
<div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code>});&nbsp;&nbsp;&nbsp;&nbsp;
</code></span></span></div>
<div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code>}&nbsp;&nbsp;&nbsp;&nbsp;
</code></span></span></div>
<div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code>//adicionar os Dados da Lista na Datagrid&nbsp;&nbsp;&nbsp;&nbsp;
</code></span></span></div>
<div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code>dataGrid1.ItemsSource = list;</code></span></span></div>
<div><span><code>}</code></span></div>
</div>
<div><span><code></code></span></div>
</div>
<p style="text-align:center;"><a href="http://aaclage.files.wordpress.com/2010/11/e14c0ef9b8d870a3c65842d8c6f6e022.jpg" rel="WLPP"><img alt=" " src="http://aaclage.files.wordpress.com/2010/11/e14c0ef9b8d870a3c65842d8c6f6e022.jpg?w=300" style="border-width:0px;border-style:solid;" /></a></p>
No seguinte exemplo foi criado um pequeno formulário no Silverlight para a lista “Anuncios”. Esta lista tem um conjunto de artigos de referência ao Site e este método mostra como se consegue criar um formulário de uma forma simples, sem ter a necessidade de
 realizar customização de páginas em aspx.Foram adicionadas na Tab “formulário” do Silverlight, 3 campos de preenchimento do nosso Artigo, como o Url do site onde se destina, Titulo e corpo.
<p style="text-align:center;"><a href="http://aaclage.files.wordpress.com/2010/11/0a9d61c7fd7942ea141b3c42db5be707.jpg" rel="WLPP"><img alt=" " src="http://aaclage.files.wordpress.com/2010/11/0a9d61c7fd7942ea141b3c42db5be707.jpg?w=237" style="border-width:0px;border-style:solid;" /></a></p>
<p><strong>Método 3</strong>:</p>
<p>Este método ira criar uma nova entrada na Lista de SharePoint de um novo anúncio.</p>
<pre><div class="reCodeBlock" style="overflow-y:auto;"><div><span><code style="font-wer-width:0px;border-style:solid;" /></a></p>
No seguinte exemplo foi criado um pequeno formulário no Silverlight para a lista “Anuncios”. Esta lista tem um conjunto de artigos de referência ao Site e este método mostra como se consegue criar um formulário de uma forma simples, sem ter a necessidade de
 realizar customização de páginas em aspx.Foram adicionadas na Tab “formulário” do Silverlight, 3 campos de preenchimento do nosso Artigo, como o Url do site onde sight:bold;">if</code> <code>(!TxtTitle.Text.Equals(</code><code style="color:blue;">&quot;&quot;</code><code>))&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></span></div><div><span><code>{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></span></div><div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code>ClientContext clientContext = </code><code style="font-weight:bold;">new</code> <code>ClientContext(TxtUrl.Text);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></span></span></div><div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code>Web oWebsite = clientContext.Web;</code></span></span></div><div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code>ListCollection collList = oWebsite.Lists;</code></span></span></div><div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code>oList = clientContext.Web.Lists.GetByTitle(</code><code style="color:blue;">&quot;Anuncios&quot;</code><code>);</code></span></span></div><div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code>ListItem oListItem = oList.AddItem(</code><code style="font-weight:bold;">new</code> <code>ListItemCreationInformation());&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></span></span></div><div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code>oListItem[</code><code style="color:blue;">&quot;Title&quot;</code><code>] = TxtTitle.Text;</code></span></span></div><div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code>oListItem[</code><code style="color:blue;">&quot;Body&quot;</code><code>] = TxtBody.Text;</code></span></span></div><div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code>oListItem.Update();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></span></span></div><div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code>clientContext.Load(oList,</code></span></span></div><div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code>list =&gt; list.Title);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></span></span></div><div><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code>clientContext.ExecuteQueryAsync(onQueryInsertSucceeded, onQueryInsertFailed);</code></span></span></div><div><span><code>}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></span></div><div><span><code style="font-weight:bold;">else</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div><span><code>{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MessageBox.Show(</code><code style="color:blue;">&quot;Vazio!!&quot;</code><code>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</code></span></div></div></pre>
<p style="text-align:center;"><a href="http://aaclage.files.wordpress.com/2010/11/de2d9bbf230bde27c6648b51b4bc2c56.jpg" rel="WLPP"><img alt=" " src="http://aaclage.files.wordpress.com/2010/11/de2d9bbf230bde27c6648b51b4bc2c56.jpg?w=300" style="border-width:0px;border-style:solid;" /></a></p>
<p>Com a criação deste 2 pequenos exemplos podemos criar a nossa solução “<strong>AccessData.XAP</strong>”.</p>
<h3><a name="SharePoint_Silverlight_Web_Part"></a>SharePoint Silverlight Web Part</h3>
<p>SharePoint disponibiliza ferramentas para integrar o projecto desenvolvido em Silverlight e adicionar nos nossos sites em SharePoint de uma forma bastante simples.</p>
<p>O primeiro passo será adicionar o nosso projecto em Silverlight, neste caso “AccessData.XAP” e adicionar no nosso site em SharePoint, podendo ser uma Folder, uma Document Library ou até na directoria ou pasta “Hive” onde se encontra instalado o SharePoint
 no servidor. Neste caso criei uma Folder dentro do site em SharePoint. Estas pastas não são visíveis aos utilizadores finais, garantido que o ficheiro não é apagado acidentalmente.</p>
<p style="text-align:center;"><a href="http://aaclage.files.wordpress.com/2010/11/1fb859c54352ce13a9e936c1554a90b2.jpg" rel="WLPP"><img alt=" " src="http://aaclage.files.wordpress.com/2010/11/1fb859c54352ce13a9e936c1554a90b2.jpg?w=300" style="border-width:0px;border-style:solid;" /></a></p>
<p>Depois de adicionado a nossa solução em Silverlight, acedemos ao nosso site em SharePoint e adicionamos uma Web Part que se encontra por defeito no SharePoint “Silverlight Web Part”. Um dos parâmetros que é requisitado é o caminho de onde se encontra a nossa
 solução em Silverlight.</p>
<p style="text-align:center;"><a href="http://aaclage.files.wordpress.com/2010/11/636b82c4206a82c792175ad6dfca804c.jpg" rel="WLPP"><img alt=" " src="http://aaclage.files.wordpress.com/2010/11/636b82c4206a82c792175ad6dfca804c.jpg?w=300" style="border-width:0px;border-style:solid;" /></a></p>
<p>Assim que esteja tudo correctamente adicionado, irá ser disponibilizado na nossa página de internet a nossa solução de Silverlight, dentro do SharePoint, numa WebPart podendo trabalhar e interagir com o conteúdo do Site onde se encontra.</p>
<p style="text-align:center;"><a href="http://aaclage.files.wordpress.com/2010/11/91e22fe23667a88f8d457dee782f0d56.jpg" rel="WLPP"><img alt=" " src="http://aaclage.files.wordpress.com/2010/11/91e22fe23667a88f8d457dee782f0d56.jpg?w=300" style="border-width:0px;border-style:solid;" /></a></p>
<p>Quando nos encontramos a trabalhar em ambiente Web a aplicação&nbsp;<a href="http://www.fiddler2.com/">Fiddler</a>&nbsp;é uma ferramenta essencial para captura e validação dos nosso trafico na Web. Estando ela em funcionamento podemos encontrar as transacções realizadas,
 através da Client OM, e encontra-mos uma chamada ao WCF Web Service “client.svc” e um Web Service XML para comunicação e transacção das operações.</p>
<p style="text-align:center;"><a href="http://aaclage.files.wordpress.com/2010/11/188b7a33db9b5b2691284f0f7cce9252.jpg" rel="WLPP"><img alt=" " src="http://aaclage.files.wordpress.com/2010/11/188b7a33db9b5b2691284f0f7cce9252.jpg?w=300" style="border-width:0px;border-style:solid;" /></a></p>
<p>Existem outra forma de poder interagir com os dados em SharePoint, com o Silverlight através dos “REST” em WCF e com todas as suas potencialidades.</p>
<p style="text-align:center;"><a href="http://aaclage.files.wordpress.com/2010/11/4e321f219c07e22360a719f87565660d.jpg" rel="WLPP"><img alt=" " src="http://aaclage.files.wordpress.com/2010/11/4e321f219c07e22360a719f87565660d.jpg?w=300" style="border-width:0px;border-style:solid;" /></a></p>
<h3><a name="Refer_ecirc_ncias"></a><strong style="line-height:normal;font-family:&#39;segoe ui&#39;,&#39;lucida grande&#39;,verdana,arial,helvetica,sans-serif;font-size:12px;"><span style="font-size:18px;">Referências</span></strong></h3>
<ul>
<li><strong>Using the Silverlight Object Model </strong><a href="http://msdn.microsoft.com/en-us/library/ee538971.aspx">http://msdn.microsoft.com/en-us/library/ee538971.aspx<strong></strong></a>
</li><li><strong>Using the SharePoint Foundation 2010 Managed Client Object Model </strong>
<a href="http://msdn.microsoft.com/en-us/library/ee857094.aspx">http://msdn.microsoft.com/en-us/library/ee857094.aspx<strong></strong></a>
</li><li><strong>Using the SharePoint Foundation 2010 Managed Client Object Model with the Open XML SDK 2.0
</strong><a href="http://msdn.microsoft.com/en-us/library/ee956524.aspx">http://msdn.microsoft.com/en-us/library/ee956524.aspx<strong></strong></a>
</li><li><strong>SharePoint 2010 SDK </strong><a href="http://www.microsoft.com/downloads/en/details.aspx?FamilyID=f0c9daf3-4c54-45ed-9bde-7b4d83a8f26f&amp;displaylang=en">SharePoint 2010 Reference: Software Development Kit</a><strong></strong>
</li><li><strong>Create a Silverlight 4 Web Part for SharePoint 2010 </strong><a href="http://msdn.microsoft.com/en-us/magazine/ff956224.aspx">http://msdn.microsoft.com/en-us/magazine/ff956224.aspx</a>
</li></ul>

</div>
    
    
