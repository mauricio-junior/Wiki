---
layout: default
title: 'SSIS Merge Join Transformation - TechNet Articles - United States (English) - TechNet Wiki'
weight: 3
---

<div class="post-content user-defined-markup">

<p style="text-align:justify;"><a class="ExistingPageLink" href="/wiki/contents/articles/776.sql-server-integration-services-ssis.aspx" title="Click to view the page titled: SQL Server Integration Services (SSIS)">Integration Services</a>&nbsp;uses transformations to manipulate data during an&nbsp;<a class="ExistingPageLink" href="/wiki/contents/articles/4475.extract-transform-load-etl.aspx" title="Click to view the page titled: Extract Transform Load (ETL)">ETL</a> dataflow. Transformations can be used in [[articles:SSIS Dataflow
 Task|Data Flow Tasks]], between data source and destination components, or <a href="http://social.technet.microsoft.com/wiki/contents/articles/6752.ssis-list-o></div><div class="r3 fiji-r3"></div><div class="r4 fiji-r4"></div></div><div class="content-fragment-content">

<div class="full-post-header"></div>
<div class="full-post">
    <h1 class="post-name">SSIS Merge Join Transformation</h1>
    

    <div class="post-content user-defined-markup">

<p style="text-align:justify;"><a class="ExistingPageLink" href="/wiki/contents/articles/776.sql-server-integration-services-ssis.aspx" title="Click to view the page titled: SQL Server Integration Servicf-transformations.aspx" class="ExistingPageLink" title="Click to view the page titled: SSIS: List of Transformations">
<span style="color:#0066dd;">other transformations</span></a>.<br />
<br />
Combining data from separate sources is quite often required by the logic of the <a class="ExistingPageLink" href="/wiki/contents/articles/4475.extract-transform-load-etl.aspx" title="Click to view the page titled: Extract Transform Load (ETL)">ETL process</a>. This can be achieved if&nbsp;both data have a common set of columns which can be used as a key to combine (or join) these data
 flows. The Merge Join transformation can combine data from different sources. It is different from the <a class="ExistingPageLink" href="/wiki/contents/articles/7428.ssis-lookup-transformation.aspx" title="Click to view the page titled: SSIS Lookup Transformation">Lookup transformation</a>, since it might produce more, or even less&nbsp;records as its inputs have: it will put all matching
 combinations to its output.<br />
<br />
The Merge Join transformation supports two inputs and&nbsp;a standard&nbsp;output. It does not support an error output - since it transforms only the data flow, not the data values. If no match found for some of the input rows, it&#39;s&nbsp;not treated as an error.<br />
<br />
It&#39;s important that&nbsp;passing sorted data as&nbsp;input to a Merge Join transformation is mandatory, and the metadata (column data types, lenghts and/or precision) must match on both side as well, in the same order. Otherwise the Merge Join will&nbsp;raise an error.<br />
The <a class="ExistingPageLink" href="/wiki/contents/articles/7395.ssis-sort-transformation.aspx" title="Click to view the page titled: SSIS Sort Transformation">Sort transformation</a> can help in this, or&nbsp;it&#39;s possible to give an explicit hint&nbsp;with&nbsp;changing the data flow metadata if it&#39;s a known fact that&nbsp;both inputs&nbsp;are sorted correctly.<br />
<br />
The Merge Join transformation can execute three kind of joins: Full outer, Left outer or Inner join. Right join is not supported, simply&nbsp;because it&#39;s easy to swap inputs with just&nbsp;a button click in the Merge Join Transformation Editor:</p>
<p style="text-align:center;"><a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/5265.SSISMergeJoin01EditorSwapInputs.PNG"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x153/__key/communityserver-wikis-components-files/00-00-00-00-05/5265.SSISMergeJoin01EditorSwapInputs.PNG" style="border:0px solid;" /></a><br />
<em>The Swap Inputs button in the Merge Join Transformation Editor</em></p>
<p style="text-align:justify;">Full outer join creates an output which includes all rows from both input, possibly combined with rows from the other one as well. If no match found from the other input, a single row will be written to the output with NULL values
 in the corresponding columns.<br />
Left outer join takes all rows from the left input, and tries to find matches from the input on the right side. If no match found, then similarly to the Full outer join, NULL values will be passed to the output in the columns which should get data from the
 right input. Any matching combinations will be written to the output otherwise. The output row count is always greater than or equal to the left input&#39;s row number.<br />
Inner join passes only matching combinations to the output.<br />
<br />
However only these three join types are selectable in the editor, it&#39;s possible to construct a cross join as well: using a <a class="ExistingPageLink" href="/wiki/contents/articles/7399.ssis-derived-column-transformation.aspx" title="Click to view the page titled: SSIS Derived Column transformation">Derived Column transformation</a>, add a new column for both inputs before the Merge Join
 transformation with the same data type (a DT_BOOL, DT_UI1 or DT_I1 is small enough), with the same value of True or 1. Sort the data flows by these columns using the <a class="ExistingPageLink" href="/wiki/contents/articles/7395.ssis-sort-transformation.aspx" title="Click to view the page titled: SSIS Sort Transformation">Sort transformation</a>. Then combine the data flows joined
 by these columns in a Merge Join.<br />
<br />
The Merge Join transformation is a partially blocking (asynchronous) one: the output does not reuse existing buffers from the inputs.<br />
<br />
For more detailed information on this transformation, please refer to <a href="http://msdn.microsoft.com/en-us/library/ms141775.aspx" title="Merge Join Transformation" target="_blank">
<span style="color:#0066dd;">this MSDN article</span></a>.<br />
For the complete list of SSIS transformations, check <a class="ExistingPageLink" href="/wiki/contents/articles/6752.ssis-list-of-transformations.aspx" title="Click to view the page titled: SSIS: List of Transformations">this Wiki article</a>.</p>
<hr />
<h1><a name="See_Also"></a>See Also</h1>
<ul>
<li><a href="http://social.technet.microsoft.com/wiki/contents/articles/19746.sql-server-integration-services-portal.aspx">SQL Server Integration Services Portal</a>
</li></ul>
<hr />

</div>
    
    
