---
layout: default
title: BizTalk Server&#58; List of Macros - TechNet Articles - United States (English) - TechNet Wiki
weight: 3
---

<div class="post-content user-defined-markup">

<div class="table-of-contents"><h2 class="title">Table of Contents</h2><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#Introduction">Introduction</a></li><li class="hierarchy-item"><a href="#List_of_Send_Macros">List of Send Macros</a></li><li class="hierarchy-item"><a href="#Restrictions_on_Using_Macros_in_File_Names">Restrictions on Using Macros in File Names</a></li><li class="hierarchy-item"><a href="#Restrictions_on_Using_Macros_in_SMTP_Headers">Restrictions on Using Macros in SMTP Headers</a></li><li class="hierarchy-item"><a href="#Other_languages">Other languages</a></li><li class="hierarchy-item"><a href="#See_Also">See Also</a></<div class="r3 fiji-r3"></div><div class="r4 fiji-r4"></div></div><div class="content-fragment-content">

<div class="full-post-header"></div>
<div class="full-post">
    <h1 class="post-name">BizTalk Server: List of Macros</h1>
    

    <div class="post-content user-defined-markup">

<div class="table-of-contents"><h2 class="title">Table of Contents</h2><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#Introduction">Introduction</a></li><li class="hierarchy-item"><a href="#List_of_Send_Macros">List of li></ul><div class="hierarchy-list-footer"> </div></div><br />
<h1><a name="Introduction"></a>Introduction</h1>
<p>Microsoft BizTalk Server provides a predefined set of macros that can help you to automate common tasks, a basic example is create output file names on File send handler.</p>
<p>If you working with sending output as a file, you’ll find these macros are really useful and that you don’t have to coding any statement to get these values.</p>
<h1><a name="List_of_Send_Macros"></a>List of Send Macros </h1>
<p>Here&#39;s a list of send macros that you can use:</p>
<table class="telerik-reTable-4">
<tbody>
<tr class="telerik-reTableHeaderRow-4">
<td class="telerik-reTableHeaderFirstCol-4">&nbsp;Macro name</td>
<td class="telerik-reTableHeaderLastCol-4">Substitute value&nbsp;</td>
</tr>
<tr class="telerik-reTableOddRow-4">
<td class="telerik-reTableFirstCol-4">%datetime%</td>
<td class="telerik-reTableLastCol-4">Coordinated Universal Time (UTC) date time in the format YYYY-MM-DDThhmmss (for example, 1997-07-12T103508).</td>
</tr>
<tr class="telerik-reTableEvenRow-4">
<td class="telerik-reTableFirstCol-4">%datetime_bts2000%</td>
<td class="telerik-reTableLastCol-4">UTC date time in the format YYYYMMDDhhmmsss, where sss means seconds and milliseconds (for example, 199707121035234 means 1997/07/12, 10:35:23 and 400 milliseconds).</td>
</tr>
<tr class="telerik-reTableOddRow-4">
<td class="telerik-reTableFirstCol-4">%datetime.tz%<br />
</td>
<td class="telerik-reTableLastCol-4">Local date time plus time zone from GMT in the format YYYY-MM-DDThhmmssTZD, (for example, 1997-07-12T103508&#43;800).</td>
</tr>
<tr class="telerik-reTableEvenRow-4">
<td class="telerik-reTableFirstCol-4">%DestinationParty%<br />
</td>
<td class="telerik-reTableLastCol-4">Name of the destination party. The value comes from the message context property BTS.DestinationParty.<br />
</td>
</tr>
<tr class="telerik-reTableOddRow-4">
<td class="telerik-reTableFirstCol-4">%DestinationPartyQualifier%<br />
</td>
<td class="telerik-reTableLastCol-4">Qualifier of the destination party. The value comes from the message context property BTS.DestinationPartyQualifier.<br />
</td>
</tr>
<tr class="telerik-reTableEvenRow-4">
<td class="telerik-reTableFirstCol-4">%MessageID%<br />
</td>
<td class="telerik-reTableLastCol-4">Globally unique identifier (GUID) of the message in BizTalk Server. The value comes directly from the message context property BTS.MessageID.<br />
</td>
</tr>
<tr class="telerik-reTableOddRow-4">
<td class="telerik-reTableFirstCol-4">%SourceFileName%<br />
</td>
<td class="telerik-reTableLastCol-4">Name of the file from which the File adapter read the message. The file name includes the extension and excludes the file path, for example, Sample.xml. When substituting this property, the File adapter extracts the file
 name from the absolute file path stored in the FILE.ReceivedFileName context property. If the context property does not have a value—for example, if a message was received on an adapter other than the File adapter—the macro will not be substituted and will
 remain in the file name as is (for example, C:\Drop\%SourceFileName%). <br />
<br />
Note: Correct implementation of this macro requires that the output message is the same message as the received message.<br />
</td>
</tr>
<tr class="telerik-reTableEvenRow-4">
<td class="telerik-reTableFirstCol-4">%SourceParty%</td>
<td class="telerik-reTableLastCol-4">Name of the source party from which the File adapter received the message.<br />
<br />
Note: Correct implementation of this macro requires that the output message is the same message as the received message.<br />
</td>
</tr>
<tr class="telerik-reTableOddRow-4">
<td class="telerik-reTableFirstCol-4">%SourcePartyQualifier%</td>
<td class="telerik-reTableLastCol-4">Qualifier of the source party from which the File adapter received the message.<br />
<br />
Note: Correct implementation of this macro requires that the output message is the same message as the received message.
<br />
</td>
</tr>
<tr class="telerik-reTableEvenRow-4">
<td class="telerik-reTableFirstCol-4">%time%<br />
</td>
<td class="telerik-reTableLastCol-4">UTC time in the format hhmmss.<br />
</td>
</tr>
<tr class="telerik-reTableEvenRow-4">
<td class="telerik-reTableFirstCol-4">%time.tz%</td>
<td class="telerik-reTableLastCol-4">Local time plus time zone from GMT in the format hhmmssTZD (for example, 124525&#43;530).</td>
</tr>
</tbody>
</table>
<p><strong>Important note</strong>:&nbsp;<span style="text-decoration:underline;">all macros are case sensitive.</span></p>
<h1><a name="Restrictions_on_Using_Macros_in_File_Names"></a>Restrictions on Using Macros in File Names</h1>
<p>You can use a predefined set of macros to dynamically create the files in which the File send handler writes messages. Before creating a file on the file system, the File send handler replaces all the macros in the file name with their individual values.
 You can use several different macros in one file name.</p>
You can use the file name macros while configuring the File send handler in BizTalk Explorer, or by using the BizTalk Explorer object model.<br />
<br />
The File send handler does not replace the macros with a value if any of the following are true:<br />
<ul>
<li>The corresponding system property is not set. </li><li>The macro is misspelled. </li><li>The value for the macro contains symbols that are not valid in the file name.
</li></ul>
<h1><a name="Restrictions_on_Using_Macros_in_SMTP_Headers"></a>Restrictions on Using Macros in SMTP Headers</h1>
<p>You can form the Subject, To, From, and CC properties on an SMTP message header dynamically by using a predefined set of macros. Before sending a message, the SMTP selly create the files in which the File send handler writes messages. Before creating a file on the file system, the File send handler replaces all nd handler substitutes all the macros in headers with their values. You can use several
 different macros when forming one header.</p>
The SMTP send handler does not substitute macros in the To, From, or CC header if any of the following are true:
<br />
<ul>
<li>The corresponding system property is not set. </li><li>The macro is misspelled. </li><li>The value for the macro contains symbols that are not valid for the SMTP headers.
</li></ul>
<p>The following table lists the macros you can use to build the To, CC, and Subject headers:</p>
<table class="telerik-reTable-4">
<tbody>
<tr class="telerik-reTableHeaderRow-4">
<td class="telerik-reTableHeaderFirstCol-4">&nbsp;Macro</td>
<td class="telerik-reTableHeaderOddCol-4">&nbsp;Description</td>
<td class="telerik-reTableHeaderEvenCol-4">&nbsp;For use with To</td>
<td class="telerik-reTableHeaderOddCol-4">&nbsp;For use with CC</td>
<td class="telerik-reTableHeaderLastCol-4">&nbsp;For use with Subject</td>
</tr>
<tr class="telerik-reTableOddRow-4">
<td class="telerik-reTableFirstCol-4">%MessageID%<br />
</td>
<td class="telerik-reTableOddCol-4">Globally unique identifier (GUID) of the message in BizTalk Server. The value comes from the message context property BTS.MessageID.<br />
</td>
<td class="telerik-reTableEvenCol-4">No</td>
<td class="telerik-reTableOddCol-4">No</td>
<td class="telerik-reTableLastCol-4">Yes<br />
</td>
</tr>
<tr class="telerik-reTableEvenRow-4">
<td class="telerik-reTableFirstCol-4">%datetime_bts2000%<br />
</td>
<td class="telerik-reTableOddCol-4">UTC date time in the format YYYYMMDDhhmmsss, where sss means seconds and milliseconds (for example, 199707121035234 means 1997/07/12, 10:35:23 and 400 milliseconds).<br />
</td>
<td class="telerik-reTableEvenCol-4">No<br />
</td>
<td class="telerik-reTableOddCol-4">No<br />
</td>
<td class="telerik-reTableLastCol-4">Yes<br />
</td>
</tr>
<tr class="telerik-reTableOddRow-4">
<td class="telerik-reTableFirstCol-4">%datetime%<br />
</td>
<td class="telerik-reTableOddCol-4">UTC date time in the format YYYY-MM-DDThhmmss (for example, 1997-07-12T103508).<br />
</td>
<td class="telerik-reTableEvenCol-4">No<br />
</td>
<td class="telerik-reTableOddCol-4">No<br />
</td>
<td class="telerik-reTableLastCol-4">Yes<br />
</td>
</tr>
<tr class="telerik-reTableEvenRow-4">
<td class="telerik-reTableFirstCol-4">%datetime.tz%<br />
</td>
<td class="telerik-reTableOddCol-4">Local date time plus time zone from GMT in the format YYYY-MM-DDThhmmssTZD, (for example, 1997-07-12T103508&#43;800).<br />
</td>
<td class="telerik-reTableEvenCol-4">No<br />
</td>
<td class="telerik-reTableOddCol-4">No<br />
</td>
<td class="telerik-reTableLastCol-4">Yes<br />
</td>
</tr>
<tr class="telerik-reTableOddRow-4">
<td class="telerik-reTableFirstCol-4">%time%<br />
</td>
<td class="telerik-reTableOddCol-4">UTC time in the format hhmmss.<br />
</td>
<td class="telerik-reTableEvenCol-4">No<br />
</td>
<td class="telerik-reTableOddCol-4">No<br />
</td>
<td class="telerik-reTableLastCol-4">Yes<br />
</td>
</tr>
<tr class="telerik-reTableEvenRow-4">
<td class="telerik-reTableFirstCol-4">%time.tz%<br />
</td>
<td class="telerik-reTableOddCol-4">Local time plus time zone from GMT in the format hhmmssTZD (for example, 124525&#43;530).<br />
</td>
<td class="telerik-reTableEvenCol-4">No<br />
</td>
<td class="telerik-reTableOddCol-4">No<br />
</td>
<td class="telerik-reTableLastCol-4">Yes<br />
</td>
</tr>
<tr class="telerik-reTableOddRow-4">
<td class="telerik-reTableFirstCol-4">%SourceParty%<br />
</td>
<td class="telerik-reTableOddCol-4">Name of the source party from which the File adapter received the message.<br />
</td>
<td class="telerik-reTableEvenCol-4">No<br />
</td>
<td class="telerik-reTableOddCol-4">No<br />
</td>
<td class="telerik-reTableLastCol-4">Yes<br />
</td>
</tr>
<tr class="telerik-reTableEvenRow-4">
<td class="telerik-reTableFirstCol-4">%SourcePartyQualifier%<br />
</td>
<td class="telerik-reTableOddCol-4">Qualifier of the source party from which the File adapter received the message.<br />
</td>
<td class="telerik-reTableEvenCol-4">No<br />
</td>
<td class="telerik-reTableOddCol-4">No<br />
</td>
<td class="telerik-reTableLastCol-4">Yes<br />
</td>
</tr>
<tr class="telerik-reTableOddRow-4">
<td class="telerik-reTableFirstCol-4">%DestinationParty%<br />
</td>
<td class="telerik-reTableOddCol-4">Name of the destination party. The value comes from the message context property BTS.DestinationParty.<br />
</td>
<td class="telerik-reTableEvenCol-4">Yes<br />
</td>
<td class="telerik-reTableOddCol-4">Yes<br />
</td>
<td class="telerik-reTableLastCol-4">Yes<br />
</td>
</tr>
<tr class="telerik-reTableOddRow-4">
<td class="telerik-reTableFirstCol-4">%DestinationPartyQualifier%</td>
<td class="telerik-reTableOddCol-4">Qualifier of the destination party. The value comes from the message context property BTS.DestinationPartyQualifier.<br />
</td>
<td class="telerik-reTableEvenCol-4">No<br />
</td>
<td class="telerik-reTableOddCol-4">No<br />
</td>
<td class="telerik-reTableLastCol-4">Yes</td>
</tr>
</tbody>
</table>
<h1><a name="Other_languages"></a>Other languages</h1>
<p>This article is also available in the following languages</p>
<ul>
<li><a href="http://social.technet.microsoft.com/wiki/contents/articles/8935.biztalk-server-list-of-macros-nb-no.aspx">Norwegian: BizTalk Server: List of Macros (nb-NO)</a>
</li><li><a href="http://social.technet.microsoft.com/wiki/contents/articles/33842.biztalk-server.aspx" target="_blank">BizTalk Server: मैक्रोज&#2364; की सूची (hi-IN)</a>
</li></ul>
<h1><a name="See_Also"></a>See Also</h1>
<p>Another important place to find a huge amount of BizTalk related articles is the TechNet Wiki itself. The best entry point is
<a href="http://social.technet.microsoft.com/wiki/contents/articles/2240.biztalk-server-resources-on-the-technet-wiki.aspx" target="_parent">
BizTalk Server Resources on the TechNet Wiki.</a></p>


</div>
    
    