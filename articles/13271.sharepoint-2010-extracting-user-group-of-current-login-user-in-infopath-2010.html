---
layout: default
title: SharePoint 2010&#58; Extracting user group of current login user in infopath 2010 - TechNet Articles - United States (English) - TechNet Wiki
weight: 3
---

<div class="post-content user-defined-markup">

<p style="color:#000000;font-family:verdana,arial,helvetica,sans-serif;font-size:10px;">
<span style="font-size:small;"></span></p>
<p style="font-size:10px;"><span style="font-size:small;"><span style="font-size:small;font-family:verdana,arial,helvetica,sans-serif;color:#000000;">Below are&nbsp;</span><span style="font-family:verdana,arial,helvetica,sans-serif;color:#000000;">some steps about
 extracting user group of current login user in infopath 2010 text field.I want to pen down my experiance with the above objective. Some of my friends encounter issues while come across though this requirement.</span></span></p>
<p style="color:#000000;font-family:verdana,arial,helvetica,sans-serif;font-size:10px;">
<span style="font-size:small;"><br />
<strong style="font-size:medium;">Checklists before commencement</strong></span></p>
<ol>
<li><span style="font-size:small;">InfoPath 2010 form needs to be designed.</span>
</li><li><span style="font-size:small;">This form should have two textbox namely “UserName” and “UserGroup”.</span>
</li><li><span style="font-size:small;">Click on Manage “Data Connections” which is on the bottom preview of “Field” pane.</span>
</li><li><span style="font-size:small;">Click on “Add” Button.</span> </li><li><span style="font-size:small;">Check on “Receive Data” which belongs to “Create new connection to”.</span>
</li><li><span style="font-size:small;">Check the “Soap Web Service”.</span> </li><li><span style="font-size:small;">Put this URL “http://servername/_vti_bin/userGroup.asmx?WSDL” in text bar.</span>
</li><li><span style="font-size:small;">Click on “Next” Button.</span> </li><li><span style="font-size:small;">Select “GetGroupCollectionFromUser” from the list.</span>
</li><li><span style="font-size:small;">Click on “Next” Button.</span> </li><li><span style="font-size:small;">Click on “Set Sample Value” Button.</span> </li><li><span style="font-size:small;">Provide the value (essbbsr\sidhanta).</span> </li><li><span style="font-size:small;">Click on “Next” Button</span> </li><li><span style="font-size:small;">Click on Next Button</span> </li><li><span style="font-size:small;">Check on “Store a copy of the data in the form template”.</span>
</li><li><span style="font-size:small;">Do not tick on “Automatically retrieve data when the form is opened”.</span>
</li><li><span style="font-size:small;">In the “Data Connection” window click on “Add” Button.</span>
</li><li><span style="font-size:small;">Check on “Receive Data” which belongs to “Create new connection to”.</span>
</li><li><span style="font-size:small;">Check the “Soap Web Service”.</span> </li><li><span style="font-size:small;">Put this URL “http://servername/_vti_bin/ UserProfileService.asmx? WSDL” in text bar.</span>
</li><li><span style="font-size:small;">Click on “Next” Button.</span> </li><li><span style="font-size:small;">Select “GetUserProfileByName” from the list.</span>
</li><li><span style="font-size:small;">Click on “Next” Button.</span> </li><li><span style="font-size:small;">Click on “Next” Button by leaving “Set Value” of “account Name”.</span>
</li><li><span style="font-size:small;">Check the “Store a copy of the data in the form template”.</span>
</li><li><span style="font-size:small;">Check on “Automatically retrieve data when the form is opened”.</span>
</li><li><span style="font-size:small;">Click on “Close” Button in “Data Connection” window pane.</span>
</li><li><span style="font-size:small;">Go to “File” tab which is on top preview.&nbsp;</span>
</li><li><span style="font-size:small;">Click on “Publish”.</span> </li><li><span style="font-size:small;">Click on “SharePoint Server” button.</span> </li><li><span style="font-size:small;">Provide the web address.</span> </li><li><span style="font-size:small;">Make sure that your InfoPath form is published to the concerned Library.</span>
</li></ol>
<p style="color:#000000;font-family:verdana,arial,helvetica,sans-serif;font-size:10px;">
</p>
<h2 style="color:#000000;font-size:10px;"><a name="Steps_For_Probable_Solution"></a><span style="font-size:medium;"><strong>Steps For Probable Solution</strong></span></h2>
<ol>
<li><span style="font-size:small;">Go to the File Tab.</span> </li><li><span style="font-size:small;">Click on “Publish”.</span> </li><li><span style="font-size:small;">Click on “Export Source Files” Button.</span> </li><li><span style="font-size:small;">Choose the Location.</span> </li><li><span style="font-size:small;">Close the InfoPath Form.</span> </li><li><span style="font-size:small;">Open the folder where the exported files reside.</span>
</li><li><span style="font-size:small;">Right Click on “GetGroupCollectionFromUser1.xsd” which is a XML Schema file and it is around 24KB.</span>
</li><li><span style="font-size:small;">Open it either by Notepad or WordPad.</span> </li><li><span style="font-size:small;">&nbsp;Identify this line.&nbsp;</span><span style="font-size:small;">&lt;s:import namespace=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;&lt;/s:import&gt;&nbsp;</span><span style="font-size:small;">Just below this line paste some lines.&nbsp;</span><span style="font-size:small;">&lt;s:complexType
 name=&quot;GetGroupCollectionFromUserType&quot;&gt;&lt;s:sequence&gt;&lt;s:element minOccurs=&quot;0&quot; maxOccurs=&quot;1&quot; name=&quot;userLoginName&quot;&nbsp;type=&quot;s:string&quot;/&gt;&lt;s:element minOccurs=&quot;0&quot; maxOccurs=&quot;1&quot; name=&quot;Groups&quot;&gt;&lt;s:complexType&gt;&lt;s:sequence&gt;&lt;s:element maxOccurs=&quot;unbounded&quot; name=&quot;Group&quot; &gt;&lt;s:complexType&gt;&lt;s:attribute
 name=&quot;ID&quot;&nbsp;type=&quot;s:unsignedShort&quot;&gt;&lt;/s:attribute&gt;&lt;s:attribute name=&quot;Name&quot; type=&quot;s:string&quot;&gt;&lt;/s:attribute&gt;&lt;s:attribute name=&quot;Description&quot;&nbsp;type=&quot;s:string&quot;&gt;&lt;/s:attribute&gt;&lt;s:attribute name=&quot;OwnerID&quot;&nbsp;type=&quot;s:unsignedByte&quot;&gt;&lt;/s:attribute&gt;&lt;s:attribute name=&quot;OwnerIsUser&quot;&nbsp;type=&quot;s:string&quot;&gt;&lt;/s:attribute&gt;&lt;/s:complexType&gt;&lt;/s:element&gt;&lt;/s:sequence&gt;&lt;/s:complexType&gt;&lt;/s:element&gt;&lt;/s:sequence&gt;&lt;/s:complexType&gt;</span>
</li><li><span style="font-size:small;">Replace the following line &nbsp;</span><span style="font-size:small;">&lt;s:element name=&quot;GetGroupCollectionFromUser&quot;&gt;&lt;s:complexType&gt;&lt;s:sequence&gt;&lt;s:element minOccurs=&quot;0&quot; maxOccurs=&quot;1&quot; name=&quot;userLoginName&quot;&nbsp;type=&quot;s:string&quot;&gt;&lt;/s:element&gt;&lt;/s:sequence&gt;&lt;/s:complexType&gt;&lt;/s:element&gt;&nbsp;</span><span style="font-size:small;">With
 these 2 lines.</span><span style="font-size:small;">&lt;s:element name=&quot;GetGroupCollectionFromUser&quot;&nbsp;type=&quot;tns:GetGroupCollectionFromUserType&quot;&gt;&lt;/s:element&gt;</span>
</li><li><span style="font-size:small;">Save this file and make it Close.</span> </li><li><span style="font-size:small;">Again back the folder where the exported files reside.</span>
</li><li><span style="font-size:small;">Right Click on “Manifest.xsf”.</span> </li><li><span style="font-size:small;">Choose “Design”.</span> </li><li><span style="font-size:small;">In “Data Connection” pane, go to “GetUserProfileByName”.</span>
</li><li><span style="font-size:small;">Apply rule on “Property Data” field.</span> </li><li><span style="font-size:small;">The rule type is “Action”.</span> </li><li><span style="font-size:small;">The rule condition will be “Name=AccountName”.</span>
</li><li><span style="font-size:small;">Click on “Add” button.</span> </li><li><span style="font-size:small;">Choose “Set Field Value”.</span> </li><li><span style="font-size:small;">For “Field” textbox go to “GetGroupCollectionFromUser”</span>
</li><li><span style="font-size:small;">Go to “Query” field.</span> </li><li><span style="font-size:small;">Click on “userLoginName”.</span> </li><li><span style="font-size:small;">For the “Value” field Click on fx Button.</span>
</li><li><span style="font-size:small;">Go to “Value” field in “GetUserProfileByName”.</span>
</li><li><span style="font-size:small;">Click on “Filter Data..,” which is at bottom.</span>
</li><li><span style="font-size:small;">Click on “Add” button.</span> </li><li><span style="font-size:small;">Click on “Name” field.</span> </li><li><span style="font-size:small;">In the “Condition” window put the equation “Name = AccountName”.</span>
</li><li><span style="font-size:small;">Click on Ok and go back to Rule window.</span> </li><li><span style="font-size:small;">Again click on “Add” button.</span> </li><li><span style="font-size:small;">Click on “Query for Data” for “GetGroupCollectionFromUser”.</span>
</li><li><span style="font-size:small;">Go to “UserGroup” textbox.</span> </li><li><span style="font-size:small;">Right Click on it.&nbsp;</span> </li><li><span style="font-size:small;">Choose “Textbox Properties”.</span> </li><li><span style="font-size:small;">Click on “Insert Field or Group” button.</span>
</li><li><span style="font-size:small;">Go to “GetGroupCollectionFromUser”.</span> </li><li><span style="font-size:small;">Click on “Data Field”.</span> </li><li><span style="font-size:small;">Click on “Group” after expanding 2 times.</span>
</li><li><span style="font-size:small;">Click on “Name”.</span> </li><li><span style="font-size:small;">Click “Ok” and back to the form.</span> </li><li><span style="font-size:small;">Right click on “UserName” textbox.</span> </li><li><span style="font-size:small;">Choose “Textbox Properties”.</span> </li><li><span style="font-size:small;">Click on “Insert Function”.</span> </li><li><span style="font-size:small;">Put “userName”.</span> </li><li><span style="font-size:small;">Click “Ok” and proceed.</span> </li><li><span style="font-size:small;">Publish the form.</span> </li></ol>
<p style="color:#000000;font-family:verdana,arial,helvetica,sans-serif;font-size:10px;">
</p>
<p style="color:#000000;font-family:verdana,arial,helvetica,sans-serif;font-size:10px;">
</p>
<strong>
<h2><strong><a name="Problem_Definition"></a><span style="font-size:medium;"><br />
Problem Definition</span></strong></h2>
</strong>
<ul>
<li><span style="font-size:small;">Log Id Error : 5566</span><span>,&nbsp;</span><span style="font-size:small;font-family:verdana,arial,helvetica,sans-serif;color:#000000;">It is due to authentication problem. It can be sort out by login as the specified user in&nbsp;GetGroupCollectionFromUser.</span>
</li></ul>
<strong>
<h2><a name="Reference"></a><strong><span style="font-size:medium;">Reference</span></strong></h2>
</strong>
<ul>
<li><span style="font-size:small;"><a href="http://blog.symprogress.com/2011/05/infopath-list-form-hidedisable-fields-based-on-sharepoint-group-membership/">http://blog.symprogress.com/2011/05/infopath-list-form-hidedisable-fields-based-on-sharepoint-group-membership/</a></span>
</li><li><span style="font-size:small;font-family:verdana,arial,helvetica,sans-serif;color:#000000;"><a href="http://jaliyaudagedara.blogspot.in/2011/05/getting-current-users-sharepoint-group.html">http://jaliyaudagedara.blogspot.in/2011/05/getting-current-users-sharepoint-group.html</a></span>
</li><li><span style="font-size:small;font-family:verdana,arial,helvetica,sans-serif;color:#000000;"><a href="http://jaliyaudagedara.blogspot.in/2011/05/getting-current-users-sharepoint-group.html"></a></span><a href="http://go4answers.webhost4life.com/Example/browser-enabled-infopath-139842.aspx" style="font-size:small;">http://go4answers.webhost4life.com/Example/browser-enabled-infopath-139842.aspx</a>
</li></ul>

</div>
    
    