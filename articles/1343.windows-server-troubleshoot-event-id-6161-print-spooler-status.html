---
layout: default
title: Windows Server&#58; Troubleshoot Event ID 6161 — Print Spooler Status - TechNet Articles - United States (English) - TechNet Wiki
weight: 3
---

<div class="post-content user-defined-markup">

<p><div class="table-of-contents"><h2 class="title">Table of Contents</h2><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li clasoter"></div></div>
<div class="content-fragment-footer"></div>
<div class="content-fragment-bottom fiji-content-fragment-bottom"><div class="r1 fiji-r1"></div><div class="r2 fiji-r2"></div><div class="r3 fiji-r3"></div><div class="r4 fiji-r4"></div></div></div></div>
<div class="content-fragment page no-wrapper" id="fragment-6615">
<div class="content-fragment-inner fiji-content-fragment-inner"><div class="content-fragment-top fiji-content-fragment-top"><div class="r1 fiji-r1"></div><div class="r2 fiji-r2"></div><div class="r3 fiji-r3"></div><div class="r4 fiji-r4"s="hierarchy-item"><a href="#Applies_To">Applies To</a></li><li class="hierarchy-item"><a href="#Event_Details">Event Details</a></li><li class="hierarchy-item"><a href="#Diagnose">Diagnose</a><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#The_printer_is_not_reachable_on_the_network">The printer is not reachable on the network</a></li><li class="hierarchy-item"><a href="#Windows_cannot_allocate_sufficient_memory">Windows cannot allocate sufficient memory</a></li><li class="hierarchy-item"><a href="#There_was_invalid_or_incomplete_data_received_by_the_print_spooler">There was invalid or incomplete data received by the print spooler</a></li><li class="hierarchy-item"><a href="#A_printer_driver_upgrade_failed">A printer driver upgrade failed</a></li><li class="hierarchy-item"><a href="#There_is_a_bad_printer_device_driver">There is a bad printer device driver</a></li></ul><div class="hierarchy-list-footer"> </div></li><li class="hierarchy-item"><a href="#Resolve">Resolve</a><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#Move_numbered_folders_and_restart_the_print_spooler">Move numbered folders and restart the print spooler</a></li><li class="hierarchy-item"><a href="#Move_numbered_folders_to_a_temporary_folder">Move numbered folders to a temporary folder</a></li><li class="hierarchy-item"><a href="#Restart_the_print_spooler">Restart the print spooler</a></li><li class="hierarchy-item"><a href="#Renew_printer_IP_address">Renew printer IP address</a></li><li class="hierarchy-item"><a href="#Check_resource_availability">Check resource availability</a></li><li class="hierarchy-item"><a href="#Install_a_new_printer_driver_and_possibly_disable_advanced_printing_features">Install a new printer driver and possibly disable advanced printing features</a><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#Install_a_new_printer_driver">Install a new printer driver</a></li><li class="hierarchy-item"><a href="#Disable_advanced_printing_features">Disable advanced printing features</a></li></ul><div class="hierarchy-list-footer"> </div></li><li class="hierarchy-item"><a href="#Install_a_new_printer_driver">Install a new printer driver</a></li></ul><div class="hierarchy-list-footer"> </div></li><li class="hierarchy-item"><a href="#Verify">Verify</a></li><li class="hierarchy-item"><a href="#Related_Management_Information">Related Management Information</a></li></ul><div class="hierarchy-list-footer"> </div></div><br />
<br />
Event ID 6161 — Print Spooler Status </p>
<h2><a name="Applies_To"></a>Applies To</h2>
<p>Windows Server 2008 </p>
<p>(This wiki page is part of a pilot program to remove topics such as this one from the TechNet and MSDN libraries and move them to the wiki.)&nbsp;&nbsp;
</p>
<p>Print Server Status controls basic operations such as initializing the spooler, creating threads, and reading the registry.
</p>
<h2><a name="Event_Details"></a>Event Details</h2>
<p><strong></strong></p>
<table>
<tbody>
<tr>
<td>Product:&nbsp;</td>
<td><span style="font-weight:normal;">Windows Operating System&nbsp;</span><br />
</td>
</tr>
<tr>
<td>Event ID:</td>
<td><span style="font-weight:normal;">6161</span></td>
</tr>
<tr>
<td>Source:</td>
<td><span style="font-weight:normal;">Microsoft-Windows-PrintSpooler</span>&nbsp;&nbsp;</td>
</tr>
<tr>
<td>Version:</td>
<td><span style="font-weight:normal;">6.0</span></td>
</tr>
<tr>
<td>Symbolic Name:</td>
<td><span style="font-weight:normal;">MSG_PRINT_ON_PROC_FAILED_EX</span>&nbsp;</td>
</tr>
<tr>
<td>Message:&nbsp;</td>
<td><span style="font-weight:normal;">The document %1, owned by %2, failed to print on printer %3. Try to print the document again, or restart the print spooler.&nbsp;&nbsp;</span>&nbsp;<br />
<br />
<span style="font-weight:normal;">Data type: %4. Size of the spool file in bytes: %5. Number of bytes printed: %6. Total number of pages in the document: %7. Number of pages printed: %8. Client computer: %9. Win32 error code returned by the print processor:
 %10. %11&nbsp;<br />
</span><br />
</td>
</tr>
</tbody>
</table>
<p><strong><br />
</strong></p>
<h2><a name="Diagnose"></a>Diagnose</h2>
<p>This error might be caused by one of the following conditions: </p>
<ul>
<li>The printer is not reachable on the network </li><li>Windows cannot allocate sufficient memory </li><li>There was invalid or incomplete data received by the print spooler </li><li>A driver upgrade failed </li><li>There is a bad printer device driver </li></ul>
<p>To diagnose the problem, use the procedures in the following sections. </p>
<h3><a name="The_printer_is_not_reachable_on_the_network"></a>The printer is not reachable on the network</h3>
<p>To determine&nbsp;whether the printer is reachable on the network: </p>
<ol>
<li>In Event Viewer, examine the event and look for the following text: &quot;Win32 error code returned by the print processor: 2250. This network connection does not exist.... &quot; If another error code is listed, skip to the next section, &quot;Windows cannot allocate
 sufficient memory.&quot; </li><li>Ping the network printer or print device from the print server. If this fails, connect to other network resources from the print server to confirm that the print server network functionality is okay. If it succeeds, skip to the next section.
</li><li>Ping the printer from another computer. If this fails, and you cannot print to the printer from another printer on the network,&nbsp;see the section titled &quot;Renew the printer IP address&quot;. Otherwise, use the procedure in the following section to continue troubleshooting.
</li></ol>
<h3><a name="Windows_cannot_allocate_sufficient_memory"></a>Windows cannot allocate sufficient memory</h3>
<p>To determine whether Windows has sufficient resources: </p>
<ol>
<li>In Event Viewer, examine the event and look for the following text: &quot;Win32 error code returned by the print processor: 8. Not enough storage is available to process this command&quot;.
</li><li>If you see this error code, see the section titled &quot;Check resource availability&quot;.
</li><li>If another error code is listed, use the&nbsp;procedure in the following section to continue troubleshooting.
</li></ol>
<h3><a name="There_was_invalid_or_incomplete_data_received_by_the_print_spooler"></a>There was invalid or incomplete data received by the print spooler</h3>
<p>To determine whether the print spooler received valid data: </p>
<ol>
<li>In Event Viewer, examine the event and look for the following error code text:
<ul>
<li>&quot;Win32 error code returned by the print processor: 87. The parameter is incorrect&quot;
</li><li>&quot;Win32 emory"></a>Windows cannot allocate sufficient memory</h3>
<p>To determine whether Windows has sufficient resources: </p>
<ol>
<li>In Event Viewer, exrror code returned by the print processor: 259. No more data is available&quot;
</li></ul>
</li><li>If you see either of these error codes, see the section titled &quot;Install a new printer driver&quot;.
</li><li>If another error code is listed, use the procedure in the following section to continue troubleshooting.
</li></ol>
<h3><a name="A_printer_driver_upgrade_failed"></a>A printer driver upgrade failed</h3>
<p>To determine whether a printer driver upgrade failed: </p>
<ol>
<li>Open Windows Explorer, and then type <strong>%WINDIR%\system32\spool\drivers</strong> in the Address Bar.
</li><li>Look in each of the IA64, W32X86, and x64 folders for the presence of a folder named &quot;3&quot; that contains a large number of numbered folders (for example, \W32X86\3\1, \W32X86\3\2, \W32X86\3\3, and so on).
</li><li>If there are a large number of numbered folders inside the &quot;3&quot; folder, see the section titled &quot;Move numbered folders and restart the print spooler&quot;.
</li><li>If the system appears to be operating normally, use the procedure in the following section to continue troubleshooting.
</li></ol>
<h3><a name="There_is_a_bad_printer_device_driver"></a>There is a bad printer device driver</h3>
<p>To determine whether there is a bad printer driver: </p>
<ol>
<li>Print to a printer that uses a different printer driver. Because this problem often does not occur unless there are a lot of print jobs, you might have to test this with a large number of print jobs to determine whether the problem still occurs with another
 printer. </li><li>If printing works on other printers, see the section titled &quot;Install a new printer driver and possibly disable advanced printing features&quot;.
</li><li>If you continue to experience this error, contact Microsoft Product Support (<a href="http://go.microsoft.com/fwlink/?LinkId=104695">http://go.microsoft.com/fwlink/?LinkId=104695</a>), or post a question in one of the following TechNet forums:
<ul>
<li>Windows Server 2008 Print/Fax forum (<a href="http://go.microsoft.com/fwlink/?LinkID=92658">http://go.microsoft.com/fwlink/?LinkID=92658</a>)
</li><li>Windows Vista Printing forum (<a href="http://go.microsoft.com/fwlink/?LinkID=92659">http://go.microsoft.com/fwlink/?LinkID=92659</a>)
</li></ul>
</li></ol>
<h2><a name="Resolve"></a>Resolve</h2>
<p>To resolve this issue, use the resolution that corresponds to the cause you identified in the Diagnose section. After performing the resolution, see the Verify section to confirm that the feature is operating properly
</p>
<p>Cause </p>
<p>Resolution </p>
<p>A printer driver upgrade failed </p>
<p><a href="http://technet.microsoft.com/#_8989A3B9_6880_436E_88FF_1D22044ADAC2">Move numbered folders and restart the print spooler</a>
</p>
<p>The printer is not reachable on the network </p>
<p><a href="http://technet.microsoft.com/#_9BFB36DF_854E_4449_AA8B_9765DF211886">Renew printer IP address</a>
</p>
<p>Windows cannot allocate sufficient memory </p>
<p><a href="http://technet.microsoft.com/#_86F5D1C3_0168_48F3_8E9D_089E0512154A">Check resource availability</a>
</p>
<p>There is a bad printer device driver </p>
<p><a href="http://technet.microsoft.com/#_01823D9A_C585_45AA_B1CA_00BE3B6DA3F0">Install a new printer driver and possibly disable advanced printing features</a>
</p>
<p>There was invalid or incomplete data received by the print spooler </p>
<p><a href="http://technet.microsoft.com/#_969CA2DB_7F90_4FF4_9264_B848FBFB54F4">Install a new printer driver</a>
</p>
<h5><a name="Move_numbered_folders_and_restart_the_print_spooler"></a><a>Move numbered folders and restart the print spooler</a></h5>
<p>To resolve this issue, use the procedures in the following sections. <br />
<br />
</p>
<h4><a name="Move_numbered_folders_to_a_temporary_folder"></a>Move numbered folders to a temporary folder</h4>
<p>To move numbered folders left over from a failed driver upgrade: </p>
<ol>
<li>In the %WINDIR%\system32\spool\drivers\ folder, look in each of the IA64, W32X86, and x64 folders for the presence of a folder named &quot;3&quot; that contains a large number of numbered folders (\W32X86\3\1, \W32X86\3\2, \W32X86\3\3, and so on).
</li><li>If there are a large number of numbered folders inside the &quot;3&quot; folder, move those folders to a temporary folder such as C:\Temp.
</li><li>After moving the folders, restart the Print Spooler service by using the procedure in the following&nbsp;section.
</li></ol>
<div><br />
</div>
<h4><a name="Restart_the_print_spooler"></a>Restart the print spooler</h4>
<p>To start or restart the Print Spooler service: </p>
<ol>
<li>In the Administrative Tools folder, open the <strong>Services</strong> snap-in.
</li><li>Locate the Print Spooler service in the list of services, and then confirm that&nbsp;its status is
<strong>Started</strong>. If its status is not <strong>Started</strong>, select the service and then click
<strong>Start</strong> on the <strong>Action</strong> menu.
<p><strong>Note</strong>: You can also do this from an elevated Command Prompt window by typing the following command:
<strong>net stop spooler &amp;&amp; net start spooler </strong></p>
</li></ol>
<p>In some instances, you might receive Error 1068 – &quot;The dependency service or group failed to start&quot; – when attempting to start the Print Spooler. This can happen if the Print Spooler service relies on other services&nbsp;that are not running. To resolve this
 issue: </p>
<ol>
<li>In the <strong>Service</strong>s snap-in, right-click <strong>Print Spooler </strong>
and then click <strong>Properties</strong>. </li><li>Click the <strong>Dependencies</strong> tab. The first box lists all of the system services that must be running for the print spooler to start. These are the dependencies.
</li><li>Make a note of each service, click <strong>OK</strong>, and then start each service that the print spooler depends on, if the service is not already started. If a particular service&nbsp;is not already started, right-click it, click
<strong>Properties</strong>, and then confirm that the <strong>Startup</strong> type is
<strong>Automatic</strong>. </li></ol>
<h4><a name="Renew_printer_IP_address"></a><a>Renew printer IP address</a></h4>
<p>To resolve this issue: </p>
<ol>
<li>On the network printer or network printing device, use the printer&#39;s control panel<strong>
</strong>to renew the printer&#39;s IP address or to choose a valid static IP address and subnet.
</li><li>Ping the printer or network printing device again. If you continue to have problems, replace the network cable and try using a different network switch.
</li><li>Retry connecting to the printer from the print server. </li></ol>
<p>For&nbsp;additional troubleshooting assistance with the printer or network print device, contact the manufacturer of the printing device.
</p>
<h4><a name="Check_resource_availability"></a><a>Check resource availability</a></h4>
<p>To determine whether the computer is low on system resources&nbsp;such as&nbsp;memory, generate a System Diagnostics Report, which presents system information collected for 60 seconds
</p>
<p><strong>Note</strong>: To perform this procedure, you must be a member of the&nbsp;local
<strong>Administrators </strong>group on the print server, or you must have been delegated the appropriate authority.
</p>
<p>To collect system information for 60 seconds and generate a System Diagnostics Report:
</p>
<ol>
<li>Open an elevated Command Prompt window. (Click <strong>Start</strong>, point to
<strong>All Programs</strong>, click <strong>Accessories</strong>, right-click <strong>
Command Prompt</strong>, and then click <strong>Run as administrator</strong>.) </li><li>At the command prompt, type <strong>perfmon /report</strong> and then press ENTER. Reliability and Performance Monitor will start collecting data to create the System Diagnostics Report.
</li><li>When the report is ready for viewing, locate the <strong>Diagnostic Results</strong> section of the report, and then check for any warnings (indicated by
<strong>Warnings </strong>in the report). You can follow links to additional help on resolving warnings from this section. In addition, you can expand each category in the
<strong>Basic System Checks</strong> section to see more details about why warnings appear. Also, the
<strong>Performance</strong> section provides process-level details about top consumers of resources. You might need to increase the size of the paging file or add physical memory.
</li></ol>
<div><br />
</div>
<p><strong></strong></p>
<h4><a name="Install_a_new_printer_driver_and_possibly_disable_advanced_printing_features"></a><a>Install a new printer driver and possibly disable advanced printing features</a></h4>
<p>To resolve this issue, do one or both of the following: </p>
<ul>
<li>Install a new printer driver. </li><li>Disable advanced printing features. </li></ul>
<h6><a name="Install_a_new_printer_driver"></a>Install a new printer driver</h6>
<p>To install a new printer&nbsp;for a printer, use the following procedure. Note that client computers automatically download and install the updated printer drivers the next time they attempt to print to the printer.
</p>
<p><strong>Note:</strong> When installing printer drivers that are provided by the device manufacturer, follow the instructions provided with the printer driver instead of using this procedure.
</p>
<ol>
<u might need to increase the size of the paging file or add physical memory.
</li></ol>
<div><br />
</div>
<p><strong></strong></p>
<h4><a name="Install_a_new_printer_driver_and_possibly_disable_advanced_printing_features"></a><a>Install a new printer driver and possibly disable advanced printing features</a></h4>
<p>To resolve this issue, do one or both of the following: </p>
<ul>
<li>Install a new printer driver. </li><li>Disable advanced printing features.li>Right-click the printer with the driver that you want to change or update, and then click
<strong>Properties</strong>. </li><li>Click the <strong>Advanced</strong> tab. </li><li>Select a new driver&nbsp;in the <strong>Driver</strong> box, or click <strong>New Driver
</strong>to install a new printer driver. </li></ol>
<p>To support client computers that use different processor architectures than the print server, you must install additional drivers. To add client printer drivers to the print server, click the
<strong>Sharing</strong> tab&nbsp;in the <strong>Properties</strong> dialog box and then click
<strong>Additional Drivers</strong>. For more information about this, see the &quot;Update or change printer drivers&quot; topic in Print Management Help, or see
<a href="http://go.microsoft.com/fwlink/?LinkId=104835">http://go.microsoft.com/fwlink/?LinkId=104835</a>.
</p>
<h6><a name="Disable_advanced_printing_features"></a>Disable advanced printing features</h6>
<p>To disable advanced printing features: </p>
<ol>
<li>Right-click the printer, and then click <strong>Properties</strong>. </li><li>Click the <strong>Advanced</strong> tab, and then clear the <strong>Enable advanced printing features
</strong>check box. </li></ol>
<h4><a name="Install_a_new_printer_driver"></a><a>Install a new printer driver</a></h4>
<p>To resolve this issue, install a new&nbsp;printer driver. You might need to contact the&nbsp;printer manufacturer&nbsp;to obtain&nbsp;an updated driver (that displays the Designed for Windows logo) for the specific model of printer you are using.
</p>
<p><strong>Note</strong>: To install a new or updated printer driver, you must be logged on to your computer as a member of the local
<strong>Administrators</strong> group. </p>
<p>To install a new or updated printer driver: </p>
<ol>
<li>Open <strong>Printers </strong>in Control Panel. </li><li>Right-click the printer for which you want to change drivers, and then click <strong>
Properties</strong>. </li><li>On the <strong>Advanced</strong> tab, click <strong>New Driver</strong> to install a new or updated version of the printer driver.
</li><li>Click <strong>Next</strong>, and then do one of the following:
<ul>
<li>If the new or updated driver is in the list, click the appropriate printer manufacturer and printer model.
</li><li>If the printer driver is not in the list, or if you have received a new or updated driver from the printer manufacturer, click
<strong>Have Disk</strong>. Type the path&nbsp;for the driver&#39;s location, and then click
<strong>OK</strong>. </li></ul>
</li><li>Click <strong>Next</strong>, and then follow the instructions on the screen to finish installing the printer driver.
</li><li>Retry printing. If you continue to experience problems, right-click the printer, click
<strong>Properties</strong>, click the <strong>Advanced</strong> tab, clear the <strong>
Enable advanced printing features</strong> check box, and then click <strong>OK</strong>.
</li></ol>
<h2><a name="Verify"></a>Verify</h2>
<p>Perform the following tasks to verify that you resolved the problem: </p>
<ul>
<li>Print the document again. </li><li>If the print server logs spooler information events, look for Print Spooler Event&nbsp;10 after printing, and then examine the document to confirm that it printed correctly.
</li></ul>
<h2><a name="Related_Management_Information"></a>Related Management Information</h2>
<p><a href="http://technet.microsoft.com/en-us/library/cc773829(WS.10).aspx">Print Spooler Status</a>&nbsp;(TechNet Library)</p>
<p><a href="http://technet.microsoft.com/en-us/library/cc771594(WS.10).aspx">Printing Infrastructure</a>&nbsp;(TechNet Library)</p>

</div>
    
    