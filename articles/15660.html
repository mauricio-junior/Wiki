---
layout: default
title: Импорт локальных проектов с подпроектами в корпоративное хранилище - Статьи TechNet - Россия (Pусский) - TechNet Wiki
weight: 3
---

<div class="post-content user-defined-markup">

Последовательность и&#1084;порта в клиенте Project Professional 2010:<br />
1. Пройти по все&#1084; з
        
</ul>
<div class="navigation-list-footer"></div></div>
<div class="content-fragment-footer"></div>
<div class="content-fragment-bottom fiji-content-fragment-bottom"><div class="r1 fiji-r1"></div><div class="r2 fiji-r2"></div><div class="r3 fiji-r3"></div><div class="r4 fiji-r4"></div></div></div></div>
<div class="content-fragment page no-wrapper" id="fragment-6478">
<diадача&#1084; &#1084;астер-проекта и найти подпроекты.<br />
2. Найденные файлы подпроектов сохранить на сервере проектов с сопоставление&#1084;&nbsp;ресурсов.<br />
3. Сохранить &#1084;астер-проект на сервере с сопоставление&#1084; ресурсов.<br />
<br />
VBA код для Project Professional 2010<br />
<br />
Sub Import()<br />
&nbsp;&nbsp;&nbsp; Dim fName1, fName2, fName3, fName4 As String<br />
&nbsp;&nbsp;&nbsp; Dim SubProj1, SubProj2 As Subproject<br />
&nbsp;&nbsp;&nbsp; fName1 = ActiveProject.Name<br />
&nbsp;&nbsp;&nbsp; fName2 = Left$(fName1, InStrRev(fName1, &quot;.&quot;) - 1)<br />
&nbsp;&nbsp;&nbsp; For Each SubProj1 In ActiveProject.Subprojects <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Application.FileOpenEx Name:=SubProj1.Path, ReadOnly:=False, FormatID:=&quot;MSProject.MPP&quot;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fName3 = Right$(SubProj1.Path, InStrRev(SubProj1.Path, &quot;\&quot;) - 1)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fName4 = Left$(fName3, InStrRev(fName3, &quot;.&quot;) - 1)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Application.FileSaveAs Name:=&quot;&lt;&gt;\&quot; &amp; fName4, FormatID:=&quot;&quot; <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Application.FileCloseEx pjSave, True, False<br />
&nbsp;&nbsp;&nbsp; Next SubProj1<br />
&nbsp;&nbsp;&nbsp; Application.FileSaveAs Name:=&quot;&lt;&gt;\&quot; &amp; fName2, FormatID:=&quot;&quot; <br />
&nbsp;&nbsp;&nbsp; Application.Publish<br />
End Sub<br />

</div>
    
    