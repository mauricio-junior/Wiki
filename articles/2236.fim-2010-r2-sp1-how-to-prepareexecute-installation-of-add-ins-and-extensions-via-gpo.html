---
layout: default
title: 'FIM 2010 R2 SP1&#58; How to Prepare/Execute Installation of Add-ins and Extensions via GPO - TechNet Articles - United States (English) - TechNet Wiki'
weight: 3
---

<div class="post-content user-defined-markup">

<hr />
<p><div class="table-of-contents"><h2 class="title">Table of Contents</h2><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#Purpose">Purpose</a></li><li class="hierarchy-item"><a href="#Software_Requirements">Software Requirements</a></li><li class="hierarchy-item"><a href="#Steps_to_prepare_for_deployment">Steps to prepare for deployment</a></li><li class="hierarchy-item"><a href="#How_to_build_the_Windows_Installer_transform_MST">How to build the Windows Installer transform (MST)</a><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#What_to_do_when_you_do_not_see_the_property">What to do when you do not see the property.</a></li><li class="hierarchy-item"><a href="#What_to_do_when_you_see_the_property">What to do when you see the property.</a></li><li class="hierarchy-item"><a href="#For_more_information_on_Windows_Installer_Transforms">For more information on Windows Installer Transforms</a></li></ul><div class="hierarchy-list-footer"> </div></li><li class="hierarchy-item"><a href="#HOW_TO_ADD_THE_INSTALLATION_PACKAGE_TO_GROUP_POLICY">How to add the installation package to GPO</a></li><li class="hierarchy-item"><a href="#VERIFY_THE_INSTALLATION_PACKAGE_ON_THE_CLIENT">Verify the installation package on the client</a></li><li class="hierarchy-item"><a href="#Troubleshooting">Troubleshooting</a><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#Logging_and_troubleshooting_ideas">Logging and troubleshooting ideas</a></li><li class="hierarchy-item"><a href="#EVENT_IDs_to_be_aware_of">EVENT IDs to be aware of</a><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#RESOLUTION">RESOLUTION</a></li></ul><div class="hierarchy-list-footer"> </div></li></ul><div class="hierarchy-list-footer"> </div></li></ul><div class="hierarchy-list-footer"> </div></div> </p>
<h1><a name="Purpose"></a>Purpose</h1>
<p>The purpose of this document is to provide a detailed explanation of how to prepare and execute the installation of the Forefront Identity Manager 2010 R2&nbsp;Add-ins and Extensions through Group Policy.&nbsp;</p>
<h1><a name="Software_Requirements"></a>Software Requirements</h1>
<ol>
<li>Orca – You will need this tool to be able to build a Windows Installer Transform file (MST). The tool is available in the Windows Installer SDK which you can download from
<a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa370557(v=vs.85).aspx">
https://msdn.microsoft.com/en-us/library/windows/desktop/aa370557(v=vs.85).aspx</a>. Once downloaded, you will find it in the %programfiles%\Microsoft SDKs\Windows\v6.0a\Bin.
</li><li>Microsoft Windows Server 2008 Active Directory </li><li>Microsoft Outlook 2007 Service Pack 2 </li></ol>
<h1><a name="Steps_to_prepare_for_deployment"></a>Steps to prepare for deployment</h1>
<p>We will cover the steps to prepare the Forefront Identity Manager 2010 Add-ins and Extensions package for deployment. It is a good idea to execute the steps in order, as it will allow things to flow more smoothly in your deployment process.</p>
<ol>
<li>Create a network installation share if you do not already have one. </li><li><a href="http://social.technet.microsoft.com/wiki/contents/articles/2236.how-to-prepareexecute-installation-of-fim-2010-add-ins-and-extensions-via-gpo/edit.aspx#_HOW_TO_BUILD">Create a Windows Installer Transform file</a>
</li><li><a href="http://social.technet.microsoft.com/wiki/contents/articles/2236.how-to-prepareexecute-installation-of-fim-2010-add-ins-and-extensions-via-gpo/edit.aspx#_HOW_TO_ADD">Add the installation package to the Group Policy Management Editor and prepare
 it for deployment</a> </li><li><a href="http://social.technet.microsoft.com/wiki/contents/articles/2236.how-to-prepareexecute-installation-of-fim-2010-add-ins-and-extensions-via-gpo/edit.aspx#_VERIFY_THE_INSTALLATION">Verify the package install on the client</a>
</li></ol>
<h1><a name="How_to_build_the_Windows_Installer_transform_MST"></a>How to build the Windows Installer transform (MST)</h1>
<p>A transform is a collection of changes applied to an installation. By applying a transform to a base installation package, the installer can add or replace data in the installation database. The installer can only apply transforms during an installation.&nbsp;
 You might want to add some custom information to the installation to help configure things as the product is installed.</p>
<p>Navigate to the installation folder for the Add-ins and Extensions (<em>Forefront Identity Manager\Add-ins and extensions</em>)
</p>
<p><strong><em>*NOTE* You will need to build a MST for each x64 and x32 if you have a mixed x64/x32 bit environment.
</em></strong></p>
<p>Right click on the Add-ins and extensions.msi file and select <strong>Edit in Orca</strong>
</p>
<p><strong><em>*NOTE* If you need to deploy to another language, you will need to build a MST file for each of the language packs.</em></strong></p>
<p>From the Transform menu select <strong>New Transform</strong> </p>
<p>Select Property from the left hand column </p>
<p>&nbsp;At this point, you can work with Public Properties that you need to customize for your environment.
</p>
<p>In this sample, we will be updating the following: <em>(RMS_LOCATION, PORTAL_LOCATION, PORTAL_PREFIX, MONITORED_EMAIL, SITELOCK_DOMAIN, IE7TRUSTEDSITES, BEST_EFFORT_INSTALL)</em></p>
<p><em>*NOTE: For more information on the properties mentioned above, refer to the following links:</em></p>
<em></em>
<ul>
<em></em>
<li><em><a href="http://technet.microsoft.com/en-us/library/ff602040(v=WS.10).aspx">Unattended installation of FIM 2010</a>
</em></li><li><em>&nbsp; <a href="http://technet.microsoft.com/en-us/library/jj134284(v=ws.10)">
Unattended installation of FIM 2010 R2 Self-Service Password Reset</a></em> </li></ul>
<h2><a name="What_to_do_when_you_do_not_see_the_property"></a>What to do when you do not see the property.</h2>
<ol>
<li>From the tables menu select <strong>Add Row</strong> </li><li>Enter the property name in all capital letters. </li><li>Enter the value </li><li>Click Ok </li></ol>
<h2><a name="What_to_do_when_you_see_the_property"></a>&nbsp;What to do when you see the property.</h2>
<ol>
<li>Simply double click on the value and update the value. </li><li>From the Transform menu select <strong>Generate Transform</strong>
<ol>
<li>Save it to a good location. </li><li>From the Transform menu select <strong>Close Transform</strong>
<ol>
<li>*NOTE* You have to select the Close Transform menu option. If you do not you will not be able to associate the MST file with the MSI file.
</li><li>Close Orca </li><li>You should now have an MST file. </li></ol>
</li></ol>
</li></ol>
<h2><a name="For_more_information_on_Windows_Installer_Transforms"></a>For more information on Windows Installer Transforms
</h2>
<ol>
<li><a href="http://technet.microsoft.com/en-us/library/cc181086.aspx">http://technet.microsoft.com/en-us/library/cc181086.aspx</a>
</li><li><a href="http://msdn.microsoft.com/en-us/library/aa367447(VS.85).aspx">http://msdn.microsoft.com/en-us/library/aa367447(VS.85).aspx</a>
</li></ol>
<p>&nbsp;</p>
<h1><a name="HOW_TO_ADD_THE_INSTALLATION_PACKAGE_TO_GROUP_POLICY"></a><a name="_Toc253670250"></a><a name="_HOW_TO_ADD"></a>How to add the installation package to GPO</h1>
<ol>
<li>Open Administrative Tools and double click on Group Policy Management </li><li>Expand Domains and then your domain </li><li>Select <strong>Default Domain Policy</strong> </li><li>From the <strong>Action</strong> menu select <strong>Edit</strong> </li><li>This will open the Group Policy Management Editor window </li><li>Expand Computer Configuration &gt; Policies &gt; Software Settings </li><li>Select Software Installation </li><li>From the <strong>Action</strong> menu select <strong>New</strong> &gt; <strong>Package</strong>
</li><li>Point to the network share installation point using the UNC path beginning with (e.g.
<a>\\machinename\installationshare</a>) </li><li>Select the Add-ins and extensions.msi file and click Open </li><li>Select Advanced and click Ok </li><li>Select Modifications and click Add </li><li>Point to the MST file that you created and click Ok </li><li>Open a command-window and type: gpupdate /force </li><li>You will receive a prompt to restart the computer. Please press “N” and then press the Enter key.&nbsp;
<ol>
<li>*NOTE* This restart option is for the DC and not the client computer. If you check “Y” here, the DC will prompt you that it is restarting and it will apply the installation policy to itself.
</li><li>The package is now ready to be deployed </li></ol>
</li></ol>
<h1><a name="VERIFY_THE_INSTALLATION_PACKAGE_ON_THE_CLIENT"></a><a name="_Toc253670251"></a><a name="_VERIFY_THE_INSTALLATION"></a>Verify the installation package on the client</h1>
<ol>
<li>Go to the client machine </li><li>Restart the client machine </li><li>Open Control Panel and then Programs and Features </li><li>Notice the installed package </li><li>Open Microsoft Outlook and start a new mail. You should see the Group information in the Office Ribbon.
</li></ol>
<h1><a name="Troubleshooting"></a>Troubleshooting</h1>
<h2><a name="Logging_and_troubleshooting_ideas"></a>Logging and troubleshooting ideas</h2>
<ul>
<li>How to enable Windows Installer verbose logging: <a href="http://support.microsoft.com/kb/223300">
http://support.microsoft.com/kb/223300</a> </li><li>Fixing Group Policy problems with logging: <a href="http://technet.microsoft.com/en-us/library/cc775423(WS.10).aspx">
http://technet.microsoft.com/en-us/library/cc775423(WS.10).aspx</a> </li><li>Troubleshooting Group Policy problems: <a href="http://technet.microsoft.com/en-us/library/cc787386(WS.10).aspx">
http://technet.microsoft.com/en-us/library/cc787386(WS.10).aspx</a> </li><li>Troubleshooting Group Policy Application Problems: <a href="http://support.microsoft.com/kb/250842">
http://support.microsoft.com/kb/250842</a> </li><li>1704 – indication that the group policy objects have been successfully deployed.
</li><li>107 – indication that group policy failed on the software installation </li><li>1040 – indication that the MSIinstaller has began a transaction </li><li>1042 – indication that the MSIinstaller has ended a transaction </li></ul>
<h2><a name="EVENT_IDs_to_be_aware_of"></a>EVENT IDs to be aware of</h2>
<pre>Log Name: Application</pre>
<pre>Source: Software Installation</pre>
<pre>Date: 3/9/2010 3:20:34 PM</pre>
<pre>Event ID: 110</pre>
<pre>Task Category: None</pre>
<pre>Level: Error</pre>
<pre>Keywords: Classic</pre>
<pre>User: N/A</pre>
<pre>Computer: USARS.speedskaters.nttest.microsoft.com</pre>
<pre>Description:</pre>
<pre>Software Installation was unable to generate the script for \\usars\AandE\x64\Add-ins and extensions.msi. The following error was encountered: Another installation is already in progress. Complete that installation before proceeding with this install.</pre>
<h3><a name="RESOLUTION"></a><strong>RESOLUTION</strong></h3>
<p>This means that you have not executed a GPUPDATE yet to fully configure the installation, or you have clicked the Ok button again before the properties window closes.</p>
<ol>
<li>Remove the item that added when the properties window closes. </li><li>Open a command-prompt </li><li>Type: gpupdate /force and press the &lt;ENTER&gt; key </li><li>Go back to the Group Policy Editor and add the package </li></ol>
<hr />

</div>
    
    
