---
layout: default
title: TROUBLESHOOTING&#58; CCertRequest&#58;&#58;GetCAPropertyFlags&#58; The version of the OLE on the client and server machines does not match. 0x80010110 - TechNet Articles - United States (English) - TechNet Wiki
weight: 3
---

<div class="post-content user-defined-markup">

<div class="table-of-contents"><h2 class="title">Table of Contents</h2><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#OVERVIEW_PURPOSE_GOAL">OVERVIEW / PURPOSE / GOAL</a></li><li class="hierarchy-item"><a href="#PROBLEM_STATEMENT">PROBLEM STATEMENT</a></li><li class="hierarchy-item"><a href="#CERTIFICATE_MANAGEMENT_VERBOSE_LOG_INFORMATION">CERTIFICATE MANAGEMENT VERBOSE LOG INFORMATION</a></li><li class="hierarchy-item"><a href="#CERTIFICATE_MANAGEMENT_EVENT_LOG">CERTIFICATE MANAGEMENT EVENT LOG</a></li><li class="hierarchy-item"><a href="#CAUSE">CAUSE</a></li><li class="hierarchy-item"><a href="#RESOLUTION">RESOLUTION</a></li><li class="hierarchy-item"><a href="#ADDTIONAL_INFORMATION">ADDTIONAL INFORMATION</a></li></ul><div class="hierarchy-list-footer"> </div></div><br />
<br />
<br />
<br />
<table>
<tbody>
<tr>
<td>
<h2><a name="OVERVIEW_PURPOSE_GOAL"></a><strong>OVERVIEW / PURPOSE / GOAL</strong></h2>
</td>
</tr>
<tr>
<td>
<blockquote dir="ltr" style="margin-right:0px;">
<p>The purpose of this wiki is to share the knowledge gained while troubleshooting an issue that&nbsp;I recently worked&nbsp;concerning Forefront Identity Manager 2010 Certificate Management (FIM CM).&nbsp; The goal of this wiki is hopefully to provide knowledge to help others
 resovle this issue as well.</p>
</blockquote>
</td>
</tr>
<tr>
<td>
<h2><a name="PROBLEM_STATEMENT"></a><strong>PROBLEM STATEMENT</strong></h2>
</td>
</tr>
<tr>
<td>
<blockquote dir="ltr" style="margin-right:0px;">
<p>You are attempting to recover a certificate in the FIM CM 2010 portal, and receive the following error message in the GUI.<br />
<br />
Error Message:<br />
CCertRequest::GetCAPropertyFlags: The version of the OLE on the client and server machines does not match. 0x80010110.</p>
</blockquote>
</td>
</tr>
<tr>
<td>
<h2><a name="CERTIFICATE_MANAGEMENT_VERBOSE_LOG_INFORMATION"></a><strong>CERTIFICATE MANAGEMENT VERBOSE LOG INFORMATION</strong></h2>
</td>
</tr>
<tr>
<td>
<blockquote dir="ltr" style="margin-right:0px;">
<p>&quot;2012-07-12 19:33:57.15 -04&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Microsoft.Clm.Web.Authentication.CustomAuthenticationConfiguration&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Microsoft.Clm.Web.Authentication.FilteredApplication MapPathToApplication(System.String)&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;DOMAIN1\FIMCMWebPool01&quot;
 0x00000D60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x00000003<br />
Mapping path: [error.aspx]<br />
&quot;2012-07-12 19:33:57.15 -04&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Microsoft.Clm.Web.Authentication.CustomAuthenticationConfiguration&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Microsoft.Clm.Web.Authentication.FilteredApplication MapPathToApplication(System.String)&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;DOMAIN1\FIMCMWebPool01&quot;
 0x00000D60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x00000003<br />
Path: [error.aspx] was not found in the configuration section.</p>
</blockquote>
</td>
</tr>
<tr>
<td>
<h2><a name="CERTIFICATE_MANAGEMENT_EVENT_LOG"></a><strong>CERTIFICATE MANAGEMENT EVENT LOG</strong></h2>
</td>
</tr>
<tr>
<td>
<p>Log Name:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FIM Certificate Management<br />
Source:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.Web<br />
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 7/12/2012 7:33:57 PM<br />
Event ID:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0<br />
Task Category: None<br />
Level:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Error<br />
Keywords:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Classic<br />
User:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; N/A<br />
Computer:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;COMPUTER NAME&gt;<br />
Description:<br />
The description for Event ID 0 from source System.Web cannot be found. Either the component that raises this event is not installed on your local computer or the installation is corrupted. You can install or repair the component on the local computer.</p>
<p>If the event originated on another computer, the display information had to be saved with the event.</p>
<p>The following information was included with the event: </p>
<p>Message:Exception of type &#39;System.Web.HttpUnhandledException&#39; was thrown.<br />
Type:System.Web.HttpUnhandledException<br />
Source:System.Web<br />
Stack Trace:&nbsp;&nbsp; at System.Web.UI.Page.HandleError(Exception e)<br />
&nbsp;&nbsp; at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)<br />
&nbsp;&nbsp; at System.Web.UI.Page.ProcessRequest(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)<br />
&nbsp;&nbsp; at System.Web.UI.Page.ProcessRequest()<br />
&nbsp;&nbsp; at System.Web.UI.Page.ProcessRequest(HttpContext context)<br />
&nbsp;&nbsp; at ASP.content_sm_requests_subscriberrecoverexecute_aspx.ProcessRequest(HttpContext context) in c:\Windows\Microsoft.NET\Framework64\v2.0.50727\Temporary ASP.NET Files\certificatemanagement\a8741d44\95e9fa81\App_Web_chusznfi.4.cs:line 0<br />
&nbsp;&nbsp; at System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()<br />
&nbsp;&nbsp; at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean&amp; completedSynchronously)</p>
<p>Inner Exception:Message:Current user &#39;DOMAIN1\user1&#39; is not authorized to self-service the&nbsp;DOMAIN1\user1 request.<br />
Type:System.UnauthorizedAccessException<br />
Source:Microsoft.Clm.BusinessLayer<br />
Stack Trace:&nbsp;&nbsp; at Microsoft.Clm.BusinessLayer.UserPrincipal.ThrowUnauthorizedForRequestException(Guid requestUuid)<br />
&nbsp;&nbsp; at Microsoft.Clm.BusinessLayer.UserPrincipal.IsAuthenticatedForRequestAndThrow(Guid requestUuid)<br />
&nbsp;&nbsp; at Microsoft.Clm.Web.BasePage.CheckAuthorizedForRequestAndThrow(Guid requestUuid)<br />
&nbsp;&nbsp; at Microsoft.Clm.Web.SubscriberRecoverExecute.get_RequestUuid()<br />
&nbsp;&nbsp; at Microsoft.Clm.Web.SubscriberRd44\95e9fa81\App_Web_chusznfi.4.cs:line 0<br />
&nbsp;&nbsp; at System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()<br />
&nbsp;&nbsp; at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean&amp; completedSynchronously)</p>
<p>Inner Exception:Message:Current user &#39;DOMAIN1\user1&#39; is not authorized to self-service the&nbsp;DOMAIN1\user1 request.<br />
Type:System.UnauthorizedAccessException<br />
Source:Microsoft.Clm.BusinessLayer<br />
Stack Trace:&nbsp;&nbsp; at Microsoft.Clm.BusinessLayer.UserPrincipal.ThrowUnauthorizedForRequestException(Guid requestUuid)<br />
&nbsp;&nbsp; at Microsoft.Clm.BusinessLayer.UserPrincipal.IsAuthenticatedForRequestecoverExecute.Page_Load(Object sender, EventArgs e)<br />
&nbsp;&nbsp; at System.Web.UI.Control.OnLoad(EventArgs e)<br />
&nbsp;&nbsp; at System.Web.UI.Control.LoadRecursive()<br />
&nbsp;&nbsp; at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)</p>
</td>
</tr>
<tr>
<td>
<h2><a name="CAUSE"></a><strong>CAUSE</strong></h2>
</td>
</tr>
<tr>
<td>
<blockquote dir="ltr" style="margin-right:0px;">
<p>The issue can be caused by a few different items:</p>
<ol>
<li>UID Authentication </li><li>Delegation of WebPool and/or SQL Server Accounts </li><li>SPNs on the accounts </li></ol>
</blockquote>
</td>
</tr>
<tr>
<td>
<h2><a name="RESOLUTION"></a><strong>RESOLUTION</strong></h2>
</td>
</tr>
<tr>
<td>
<blockquote dir="ltr" style="margin-right:0px;">
<p>Review the following Microsoft TechNet Article:<br />
<strong>Perform FIM CM Post-Installation Tasks</strong>: <a href="http://technet.microsoft.com/en-us/library/hh230239(WS.10).aspx">
http://technet.microsoft.com/en-us/library/hh230239(WS.10).aspx</a></p>
</blockquote>
</td>
</tr>
<tr>
<td>
<h2><a name="ADDTIONAL_INFORMATION"></a><strong>ADDTIONAL INFORMATION</strong></h2>
</td>
</tr>
<tr>
<td><a href="http://social.technet.microsoft.com/wiki/contents/articles/11405.reference-fim-landing-page-resource-wiki-page-index-en-us.aspx">FIM LANDING PAGE: Resource Wiki Page Index</a></td>
</tr>
</tbody>
</table>
<br />

</div>
    
    