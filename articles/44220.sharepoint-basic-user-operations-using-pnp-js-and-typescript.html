---
layout: default
title: 'SharePoint&#58; Basic User Operations using PNP JS and TypeScript - TechNet Articles - United States (English) - TechNet Wiki'
weight: 3
---

<div class="post-content user-defined-markup">

<div class="table-of-contents"><h2 class="title">Table of Contents</h2><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#What_is_PnP_JavaScript_Core_Library">What is PnP JavaScript Core Library ?</a></li><li class="hierarchy-item"><a class="r1 fiji-r1"></div><div class="r2 fiji-r2"></div><div class="r3 fiji-r3"></div><div class="r4 fiji-r4"></div></div></div></div>
<div class="content-fragment page no-wrapper" id="fragment-6615">
<div class="content-fragment-inner fiji-content-fragment-inner"><div class="content-fragment-top fiji-content-fragment-top"><div class="r1 fiji-r1"></div><div class="r2 fiji-r2"></div><div class="r3 fiji-r3"></div><div class="r4 fiji-r4"></div> href="#Overview">Overview</a></li><li class="hierarchy-item"><a href="#Prerequisites">Prerequisites</a></li><li class="hierarchy-item"><a href="#Scenario">Scenario</a></li><li class="hierarchy-item"><a href="#Setup">Implementation</a></li><li class="hierarchy-item"><a href="#References">References</a></li></ul><div class="hierarchy-list-footer"> </div></div><br />
<br />
<h1><a name="What_is_PnP_JavaScript_Core_Library"></a>What is PnP JavaScript Core Library ?</h1>
<p>The Patterns and Practices (PnP) is an open source initiative driven by widespread community of Microsoft employees and MVP’s around the globe who collaborate to provide guidance, samples, reusable components that we as a community can use it in our day
 to day life to simplify our work. Anyone can contribute to this initiative.<br />
<br />
<em>“The new Patterns and Practices JavaScript Core Library was created to help developers by simplifying common operations within SharePoint. Currently it contains a fluent API for working with the full SharePoint REST API as well as utility and helper functions.
 This takes the guess work out of creating REST requests, letting developers focus on the what and less on the how.”<br />
</em></p>
<h1><a name="Overview"></a>Overview</h1>
<p>There are different ways in which we can use the PNP library.&nbsp;<br />
<span style="font-size:12.1px;"><br />
1. You can include a CDN link in your code pointing to the js file and then use a content editor webpart.</span></p>
<p><a target="_blank" href="https://cdnjs.cloudflare.com/ajax/libs/sp-pnp-js/3.0.1/pnp.js">https://cdnjs.cloudflare.com/ajax/libs/sp-pnp-js/3.0.1/pnp.js</a><br />
<br />
<a target="_blank" href="https://cdnjs.cloudflare.com/ajax/libs/sp-pnp-js/3.0.1/pnp.min.js">https://cdnjs.cloudflare.com/ajax/libs/sp-pnp-js/3.0.1/pnp.min.js</a><br />
<br />
<span style="font-size:12.1px;">2.&nbsp;</span><span style="font-size:12.1px;">You can download the file to your local and then upload it in your SharePoint site and refer it from there inside of a content editor webpart.</span></p>
<p>3. You can use NPM to include the relevant package to your project.<br />
<br />
</p>
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#000000;">npm install sp-pnp-js –save</code></span></div>
</div>
<br />
In this article, we will be using the third option of installing the package using NPM. We will use Visual Studio Code as the editor for writing code. Our development environment will be SharePoint 2013 On Premise.<br />
<br />
We could have used a content editor webpart and referred to pnp.min.js file to perform our operations using PnP but we are specifically using Visual Studio Code so that we can see how we can make use of the PNP library while writing TypeScript code. This will
 come handy while developing SPFx applications or while writing Angular code.
<div><br />
</div>
<h1><a name="Prerequisites"></a>Prerequisites</h1>
<p><span style="font-size:12.1px;font-family:&#39;Segoe UI&#39;,&#39;Lucida Grande&#39;,Arial,Verdana,Helvetica,sans-serif;color:#333333;">1.</span><strong style="font-size:12.1px;color:#333333;"> Node.Js</strong><span style="font-size:12.1px;font-family:&#39;Segoe UI&#39;,&#39;Lucida Grande&#39;,Arial,Verdana,Helvetica,sans-serif;color:#333333;">
 - It is a cross platform runtime environment for applications written in JavaScript. It helps in transpiling our .ts files to into .js files. You can install Node.js from</span><a href="https://social.technet.microsoft.com/wiki/contents/articles/44220.sharepoint-basic-user-operations-using-pnp-js-and-typescript/%20https://nodejs.org/en" target="_blank" style="font-size:12.1px;">
 https://nodejs.org/en</a></p>
<p><span><span style="font-size:12.1px;font-family:&#39;Segoe UI&#39;,&#39;Lucida Grande&#39;,Arial,Verdana,Helvetica,sans-serif;color:#333333;">2.</span><strong style="font-size:12.1px;color:#333333;"> Node Package Manager</strong><span style="font-size:12.1px;font-family:&#39;Segoe UI&#39;,&#39;Lucida Grande&#39;,Arial,Verdana,Helvetica,sans-serif;color:#333333;">
 - Node JS package manager, helps us to manage all the libraries that our software relies upon. Node comes with npm installed so, we should have a version of npm.<br />
</span></span></p>
<p><span><span style="font-size:12.1px;font-family:&#39;Segoe UI&#39;,&#39;Lucida Grande&#39;,Arial,Verdana,Helvetica,sans-serif;color:#333333;">3.</span><strong style="color:#333333;font-size:12.1px;"> Visual Studio Code</strong><span style="font-size:12.1px;font-family:&#39;Segoe UI&#39;,&#39;Lucida Grande&#39;,Arial,Verdana,Helvetica,sans-serif;color:#333333;">
 - Visual Studio Code is optimized for building and debugging modern web applications. Install Visual Studio Code. Browse
</span><a href="https://code.visualstudio.com/" target="_blank" style="font-size:12.1px;">https://code.visualstudio.com/</a><span style="font-size:12.1px;font-family:&#39;Segoe UI&#39;,&#39;Lucida Grande&#39;,Arial,Verdana,Helvetica,sans-serif;color:#333333;"> and follow instructions<br />
</span></span></p>
<p><span><span style="font-size:12.1px;font-family:&#39;Segoe UI&#39;,&#39;Lucida Grande&#39;,Arial,Verdana,Helvetica,sans-serif;color:#333333;">4.
</span><strong style="color:#333333;font-size:12.1px;">TypeScript</strong><span style="font-size:12.1px;font-family:&#39;Segoe UI&#39;,&#39;Lucida Grande&#39;,Arial,Verdana,Helvetica,sans-serif;color:#333333;"> -&nbsp; It is a typed superset of JavaScript that compiles to plain
 JavaScript. You can use NPM to install TypeScript.</span></span></p>
<div>
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#000000;">npm install –g typescript</code></span></div>
</div>
</div>
<span style="font-size:12.1px;"><br />
5.</span><strong style="font-size:12.1px;"> Gulp</strong><span style="font-size:12.1px;"> - Gulp is a JavaScript task runner that helps us in automating tasks. You can use NPM to install Gulp.<br />
</span><br />
<div>
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#000000;">npm install –g gulp</code></span></div>
</div>
</div>
<span style="font-size:12.1px;"><br />
6.</span><strong style="font-size:12.1px;"> Webpack</strong><span style="font-size:12.1px;"> - It is a module bundler. Reference
</span><a href="https://angular.io/guide/webpack" target="_blank" style="font-size:12.1px;">https://angular.io/guide/webpack<br />
<span style="font-size:12.1px;color:#333333;"><br />
7. Refid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#000000;">npm install –g typescript</code></span></div>
</div>
</div>
<span style="font-size:12.1px;"><br />
5.</span><strong style="font-size:12.1px;"> Gulp</strong><span style="ference to es6-promise and fetch protocol for IE. These files are required in order for pnp to work in IE.&nbsp;</span><br />
</a><br />
<a target="_blank" href="https://github.com/stefanpenner/es6-promise">https://github.com/stefanpenner/es6-promise</a><br />
<br />
<a target="_blank" href="https://github.com/github/fetch">https://github.com/github/fetch</a><br />
<br />
<h1><a name="Scenario"></a>Scenario</h1>
<div><br />
We will use the PnP library along with TypeScript to perform some basic user operations like below. There are lot of other operations as well that we can do but for a starter we will implement the below mentioned operations.<br />
<br />
1. Getting Logged In User Information<br />
<br />
2. Check If a given user belongs to a particular group or not<br />
<br />
3. Get Extended Managers for the current user<br />
<br />
4. Get all user profile properties for the current user<br />
<br />
5. Get a particular user profile property for a given user<br />
<br />
Now let us get started with the actual implementation.<br />
<br />
<br />
</div>
<h1><a name="Setup"></a>Implementation</h1>
<br />
<span style="font-size:12.1px;">1. After ensuring that you have the prerequisites set up you can start with the actual project setup.<br />
</span><span style="font-size:12.1px;"><br />
2. We can initialize our project using &quot;npm init&quot; command. We simply type this command in the command line and it will ask for some parameters like name, version etc. and will generate package.json file for you. The package.json file is very important. It contains
 information about metadata for the project, what dependencies the project have like what all packages must be installed. Refer to the reference section for more details.</span>
<div><br />
</div>
<div><a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/517416.1.png"><img alt=" " src="https://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/517416.1.png" style="border-width:0px;border-style:solid;" /></a><br />
<br />
<span style="font-size:12.1px;">3. Install the following packages using NPM.<br />
</span><br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#000000;">npm install --save-dev gulp-serve</code></span></div>
<div style="background-color:#f8f8f8;"><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">npm install sp-pnp-js –save-dev</code></span></div>
</div>
<br />
<span style="font-size:12.1px;">4. In Visual Studio Code create the following folder structure. The structure is self explanatory.</span><br />
<p><a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/4617.2.png"><img alt=" " src="https://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/4617.2.png" height="115" width="314" style="border-width:0px;border-style:solid;" /></a></p>
<span style="font-size:12.1px;">5. In Visual Studio Code, add a new file called gulpfile.js and add the following code<br />
</span><br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">var</code>
<code style="color:#000000;">gulp = require(</code><code style="color:blue;">&#39;gulp&#39;</code><code style="color:#000000;">)</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#006699;font-weight:bold;">var</code>
<code style="color:#000000;">serve = require(</code><code style="color:blue;">&#39;gulp-serve&#39;</code><code style="color:#000000;">);</code></span></div>
<div style="background-color:#ffffff;"><span>&nbsp;</span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">gulp.task(</code><code style="color:blue;">&#39;serve&#39;</code><code style="color:#000000;">, serve([</code><code style="color:blue;">&#39;app&#39;</code><code style="color:#000000;">]));</code></span></div>
</div>
<br />
</div>
<span style="font-size:12.1px;">6. Click Ctrl &#43; Shift &#43; P and search for “Configure Task Runner”. Click on it.</span><br />
<p><a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/11174.3.png"><img alt=" " src="https://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/11174.3.png" style="border-width:0px;border-style:solid;" /></a></p>
<div><span style="font-size:12.1px;">7. Select TypeScript – tsconfig.json.</span><br />
<span style="font-size:12.1px;"><br />
8. Add a tsconfig.json file at the root of the project and add the following code. The tsconfig.json is another important file. It is the TypeScript configuration file which guides the compiler to generate JavaScript files. Refer to the references for more
 details.<br />
<br />
</span></div>
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;</code><span><code style="color:blue;">&quot;compilerOptions&quot;</code><code style="color:#000000;">: {</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:blue;">&quot;target&quot;</code><code style="color:#000000;">:
</code><code style="color:blue;">&quot;es5&quot;</code><code style="color:#000000;">,</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:blue;">&quot;module&quot;</code><code style="color:#000000;">:
</code><code style="color:blue;">&quot;commonjs&quot;</code><code style="color:#000000;">,</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:blue;">&quot;moduleResolution&quot;</code><code style="color:#000000;">:
</code><code style="color:blue;">&quot;node&quot;</code><code style="color:#000000;">,</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:blue;">&quot;sourceMap&quot;</code><code style="color:#000000;">:
</code><code style="color:#006699;font-weight:bold;">true</code><code style="color:#000000;">,</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:blue;">&quot;emitDecoratorMetadata&quot;</code><code style="color:#000000;">:
</code><code style="color:#006699;font-weight:bold;">true</code><code style="color:#000000;">,</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:blue;">&quot;experimentalDecorators&quot;</code><code style="color:#000000;">:
</code><code style="color:#006699;font-weight:bold;">true</code><code style="color:#000000;">,</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:blue;">&quot;noImplicitAny&quot;</code><code style="color:#000000;">:
</code><code style="color:#006699;font-weight:bold;">true</code><code style="color:#000000;">,</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:blue;">&quot;suppressImplicitAnyIndexErrors&quot;</code><code style="color:#000000;">:
</code><code style="color:#006699;font-weight:bold;">true</code><code style="color:#000000;">,</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:blue;">&quot;types&quot;</code><code style="color:#000000;">: [
</code><code style="color:blue;">&quot;node&quot;</code> <code style="color:#000000;">],</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:blue;">&quot;typeRoots&quot;</code><code style="color:#000000;">: [
</code><code style="color:blue;">&quot;./node_modules/@types&quot;</code> <code style="color:#000000;">
]</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">}</code></span></div>
</div>
<br />
<span style="font-size:12.1px;">9. Now add the following code inside -app/index.aspx file.<br />
</span><br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#000000;">&lt;</code><code style="color:#006699;font-weight:bold;">html</code><code style="color:#000000;">&gt;</code></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">&lt;</code><code style="color:#006699;font-weight:bold;">head</code><code style="color:#000000;">&gt;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code styv style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">}</code></span></div>
</div>
<br />
<span style="font-size:12.1px;">9. Now add the following code inside -app/index.aspx file.<br />
</span><br />
le="color:#000000;">&lt;</code><code style="color:#006699;font-weight:bold;">title</code><code style="color:#000000;">&gt;SharePoint PnP Sample &lt;/</code><code style="color:#006699;font-weight:bold;">title</code><code style="color:#000000;">&gt;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">&lt;/</code><code style="color:#006699;font-weight:bold;">head</code><code style="color:#000000;">&gt;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">&lt;</code><code style="color:#006699;font-weight:bold;">body</code><code style="color:#000000;">&gt;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">&lt;</code><code style="color:#006699;font-weight:bold;">script</code>
<code style="color:#808080;">type</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;text/javascript&quot;</code>
<code style="color:#808080;">src</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;<a href="http://127.0.0.1/">http://127.0.0.1</a>:3000/scripts/bundle-app.js&quot;</code><code style="color:#000000;">&gt;&lt;/</code><code style="color:#006699;font-weight:bold;">script</code><code style="color:#000000;">&gt;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">&lt;</code><code style="color:#006699;font-weight:bold;">div</code>
<code style="color:#808080;">class</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;divSample&quot;</code><code style="color:#000000;">&gt;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">&lt;</code><code style="color:#006699;font-weight:bold;">div</code>
<code style="color:#808080;">class</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;userInfo&quot;</code><code style="color:#000000;">&gt;&lt;/</code><code style="color:#006699;font-weight:bold;">div</code><code style="color:#000000;">&gt;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">&lt;/</code><code style="color:#006699;font-weight:bold;">div</code><code style="color:#000000;">&gt;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">&lt;/</code><code style="color:#006699;font-weight:bold;">body</code><code style="color:#000000;">&gt;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">&lt;/</code><code style="color:#006699;font-weight:bold;">html</code><code style="color:#000000;">&gt;</code></span></div>
</div>
<br />
<span style="font-size:12.1px;">10. Add the following code in -app/scripts/app.ts file.<br />
</span><br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#000000;">import pnp from
</code><code style="color:blue;">&quot;sp-pnp-js&quot;</code><code style="color:#000000;">;</code></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">function</code>
<code style="color:#000000;">GetUser() {</code></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">pnp.setup({</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">sp: {</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">headers: {</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:blue;">&quot;Accept&quot;</code><code style="color:#000000;">:
</code><code style="color:blue;">&quot;application/json; odata=verbose&quot;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">});</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">pnp.sp.web.currentUser.get().then(result =&gt; {</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">console.log(result);</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">});</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">}</code></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
sp;</code><span><code style="color:#000000;">});</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">pnp.sp.web.currentUser.get().then(result =&gt; {</code></span></span></
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">function</code>
<code style="color:#000000;">CheckIfUserBelongsToGroup(groupName: string, userEmail: string) {</code></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">pnp.sp.web.siteGroups.getByName(groupName).users.getByEmail(userEmail).get().then(rs =&gt; {</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">console.log(</code><code style="color:blue;">&quot;user belongs to group&quot;</code><code style="color:#000000;">);</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}).</code><code style="color:#006699;font-weight:bold;">catch</code><code style="color:#000000;">(error =&gt; {</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">console.log(</code><code style="color:blue;">&quot;user does not belong&quot;</code><code style="color:#000000;">);</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">})</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">}</code></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">function</code>
<code style="color:#000000;">getExtendedManagers() {</code></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">var</code>
<code style="color:#000000;">managers: any = [];</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">pnp.setup({</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">sp: {</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">headers: {</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:blue;">&quot;Accept&quot;</code><code style="color:#000000;">:
</code><code style="color:blue;">&quot;application/json; odata=verbose&quot;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">});</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">pnp.sp.profiles.myProperties.select(</code><code style="color:blue;">&quot;ExtendedManagers&quot;</code><code style="color:#000000;">).get().then(d
 =&gt; {</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">managers = d.ExtendedManagers.results;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">console.log(managers);</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">});</code></span></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">}</code></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">function</code>
<code style="color:#000000;">getMyProperties() {</code></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">pnp.setup({</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">sp: {</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">headers: {</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:blue;">&quot;Accept&quot;</code><code style="color:#000000;">:
</code><code style="color:blue;">&quot;application/json; odata=verbose&quot;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">});</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">pnp.sp.profiles.myProperties.get().then(d =&gt; {</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">var</code>
<code style="color:#000000;">properties = d.UserProfileProperties.results;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">console.log(properties);</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">});</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">}</code></span></div>
<div style="background-color:#ffffff;"><span>&nbsp;</span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#006699;font-weight:bold;">function</code>
<code style="color:#000000;">getUserProfilePropertyForUser(userLoginName: string, propertyName: string) {</code></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">pnp.setup({</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">sp: {</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">headers: {</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:blue;">&quot;Accept&qht:bold;">function</code>
<code style="color:#000000;">getUserProfilePropertyForUser(userLoginName: string, propertyName: string) {</code></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<uot;</code><code style="color:#000000;">:
</code><code style="color:blue;">&quot;application/json; odata=verbose&quot;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">});</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">pnp.sp.profiles.getUserProfilePropertyFor(userLoginName, propertyName).then((result: any) =&gt; {</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">console.log(result.GetUserProfilePropertyFor);</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">});</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">}</code></span></div>
</div>
<br />
Let us split the above code into bits and see what every method is doing.<br />
<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#000000;">import pnp from
</code><code style="color:blue;">&quot;sp-pnp-js&quot;</code><code style="color:#000000;">;</code></span></div>
</div>
<br />
The above piece of code imports the functionalities from the PnP JavaScript Core library.<br />
<br />
<strong>Get Logged In User Information - <br />
</strong>In the below code we are using PnP to fetch the current logged in user information.&nbsp;
<br />
We are first setting the headers and after that we are fetching the current user information.&nbsp;&nbsp;<br />
<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">function</code>
<code style="color:#000000;">GetUser() {</code></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">pnp.setup({</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">sp: {</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">headers: {</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:blue;">&quot;Accept&quot;</code><code style="color:#000000;">:
</code><code style="color:blue;">&quot;application/json; odata=verbose&quot;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">});</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">pnp.sp.web.currentUser.get().then(result =&gt; {</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">console.log(result);</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">});</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">}</code></span></div>
</div>
<br />
If we check the console, we will see the JSON result in below format.<br />
<br />
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/1462.11.png"><img alt=" " src="https://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/1462.11.png" style="border-width:0px;border-style:solid;" /></a><br />
<br />
<strong>Check If the user belongs to a particular SharePoint group -</strong><br />
&nbsp;<br />
The following method checks if the user belongs a particular group or not.<br />
<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">function</code>
<code style="color:#0000><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">}</code></span></div>
</div>
<br />
If we check the console, we will see the JSON result in below format.<br />
<br />
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/1462.11.png"><img alt=" " src="https://social.technet.microsoft.com/wiki/resized-image.ashx/__size/55000;">CheckIfUserBelongsToGroup(groupName: string, userEmail: string) {</code></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">pnp.sp.web.siteGroups.getByName(groupName).users.getByEmail(userEmail).get().then(rs =&gt; {</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">console.log(</code><code style="color:blue;">&quot;user belongs to group&quot;</code><code style="color:#000000;">);</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}).</code><code style="color:#006699;font-weight:bold;">catch</code><code style="color:#000000;">(error =&gt; {</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">console.log(</code><code style="color:blue;">&quot;user does not belong&quot;</code><code style="color:#000000;">);</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">})</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">}</code></span></div>
</div>
<br />
<strong>Get the extended managers -</strong><br />
<br />
In the below method we are getting all the managers for the current logged in user.<br />
<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">function</code>
<code style="color:#000000;">getExtendedManagers() {</code></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">var</code>
<code style="color:#000000;">managers: any = [];</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">pnp.setup({</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">sp: {</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">headers: {</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:blue;">&quot;Accept&quot;</code><code style="color:#000000;">:
</code><code style="color:blue;">&quot;application/json; odata=verbose&quot;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">});</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">pnp.sp.profiles.myProperties.select(</code><code style="color:blue;">&quot;ExtendedManagers&quot;</code><code style="color:#000000;">).get().then(d
 =&gt; {</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">managers = d.ExtendedManagers.results;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">console.log(managers);</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">});</code></span></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">}</code></span></div>
</div>
<br />
In the console we will see all our extended managers. <br />
<br />
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/3823.22.png"><img alt=" " src="https://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/3823.22.png" style="border-width:0px;border-style:solid;" /></a><br />
<br />
<strong>Get all user profile properties -<br />
</strong><br />
The below piece of code is used to get all the user profile properties of the logged in user.<br />
<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">function</code>
<code style="color:#000000;">getMyProperties() {</code></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">pnp.setup({</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">sp: {</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">headers: {</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:blue;">&quot;Accept&quot;</code><code style="color:#000000;">:
</code><code style="color:blue;">&quot;application/json; odata=verbose&quot;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">});</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">pnp.sp.profiles.myProperties.get().then(d =&gt; {</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">var</code>
<code style="color:#000000;">properties = d.UserProfileProperties.results;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">console.log(properties);</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">});</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">}</code></span></div>
</div>
<br />
In the console we can see all our user profile properties.<br />
<br />
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/1805.33.png"><img alt=" " src="https://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/1805.33.png" style="border-width:0px;border-style:solid;" /></a><br />
<br />
<span style="font-size:12.1px;"><strong>Get a particular user profile property for a given user</strong></span><br />
<br />
The below piece of code is used to get a particular user profile property for a given user based upon the login name of the user. This is useful in scenarios where we want to fetch a profile property of a user for e.g. Job Title from the login name.<br />
<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">function</code>
<code style="color:#000000;">getUserProfilePropertyForUser(userLoginName: string, propertyName: string) {</code></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">pnp.setup({</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">sp: {</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">headers: {</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:blue;">&quot;Accept&quot;</code><code style="color:#000000;">:
</code><code style="color:blue;">&quot;application/json; odata=verbose&quot;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">});</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">pnp.sp.profiles.getUserProfilePropertyFor(userLoginName, propertyName).then(result =&gt; {</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">console.log(result.GetUserProfilePropertyFor);</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">});</code></span></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">}</code></span></div>
</div>
<br />
In the console we will see the job title or any other user profile property for the respective user whose login name was passed.<br />
<br />
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/7317.44.png"><img alt=" " src="https://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/7317.44.png" height="18" width="195" style="border-width:0px;border-style:solid;" /></a><br />
<br />
If we look at the code blocks above, we see how rich the pnp library is and how it simplified the developers life for making REST calls. You can modify the above pieces of code by subscribing to these calls and use the JSON results obtained.<br />
<br />
<span style="font-size:12.1px;">11. In order to transpile the TypeScript file into JavaScript file type Ctrl &#43; Shift &#43; B. This will create app.js and app.js.map file in your scripts folder.</span><br />
<span style="font-size:12.1px;"><br />
12. Now we will create a single js file with all the required dependencies using the webpack. To that navigate to the scripts folder using command prompt and type:<br />
</span><br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#000000;">webpack ./app.js bundle-app.js</code></span></div>
</div>
<br />
<br />
Your final project structure will be like<strong><br />
<br />
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/515400.5.png"><img alt=" " src="https://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/515400.5.png" height="582" width="347" style="border-width:0px;border-style:solid;" /></a><br />
<br />
<br />
</strong><span style="font-size:12.1px;">13. Drag and drop your index.aspx file in SharePoint.</span><br />
<span style="font-size:12.1px;"><br />
14. Type in gulp serve at the command prompt.</span><br />
<p><a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/4505.6.png"><img alt=" " src="https://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/4505.6.png" style="border-width:0px;border-style:solid;" /></a><br />
<br />
15. Now if you browse your index.aspx file and check the console of your browser using Developer tools you will find the result retrieved from all the methods above.</p>
<h1><a name="References"></a>References</h1>
<p>1.&nbsp;<a href="https://github.com/SharePoint/PnP-JS-Core" target="_blank">https://github.com/SharePoint/PnP-JS-Core</a><br />
<br />
2.&nbsp;<a href="https://github.com/SharePoint/PnP-JS-Core/wiki/Install-and-Use" target="_blank">https://github.com/SharePoint/PnP-JS-Core/wiki/Install-and-Use</a><br />
<br />
3.&nbsp;<span style="font-size:12.1px;"><a href="https://angular.io/guide/webpack" target="_blank" style="font-size:12.1px;">https://angular.io/guide/webpack</a><br />
</span><br />
4.&nbsp;<a href="https://github.com/SharePoint/PnP-JS-Core/wiki/Developer-Guide" target="_blank">https://github.com/SharePoint/PnP-JS-Core/wiki/Developer-Guide</a><br />
<br />
5.&nbsp;<a href="https://gulpjs.com/" target="_blank">https://gulpjs.com/</a><br />
<br />
6.&nbsp;<a href="https://webpack.js.org/concepts/" target="_blank">https://webpack.js.org/concepts/</a><br />
<br />
7.&nbsp;<a href="https://docs.npmjs.com/getting-started/using-a-package.json" target="_blank">https://docs.npmjs.com/getting-started/using-a-package.json</a><br />
<br />
8.&nbsp;<a href="https://angular.io/guide/typescript-configuration" target="_blank">https://angular.io/guide/typescript-configuration</a><br />
<br />
<br />
</p>

</div>
    
    
