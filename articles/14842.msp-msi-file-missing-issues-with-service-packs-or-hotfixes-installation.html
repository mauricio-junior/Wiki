---
layout: default
title: MSP & MSI File Missing Issues with Service Packs or Hotfixes Installation - TechNet Articles - United States (English) - TechNet Wiki
weight: 3
---

<div class="post-content user-defined-markup">

This article is about the issues where installation fails for service packs and hotfixes.&nb
        
</ul>
<div class="navigation-list-footer"></div></div>
<div class="content-fragment-fsp;<br />
<br />
The two common issues I have come across are Missing MSP and MSI files or the patch installer has failed to update the shared features.<br />
<br />
There is perfect answer as why MSP and MSI files will be missing. There are chances that any windows cleanup utility might have removed the files.&nbsp;<br />
<br />
To begin with troubleshooting the issue we always look into the setup log files.<br />
<br />
Whenever a hotfix installation fails, we start troubleshooting &nbsp;with the log file usually located at &nbsp;<br />
%ProgramFiles%\Microsoft SQL Server\90\Setup Bootstrap\LOG\Hotfix\Summary.txt <br />
<br />
(Following <a href="http://msdn.microsoft.com/en-us/library/ms143702(v=sql.110).aspx">
MSDN article</a> provides you the information about viewing and reading SQL Server setup log files )<br />
<br />
In SQL Server 2008 R2 the error message is pretty much clear and concise but this is not the same with the SQL Server 2005.<br />
We need to verify the setup log and there are scenarios where each time different MSP file was missing .&nbsp;<br />
<br />
<strong>MSP error screenshot on 2008 R2 :&nbsp;</strong><br />
<br />
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/5661.msp.png"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/5661.msp.png" style="border-width:0px;border-style:solid;" /></a><br />
<br />
1) If MSP file is missing then we need to identify what is old patch applied.&nbsp;<br />
2) Download that KB patch to Desktop and extract the files from command prompt. &nbsp;Please use following switch to extract PATCH or KB name/extract.<br />
3) Go to extracted directory and copy ..\ hotfixsql\files\sqlrun_sql.msp<br />
4) Paste it in C:\Windows\Installer and rename it to XXXX.msp.<br />
5) Double check that &#39;C:\WINDOWS\Installer\XXXX.msp&#39; exists now.<br />
6) Run the setup and the patch will run successfully&nbsp;<br />
<br />
<strong>MSI Error :</strong><br />
Sql Server Setup encountered following error : C:\Windows\Installer\XXXXX.MSI failed.<br />
<br />
<strong>Resolution :</strong><br />
To resolve the issue copy SqlRun_SQL.msi from setup folder and rename it with the missing MSI file name and copy it into the location C:\Windows\Installer<br />
<br />
<br />
<strong>If you encountered the following error: &quot;Error: Setup fails with the error The patch installer has failed to update the shared features&quot;&nbsp;</strong><br />
<br />
Resolution:&nbsp;<br />
The problem occurs if Devenv.exe.config.tmp file is missing from the computer.&nbsp;<br />
To work around this problem check for the following file devenv.exe.config.tmp &nbsp;in the following folder &quot;C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE\PrivateAssemblies&quot;&nbsp;<br />
<br />
You may refer the following MSDN KB artcile for more information&nbsp;<br />
<a href="http://support.microsoft.com/kb/2216468">http://support.microsoft.com/kb/2216468</a><br />
<br />

</div>
    
    