---
layout: default
title: KB2686509 - Failure Due to Missing DLL Files - TechNet Articles - United States (English) - TechNet Wiki
weight: 3
---

<div class="post-content user-defined-markup"><strong>EDIT OF 6/19/2012:<br />
New Instructions:<br />
<span style="color:#000000;font-family:arial, sans-serif;">The FIX-IT&rsquo;s for this KB have been released today for this Security update. They are available for download at :&nbsp;</span><a href="http://support.microsoft.com/kb/2686509" style="font-family:arial, sans-serif;">http://support.microsoft.com/kb/2686509</a><span style="color:#000000;font-family:arial, sans-serif;">&nbsp;</span><br style="color:#000000;font-family:arial, sans-serif;" />
</strong>
<ul style="color:#000000;font-family:arial, sans-serif;">
    <li><strong>To perform steps 1 through 3 in the &quot;<a href="http://support.microsoft.com/kb/2686509#LetMeFixItMyselfAlways" target="_blank">Let me fix it myself</a>&quot; section, run&nbsp;Microsoft Fix it 50882. &nbsp;(&nbsp;<a href="http://go.microsoft.com/?linkid=9812279" target="_blank">http://go.microsoft.com/?linkid=9812279</a>&nbsp;&nbsp;)</strong></li>
    <li><strong>To perform step 5 in the&nbsp;&quot;<a href="http://support.microsoft.com/kb/2686509#LetMeFixItMyselfAlways" target="_blank">Let me fix it myself</a>&quot; section, run Microsoft Fix it 50883. &nbsp;(<a href="http://go.microsoft.com/?linkid=9812280" target="_blank">http://go.microsoft.com/?linkid=9812280</a>)</strong></li>
</ul>
<hr />
<br />
For those people posting to the <a href="http://answers.microsoft.com/thread/0deeacb6-115c-419d-ac37-03ff8927b79c" target="_blank"><span style="color:#00749e;">http://answers.microsoft.com/thread/0deeacb6-115c-419d-ac37-03ff8927b79c <img alt=" " title="This link is external to TechNet Wiki. It will open in a new window." style="border-width:0px;border-style:solid;" src="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-components-sitefiles/10_5F00_external.png" /> </span></a> thread&nbsp;seems to have a situation where some keyboard layout files are registered in the registry but the corresponding files are not present on his computer. As a result the patch will fail. I&#39;ve typed up this visual how-to to make it a bit easier. Please note this is only one of three different errors types I&#39;ve seen so if this doesn&#39;t fit your exact failure type, I will be attempting to document all three I&#39;ve seen people report.&nbsp; This issue typically occurs due to the use of Nlite to thin down the installation.<br />
<br />
The other two reported failures are due to remapping of keyboard keys which can be found<a href="http://social.technet.microsoft.com/wiki/contents/articles/10829.kb2686509-failure-due-to-remapping-of-a-key.aspx"> here</a>, and files leftover from an upgrade from Windows ME or 98 to Windows XP documented <a href="http://social.technet.microsoft.com/wiki/contents/articles/10876.kb2686509-failure-due-to-upgrade-from-windows-98-to-windows-xp.aspx">here</a>., <br />
<br />
You have a Windows XP that fails to install KB2686509. You go to install&nbsp;<a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;2686509">KB2686509</a> it fails with 0x8007F0F4 error.<br />
<br />
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/8765.Winxpfail.PNG"><img alt=" " width="406" height="305" style="border-width:0px;border-style:solid;" src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/8765.Winxpfail.PNG" /></a><br />
<br />
<br />
Or you may see a message like this:<br />
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/7180.setupfail.PNG"><img alt=" " style="border-width:0px;border-style:solid;" src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/7180.setupfail.PNG" /></a><br />
<br />
<br />
<br />
You DO have a log file anywhere on your PC called faultykeyboard.log file.&nbsp; This should be in the c:\windows folder.&nbsp; <br />
The contents of the log file looks like (or very&nbsp;similar to)&nbsp;this:<br />
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/2642.faultylog2.PNG"><img alt=" " width="390" height="189" style="border-width:0px;border-style:solid;width:229px;height:141px;" src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/2642.faultylog2.PNG" /></a><br />
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/8867.faultylog.PNG"></a><br />
<br />
And the details of the log file are (or are similar with the .dll file extension)<br />
KBDDV.DLL<br />
KBDUSX.DLL<br />
KBDUSL.DLL<br />
KBDUSR.DLL <br />
<br />
<br />
If this is your symptoms, see if following this will get KB2686509 installed.<br />
<br />
Search for each of these files on the computer. Normally if you can find these you are to copy them to the c:\windows\system32 folder. But if you cannot find them then you can delete the registry entry for each of these keyboard layout files. <br />
<br />
Step one, go to your Windows XP and click on the start button, then on run<br />
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/8306.startrun.PNG"><img alt=" " width="329" height="135" style="border-width:0px;border-style:solid;" src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/8306.startrun.PNG" /></a><br />
<br />
Then in the run box type in regedit.<br />
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/6708.regedit.PNG"><img alt=" " width="418" height="216" style="border-width:0px;border-style:solid;" src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/6708.regedit.PNG" /></a><br />
Now drill down the listing you see there and find a specific registry key.<br />
<br />
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Keyboard Layouts<br />
<br />
Go to HKEY_LOCAL_MACHINE. Under there find System and click on the &quot;+&quot; to expand the location.&nbsp; Now find a key called CurrentControlSet and expand that by clicking the &quot;+&quot; . Now scroll down and find the registry key Control and again click on the &quot;+&quot;. Now find the key called Keyboard Layouts.<br />
Right mouse click and export this file to a place on your computer like My documents.<br />
<br />
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityservis-components-files/00-00-00-00-05/6708.regedit.PNG"><img alt=" " width="418" height="216" style="border-width:0px;border-style:solid;" src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00er-wikis-components-files/00-00-00-00-05/2308.exportreg.PNG"><img alt=" " width="406" height="502" style="border-width:0px;border-style:solid;width:292px;height:367px;" src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/2308.exportreg.PNG" /></a><br />
Save this key in a place where you can find it again, like My documents<br />
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/2388.keyboard2.PNG"><img alt=" " width="503" height="391" style="border-width:0px;border-style:solid;" src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/2388.keyboard2.PNG" /></a><br />
<br />
Now that you&#39;ve exported this value, open up the file in notepad.<br />
Right mouse click the file, and click on open with notepad. Click on Edit, then on Find Next (or hit F3) and put in one at a time, the listing of the kbd files found in your faultykeyboard registry file.<br />
<br />
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/2425.kbdfind.PNG"></a><a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/3187.finddleete.PNG"><img alt=" " width="368" height="136" style="border-width:0px;border-style:solid;" src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/3187.finddleete.PNG" /></a><br />
<br />
Delete the entire entry that contains the dll files in this registry file and delete them. <br />
<br />
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/8284.deletinfo.PNG"><img alt=" " style="border-width:0px;border-style:solid;" src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/8284.deletinfo.PNG" /></a><br />
Go back to HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Keyboard Layouts
<p>And save the original keyboard layouts file with a different name. You can, for example, add a 1 to the registry file name so you have a backup.</p>
<p>Save the edited registry file of Keyboard Layouts (the original file name) back into&nbsp;to the registry. You can click on the file and it will reimport it into the registry replacing the kbd files in the registry.</p>
<p>
Now reboot your Windows XP.<br />
Now attempt to install KB2686509 again either via manual download going to <a href="http://www.microsoft.com/en-us/download/details.aspx?id=29804">http://www.microsoft.com/en-us/download/details.aspx?id=29804</a>&nbsp;and downloading from there or using Windows update again. It now should complete successfully.<br />
<br />
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/3426.kbin.PNG"><img alt=" " style="border-width:0px;border-style:solid;" src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/3426.kbin.PNG" /></a><br />
<br />
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/6708.regedit.PNG"></a><br />
<br />
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/8306.startrun.PNG"></a>If these instructions do not work for these orphaned DLL files, please post back on the <a href="http://answers.microsoft.com/thread/0deeacb6-115c-419d-ac37-03ff8927b79c">http://answers.microsoft.com/thread/0deeacb6-115c-419d-ac37-03ff8927b79c</a>&nbsp;thread with your exact problem.<br />
<br />
<br />
</p></div>
    
    