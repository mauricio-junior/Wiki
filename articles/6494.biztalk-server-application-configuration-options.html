---
layout: default
title: 'BizTalk Server&#58; Application Configuration options - TechNet Articles - United States (English) - TechNet Wiki'
weight: 3
---

<div class="post-content user-defined-markup">

<hr />
<div class="table-of-contents"><h2 class="title">Table of Contents</h2><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#Introduction"-fragment page no-wrapper" id="fragment-6615">
<div class="content-fragment-inner fiji-content-fragment-inner"><div class="content-fragment-top fiji-content-fragment-top"><div class="r1 fiji-r1"></div><div class="r2 fiji-r2"></div><div class="r3 fiji-r3"></div><div class="r4 fiji-r4"></div></div><div class="content-fragment-content">

<div class="full-post-header"></div>
<div class="full-post">
    <h1 class="post-name">BizTalk Server: Application Configuration options</h1>
    <div class="post-rating"><span id="ctl00_ctl00_content_content_ctl00_w_6615__648663c5_ctl00_ctl01" title="Rated Excellent [5 out of 5]."></span><input type="hidden" value="5" id="ctl00_ctl00_content_content_ctl00_w_6615__648663c5_ctl00_ctl01_Value" /></div>

    <div class="post-content user-defined-markup">

<hr />
<div class="table-of-contents"><h2 class="title">Table of Contents</h2><div class>Introduction</a></li><li class="hierarchy-item"><a href="#BTSNTSvc_exe_config_file">BTSNTSvc.exe.config file</a><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#Blogs1">Blogs</a></li></ul><div class="hierarchy-list-footer"> </div></li><li class="hierarchy-item"><a href="#Custom_Config_File">Custom Config File</a><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#Blogs2">Blogs</a></li></ul><div class="hierarchy-list-footer"> </div></li><li class="hierarchy-item"><a href="#Enterprise_Library">Registry</a></li><li class="hierarchy-item"><a href="#Business_Rule_Engine">Business Rule Engine</a><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#Blogs3">Blogs</a></li></ul><div class="hierarchy-list-footer"> </div></li><li class="hierarchy-item"><a href="#SSO_Database">SSO Database</a><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#Blogs4">Blogs</a></li></ul><div class="hierarchy-list-footer"> </div></li><li class="hierarchy-item"><a href="#Custom_Database">Custom Database</a></li><li class="hierarchy-item"><a href="#Samples">Samples</a></li><li class="hierarchy-item"><a href="#See_Also">See Also</a></li></ul><div class="hierarchy-list-footer"> </div></div>
<h1><a name="Introduction"></a>Introduction</h1>
<p>There are a couple of options a developer can have when comes to using application configurable values. These options can be divided into three categories:</p>
<ul>
<li><strong>File</strong>: BTSNTSvc.exe.config, Custom config file, Enterprise Library
</li><li><strong>Database</strong>: Business Rule Engine, SSO, or Custom database </li><li><strong>Registry</strong> </li></ul>
<p>This article will provide guidance on each of possible options.</p>
<h1><a name="BTSNTSvc_exe_config_file"></a>BTSNTSvc.exe.config file</h1>
<p>The BizTalk orchestration engine uses an XML file called <a href="http://msdn.microsoft.com/en-us/library/aa561903%28v=bts.70%29.aspx" target="_blank">
BTSNTSvc.exe.config</a> to determine certain behaviors. This file attaches to the main executable BTSNTSvc.exe. Any changes placed in BTSNTSvc.exe.config apply to all host instance regardless of their names. This file is always located in the same directory
 as the BTSNTSvc.exe file, which is usually C:\Program Files\Microsoft BizTalk Server 2010. Any changes in this file will result in a restart of BizTalk Host Instance. Values can be obtained through code in expression shape in an orchestration.</p>
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#008200;"><span style="font-size:12px;">//Get Configuration parameters from BTSNTsvc.exe.config</span></code></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code style="color:#000000;">BTSNTsvcConfigValue1=System.Configuration.ConfigurationSettings.AppSettings.Get(</code><code style="color:blue;">&quot;Value1&quot;</code><code style="color:#000000;">);</code></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code style="color:#000000;">BTSNTsvcConfigValue2=System.Configuration.ConfigurationSettings.AppSettings.Get(</code><code style="color:blue;">&quot;Value2&quot;</code><code style="color:#000000;">);</code></span></div>
</div>
<br />
<h2><a name="Blogs1"></a>Blogs</h2>
<ul>
<li><a href="http://sandroaspbiztalkblog.wordpress.com/2009/04/03/working-with-biztalk-configuration-file-btsntsvc-exe-config/" target="_blank">Working with BizTalk Configuration File â€“ BTSNTSvc.exe.config</a>
</li></ul>
<h1><a name="Custom_Config_File"></a>Custom Config File</h1>
<p>A custom configuration file (.config) can be option to store application configuration data that you can use within BizTalk orchestration for instance. A custom config can be easier to maintain than
<a href="https://social.technet.microsoft.com/wiki/contents/articles/6494.biztalk-server-application-configuration-options/edit.aspx?wa=wsignin1.0#BTSNTSvc_exe_config_file" target="_blank">
BTSNTSvc.exe.config</a> file. You can choose whether or not to use <a href="http://geekswithblogs.net/paulp/archive/2008/06/11/122803.aspx" target="_blank">
Enterprise Library</a> or custom code. Enterprise Library may be too much overhead to just access a custom file. Accessing a .config file can be done using simple .NET code, using the
<a href="http://msdn.microsoft.com/en-us/library/system.configuration.aspx" target="_blank">
System.Configuration</a> namespace. </p>
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code style="color:#808080;">/// &lt;summary&gt;</code></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code style="color:#808080;">/// Return configuration value</code></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code style="color:#808080;">/// &lt;/summary&gt;</code></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code style="color:#808080;">/// &lt;param name=&quot;key&quot;&gt;Key in configuration&lt;/param&gt;</code></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code style="color:#808080;">/// &lt;param name=&quot;nameConfigFile&quot;&gt;Name of configuration file&lt;/param&gt;</code></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code style="color:#808080;">/// &lt;returns&gt;&lt;/returns&gt;</code></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#006699;font-weight:bold;">static</code> <code style="color:#006699;font-weight:bold;">
string</code> <code style="color:#000000;">GetConfigValue(</code><code style="color:#006699;font-weight:bold;">string</code>
<code style="color:#000000;">key, </code><code style="color:#006699;font-weight:bold;">string</code>
<code style="color:#000000;">nameConfigFile)</code></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code style="color:#000000;">{</code></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span style="font-size:12px;"><code style="color:#008200;">// Get the application configuration file path.</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span style="font-size:12px;"><code style="color:#008200;">// Combining location of config file with name of config file</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span style="font-size:12px;"><code style="color:#006699;font-weight:bold;">string</code>
<code style="color:#000000;">exeFilePath = System.IO.Path.Combine(tyle="color:#006699;font-weight:bold;">string</code>
<code style="color:#000000;">nameConfigFile)</code></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code style="color:#000000;">{</code></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span style="font-size:12px;"><code style="color:#008200;">// Get the application configuration file path.</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span style="font-size:12px;"><code style="color:#008200;">// Combining location of config file with name of config file</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbspEnvironment.GetEnvironmentVariable(</code><code style="color:blue;">&quot;BizTalkConfigOptions&quot;</code><code style="color:#000000;">, EnvironmentVariableTarget.Machine), nameConfigFile);</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;">&nbsp;</span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span style="font-size:12px;"><code style="color:#008200;">// Map to the application configuration file.</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span style="font-size:12px;"><code style="color:#008200;">// Instantiate ExeConfigurationFileMap</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span style="font-size:12px;"><code style="color:#000000;">ExeConfigurationFileMap configFile =
</code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">
ExeConfigurationFileMap();</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;">&nbsp;</span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span style="font-size:12px;"><code style="color:#008200;">// Bind filepath to configFile object</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span style="font-size:12px;"><code style="color:#000000;">configFile.ExeConfigFilename = exeFilePath;</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;">&nbsp;</span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span style="font-size:12px;"><code style="color:#008200;">// Instantiate Configuration object and assign configFile</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span style="font-size:12px;"><code style="color:#000000;">System.Configuration.Configuration config = ConfigurationManager.OpenMappedExeConfiguration(configFile,
 ConfigurationUserLevel.None);</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;">&nbsp;</span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span style="font-size:12px;"><code style="color:#008200;">// Return desired value from configuration file</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span style="font-size:12px;"><code style="color:#006699;font-weight:bold;">return</code>
<code style="color:#000000;">config.AppSettings.Settings[key].Value.ToString();</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code style="color:#000000;">}</code></span></div>
</div>
<p>When using custom config file in a multi-machine environment you need to maintain config on each machine. Another back draw is I/O with reading from file. You might need to implement some caching to avoid delays in reading from physical file.</p>
<h2><a name="Blogs2"></a>Blogs</h2>
<p>There are some blogs that discuss this option:</p>
<ul>
<li><a href="http://soa-thoughts.blogspot.com/2007/07/biztalk-and-configuration-files.html" target="_blank">BizTalk and Configuration Files</a>
</li><li><a href="http://geekswithblogs.net/paulp/archive/2008/06/11/122803.aspx" target="_blank">Storing BizTalk settings in custom configuration file using Enterprise Library
</a></li></ul>
<h1><a name="Enterprise_Library"></a>Registry</h1>
<p>Another option is accessing the registry to obtain application configuration values. Through custom code in .NET Helper Class using
<a href="http://msdn.microsoft.com/en-us/library/microsoft.win32.aspx">Microsoft.Win32</a> namespace you can access the registry and read values. See code below to access the registry.</p>
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#000000;"><span style="font-size:12px;">[Serializable]</span></code></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#006699;font-weight:bold;">static</code> <code style="color:#006699;font-weight:bold;">
class</code> <code style="color:#000000;">REGISTRYConfigHelper</code></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;"><span style="font-size:12px;">{</span></code></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#808080;">/// &lt;summary&gt;</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#808080;">/// Return value from registry</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#808080;">/// &lt;/summary&gt;</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#808080;">/// &lt;param name=&quot;subKey&quot;&gt;subKey in the Hive&lt;/param&gt;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#808080;">/// &lt;param name=&quot;value&quot;&gt;Value from subKey&lt;/param&gt;</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#808080;">/// &lt;returns&gt;Request value from the subKey&lt;/returns&gt;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#006699;font-weight:bold;">static</code> <code style="color:#006699;font-weight:bold;">
string</code> <code style="color:#000000;">Read(</code><code style="color:#006699;font-weight:bold;">string</code>
<code style="color:#000000;">subKey, </code><code style="color:#006699;font-weight:bold;">string</code>
<code style="color:#000000;">value)</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#008200;">// Create value variable</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">string</code>
<code style="color:#000000;">retValue = </code><code style="color:#006699;font-weight:bold;">null</code><code style="color:#000000;">;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#008200;">// Opening the registry key</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">RegistryKey rk = Registry.CurrentUser;</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#008200;">// Open a subKey as read-only</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">RegistryKey sk1 = rk.OpenSubKey(subKey,RegistryKeyPermissionCheck.ReadSubTree,System.Security.AccessControl.RegistryRights.FullControl);</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#008200;">// If the RegistrySubKey does exist</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbolor:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#008200;">// Open a subKey as read-only</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">RegistryKey sk1 = rk.OpenSubKey(subKey,RegistryKeyPermissionCheck.ReadSubTree,System.Security.AccessControl.RegistryRights.FullControl);</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code stsp;</code><span><code style="color:#006699;font-weight:bold;">if</code>
<code style="color:#000000;">(sk1 != </code><code style="color:#006699;font-weight:bold;">null</code><code style="color:#000000;">)</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">try</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#008200;">// If the RegistryKey exists get its value or null is returned.</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">retValue = (</code><code style="color:#006699;font-weight:bold;">string</code><code style="color:#000000;">)sk1.GetValue(value.ToUpper());</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">catch</code>
<code style="color:#000000;">(Exception e)</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">System.Diagnostics.Trace.WriteLine(e.Message);</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">throw</code><code style="color:#000000;">;</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#008200;">// Return value</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">return</code>
<code style="color:#000000;">retValue;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;"><span style="font-size:12px;">}</span></code></span></div>
</div>
<p>Storing values in registry is an option, however it is not easy to maintain. In a multiple machine BizTalk deployment this is far from ideal option as you have to maintain multiple registries. The same accounts for using custom file or BTSNTSvc.exe.config.</p>
<h1><a name="Business_Rule_Engine"></a>Business Rule Engine</h1>
<p>So far registry and file options have been discussed. Not the best options when you want to consider a central store for your&nbsp;application custom configuration data. A database would be a better option from an administrative viewpoint. Business Rule Engine
 (BRE) can be used to store configuration data. Using a <a href="http://msdn.microsoft.com/en-us/library/aa560288.aspx">
vocabulary</a> with custom definitions containing constant values.&nbsp; Code below shows how to access custom definition in a vocabulary.</p>
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#808080;"><span style="font-size:12px;">/// &lt;summary&gt;</span></code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#808080;"><span style="font-size:12px;">/// Obtain value from Definition in a Vocabulary</span></code></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#808080;"><span style="font-size:12px;">/// &lt;/summary&gt;</span></code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#808080;"><span style="font-size:12px;">/// &lt;param name=&quot;definitionName&quot;&gt;Definition Name e.g. Value1&lt;/param&gt;</span></code></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#808080;"><span style="font-size:12px;">/// &lt;param name=&quot;vocabularyName&quot;&gt;Name of Vocabulary i.e. Config&lt;/param&gt;</span></code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#808080;"><span style="font-size:12px;">/// &lt;returns&gt;Return Constant Value&lt;/returns&gt;</span></code></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#006699;font-weight:bold;">static</code> <code style="color:#006699;font-weight:bold;">
string</code> <code style="color:#000000;">Read(</code><code style="color:#006699;font-weight:bold;">string</code>
<code style="color:#000000;">definitionName, </code><code style="color:#006699;font-weight:bold;">string</code>
<code style="color:#000000;">vocabularyName)</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;"><span style="font-size:12px;">{</span></code></span></div>
<div style="backgroun>/// &lt;param name=&quot;vocabularyName&quot;&gt;Name of Vocabulary i.e. Config&lt;/param&gt;</span></code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#808080;"><span style="font-size:12px;">/// &lt;returns&gt;Return Constant Value&lt;/returns&gt;</span></code></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#006699;font-weight:bold;">static</code> <code style="color:#006699;font-weight:bold;">
string</code> <code style="color:#000000;">Read(</code><code style="color:#006699;font-weight:bold;">string</code>
<code style="color:#000000;">definitionName, </code><code style="color:#006699;font-weight:bold;">string</code>
<code style="color:#000000;">vocabularyName)</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;d-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#008200;">// RuleStore Object</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">RuleStore rlsRuleStore;</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#008200;">// Vocab Info collection</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">VocabularyInfoCollection vicVocabInfo;</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#008200;">// Vocab itself</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">Vocabulary vocVocab;</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#008200;">// Provides the default deployment driver used to import, export, deploy, un-deploy, and</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#008200;">// set tracking configuration for published rule sets and vocabularies,</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#008200;">// and to retrieve their deployment characteristics.
</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">RuleSetDeploymentDriver rsdDriver =
</code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">
RuleSetDeploymentDriver();</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#008200;">// The current RuleStore</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">rlsRuleStore = rsdDriver.GetRuleStore();</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#008200;">// Set Vocabulary based on Vocabulary collection</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">vicVocabInfo = rlsRuleStore.GetVocabularies(vocabularyName, RuleStore.Filter.All);</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#008200;">// Get the vocabulary itself</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">vocVocab = rlsRuleStore.GetVocabulary(vicVocabInfo[0]);</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#008200;">// Get the definition</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">VocabularyDefinition vocDef = vocVocab.Definitions.GetByName(definitionName);</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#008200;">// Set LiteralDefition</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">LiteralDefinition literalDefinition = vocDef
</code><code style="color:#006699;font-weight:bold;">as</code> <code style="color:#000000;">
LiteralDefinition;</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#008200;">// Return Value</code></span></span></div>
<div><span style="font-size:12px;"><code style="background-color:#ffffff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;background-color:#ffffff;">return</code>
<code style="color:#000000;"><span style="background-color:#ffffff;">literalDefinition.Value.ToString();<br />
</span></code></span><span style="font-size:12.1px;background-color:#f8f8f8;color:#000000;">}</span></span></div>
</div>
<p class="code">From administrative standpoint maintaining configuration files in BRE can be complex compared to using SSO or CustomDb.</p>
<div class="code">
<h2><a name="Blogs3"></a>Blogs</h2>
<ul>
<li><a href="http://geekswithblogs.net/FMRuiz/archive/2009/08/14/temp.aspx" target="_blank">BizTalk configuration with the Business Rule Engine</a>
</li></ul>
</div>
<h1><a name="SSO_Database"></a>SSO Database</h1>
<p>One of popular and easy options of retrieving application configuration data is using SSO. Microsoft has built a
<a href="http://www.microsoft.com/download/en/details.aspx?id=14524">SSO Application Configuration snap in</a> that provides an good user experience maintaining custom configuration data. When downloading the snap in you will also get code for a .NET Helper
 Class to support retrieval of data in BizTalk. See code below for retrieving data from SSO.</p>
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#808080;"><span style="font-size:12px;">/// &lt;summary&gt;</span></code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#808080;"><span style="font-size:12px;">/// Read method helps get configuration data</span></code></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#808080;"><span style="font-size:12px;">/// &lt;/summary&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#808080;"><span style="font-size:12px;">/// &lt;param name=&quot;appName&quot;&gt;The name of the affiliate application to represent the configuration container to access&lt;/param&gt;</span></code></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#808080;"><span style="font-size:12px;">/// &lt;param name=&quot;propName&quot;&gt;The property name to read&lt;/param&gt;</span></code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#808080;"><span style="font-size:12px;">/// &lt;returns&gt;</span></code></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#808080;"><span style="font-size:12px;">///&nbsp; The value of the property stored in the given affiliate application of this component.</span></code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#808080;"><span style="font-size:12px;">/// &lt;/returns&gt;</span></code></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#006699;font-weight:bold;">static</code> <code style="color:#006699;font-weight:bold;">
string</code> <code style="color:#000000;">Read(</code><code style="color:#006699;font-weight:bold;"font-size:12px;">/// &lt;param name=&quot;propName&quot;&gt;The property name to read&lt;/param&gt;</span></code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#808080;"><span style="font-size:12px;">/// &lt;returns&gt;</span></code></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#808080;"><span style="font-size:12px;">///&nbsp; The value of the property stored in the given affiliate application of this component.</span></code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#808080;"><span style="font-size:12px;">/// &lt;/returns&gt;</span></code></span></div>
<div style="background-color:#ffffff">string</code>
<code style="color:#000000;">appName, </code><code style="color:#006699;font-weight:bold;">string</code>
<code style="color:#000000;">propName)</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;"><span style="font-size:12px;">{</span></code></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">try</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#008200;">//Instantiate SSOConfigStore Object</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">SSOConfigStore ssoStore =
</code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">
SSOConfigStore();</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#008200;">//Instantiate ConfigurationPropertyBag</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">ConfigurationPropertyBag appMgmtBag =
</code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">
ConfigurationPropertyBag();</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#008200;">//Get value based on appName</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">((ISSOConfigStore)ssoStore).GetConfigInfo(appName, idenifierGUID, SSOFlag.SSO_FLAG_RUNTIME, (IPropertyBag)appMgmtBag);</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#008200;">//Create propertyValue object</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">object</code>
<code style="color:#000000;">propertyValue = </code><code style="color:#006699;font-weight:bold;">null</code><code style="color:#000000;">;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#008200;">//Read property</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">appMgmtBag.Read(propName,
</code><code style="color:#006699;font-weight:bold;">out</code> <code style="color:#000000;">
propertyValue, 0);</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#008200;">//return property value</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">return</code>
<code style="color:#000000;">(</code><code style="color:#006699;font-weight:bold;">string</code><code style="color:#000000;">)propertyValue;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">catch</code>
<code style="color:#000000;">(Exception e)</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">System.Diagnostics.Trace.WriteLine(e.Message);</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">throw</code><code style="color:#000000;">;</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;"><span style="font-size:12px;">}</span></code></span></div>
</div>
<p class="code">This approach has some major benefits. Data is cached and has a built in refresh mechanism (ESSO Service) and secure. It offers ability to store sensitive information.</p>
<div class="code">
<h2><a name="Blogs4"></a>Blogs</h2>
<ul>
<li><a href="http://blogs.msdn.com/b/skaufman/archive/2010/08/31/storing-application-configuration-information-in-sso.aspx" target="_blank">Custom Configuration options for BizTalk Solution</a>
</li><li><a href="http://blogs.msdn.com/b/teekamg/archive/2009/08/19/sso-configuration-application-mmc-snap-in.aspx" target="_blank">SSO Configuration Application MMC Snap-In</a>
</li><li><a href="http://www.biztalkgurus.com/biztalk_server/biztalk_blogs/b/biztalksyn/archive/2010/08/31/storing-application-configuration-information-in-sso.aspx" target="_blank">Storing Application Configuration Information in SSO</a>
</li></ul>
</div>
<h1><a name="Custom_Datayle="color:#0base"></a>Custom Database</h1>
<p>Instead of using one of existing BizTalk databases you can use a custom database to store application configuration data. You can use an .Net Helper Class that supports retrieving the data from database (see code below).</p>
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><span><code style="color:#808080;"><span style="font-size:12px;">/// &lt;summary&gt;</span></code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#808080;"><span style="font-size:12px;">/// Get value from custom database table</span></code></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#808080;"><span style="font-size:12px;">/// &lt;/summary&gt;</span></code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#808080;"><span style="font-size:12px;">/// &lt;param name=&quot;value&quot;&gt;name to search in database table&lt;/param&gt;</span></code></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#808080;"><span style="font-size:12px;">/// &lt;returns&gt;Value of the name&lt;/returns&gt;</span></code></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#006699;font-weight:bold;">static</code> <code style="color:#006699;font-weight:bold;">
string</code> <code style="color:#000000;">Read(</code><code style="color:#006699;font-weight:bold;">string</code>
<code style="color:#000000;">name)</code></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;"><span style="font-size:12px;">{</span></code></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">string</code>
<code style="color:#000000;">result = </code><code style="color:#006699;font-weight:bold;">null</code><code style="color:#000000;">;</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#008200;">// Connectionstring, you have to change this setting your own Data Source</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#008200;">// Connectionstring could be obtain from config file</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">using</code>
<code style="color:#000000;">(var conn = </code><code style="color:#006699;font-weight:bold;">new</code>
<code style="color:#000000;">SqlConnection(</code><code style="color:blue;">&quot;Data Source=WIN-8BPNTQKTJ5M;Initial Catalog=ConfigDb;Integrated Security=True&quot;</code><code style="color:#000000;">))</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">using</code>
<code style="color:#000000;">(var cmd = conn.CreateCommand())</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">conn.Open();</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">cmd.CommandText =
</code><code style="color:blue;">&quot;SELECT Value FROM ConfigValues WHERE Name=&#39;&quot;</code>
<code style="color:#000000;">&#43; name &#43; </code><code style="color:blue;">&quot;&#39;&quot;</code><code style="color:#000000;">;</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#008200;">//Execute command</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">SqlDataReader reader = cmd.ExecuteReader();</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#008200;">//Read result</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">while</code>
<code style="color:#000000;">(reader.Read())</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">result = reader.GetString(0);</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#008200;">//Close reader</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">reader.Close();</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#008200;">//Close connection</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">conn.Close();</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#f8f8f8;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#008200;">// return value</code></span></span></div>
<div style="background-color:#ffffff;"><span style="font-size:12px;"><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">return</code>
<code style="color:#000000;">result;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;"><span style="font-size:12px;">}</span></code></span></div>
</div>
<p>Custom database can be option, but it does not offer the security like SSO. Maintaining custom database is less intuitive as with SSO Application Configuration snap in.</p>
<h1><a name="Samples"></a>Samples</h1>
<p>There are a couple of samples available demonstrating the options:</p>
<ul>
<li><a href="http://code.msdn.microsoft.com/Custom-Configuration-6c807804" target="_blank">Custom Configuration options for BizTalk Solution</a>
</li><li><a href="http://geekswithblogs.net/michaelstephenson/archive/2008/05/25/122381.aspx" target="_blank">Where do I store my custom configuration for a BizTalk solution</a>
</li></ul>
<h1><a name="See_Also"></a>See Also</h1>
<p>Read suggested related topics:</p>
<ul>
<li><a href="http://blogs.msdn.com/b/vishalag/archive/2008/06/22/biztalk-configuration-store.aspx" target="_blank">BizTalk Configuration Store</a>
</li></ul>
Another important place to find a huge amount of BizTalk related articles is the TechNet Wiki itself. The best entry point is
<a href="http://social.technet.microsoft.com/wiki/contents/articles/2240.biztalk-server-resources-on-the-technet-wiki.aspx" target="_blank">
BizTalk Server Resources on the TechNet Wiki</a>.

</div>
    
    
