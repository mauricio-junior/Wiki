---
layout: default
title: Максимум из нескольких колонок (ru-RU) - TechNet Articles - United States (English) - TechNet Wiki
weight: 3
---

<div class="post-content user-defined-markup">

<em><strong><span style="font-size:14px;">Как получить &#1084;акси&#1084;у&#1084; из нескольких колонок одной таблицы?<br />
</span></strong></em>
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">01.</code><span><code style="color:#000000;">if object_id ( N</code><code style="color:blue;">&#39;dbo.test_table&#39;</code><code style="color:#000000;">,
 N</code><code style="color:blue;">&#39;U&#39;</code> <code style="color:#000000;">) </code>
<code style=nt-top"><div class="r1 fiji-r1"></div><div class="r2 fiji-r2"></div><div class="r3 fiji-r3"></div><div class="r4 fiji-r4"></div></div><div class="content-fragment-content">

<div clas"color:#006699;font-weight:bold;">is</code> <code style="color:#808080;">
not</code> <code style="color:#808080;">null</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">02.</code><span><code>&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">drop</code>
<code style="color:#006699;font-weight:bold;">table</code> <code style="color:#000000;">
dbo.test_table;</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">03.</code><span><code style="color:#000000;">go</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">04.</code><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">05.</code><span><code style="color:#006699;font-weight:bold;">create</code>
<code style="color:#006699;font-weight:bold;">table</code> <code style="color:#000000;">
dbo.test_table ( id </code><code style="color:#006699;font-weight:bold;">int</code>
<code style="color:#000000;">identity</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">06.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">,
 a </code><code style="color:#006699;font-weight:bold;">int</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">07.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">,
 b </code><code style="color:#006699;font-weight:bold;">int</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">08.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">,
 c </code><code style="color:#006699;font-weight:bold;">int</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">09.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">,
 d </code><code style="color:#006699;font-weight:bold;">int</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">10.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">,
 e </code><code style="color:#006699;font-weight:bold;">int</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">11.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">);</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">12.</code><span><code style="color:#000000;">go</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">13.</code><span>&nbsp;</span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">14.</code><span><code style="color:#006699;font-weight:bold;">insert</code>
<code style="color:#006699;font-weight:bold;">into</code> <code style="color:#000000;">
dbo.test_table</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">15.</code><span><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#000000;">10, 5, 12, 56, 2</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">16.</code><span><code style="color:#006699;font-weight:bold;">union</code>
<code style="color:#808080;">all</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">17.</code><span><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#000000;">100, 45, 78, 6, 122</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">18.</code><span><code style="color:#006699;font-weight:bold;">union</code>
<code style="color:#808080;">all</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">19.</code><span><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#000000;">150, 50, 127, 596, 22</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">20.</code><span><code style="color:#006699;font-weight:bold;">union</code>
<code style="color:#808080;">all</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">21.</code><span><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#000000;">3410, 55, 0, -45, 90</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">22.</code><span><code style="color:#006699;font-weight:bold;">union</code>
<code style="color:#808080;">all</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">23.</code><span><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#000000;">-10, -5, 0, -56, -2;</code></span></divfloat:left;display:block;">20.</code><span><code style="color:#006699;font-weight:bold;">union</code>
<code style="color:#808080;">all</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">21.</code><span><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#000000;">3410, 55, 0, -45, 90</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">22.</code><span><code style="color:#006699;font-weight:bold;">union</code>
<code style="color:#80>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">24.</code><span><code style="color:#000000;">go</code></span></div>
</div>
<br />
<a href="http://t-sql.ru/image.axd?picture=2012/2/max-01.png">max 01.png</a><br />
<br />
А теперь несколько при&#1084;еров, как найти &#1084;акси&#1084;у&#1084; в каждой строке по все&#1084; колонка&#1084;.<br />
<br />
<strong><span style="font-size:13px;">1. Выражение CASE (любая версия)</span></strong>
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">01.</code><span><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#000000;">*</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">02.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">, max_val =
</code><code style="color:#ff1493;">case</code> <code style="color:#006699;font-weight:bold;">
when</code> <code style="color:#000000;">( a &gt;= b ) </code><code style="color:#808080;">and</code>
<code style="color:#000000;">( a &gt;= c ) </code><code style="color:#808080;">and</code>
<code style="color:#000000;">( a &gt;= d ) </code><code style="color:#808080;">and</code>
<code style="color:#000000;">( a &gt;= e )</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">03.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">then</code>
<code style="color:#000000;">a</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">04.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">when</code>
<code style="color:#000000;">( b &gt;= a ) </code><code style="color:#808080;">and</code>
<code style="color:#000000;">( b &gt;= c ) </code><code style="color:#808080;">and</code>
<code style="color:#000000;">( b &gt;= d ) </code><code style="color:#808080;">and</code>
<code style="color:#000000;">( b &gt;= e )</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">05.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">then</code>
<code style="color:#000000;">b</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">06.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">when</code>
<code style="color:#000000;">( c &gt;= a ) </code><code style="color:#808080;">and</code>
<code style="color:#000000;">( c &gt;= b ) </code><code style="color:#808080;">and</code>
<code style="color:#000000;">( c &gt;= d ) </code><code style="color:#808080;">and</code>
<code style="color:#000000;">( c &gt;= e )</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">07.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">then</code>
<code style="color:#000000;">c</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">08.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">when</code>
<code style="color:#000000;">( d &gt;= a ) </code><code style="color:#808080;">and</code>
<code style="color:#000000;">( d &gt;= b ) </code><code style="color:#808080;">and</code>
<code style="color:#000000;">( d &gt;= c ) </code><code style="color:#808080;">and</code>
<code style="color:#000000;">( d &gt;= e )</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">09.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">then</code>
<code style="color:#000000;">d</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">10.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">else</code>
<code style="color:#000000;">e</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">11.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">end</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">12.</code><span><code>&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">from</code>
<code style="color:#000000;">dbo.test_table</code></span></span></div>
</div>
<br />
<strong><span style="font-size:13px;">2. Подзапрос и оператор UNION (любая версия)</span></strong>
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">01.</code><span><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#000000;">*</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">02.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">, max_val =
 ( </code><code style="color:#006699;font-weight:bold;">select</code> <code style="color:#006699;font-weight:bold;">
max</code><code style="color:#000000;">(i) </code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">03.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">from</code>
<code style="color:#000000;">( </code><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#000000;">a </code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">04.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">union</code>
<code style="color:#808080;">all</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">05.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#000000;">b </code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;paddlor:#f8f8f8;"><code style="width:3em;text-aing-right:0.3em;float:left;display:block;">06.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">union</code>
<code style="color:#808080;">all</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">07.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#000000;">c</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">08.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">union</code>
<code style="color:#808080;">all</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">09.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#000000;">d</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">10.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">union</code>
<code style="color:#808080;">all</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">11.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#000000;">e</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">12.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">)
 t(i)</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">13.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">)</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">14.</code><span><code>&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">from</code>
<code style="color:#000000;">dbo.test_table</code></span></span></div>
</div>
<br />
<strong><span style="font-size:13px;">3. Подзапрос и предложение VALUES (SQL Server 2008 и выше)</span></strong>
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">01.</code><span><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#000000;">*</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">02.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">, max_val =
 ( </code><code style="color:#006699;font-weight:bold;">select</code> <code style="color:#006699;font-weight:bold;">
max</code><code style="color:#000000;">(i) </code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">03.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">from</code>
<code style="color:#000000;">( </code><code style="color:#006699;font-weight:bold;">values</code>
<code style="color:#000000;">(a)</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">04.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">,(b)</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">05.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">,(c)</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">06.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">,(d)</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">07.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">,(e)
</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">08.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbcode><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">,(d)</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">07.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">,(e)
</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;textsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">)
 t(i)</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">09.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">)</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">10.</code><span><code>&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">from</code>
<code style="color:#000000;">dbo.test_table</code></span></span></div>
</div>
<br />
<strong><span style="font-size:13px;">4. Оператор UNPIVOT (SQL Server 2005 и выше)</span></strong>
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">1.</code><span><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#000000;">id, </code><code style="color:#006699;font-weight:bold;">max</code><code style="color:#000000;">(val)
</code><code style="color:#006699;font-weight:bold;">as</code> <code style="color:#000000;">
max_val</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">2.</code><span><code>&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">from</code>
<code style="color:#000000;">( </code><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#000000;">* </code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">3.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">from</code>
<code style="color:#000000;">dbo.test_table t</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">4.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">unpivot
 ( val </code><code style="color:#006699;font-weight:bold;">for</code> <code style="color:#000000;">
col </code><code style="color:#808080;">in</code> <code style="color:#000000;">( [a],[b],[c],[d],[e]) ) up</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">5.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">6.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">) t</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">7.</code><span><code>&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">group</code>
<code style="color:#006699;font-weight:bold;">by</code> <code style="color:#000000;">
id</code></span></span></div>
</div>
<br />
<strong><span style="font-size:13px;">5. Оператор UNPIVOT и ранжирующие функции (SQL Server 2005 и выше)</span></strong>
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">1.</code><span><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#006699;font-weight:bold;">top</code> <code style="color:#000000;">
1 </code><code style="color:#006699;font-weight:bold;">with</code> <code style="color:#000000;">
ties id, val </code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">2.</code><span><code>&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">from</code>
<code style="color:#000000;">dbo.test_table t</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">3.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">unpivot ( val
</code><code style="color:#006699;font-weight:bold;">for</code> <code style="color:#000000;">
col </code><code style="color:#808080;">in</code> <code style="color:#000000;">( [a],[b],[c],[d],[e]) ) up</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">4.</code><span><code>&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">order</code>
<code style="color:#006699;font-weight:bold;">by</code> <code style="color:#000000;">
row_number() over ( partition </code><code style="color:#006699;font-weight:bold;">by</code>
<code style="color:#000000;">id </code><code style="color:#006699;font-weight:bold;">order</code>
<code style="color:#006699;font-weight:bold;">by</code> <code style="color:#000000;">
val </code><code style="color:#006699;font-weight:bold;">desc</code> <code style="color:#000000;">
)</code></span></span></div>
</div>
<br />
<strong><span style="font-size:13px;">6. Оператор CROSS APPLY (SQL Server 2005 и выше)</span></strong>
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">01.</code><span><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#000000;">* </code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">02.</code><span><code>&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">from</code>
<code style="color:#000000;">dbo.test_table t</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">03.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#808080;">cross</code>
<code style="color:#000000;">apply ( </code><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#006699;font-weight:bold;">top</code> <code style="color:#000000;">
1 val </code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">04.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">from</code>
<code style="color:#000000;">( </code><code style="color:#006699;font-weight:bold;">values</code>
<code style="color:#000000;">(a),(b),(c),(d),(e) ) t (val)</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">05.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">order</code>
<code style="color:#006699;font-weight:bold;">by</code> <code style="color:#000000;">
val </code><code style="color:#006699;font-weight:bold;">desc</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">06.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">)
 ca (max_val)</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">07.</code><span>&nbsp;</span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">08.</code><span><code style="color:#008200;">--Ещё вариант</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">09.</code><span>&nbsp;</span></div>
<div style="backgror:#006699;font-weight:bold;">desc</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">06.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">)
 ca (max_val)</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">07.</code><span>&nbsp;</span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">08.</code><span><code style="color:#008200;">--Ещё вариант</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;paddingound-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">10.</code><span><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#000000;">id, a, b, c, d, e, max_val</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">11.</code><span><code>&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">from</code>
<code style="color:#000000;">dbo.test_table t</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">12.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#808080;">cross</code>
<code style="color:#000000;">apply ( </code><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#000000;">row_number() over (</code><code style="color:#006699;font-weight:bold;">order</code>
<code style="color:#006699;font-weight:bold;">by</code> <code style="color:#000000;">
val </code><code style="color:#006699;font-weight:bold;">desc</code><code style="color:#000000;">) i, val</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">13.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">from</code>
<code style="color:#000000;">( </code><code style="color:#006699;font-weight:bold;">values</code>
<code style="color:#000000;">(a),(b),(c),(d),(e) ) t (val)</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">14.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">)
 ca (i, max_val)</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">15.</code><span><code>&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">where</code>
<code style="color:#000000;">ca.i = 1</code></span></span></div>
</div>
<br />
<strong><span style="font-size:13px;">7. Inline-функция и CTE (SQL Server 2005 и выше)</span></strong>
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">01.</code><span><code style="color:#000000;">if object_id ( N</code><code style="color:blue;">&#39;dbo.f_get_max&#39;</code><code style="color:#000000;">,
 N</code><code style="color:blue;">&#39;IF&#39;</code> <code style="color:#000000;">) </code>
<code style="color:#006699;font-weight:bold;">is</code> <code style="color:#808080;">
not</code> <code style="color:#808080;">null</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">02.</code><span><code>&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">drop</code>
<code style="color:#006699;font-weight:bold;">function</code> <code style="color:#000000;">
dbo.f_get_max;</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">03.</code><span><code style="color:#000000;">go</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">04.</code><span><code style="color:#006699;font-weight:bold;">create</code>
<code style="color:#006699;font-weight:bold;">function</code> <code style="color:#000000;">
dbo.f_get_max ( </code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">05.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">@a
</code><code style="color:#006699;font-weight:bold;">int</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">06.</code><span><code>&nbsp;&nbsp;</code><span><code style="color:#000000;">, @b
</code><code style="color:#006699;font-weight:bold;">int</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">07.</code><span><code>&nbsp;&nbsp;</code><span><code style="color:#000000;">, @c
</code><code style="color:#006699;font-weight:bold;">int</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">08.</code><span><code>&nbsp;&nbsp;</code><span><code style="color:#000000;">, @d
</code><code style="color:#006699;font-weight:bold;">int</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">09.</code><span><code>&nbsp;&nbsp;</code><span><code style="color:#000000;">, @e
</code><code style="color:#006699;font-weight:bold;">int</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">10.</code><span><code style="color:#000000;">)
</code><code style="color:#006699;font-weight:bold;">returns</code> <code style="color:#006699;font-weight:bold;">
table</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">11.</code><span><code style="color:#006699;font-weight:bold;">as</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">12.</code><span><code style="color:#006699;font-weight:bold;">return</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">13.</code><span><code style="color:#006699;font-weight:bold;">with</code>
<code style="color:#000000;">cte</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">14.</code><span><code style="color:#006699;font-weight:bold;">as</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;xt-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">11.</code><span><code style="color:#006699;font-weight:bold;">as</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">12.</code><span><code style="color:#006699;font-weight:bold;">return</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">13.</code><span><code style="color:#006699;font-weight:bold;">with</code>
<code style="color:#000000;">cte</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">14.</code><span><code style="color:#006699;font-weight:bold;">as</code></span></div>
<float:left;display:block;">15.</code><span><code style="color:#000000;">(
</code><code style="color:#006699;font-weight:bold;">select</code> <code style="color:#000000;">
val </code><code style="color:#006699;font-weight:bold;">from</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">16.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">(
</code><code style="color:#006699;font-weight:bold;">values</code> <code style="color:#000000;">
(@a),(@b),(@c),(@d),(@e) </code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">17.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">) t(val)</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">18.</code><span><code style="color:#000000;">)</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">19.</code><span><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#006699;font-weight:bold;">max</code><code style="color:#000000;">(val)
</code><code style="color:#006699;font-weight:bold;">as</code> <code style="color:#000000;">
max_val </code><code style="color:#006699;font-weight:bold;">from</code> <code style="color:#000000;">
cte;</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">20.</code><span><code style="color:#000000;">go
</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">21.</code><span>&nbsp;</span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">22.</code><span><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#000000;">* </code><code style="color:#006699;font-weight:bold;">from</code>
<code style="color:#000000;">dbo.test_table t</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">23.</code><span><code>&nbsp;&nbsp;</code><span><code style="color:#808080;">cross</code>
<code style="color:#000000;">apply dbo.f_get_max ( a, b, c, d, e )</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">24.</code><span><code style="color:#000000;">go</code></span></div>
</div>
<br />
<br />
А теперь пос&#1084;отри&#1084; на производительность этих запросов, чтобы определить, какой из вариантов более предпочтителен. Тест буду проводить также на 5 колонках таблицы с 10 &#1084;лн. записей.
<br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">001.</code><span><code style="color:#006699;font-weight:bold;">set</code>
<code style="color:#000000;">nocount </code><code style="color:#006699;font-weight:bold;">on</code><code style="color:#000000;">;</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">002.</code><span><code style="color:#000000;">go</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">003.</code><span>&nbsp;</span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">004.</code><span><code style="color:#000000;">if object_id ( N</code><code style="color:blue;">&#39;dbo.test_table&#39;</code><code style="color:#000000;">,
 N</code><code style="color:blue;">&#39;U&#39;</code> <code style="color:#000000;">) </code>
<code style="color:#006699;font-weight:bold;">is</code> <code style="color:#808080;">
not</code> <code style="color:#808080;">null</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">005.</code><span><code>&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">drop</code>
<code style="color:#006699;font-weight:bold;">table</code> <code style="color:#000000;">
dbo.test_table;</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">006.</code><span><code style="color:#000000;">go</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">007.</code><span>&nbsp;</span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">008.</code><span><code style="color:#006699;font-weight:bold;">create</code>
<code style="color:#006699;font-weight:bold;">table</code> <code style="color:#000000;">
dbo.test_table ( id </code><code style="color:#006699;font-weight:bold;">int</code>
<code style="color:#000000;">identity </code><code style="color:#006699;font-weight:bold;">primary</code>
<code style="color:#006699;font-weight:bold;">key</code> <code style="color:#000000;">
clustered</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">009.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">,
 a </code><code style="color:#006699;font-weight:bold;">int</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">010.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">,
 b </code><code style="color:#006699;font-weight:bold;">int</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">011.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">,
 c </code><code style="color:#006699;font-weight:bold;">int</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">012.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">,
 d </code><code style="color:#006699;font-weight:bold;">int</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">013.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">,
 e </code><code style="color:#006699;font-weight:bold;">int</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">014.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">);</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">015.</code><span><code style="color:#000000;">go</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">016.</code><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><code style="width&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">,
 e </code><code style="color:#006699;font-weight:bold;">int</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">014.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">);</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">015.</code><span><code style="color:#000000;">go</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:le:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">017.</code><span><code style="color:#008200;">--Генери&#1084; 10 &#1084;лн строк</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">018.</code><span><code style="color:#006699;font-weight:bold;">with</code>
<code style="color:#000000;">cte </code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">019.</code><span><code style="color:#006699;font-weight:bold;">as</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">020.</code><span><code style="color:#000000;">(
</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">021.</code><span><code>&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#000000;">1 i</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">022.</code><span><code>&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">union</code>
<code style="color:#808080;">all</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">023.</code><span><code>&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#000000;">i&#43;1 </code><code style="color:#006699;font-weight:bold;">from</code>
<code style="color:#000000;">cte </code><code style="color:#006699;font-weight:bold;">where</code>
<code style="color:#000000;">i &lt; 10000000</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">024.</code><span><code style="color:#000000;">)</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">025.</code><span><code style="color:#006699;font-weight:bold;">insert</code>
<code style="color:#006699;font-weight:bold;">into</code> <code style="color:#000000;">
dbo.test_table</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">026.</code><span><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#000000;">checksum ( newid() ) % 1000 </code><code style="color:#006699;font-weight:bold;">as</code>
<code style="color:#000000;">a</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">027.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">, checksum
 ( newid() ) % 1000 </code><code style="color:#006699;font-weight:bold;">as</code>
<code style="color:#000000;">b</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">028.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">, checksum
 ( newid() ) % 1000 </code><code style="color:#006699;font-weight:bold;">as</code>
<code style="color:#000000;">c</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">029.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">, checksum
 ( newid() ) % 1000 </code><code style="color:#006699;font-weight:bold;">as</code>
<code style="color:#000000;">d</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">030.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">, checksum
 ( newid() ) % 1000 </code><code style="color:#006699;font-weight:bold;">as</code>
<code style="color:#000000;">e</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">031.</code><span><code>&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">from</code>
<code style="color:#000000;">cte</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">032.</code><span><code style="color:#006699;font-weight:bold;">option</code>
<code style="color:#000000;">( maxrecursion 0 );</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">033.</code><span>&nbsp;</span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">034.</code><span><code style="color:#006699;font-weight:bold;">declare</code>
<code style="color:#000000;">@val </code><code style="color:#006699;font-weight:bold;">int</code><code style="color:#000000;">;</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">035.</code><span>&nbsp;</span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">036.</code><span><code style="color:#000000;">print
</code><code style="color:blue;">&#39;1. Выражение CASE (любая версия)&#39;</code><code style="color:#000000;">;</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">037.</code><span><code style="color:#006699;font-weight:bold;">set</code>
<code style="color:#006699;font-weight:bold;">statistics</code> <code style="color:#006699;font-weight:bold;">
time</code> <code style="color:#006699;font-weight:bold;">on</code><code style="color:#000000;">;</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">038.</code><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">039.</code><span><code style="color:#006699;ck;"font-weight:bold;">select</code>
<code style="color:#000000;">@val =&nbsp; </code><code style="color:#ff1493;">case</code>
<code style="color:#006699;font-weight:bold;">when</code> <code style="color:#000000;">
( a &gt;= b ) </code><code style="color:#808080;">and</code> <code style="color:#000000;">
( a &gt;= c ) </code><code style="color:#808080;">and</code> <code style="color:#000000;">
( a &gt;= d ) </code><code style="color:#808080;">and</code> <code style="color:#000000;">
( a &gt;= e )</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">040.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">then</code>
<code style="color:#000000;">a</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">041.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">when</code>
<code style="color:#000000;">( b &gt;= a ) </code><code style="color:#808080;">and</code>
<code style="color:#000000;">( b &gt;= c ) </code><code style="color:#808080;">and</code>
<code style="color:#000000;">( b &gt;= d ) </code><code style="color:#808080;">and</code>
<code style="color:#000000;">( b &gt;= e )</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">042.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">then</code>
<code style="color:#000000;">b</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">043.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">when</code>
<code style="color:#000000;">( c &gt;= a ) </code><code style="color:#808080;">and</code>
<code style="color:#000000;">( c &gt;= b ) </code><code style="color:#808080;">and</code>
<code style="color:#000000;">( c &gt;= d ) </code><code style="color:#808080;">and</code>
<code style="color:#000000;">( c &gt;= e )</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">044.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">then</code>
<code style="color:#000000;">c</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">045.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">when</code>
<code style="color:#000000;">( d &gt;= a ) </code><code style="color:#808080;">and</code>
<code style="color:#000000;">( d &gt;= b ) </code><code style="color:#808080;">and</code>
<code style="color:#000000;">( d &gt;= c ) </code><code style="color:#808080;">and</code>
<code style="color:#000000;">( d &gt;= e )</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">046.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">then</code>
<code style="color:#000000;">d</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">047.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">else</code>
<code style="color:#000000;">e</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">048.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">end</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">049.</code><span><code>&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">from</code>
<code style="color:#000000;">dbo.test_table;</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">050.</code><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">051.</code><span><code style="color:#006699;font-weight:bold;">set</code>
<code style="color:#006699;font-weight:bold;">statistics</code> <code style="color:#006699;font-weight:bold;">
time</code> <code style="color:#006699;font-weight:bold;">off</code><code style="color:#000000;">;</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">052.</code><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">053.</code><span><code style="color:#000000;">print
</code><code style="color:blue;">&#39;2. Подзапрос и оператор UNION (любая версия)&#39;</code><code style="color:#000000;">;</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">054.</code><span><code style="color:#006699;font-weight:bold;">set</code>
<code style="color:#006699;font-weight:bold;">statistics</code> <code style="color:#006699;font-weight:bold;">
time</code> <code style="color:#006699;font-weight:bold;">on</code><code style="color:#000000;">;</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">055.</code><span>&nbsp;</span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">056.</code><span><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#000000;">@val = ( </code><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#006699;font-weight:bold;">max</code><code style="color:#000000;">(i)
</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">057.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">from</code>
<code style="color:#000000;">( </code><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#000000;">a </code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">058.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">union</code>
<code style="color:#808080;">all</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">059.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#000000;">b </code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">060.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">union</code>
<code style="color:#808080;">all</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">061.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#000000;">c</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">062.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">union</code>
<code style="color:#808080;">all</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">063.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#000000;">d</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">064.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">union</code>
<code style="color:#808080;">all</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">065.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#000000;">e</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">066.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">)
 t(i)</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">067.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">)</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">068.</code><span><code>&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">from</code>
<code style="color:#000000;">dbo.test_table;</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">069.</code><span>&nbsp;</span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">070.</code><span><code style="color:#006699;font-weight:bold;">set</code>
<code style="color:#006699;font-weight:bold;">statistics</code> <code style="color:#006699;font-weight:bold;">
time</code> <code style="color:#006699;font-weight:bold;">off</code><code style="color:#000000;">;</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">071.</code><span>&nbsp;</span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">072.</code><span><code style="color:#000000;">print
</code><code style="color:blue;">&#39;3. Подзапрос и предложение VALUES (SQL Server 2008 и выше)&#39;</code><code style="color:#000000;">;</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">073.</code><span><code style="color:#006699;font-weight:bold;">set</code>
<code style="color:#006699;font-weight:bold;">statistics</code> <code style="color:#006699;font-weight:bold;">
time</code> <code style="color:#006699;font-weight:bold;">on</code><code style="color:#000000;">;</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">074.</code><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">075.</code><span><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#000000;">@val = ( </code><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#006699;font-weight:bold;">max</code><code style="color:#000000;">(i)
</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">076.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">from</code>
<code style="color:#000000;">( </code><code style="color:#006699;font-weight:bold;">values</code>
<code style="color:#000000;">(a)</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">077.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">,(b)</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">078.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">,(c)</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">079.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">,(d)</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">080.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">,(e)
</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">081.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">)
 t(i)</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">082.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">)</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">083.</code><span><code>&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">from</code>
<code style="color:#000000;">dbo.test_table;</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">084.</code><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">085.</code><span><code style="color:#006699;font-weight:bold;">set</code>
<code style="color:#006699;font-weight:bold;">statistics</code> <code style="color:#006699;font-weight:bold;">
time</code> <code style="color:#006699;font-weight:bold;">off</code><code style="color:#000000;">;</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">086.</code><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">087.</code><span><code style="color:#000000;">print
</code><code style="color:blue;">&#39;4. Оператор UNPIVOT (SQL Server 2005 и выше)&#39;</code><code style="color:#000000;">;</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">088.</code><span><code style="color:#006699;font-weight:bold;">set</code>
<code style="color:#006699;font-weight:bold;">statistics</code> <code style="color:#006699;font-weight:bold;">
time</code> <code style="color:#006699;font-weight:bold;">on</code><code style="color:#000000;">;</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">089.</code><span>&nbsp;</span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">090.</code><span><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#000000;">@val = </code><code style="color:#006699;font-weight:bold;">max</code><code style="color:#000000;">(val)</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">091.</code><span><code>&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">from</code>
<code style="color:#000000;">( </code><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#000000;">* </code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">092.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">from</code>
<code style="color:#000000;">dbo.test_table t</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">093.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">unpivot
 ( val </code><code style="color:#006699;font-weight:bold;">for</code> <code style="color:#000000;">
col </code><code style="color:#808080;">in</code> <code style="color:#000000;">( [a],[b],[c],[d],[e]) ) up</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">094.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">095.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">) t</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">096.</code><span><code>&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">group</code>
<code style="color:#006699;font-weight:bold;">by</code> <code style="color:#000000;">
id;</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">097.</code><span>&nbsp;</span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">098.</code><span><code style="color:#006699;font-weight:bold;">set</code>
<code style="color:#006699;font-weight:bold;">statistics</code> <code style="color:#006699;font-weight:bold;">
time</code> <code style="color:#006699;font-weight:bold;">off</code><code style="color:#000000;">;</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">099.</code><span>&nbsp;</span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">100.</code><span><code style="color:#000000;">print
</code><code style="color:blue;">&#39;5. Оператор UNPIVOT и ранжирующие функции (SQL Server 2005 и выше)&#39;</code><code style="color:#000000;">;</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">101.</code><span><code style="color:#006699;font-weight:bold;">set</code>
<code style="color:#006699;font-weight:bold;">statistics</code> <code style="color:#006699;font-weight:bold;">
time</code> <code style="color:#006699;font-weight:bold;">on</code><code style="color:#000000;">;</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">102.</code><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">103.</code><span><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#006699;font-weight:bold;">top</code> <code style="color:#000000;">
1 </code><code style="color:#006699;font-weight:bold;">with</code> <code style="color:#000000;">
ties @val = val </code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">104.</code><span><code>&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">from</code>
<code style="color:#000000;">dbo.test_table t</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">105.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">unpivot ( val
</code><code style="color:#006699;font-weight:bold;">for</code> <code style="color:#000000;">
col </code><code style="color:#808080;">in</code> <code style="color:#000000;">( [a],[b],[c],[d],[e]) ) up</code></span></span></div>
<div style="backght:bold;">top</code> <code style="color:#000000;">
1 </code><code style="color:#006699;font-weight:bold;">with</code> <code style="color:#000000;">
ties @val = val </code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">104.</code><span><code>&nbsp;&nbsround-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">106.</code><span><code>&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">order</code>
<code style="color:#006699;font-weight:bold;">by</code> <code style="color:#000000;">
row_number() over ( partition </code><code style="color:#006699;font-weight:bold;">by</code>
<code style="color:#000000;">id </code><code style="color:#006699;font-weight:bold;">order</code>
<code style="color:#006699;font-weight:bold;">by</code> <code style="color:#000000;">
val </code><code style="color:#006699;font-weight:bold;">desc</code> <code style="color:#000000;">
);</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">107.</code><span>&nbsp;</span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">108.</code><span><code style="color:#006699;font-weight:bold;">set</code>
<code style="color:#006699;font-weight:bold;">statistics</code> <code style="color:#006699;font-weight:bold;">
time</code> <code style="color:#006699;font-weight:bold;">off</code><code style="color:#000000;">;</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">109.</code><span>&nbsp;</span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">110.</code><span><code style="color:#000000;">print
</code><code style="color:blue;">&#39;6. Оператор CROSS APPLY (SQL Server 2005 и выше)&#39;</code><code style="color:#000000;">;</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">111.</code><span>&nbsp;</span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">112.</code><span><code style="color:#000000;">print
</code><code style="color:blue;">&#39;CROSS APPLY 1&#39;</code><code style="color:#000000;">;</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">113.</code><span><code style="color:#006699;font-weight:bold;">set</code>
<code style="color:#006699;font-weight:bold;">statistics</code> <code style="color:#006699;font-weight:bold;">
time</code> <code style="color:#006699;font-weight:bold;">on</code><code style="color:#000000;">;</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">114.</code><span><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#000000;">@val = max_val </code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">115.</code><span><code>&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">from</code>
<code style="color:#000000;">dbo.test_table t</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">116.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#808080;">cross</code>
<code style="color:#000000;">apply ( </code><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#006699;font-weight:bold;">top</code> <code style="color:#000000;">
1 val </code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">117.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">from</code>
<code style="color:#000000;">( </code><code style="color:#006699;font-weight:bold;">values</code>
<code style="color:#000000;">(a),(b),(c),(d),(e) ) t (val)</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">118.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">order</code>
<code style="color:#006699;font-weight:bold;">by</code> <code style="color:#000000;">
val </code><code style="color:#006699;font-weight:bold;">desc</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">119.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">)
 ca (max_val);</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">120.</code><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">121.</code><span><code style="color:#000000;">print
</code><code style="color:blue;">&#39;CROSS APPLY 2&#39;</code><code style="color:#000000;">;</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">122.</code><span><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#000000;">@val = max_val</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">123.</code><span><code>&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">from</code>
<code style="color:#000000;">dbo.test_table t</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">124.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#808080;">cross</code>
<code style="color:#000000;">apply ( </code><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#000000;">row_number() over (</code><code style="co-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">122.</code><span><code style="color:#006699;font-weight:bolor:#006699;font-weight:bold;">order</code>
<code style="color:#006699;font-weight:bold;">by</code> <code style="color:#000000;">
val </code><code style="color:#006699;font-weight:bold;">desc</code><code style="color:#000000;">) i, val</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">125.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">from</code>
<code style="color:#000000;">( </code><code style="color:#006699;font-weight:bold;">values</code>
<code style="color:#000000;">(a),(b),(c),(d),(e) ) t (val)</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">126.</code><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">)
 ca (i, max_val)</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">127.</code><span><code>&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">where</code>
<code style="color:#000000;">ca.i = 1;</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">128.</code><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">129.</code><span><code style="color:#006699;font-weight:bold;">set</code>
<code style="color:#006699;font-weight:bold;">statistics</code> <code style="color:#006699;font-weight:bold;">
time</code> <code style="color:#006699;font-weight:bold;">off</code><code style="color:#000000;">;</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">130.</code><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">131.</code><span><code style="color:#000000;">print
</code><code style="color:blue;">&#39;7. Inline-функция и CTE (SQL Server 2005 и выше)&#39;</code><code style="color:#000000;">;</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">132.</code><span><code style="color:#006699;font-weight:bold;">set</code>
<code style="color:#006699;font-weight:bold;">statistics</code> <code style="color:#006699;font-weight:bold;">
time</code> <code style="color:#006699;font-weight:bold;">on</code><code style="color:#000000;">;</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">133.</code><span>&nbsp;</span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">134.</code><span><code style="color:#006699;font-weight:bold;">select</code>
<code style="color:#000000;">@val = max_val </code><code style="color:#006699;font-weight:bold;">from</code>
<code style="color:#000000;">dbo.test_table t&nbsp; </code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">135.</code><span><code>&nbsp;&nbsp;</code><span><code style="color:#808080;">cross</code>
<code style="color:#000000;">apply dbo.f_get_max ( a, b, c, d, e );</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">136.</code><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">137.</code><span><code style="color:#006699;font-weight:bold;">set</code>
<code style="color:#006699;font-weight:bold;">statistics</code> <code style="color:#006699;font-weight:bold;">
time</code> <code style="color:#006699;font-weight:bold;">off</code><code style="color:#000000;">;</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">138.</code><span><code style="color:#000000;">go</code></span></div>
</div>
<br />
Результат ниже: <br />
<div class="reCodeBlock" style="border:1px solid #7f9db9;overflow-y:auto;">
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">01.</code><span><code style="color:#000000;">1. Выражение
</code><code style="color:#ff1493;">CASE</code> <code style="color:#000000;">(любая версия)</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">02.</code><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">03.</code><span><code style="color:#000000;">SQL Server Execution Times:</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">04.</code><span><code>&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">CPU
</code><code style="color:#006699;font-weight:bold;">time</code> <code style="color:#000000;">
= 3416 ms,&nbsp; elapsed </code><code style="color:#006699;font-weight:bold;">time</code>
<code style="color:#000000;">= 3416 ms.</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">05.</code><span><code style="color:#008200;">----------------------------------------------------------------------</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">06.</code><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">07.</code><span><code style="color:#000000;">2. Подзапрос и оператор
</code><code style="color:#006699;font-weight:bold;">UNION</code> <code style="color:#000000;">
(любая версия)</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">08.</code><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">09.</code><span><code style="color:#000000;">SQL Server Execution Times:</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">10.</code><span><code>&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">CPU
</code><code style="color:#006699;font-weight:bold;">time</code> <code style="color:#000000;">
= 12777 ms,&nbsp; elapsed </code><code style="color:#006699;font-weight:bold;">time</code>
<code style="color:#000000;">= 3848 ms.</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">11.</code><span><code style="color:#008200;">----------------------------------------------------------------------</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">12.</code><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">13.</code><span><code style="color:#000000;">3. Подзапрос и предложение
</code><code style="color:#006699;font-weight:bold;">VALUES</code> <code style="color:#000000;">
(SQL Server 2008 и выше)</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">14.</code><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">15.</code><span><code style="color:#000000;">SQL Server Execution Times:</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">16.</code><span><code>&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">CPU
</code><code style="color:#006699;font-weight:bold;">time</code> <code style="color:#000000;">
= 13182 ms,&nbsp; elapsed </code><code style="color:#006699;font-weightstyle="color:#000000;">3. Подзапрос и предложение
</code><code style="color:#006699;font-weight:bold;">VALUES</code> <code style="color:#000000;">
(SQL Server 2008 и выше)</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">14.</code><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">15.</code><span><code style="color:#000000:bold;">time</code>
<code style="color:#000000;">= 3968 ms.</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">17.</code><span><code style="color:#008200;">----------------------------------------------------------------------</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">18.</code><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">19.</code><span><code style="color:#000000;">4. Оператор UNPIVOT (SQL Server 2005
 и выше)</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">20.</code><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">21.</code><span><code style="color:#000000;">SQL Server Execution Times:</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">22.</code><span><code>&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">CPU
</code><code style="color:#006699;font-weight:bold;">time</code> <code style="color:#000000;">
= 22246 ms,&nbsp; elapsed </code><code style="color:#006699;font-weight:bold;">time</code>
<code style="color:#000000;">= 15966 ms.</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">23.</code><span><code style="color:#008200;">----------------------------------------------------------------------</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">24.</code><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">25.</code><span><code style="color:#000000;">5. Оператор UNPIVOT и ранжирующие функции
 (SQL Server 2005 и выше)</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">26.</code><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">27.</code><span><code style="color:#000000;">SQL Server Execution Times:</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">28.</code><span><code>&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">CPU
</code><code style="color:#006699;font-weight:bold;">time</code> <code style="color:#000000;">
= 153957 ms,&nbsp; elapsed </code><code style="color:#006699;font-weight:bold;">time</code>
<code style="color:#000000;">= 239071 ms.</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">29.</code><span><code style="color:#008200;">----------------------------------------------------------------------</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">30.</code><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">31.</code><span><code style="color:#000000;">6. Оператор
</code><code style="color:#808080;">CROSS</code> <code style="color:#000000;">APPLY (SQL Server 2005 и выше)</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">32.</code><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">33.</code><span><code style="color:#808080;">CROSS</code>
<code style="color:#000000;">APPLY 1</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">34.</code><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">35.</code><span><code style="color:#000000;">SQL Server Execution Times:</code></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">36.</code><span><code>&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">CPU
</code><code style="color:#006699;font-weight:bold;">time</code> <code style="color:#000000;">
= 22963 ms,&nbsp; elapsed </code><code style="color:#006699;font-weight:bold;">time</code>
<code style="color:#000000;">= 6273 ms.</code></span></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">37.</code><span>&nbsp;</span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">38.</code><span><code style="color:#808080;">CROSS</code>
<code style="color:#000000;">APPLY 2</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">39.</code><span>&nbsp;</span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">40.</code><span><code style="color:#000000;">SQL Server Execution Times:</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">41.</code><span><code>&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">CPU
</code><code style="color:#006699;font-weight:bold;">time</code> <code style="color:#000000;">
= 33244 ms,&nbsp; elapsed </code><code style="color:#006699;font-weight:bold;">time</codcolor:#5c5c5c;padding-right:0.3em;float:left;display:block;">38.</code><span><code style="color:#808080;">CROSS</code>
<code style="color:#000000;">APPLY 2</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;"e>
<code style="color:#000000;">= 9270 ms.</code></span></span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">42.</code><span><code style="color:#008200;">----------------------------------------------------------------------</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">43.</code><span>&nbsp;</span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">44.</code><span><code style="color:#000000;">7. Inline-функция и CTE (SQL Server
 2005 и выше)</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">45.</code><span>&nbsp;</span></div>
<div style="background-color:#f8f8f8;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">46.</code><span><code style="color:#000000;">SQL Server Execution Times:</code></span></div>
<div style="background-color:#ffffff;"><code style="width:3em;text-align:right;color:#5c5c5c;padding-right:0.3em;float:left;display:block;">47.</code><span><code>&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">CPU
</code><code style="color:#006699;font-weight:bold;">time</code> <code style="color:#000000;">
= 12246 ms,&nbsp; elapsed </code><code style="color:#006699;font-weight:bold;">time</code>
<code style="color:#000000;">= 3787 ms.</code></span></span></div>
</div>

</div>
    
    