---
layout: default
title: 'FIM2010 Troubleshooting&#58; Stopped extension dll load - EventID 6300 - TechNet Articles - United States (English) - TechNet Wiki'
weight: 3
---

<div class="post-content user-defined-markup">




<hr />
<div class="table-of-contents"><h2 class="title">Table of Contents</h2><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#Credits">Credits</a></li><li class="hierarchy-item"><a href="#Intro">Intro</a></li><li class="hierarchy-item"><a href="#Issue">Issue</a></li><l</div><div class="r3 fiji-r3"></div><div class="r4 fiji-r4"></div></div></div></div>
<div class="content-fragment page no-wrapper" id="fragment-6615">
<div class="content-fragment-inner fiji-content-fragment-inner"><i class="hierarchy-item"><a href="#Solution">Solution</a></li><li class="hierarchy-item"><a href="#Conclusion">Conclusion</a></li><li class="hierarchy-item"><a href="#See_Also">See Also</a></li></ul><div class="hierarchy-list-footer"> </div></div>
<p>&nbsp;</p>
<hr />
<h1><a name="Credits"></a>Credits</h1>
<p>Originally posted at: <a href="http://blog.is4u.be/2016/11/fim2010-troubleshooting-stopped.html">
FIM2010 Troubleshooting: Stopped extension dll load @ IS4U Blog</a> </p>
<p>&nbsp;</p>
<hr />
<h1><a name="Intro"></a>Intro</h1>
<p>When uploading a new extension to an existing deployment and trying to sync, the error &quot;Stopped-extension-dll-load&quot; was occurring. The deployment was already using rules extensions, so you would not expect any issues with .NET.</p>
<p>With some basic troubleshooting steps, checking the .NET build version of the extensions, restarting services, checking the event viewer you&#39;ll find the hint to the solution.</p>
<p>&nbsp;</p>
<hr />
<h1><a name="Issue"></a>Issue</h1>
The following info is logged in the event viewer.
<div class="reCodeBlock">
<div style="background-color:white;"><span><code style="color:black;">&lt;</code><code style="color:cornflowerblue;font-weight:bold;">Event</code>
<code style="color:gray;">xmlns</code><code style="color:black;">=</code><code style="color:blue;">&quot;<a href="http://schemas.microsoft.com/win/2004/08/events/event">http://schemas.microsoft.com/win/2004/08/events/event</a>&quot;</code><code style="color:black;">&gt;</code></span></div>
<div style="background-color:whitesmoke;"><span><code>&nbsp;&nbsp;</code><span><code style="color:black;">&lt;</code><code style="color:cornflowerblue;font-weight:bold;">System</code><code style="color:black;">&gt;</code></span></span></div>
<div style="background-color:white;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:black;">&lt;</code><code style="color:cornflowerblue;font-weight:bold;">Provider</code>
<code style="color:gray;">Name</code><code style="color:black;">=</code><code style="color:blue;">&quot;FIMSynchronizationService&quot;</code>
<code style="color:black;">/&gt;</code></span></span></div>
<div style="background-color:whitesmoke;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:black;">&lt;</code><code style="color:cornflowerblue;font-weight:bold;">EventID</code>
<code style="color:gray;">Qualifiers</code><code style="color:black;">=</code><code style="color:blue;">&quot;49152&quot;</code><code style="color:black;">&gt;6300&lt;/</code><code style="color:cornflowerblue;font-weight:bold;">EventID</code><code style="color:black;">&gt;</code></span></span></div>
<div style="background-color:white;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:black;">&lt;</code><code style="color:cornflowerblue;font-weight:bold;">Level</code><code style="color:black;">&gt;2&lt;/</code><code style="color:cornflowerblue;font-weight:bold;">Level</code><code style="color:black;">&gt;</code></span></span></div>
<div style="background-color:whitesmoke;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:black;">&lt;</code><code style="color:cornflowerblue;font-weight:bold;">Task</code><code style="color:black;">&gt;3&lt;/</code><code style="color:cornflowerblue;font-weight:bold;">Task</code><code style="color:black;">&gt;</code></span></span></div>
<div style="background-color:white;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:black;">&lt;</code><code style="color:cornflowerblue;font-weight:bold;">Keywords</code><code style="color:black;">&gt;0x80000000000000&lt;/</code><code style="color:cornflowerblue;font-weight:bold;">Keywords</code><code style="color:black;">&gt;</code></span></span></div>
<div style="background-color:whitesmoke;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:black;">&lt;</code><code style="color:cornflowerblue;font-weight:bold;">TimeCreated</code>
<code style="color:gray;">SystemTime</code><code style="color:black;">=</code><code style="color:blue;">&quot;2016-11-02T15:33:07.000000000Z&quot;</code>
<code style="color:black;">/&gt;</code></span></span></div>
<div style="background-color:white;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:black;">&lt;</code><code style="color:cornflowerblue;font-weight:bold;">EventRecordID</code><code style="color:black;">&gt;523064&lt;/</code><code style="color:cornflowerblue;font-weight:bold;">EventRecordID</code><code style="color:black;">&gt;</code></span></span></div>
<div style="background-color:whitesmoke;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:black;">&lt;</code><code style="color:cornflowerblue;font-weight:bold;">Channel</code><code style="color:black;">&gt;Application&lt;/</code><code style="color:cornflowerblue;font-weight:bold;">Channel</code><code style="color:black;">&gt;</code></span></span></div>
<div style="background-color:white;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:black;">&lt;</code><code style="color:cornflowerblue;font-weight:bold;">Computer</code><code style="color:black;">&gt;FIM&lt;/</code><code style="color:cornflowerblue;font-weight:bold;">Computer</code><code style="color:black;">&gt;</code></span></span></div>
<div style="background-color:whitesmoke;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:black;">&lt;</code><code style="color:cornflowerblue;font-weight:bold;">Security</code>
<code style="color:black;">/&gt;</code></span></span></div>
<div style="background-color:white;"><span><code>&nbsp;&nbsp;</code><span><code style="color:black;">&lt;/</code><code style="color:cornflowerblue;font-weight:bold;">System</code><code style="color:black;">&gt;</code></span></span></div>
<div style="background-color:whitesmoke;"><span><code>&nbsp;&nbsp;</code><span><code style="color:black;">&lt;</code><code style="color:cornflowerblue;font-weight:bold;">EventData</code><code style="color:black;">&gt;</code></span></span></div>
<div style="background-color:white;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:black;">&lt;</code><code style="color:cornflowerblue;font-weight:bold;">Data</code><code style="color:black;">&gt;</code></span></span></div>
<div style="background-color:whitesmoke;"><span><code style="color:black;">Could not load file or assembly &#39;file:///C:\Program Files\Microsoft Forefront Identity Manager\2010\Synchronization Service\Extensions\MVRulesExtension.dll&#39;
 or one of its dependencies. </code></span></div>
<div style="background-color:white;"><span><code style="color:black;">Operation is not supported. (Exception from HRESULT: 0x80131515)
</code></span></div>
<div style="background-color:whitesmoke;"><span><code style="color:black;">at System.Reflection.RuntimeAssembly._nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, StackCrawlMark&amp;
 stackMark, IntPtr pPrivHostBinder, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks)
</code></span></div>
<div style="background-color:white;"><span><code style="color:black;">at System.Reflection.RuntimeAssembly.InternalLoadAssemblyName(AssemblyName assemblyRef, Evidence assemblySecurity, RuntimeAssembly reqAssembly, StackCrawlMark&amp;
 stackMark, IntPtr pPrivHostBinder, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppres2010\Synchronization Service\Extensions\MVRulesExtension.dll&#39;
 or one of its dependencies. </code></span></div>
<div style="background-color:white;"><span><code style="color:black;">Operation is not supported. (Exception from HRESULT: 0x80131515)
</code></span></div>
<div style="background-color:whitesmoke;"><span><code style="color:black;">at System.Reflection.RuntimeAssembly._nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, StacsSecurityChecks)
</code></span></div>
<div style="background-color:whitesmoke;"><span><code style="color:black;">at System.Reflection.RuntimeAssembly.InternalLoadAssemblyName(AssemblyName assemblyRef, Evidence assemblySecurity, RuntimeAssembly reqAssembly, StackCrawlMark&amp;
 stackMark, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks)
</code></span></div>
<div style="background-color:white;"><span><code style="color:black;">at System.Reflection.RuntimeAssembly.InternalLoadFrom(String assemblyFile, Evidence securityEvidence, Byte[] hashValue, AssemblyHashAlgorithm hashAlgorithm,
 Boolean forIntrospection, Boolean suppressSecurityChecks, StackCrawlMark&amp; stackMark) at System.Reflection.Assembly.LoadFrom(String assemblyFile)
</code></span></div>
<div style="background-color:whitesmoke;"><span><code style="color:black;">at Microsoft.MetadirectoryServices.Impl.ScriptHost.InitializeWorker(InitializeArguments pArgs) InnerException=&gt;
</code></span></div>
<div style="background-color:white;"><span><code style="color:black;">An attempt was made to load an assembly from a network location which would have caused the assembly to be sandboxed in previous versions of the .NET Framework.
</code></span></div>
<div style="background-color:whitesmoke;"><span><code style="color:black;">This release of the .NET Framework does not enable CAS policy by default, so this load may be dangerous.</code></span></div>
<div style="background-color:white;"><span><code style="color:black;">If this load is not intended to sandbox the assembly, please enable the loadFromRemoteSources switch.
</code></span></div>
<div style="background-color:whitesmoke;"><span><code style="color:black;">See
<a href="http://go.microsoft.com/fwlink/?LinkId=155569">http://go.microsoft.com/fwlink/?LinkId=155569</a> for more information.
</code></span></div>
<div style="background-color:white;"><span><code style="color:black;">InnerException=&gt; none</code></span></div>
<div style="background-color:whitesmoke;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:black;">&lt;/</code><code style="color:cornflowerblue;font-weight:bold;">Data</code><code style="color:black;">&gt;</code></span></span></div>
<div style="background-color:white;"><span><code>&nbsp;&nbsp;</code><span><code style="color:black;">&lt;/</code><code style="color:cornflowerblue;font-weight:bold;">EventData</code><code style="color:black;">&gt;</code></span></span></div>
<div style="background-color:whitesmoke;"><span><code style="color:black;">&lt;/</code><code style="color:cornflowerblue;font-weight:bold;">Event</code><code style="color:black;">&gt;</code></span></div>
</div>
<hr />
<h1><a name="Solution"></a>Solution</h1>
<p>After checking the <a href="http://go.microsoft.com/fwlink/?LinkId=155569">provided link</a> and googling more info using the inner exception quoted below, it was pretty clear how to solve it.</p>
<blockquote>An attempt was made to load an assembly from a network location which would have caused the assembly to be sandboxed in previous versions of the .NET Framework. This release of the .NET Framework does not enable CAS policy by default, so this load
 may be dangerous. If this load is not intended to sandbox the assembly, please enable the loadFromRemoteSources switch.</blockquote>
<p>The error went away after adding the <code>loadFromRemoteSources</code> switch to the runtime part of the FIM configuration file miiserver.exe.config, located in the &quot;Microsoft Forefront Identity Manager\2010\Synchronization Service\Bin&quot; folder.</p>
<div class="reCodeBlock">
<div style="background-color:white;"><span><code style="color:black;">&lt;</code><code style="color:cornflowerblue;font-weight:bold;">configuration</code><code style="color:black;">&gt;</code></span></div>
<div style="background-color:whitesmoke;"><span><code>&nbsp;&nbsp;</code><span><code style="color:black;">[...]</code></span></span></div>
<div style="background-color:white;"><span><code>&nbsp;&nbsp;</code><span><code style="color:black;">&lt;</code><code style="color:cornflowerblue;font-weight:bold;">runtime</code><code style="color:black;">&gt;</code></span></span></div>
<div style="background-color:whitesmoke;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:black;">[...]</code></span></span></div>
<div style="background-color:white;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:black;">&lt;</code><code style="color:cornflowerblue;font-weight:bold;">loadFromRemoteSources</code>
<code style="color:gray;">enabled</code><code style="color:black;">=</code><code style="color:blue;">&quot;true&quot;</code><code style="color:black;">/&gt;</code></span></span></div>
<div style="background-color:whitesmoke;"><span><code>&nbsp;&nbsp;</code><span><code style="color:black;">&lt;/</code><code style="color:cornflowerblue;font-weight:bold;">runtime</code><code style="color:black;">&gt;</code></span></span></div>
<div style="background-color:white;"><span><code style="color:black;">&lt;/</code><code style="color:cornflowerblue;font-weight:bold;">configuration</code><code style="color:black;">&gt;</code></span></div>
</div>
&nbsp;
<hr />
<h1><a name="Conclusion"></a>Conclusion</h1>
<p>It&#39;s still a mystery why this issue would arise after adding a new DLL to a deployment that was already using extensions for a year without problems.</p>
<p>&nbsp;Hopefully, this article will be helpful for someone having the same stacktrace for his stopped-extension-dll-load error.</p>
<p>&nbsp;</p>
<hr />
<h1><a name="See_Also"></a>See Also</h1>
<p><a href="https://social.technet.microsoft.com/wiki/contents/articles/8759.fim-troubleshooting-stopped-dll-exception-troubleshooter-document.aspx">FIM Troubleshooting: stopped-dll-exception troubleshooter document</a></p>
<hr />

</div>
    
    
