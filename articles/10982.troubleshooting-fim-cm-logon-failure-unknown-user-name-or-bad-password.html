---
layout: default
title: Troubleshooting FIM CM&#58; "Logon failure&#58; unknown user name or bad password" - TechNet Articles - United States (English) - TechNet Wiki
weight: 3
---

<div class="post-content user-defined-markup">

<div class="table-of-contents"><h2 class="title">Table of Contents</h2><div class="hierarchy-lis</ul>
<div class="navigation-list-footer"></div></div>
<div class="content-fragment-footer"></div>
<div class="content-fragment-bottom fiji-content-fragment-bottom"><div class="r1 fiji-r1"></div><div class="r2 fiji-r2"></div><div class="r3 fiji-r3"></div><div class="r4 fiji-r4"></div></div></div></div>
<div class="content-fragment page no-wrapper" id="fragment-6615">
<div class="content-fragment-inner fiji-content-fragment-inner"><div class="content-fragment-top fiji-content-fragment-top"><div class="r1 fiji-r1"></div><div class="r2 fiji-r2"></div><dit-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#OVERVIEW_PURPOSE">OVERVIEW / PURPOSE</a></li><li class="hierarchy-item"><a href="#PROBLEM_STATEMENT">PROBLEM STATEMENT</a><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#ERROR_MESSAGE">ERROR MESSAGE</a></li></ul><div class="hierarchy-list-footer"> </div></li><li class="hierarchy-item"><a href="#CONFIGURATION_WIZARD_LOG_FILE">CONFIGURATION WIZARD LOG FILE</a></li><li class="hierarchy-item"><a href="#RESOLUTION_WORK_AROUND">RESOLUTION / WORK AROUND</a></li><li class="hierarchy-item"><a href="#ADDITIONAL_INFORMATION">ADDITIONAL INFORMATION</a></li><li class="hierarchy-item"><a href="#SEE_ALSO">SEE ALSO</a></li></ul><div class="hierarchy-list-footer"> </div></div><br />
&nbsp;<br />
<table>
<tbody>
<tr>
<td style="background-color:#0f243e;">
<h2><a name="OVERVIEW_PURPOSE"></a><strong><span style="color:#ffff00;">OVERVIEW / PURPOSE</span></strong></h2>
</td>
</tr>
<tr>
<td>Recently worked my way through a FIM Certificate Management configuration issue where the Configuration Wizard was failing with a Logon failure.&nbsp;</td>
</tr>
<tr>
<td style="background-color:#0f243e;">
<h2><a name="PROBLEM_STATEMENT"></a><strong><span style="color:#ffff00;">PROBLEM STATEMENT</span></strong></h2>
</td>
</tr>
<tr>
<td>You have just installed Forefront Identity Manager 2010 Certificate Management, and now going through the Configuration Wizard.&nbsp; In doing so, you receive an error message<br />
<h3><a name="ERROR_MESSAGE"></a><strong><span style="text-decoration:underline;">ERROR MESSAGE</span></strong></h3>
Logon failed for the user <a href="mailto:clmKRAgent@clmsamp.samples">clmKRAgent@clmsamp.samples</a>.&nbsp; Please check username and password.<br />
&gt; Logon failure: unknown user name or bad password.&nbsp;<br />
(Exception from HRESULT: 0x8007052E)<br />
<br />
You investigate the Configuration Wizard Log File (<span style="font-size:13px;color:#000000;">(%programfiles%\Microsoft Forefront Identity Management\2010\Certificate Management\config.log), and find the following information.</span><br />
</td>
</tr>
<tr>
<td style="background-color:#0f243e;">
<h2><a name="CONFIGURATION_WIZARD_LOG_FILE"></a><strong><span style="color:#ffff00;">CONFIGURATION WIZARD LOG FILE</span></strong></h2>
<span style="font-size:11px;color:#ffff00;">(%programfiles%\Microsoft Forefront Identity Management\2010\Certificate Management\config.log)&nbsp;</span></td>
</tr>
<tr>
<td>
<p>&quot;2012-05-15 16:08:01.27 -05&quot; &quot;Microsoft.Clm.Config.Core.CertificateAuthority&quot; &quot;System.Object IssueCertificateForUser(System.String, System.String, System.String, System.String, Microsoft.Clm.CertificateServices.Interop.CertificateFormatFlags, AgentType)&quot;
 &quot;&quot; &quot;CLMSAMP\da.clmsamp.samples&quot; 0x00000E04 0x00000001</p>
<p>General Information <br />
*********************************************<br />
Additional Info:<br />
Logon failure: unknown user name or bad password for the user: <a href="mailto:clmKRAgent@clmsamp.samples">
clmKRAgent@clmsamp.samples</a></p>
<p>1) Exception Information<br />
*********************************************<br />
Exception Type: System.Runtime.InteropServices.COMException<br />
ErrorCode: -2147023570<br />
Message: Logon failure: unknown user name or bad password. (Exception from HRESULT: 0x8007052E)<br />
Data: System.Collections.ListDictionaryInternal<br />
TargetSite: Void ThrowExceptionForHRInternal(Int32, IntPtr)<br />
HelpLink: NULL<br />
Source: mscorlib</p>
<p>StackTrace Information<br />
*********************************************<br />
&nbsp;&nbsp; at System.Runtime.InteropServices.Marshal.ThrowExceptionForHRInternal(Int32 errorCode, IntPtr errorInfo)<br />
&nbsp;&nbsp; at Microsoft.Clm.Security.Principal.LoggedOnUser.Logon(String userName, String password)<br />
&nbsp;&nbsp; at Microsoft.Clm.Security.Principal.LoggedOnUser..ctor(String userName, String password, LogonType logonType, LogonProvider logonProvider)<br />
&nbsp;&nbsp; at Microsoft.Clm.Security.Principal.LoggedOnUser..ctor(String userName, String password)<br />
&nbsp;&nbsp; at Microsoft.Clm.Config.Core.CertificateAuthority.IssueCertificateForUser(String caConfig, String templateName, String userName, String password, CertificateFormatFlags flag, AgentType agentType)<br />
&quot;2012-05-15 16:08:01.29 -05&quot; &quot;Microsoft.Clm.Config.Core.CertificateAuthority&quot; &quot;System.Object IssueCertificateForUser(System.String, System.String, System.String, System.String, Microsoft.Clm.CertificateServices.Interop.CertificateFormatFlags, AgentType)&quot; &quot;&quot;
 &quot;PROD\da.matt.chambers&quot; 0x00000E04 0x00000001</p>
<p>General Information <br />
*********************************************<br />
Additional Info:<br />
Failed to issue certificate for user: <a href="mailto:clmKRAgent@clmsamp.samples">
clmKRAgent@<span style="color:#0066dd;">clmsamp.samples</span></a></p>
<p>1) Exception Information<br />
*********************************************<br />
Exception Type: System.UnauthorizedAccessException<br />
Message: Logon failed for the user <a href="mailto:clmKRAgent@clmsamp.samples">clmKRAgent@<span style="color:#0066dd;">clmsamp.samples</span></a>. Please check username and password<br />
Data: System.Collections.ListDictionaryInternal<br />
TargetSite: System.Object IssueCertificateForUser(System.String, System.String, System.String, System.String, Microsoft.Clm.CertificateServices.Interop.CertificateFormatFlags, AgentType)<br />
HelpLink: NULL<br />
Source: Microsoft.Clm.Config</p>
<p>StackTrace Information<br />
*********************************************<br />
&nbsp;&nbsp; at Microsoft.Clm.Config.Core.Certific************************************<br />
Additional Info:<br />
Failed to issue certificate for user: <a href="mailto:clmKRAgent@clmsamp.samples">
clateAuthority.IssueCertificateForUser(String caConfig, String templateName, String userName, String password, CertificateFormatFlags flag, AgentType agentType)</p>
<p>2) Exception Information<br />
*********************************************<br />
Exception Type: System.Runtime.InteropServices.COMException<br />
ErrorCode: -2147023570<br />
Message: Logon failure: unknown user name or bad password. (Exception from HRESULT: 0x8007052E)<br />
Data: System.Collections.ListDictionaryInternal<br />
TargetSite: Void ThrowExceptionForHRInternal(Int32, IntPtr)<br />
HelpLink: NULL<br />
Source: mscorlib</p>
<p>StackTrace Information<br />
*********************************************<br />
&nbsp;&nbsp; at System.Runtime.InteropServices.Marshal.ThrowExceptionForHRInternal(Int32 errorCode, IntPtr errorInfo)<br />
&nbsp;&nbsp; at Microsoft.Clm.Security.Principal.LoggedOnUser.Logon(String userName, String password)<br />
&nbsp;&nbsp; at Microsoft.Clm.Security.Principal.LoggedOnUser..ctor(String userName, String password, LogonType logonType, LogonProvider logonProvider)<br />
&nbsp;&nbsp; at Microsoft.Clm.Security.Principal.LoggedOnUser..ctor(String userName, String password)<br />
&nbsp;&nbsp; at Microsoft.Clm.Config.Core.CertificateAuthority.IssueCertificateForUser(String caConfig, String templateName, String userName, String password, CertificateFormatFlags flag, AgentType agentType)<br />
&quot;2012-05-15 16:08:01.29 -05&quot; &quot;Microsoft.Clm.Config.Steps.Finish&quot; &quot;Void Finish_Activated(System.Object, System.EventArgs)&quot; &quot;&quot; &quot;CLMSAMP\da.clmsamp.samples&quot; 0x00000E04 0x00000001</p>
<p>1) Exception Information<br />
*********************************************<br />
Exception Type: System.UnauthorizedAccessException<br />
Message: Logon failed for the user <a href="mailto:clmKRAgent@clmsamp.samples">clmKRAgent@<span style="color:#0066dd;">clmsamp.samples</span></a>. Please check username and password<br />
Data: System.Collections.ListDictionaryInternal<br />
TargetSite: System.Object IssueCertificateForUser(System.String, System.String, System.String, System.String, Microsoft.Clm.CertificateServices.Interop.CertificateFormatFlags, AgentType)<br />
HelpLink: NULL<br />
Source: Microsoft.Clm.Config</p>
<p>StackTrace Information<br />
*********************************************<br />
&nbsp;&nbsp; at Microsoft.Clm.Config.Core.CertificateAuthority.IssueCertificateForUser(String caConfig, String templateName, String userName, String password, CertificateFormatFlags flag, AgentType agentType)<br />
&nbsp;&nbsp; at Microsoft.Clm.Config.Steps.Finish.CreateKeyRecoveryUser()<br />
&nbsp;&nbsp; at Microsoft.Clm.Config.Steps.Finish.Finish_Activated(Object sender, EventArgs e)</p>
<p>2) Exception Information<br />
*********************************************<br />
Exception Type: System.Runtime.InteropServices.COMException<br />
ErrorCode: -2147023570<br />
Message: Logon failure: unknown user name or bad password. (Exception from HRESULT: 0x8007052E)<br />
Data: System.Collections.ListDictionaryInternal<br />
TargetSite: Void ThrowExceptionForHRInternal(Int32, IntPtr)<br />
HelpLink: NULL<br />
Source: mscorlib</p>
<p>StackTrace Information<br />
*********************************************<br />
&nbsp;&nbsp; at System.Runtime.InteropServices.Marshal.ThrowExceptionForHRInternal(Int32 errorCode, IntPtr errorInfo)<br />
&nbsp;&nbsp; at Microsoft.Clm.Security.Principal.LoggedOnUser.Logon(String userName, String password)<br />
&nbsp;&nbsp; at Microsoft.Clm.Security.Principal.LoggedOnUser..ctor(String userName, String password, LogonType logonType, LogonProvider logonProvider)<br />
&nbsp;&nbsp; at Microsoft.Clm.Security.Principal.LoggedOnUser..ctor(String userName, String password)<br />
&nbsp;&nbsp; at Microsoft.Clm.Config.Core.CertificateAuthority.IssueCertificateForUser(String caConfig, String templateName, String userName, String password, CertificateFormatFlags flag, AgentType agentType)</p>
</td>
</tr>
<tr>
<td style="background-color:#0f243e;">
<h2><a name="RESOLUTION_WORK_AROUND"></a><strong><span style="color:#ffff00;">RESOLUTION / WORK AROUND</span></strong></h2>
</td>
</tr>
<tr>
<td>
<blockquote dir="ltr" style="margin-right:0px;">
<p>The best way around this error is to create the accounts necessary for Certificate Lifecycle Manager 2007 or FIM Certificate Management prior to running the Configuration Wizard.&nbsp; During the Configuration Wizard on the Accounts page:</p>
<ol>
<li>Uncheck the box to use the defaults </li><li>Click the button to for Custom Accounts </li><li>On each tab, in the lower left, check &quot;Use existing account&quot; </li><li>In the textbox for the username enter &lt;domain&gt;\&lt; the name of the agent account&nbsp;that you used for the agent account specified&nbsp;on the current tab &gt; (e.g. CLMSAMP\clmAgent)
</li><li>Repeat Steps 3 and 4 for each tab </li><li>Click Ok when finished </li><li>Finish the Wizard </li></ol>
<p>&nbsp;</p>
</blockquote>
</td>
</tr>
<tr>
<td style="background-color:#0f243e;">
<h2><a name="ADDITIONAL_INFORMATION"></a><strong><span style="color:#ffff00;">ADDITIONAL INFORMATION</span></strong></h2>
</td>
</tr>
<tr>
<td>
<ul>
<li><a href="http://technet.microsoft.com/en-us/library/gg418612(v=ws.10)">Configuring Forefront Identity Manager 2010 Certificate Management</a>
</li></ul>
</td>
</tr>
<tr>
<td style="background-color:#0f243e;">
<h2><a name="SEE_ALSO"></a><strong><span style="color:#ffff00;">SEE ALSO</span></strong></h2>
</td>
</tr>
<tr>
<td>
<ul>
<ul>
<li><span style="color:#00749e;"><a href="http://social.technet.microsoft.com/wiki/contents/articles/forefront-identity-manager-resources.aspx"><span style="color:#00749e;">Current Forefront Identity Manager Resources</span></a></span>
</li><li><span style="color:#00749e;"><span style="color:#00749e;"><span style="color:#00749e;"><span style="color:#00749e;"><a href="http://social.technet.microsoft.com/wiki/contents/articles/current-certificate-lifecycle-manager-resources.aspx"></a></span><a href="http://social.technet.microsoft.com/wiki/contents/articles/current-certificate-lifecycle-manager-resources.aspx"><span style="color:#00749e;">Current
 Certificate Lifecycle Manager Resources</span></a></span><a href="http://social.technet.microsoft.com/wiki/contents/articles/current-certificate-lifecycle-manager-resources.aspx"></a></span><a href="http://social.technet.microsoft.com/wiki/contents/articles/current-certificate-lifecycle-manager-resources.aspx"></a></span><a href="http://social.technet.microsoft.com/wiki/contents/articles/current-certificate-lifecycle-manager-resources.aspx"></a>
</li><li><a href="http://social.technet.microsoft.com/wiki/contents/articles/1726.aspx"><span style="color:#00749e;">GalSync Resource Wiki</span></a>
</li><li><a href="http://social.technet.microsoft.com/wiki/contents/articles/2762.aspx"><span style="color:#00749e;">PCNS-Password Synchronization Resource Wiki</span></a>
</li><li><a href="http://social.technet.microsoft.com/wiki/contents/articles/9846.self-service-password-reset-sspr-resources.aspx"><span style="color:#00749e;">Self-Service Password Reset (SSPR) Resources</span></a>
</li></ul>
</ul>
</td>
</tr>
</tbody>
</table>
<br />

</div>
    
    