---
layout: default
title: Forefront UAG DirectAccess Troubleshooting&#58; One-time Password (OTP) Related Event Viewer Messages - TechNet Articles - United States (English) - TechNet Wiki
weight: 3
---

<div class="post-content user-defined-markup">

<p>The following OTP related events occur on activation of Forefront UAG, and are sent to the Windows Event Viewer. Solutions are provided for the Error and Warning messages where possible.<br />
<br />
</p>
<table>
<tbody>
<tr>
<th>Event ID</th>
<th>Messages</th>
</tr>
<tr>
<td>
<p><a href="http://social.technet.microsoft.com/wiki/contents/articles/forefront-uag-directaccess-troubleshooting-one-time-password-otp-related-event-viewer-messages/edit.aspx#20500">20500</a></p>
</td>
<td>
<p>UAG DirectAccess OTP certificate %1 cannot be enrolled because the CA server %2 is unreachable.</p>
</td>
</tr>
<tr>
<td>
<p><a href="http://social.technet.microsoft.com/wiki/contents/articles/forefront-uag-directaccess-troubleshooting-one-time-password-otp-related-event-viewer-messages/edit.aspx#20501">20501</a></p>
</td>
<td>
<p>UAG DirectAccess OTP certificate %1 cannot be enrolled because it is not supported by CA server %2. Check that the CA template exists in Active Directory, and verify that the CA server is configured to use the template.</p>
</td>
</tr>
<tr>
<td>
<p><a href="http://social.technet.microsoft.com/wiki/contents/articles/forefront-uag-directaccess-troubleshooting-one-time-password-otp-related-event-viewer-messages/edit.aspx#20502">20502</a></p>
</td>
<td>
<p>UAG DirectAccess OTP certificate %1 cannot be enrolled because the computer account of the UAG server does not have sufficient permissions on the certificate template. Configure the required permissions in Active Directory.</p>
</td>
</tr>
<tr>
<td>
<p><a href="http://social.technet.microsoft.com/wiki/contents/articles/forefront-uag-directaccess-troubleshooting-one-time-password-otp-related-event-viewer-messages/edit.aspx#20503">20503</a></p>
</td>
<td>
<p>UAG DirectAccess OTP certificate %1 cannot be installed because the CA %2 that issued the certificate is not trusted. Ensure that the CA certificate (or a parent CA certificate) is installed in the Trusted Root CA folder in the Local Computer certificate
 store of the UAG server.</p>
</td>
</tr>
<tr>
<td>
<p><a href="http://social.technet.microsoft.com/wiki/contents/articles/forefront-uag-directaccess-troubleshooting-one-time-password-otp-related-event-viewer-messages/edit.aspx#20504">20504</a></p>
</td>
<td>
<p>Enrollment of UAG DirectAccess OTP %1 certificate from the CA server %2 did not complete because the certificate request is pending CA manager approval</p>
</td>
</tr>
<tr>
<td>
<p><a href="http://social.technet.microsoft.com/wiki/contents/articles/forefront-uag-directaccess-troubleshooting-one-time-password-otp-related-event-viewer-messages/edit.aspx#20505">20505</a></p>
</td>
<td>
<p>UAG DirectAccess OTP certificate %1 cannot be installed because the certificate has not been issued as expected. Contact the CA administrator to ensure the certificate was issued and approved correctly.</p>
</td>
</tr>
<tr>
<td>
<p><a href="http://social.technet.microsoft.com/wiki/contents/articles/forefront-uag-directaccess-troubleshooting-one-time-password-otp-related-event-viewer-messages/edit.aspx#20506">20506</a></p>
</td>
<td>
<p>UAG DirectAccess OTP certificate %1 cannot be enrolled from CA server %2, and the following error occurred: %3. Ensure that the CA server is configured correctly, verify OTP settings in UAG, and then reactivate the configuration.</p>
</td>
</tr>
<tr>
<td>
<p><a href="http://social.technet.microsoft.com/wiki/contents/articles/forefront-uag-directaccess-troubleshooting-one-time-password-otp-related-event-viewer-messages/edit.aspx#20507">20507</a></p>
</td>
<td>
<p>UAG DirectAccess OTP certificates cannot be deleted from the UAG server, and the following error occurred: %1.</p>
</td>
</tr>
<tr>
<td>
<p><a href="http://social.technet.microsoft.com/wiki/contents/articles/forefront-uag-directaccess-troubleshooting-one-time-password-otp-related-event-viewer-messages/edit.aspx#20508">20508</a></p>
</td>
<td>
<p>One or more UAG DirectAccess OTP configuration settings is not valid: CA server(s): %1; CA to which the OTP CA servers chain: %2; Workstation template name: %3; User template name: %4. Verify OTP settings, and then reactivate the configuration.</p>
</td>
</tr>
<tr>
<td>
<p><a href="http://social.technet.microsoft.com/wiki/contents/articles/forefront-uag-directaccess-troubleshooting-one-time-password-otp-related-event-viewer-messages/edit.aspx#20510">20510</a></p>
</td>
<td>
<p>UAG DirectAccess OTP cannot be configured when UAG DirectAccess is deployed for remote management only.</p>
</td>
</tr>
<tr>
<td>
<p><a href="http://social.technet.microsoft.com/wiki/contents/articles/forefront-uag-directaccess-troubleshooting-one-time-password-otp-related-event-viewer-messages/edit.aspx#20511">20511</a></p>
</td>
<td>
<p>UAG DirectAccess OTP configuration settings cannot be saved to disk, and the following error occurred: %1. Ensure that disk space is available, and that the UAG application has write permissions for the %2 file.</p>
</td>
</tr>
<tr>
<td>
<p><a href="http://social.technet.microsoft.com/wiki/contents/articles/forefront-uag-directaccess-troubleshooting-one-time-password-otp-related-event-viewer-messages/edit.aspx#20512">20512</a></p>
</td>
<td>
<p>Activation failed because OTP certificate %1 cannot be enrolled from configured OTP CA servers. Check the event log for specific details.</p>
</td>
</tr>
</tbody>
</table>
<br />
<h2><a name="UAG_DirectAccess_OTP_certificate_1_cannot_be_enrolled_because_the_CA_server_2_is_unreachable"></a>
<hr style="width:100%;" />
<a name="20500"></a>20500 - UAG DirectAccess OTP certificate %1 cannot be enrolled because the CA server %2 is unreachable</h2>
<p class="section"><strong>Cause</strong>—The Forefront UAG server cannot reach one of the specified CAs to enroll the DirectAccess OTP Workstation certificate. This can be a result of the certification authority (CA) being unreachable from the Forefront UAG
 server, or the Active Directory Certificate Services (CertSvc) being in a stopped state on the CA server. This is a Warning level event.</p>
<p class="section"><strong>Solution</strong>—Verify the following and reactivate Forefront UAG:</p>
<div class="section">
<ol class="ordered">
<li>That the CA specified in the message is reachable from the Forefront UAG server.
</li><li>That the CertSvc service is started on the CA server. To start the <strong>CertSvc</strong> service, at an elevated command prompt, type
<strong>net start CertSvc</strong>. </li></ol>
</div>
<h2><a name="UAG_DirectAccess_OTP_certificate_1_></a>20500 - UAG DirectAccess OTP certificate %1 cannot be enrolled because the CA server %2 is unreachable</h2>
<p class="section"><strong>Cause</strong>—The Forefront UAG server cannot reach one of the specified CAs to enroll the DirectAccess OTP Workstation certificate. This can be a result of the certificaticannot_be_enrolled_because_it_is_not_supported_by_CA_server_2_Check_that_the_CA_template_exists_in_Active_Directory_and_verify_that_the_CA_server_is_configured_to_use_the_template"></a>
<hr style="width:100%;" />
<a name="20501"></a>
<p>20501 - UAG DirectAccess OTP certificate %1 cannot be enrolled because it is not supported by CA server %2. Check that the CA template exists in Active Directory, and verify that the CA server is configured to use the template.
</p>
</h2>
<p class="section"><strong>Cause</strong>—The DirectAccess OTP Workstation certificate is not supported by the specified CA. This is a Warning level event.</p>
<p class="section"><strong>Solution</strong>—Verify the following and reactivate Forefront UAG:</p>
<div class="section">
<ol class="ordered">
<li>That the DirectAccess OTP Workstation certificate template exists in Active Directory.
</li><li>That the DirectAccess OTP Workstation certificate template is enabled on the CA specified in the error message.
</li></ol>
</div>
<h2><a name="UAG_DirectAccess_OTP_certificate_1_cannot_be_enrolled_because_the_computer_account_of_the_UAG_server_does_not_have_sufficient_permissions_on_the_certificate_template_Configure_the_required_permissions_in_Active_Directory"></a>
<hr style="width:100%;" />
<a name="20502"></a>
<p>20502 - UAG DirectAccess OTP certificate %1 cannot be enrolled because the computer account of the UAG server does not have sufficient permissions on the certificate template. Configure the required permissions in Active Directory.
</p>
</h2>
<div class="section" id="sectionSection2">
<p><strong>Cause</strong>-The computer account of the Forefront UAG server does not have the correct permissions on the DirectAccess OTP Workstation certificate template to enroll the OTP Workstation certificate. This is a Warning level event.</p>
<p><strong>Solution</strong>—Ensure that the Forefront UAG server has <strong>Read</strong>,
<strong>Enroll</strong>, and <strong>Autoenroll</strong> permissions on the DirectAccess OTP Workstation certificate template, and then reactivate Forefront UAG.<br />
<br />
</p>
<h2><a name="UAG_DirectAccess_OTP_certificate_1_cannot_be_installed_because_the_CA_2_that_issued_the_certificate_is_not_trusted_Ensure_that_the_CA_certificate_or_a_parent_CA_certificate_is_installed_in_the_Trusted_Root_CA_folder_in_the_Local_Computer_certificate_store_of_the_UAG_server"></a>
<hr style="width:100%;" />
<a name="20503"></a>20503 - UAG DirectAccess OTP certificate %1 cannot be installed because the CA %2 that issued the certificate is not trusted. Ensure that the CA certificate (or a parent CA certificate) is installed in the Trusted Root CA folder in the Local
 Computer certificate store of the UAG server. </h2>
<p><strong>Cause</strong>—The specified CA that issues the DirectAccess OTP Workstation certificate must be trusted by the Forefront UAG server, so that it can be installed. This is a Warning level event.</p>
<p class="section"><strong>Solution</strong>—Ensure that a CA certificate from the CA issuing the OTP certificate (or one of its parent CAs) is installed in the Trusted Root Certification Authority folder in the Local computer certificate store on the Forefront
 UAG server:</p>
<div class="section">
<ol class="ordered">
<li>On the Forefront UAG server, open the MMC and add the <strong>Certificate Templates</strong> snap-in for the
<strong>Computer account</strong> on the <strong>Local computer</strong>. </li><li>Expand <strong>Certificates (Local computer)\Trusted Root Certification Authorities\Certificates</strong>, and ensure that the CA that issues the DirectAccess OTP Workstation certificate (or one of its parent CAs) is included in the list of the Trusted
 root CAs. </li><li>Reactivate Forefront UAG. </li></ol>
</div>
<h2><a name="Enrollment_of_UAG_DirectAccess_OTP_1_certificate_from_the_CA_server_2_did_not_complete_because_the_certificate_request_is_pending_CA_manager_approval"></a>
<hr style="width:100%;" />
<a name="20504"></a>
<p>20504 - Enrollment of UAG DirectAccess OTP %1 certificate from the CA server %2 did not complete because the certificate request is pending CA manager approval
</p>
</h2>
<p class="section"><strong>Cause</strong>—When <strong>CA certificate manager approval</strong> is enabled in the DirectAccess OTP Workstation certificate template properties, certificate requests are placed into a pending state, waiting for a certificate manager
 to issue the certificate request. This is a Warning level event.</p>
<p class="section"><strong>Solution</strong>—Clear CA certificate management approval:</p>
<div class="section">
<ol class="ordered">
<li>On the specified CA server, open the MMC and add the <strong>Certificate Templates</strong> snap-in.
</li><li>In the details pane, right-click the <strong>DirectAccess OTP Workstation Authentication</strong> template, and then click
<strong>Properties</strong>. </li><li>Click the <strong>Issuance Requirements</strong> tab, clear the <strong>CA certificate manager approval</strong> check box, and then click
<strong>OK</strong>. </li><li>Reactivate Forefront UAG. </li></ol>
</div>
<h2><a name="UAG_DirectAccess_OTP_certificate_1_cannot_be_installed_because_the_certificate_has_not_been_issued_as_expected_Contact_the_CA_administrator_to_ensure_the_certificate_was_issued_and_approved_correctly"></a>
<hr style="width:100%;" />
<a name="20505"></a>
<p>20505 - UAG DirectAccess OTP certificate %1 cannot be installed because the certificate has not been issued as expected. Contact the CA administrator to ensure the certificate was issued and approved correctly.</p>
</h2>
<div class="section" id="sectionSection5">
<p><strong>Cause</strong>—When the CA reports that the specified OTP certificate was not issued correctly. This is a Warning level event.</p>
<p><strong>Solution</strong>—Validate that the CA was correctly configured as described in the TechNet topic
<strong><a href="http://technet.microsoft.com/en-us/library/gg274319.aspx">Configuring two-factor authentication in SP1</a></strong>. If the CA is correctly configured, use associated events in the Windows Event Viewer to troubleshoot further.<br />
<br />
</p>
<h2><a name="UAG_DirectAccess_OTP_certificate_1_cannot_be_enrolled_from_CA_server_2_and_the_following_error_occurred_3_Ensure_that_the_CA_server_is_configured_correctly_verify_OTP_settings_in_UAG_and_then_reactivate_the_configuration"></a>
<hr style="width:100%;" />
<a name="20506"></a>20506 - UAG DirectAccess OTP certificate %1 cannot be enrolled from CA server %2, and the following error occurred: %3. Ensure that the CA server is configured correctly, verify OTP settings in UAG, and then reactivate the configuration.
</h2>
<p>&nbsp;<strong>Cause</strong>—A general CA related OTP error occurred while trying to enroll the DirectAccess OTP Workstation certificate.</p>
<div class="section" id="sectionSection6">
<p><strong>Solution</strong>— Use the CA error code specified in the message to investigate further.</p>
<p>For more information on error codes, see <a href="http://go.microsoft.com/fwlink/?LinkId=204483" target="_blank">
Common HRESULT values</a> (http://go.microsoft.com/fwlink/?LinkId=204483), and <a href="http://go.microsoft.com/fwlink/?LinkId=204484" target="_blank">
Winerror.h</a> (http://go.microsoft.com/fwlink/?LinkId=204484).<br />
<br />
</p>
<h2><a name="UAG_DirectAccess_OTP_certificates_cannot_be_deleted_from_the_UAG_server_and_the_following_error_occurred_1"></a>
<hr style="width:100%;" />
<a name="20507"></a>20507 - UAG DirectAccess OTP certificates cannot be deleted from the UAG server, and the following error occurred: %1.</h2>
<div class="section" id="sectionSection7">
<p><strong>Cause 1</strong>-When the Forefront UAG computer account does not have the correct permissions to the Local Computer certificate store of the Forefront UAG server when activating Forefront UAG.</p>
<p><strong>Solution 1</strong>— Ensure that the Forefront UAG computer account has the correct permissions to delete the DirectAccess OTP Workstation certificate. Certificates issued to a computer or service can only be managed by the computer account that
 has the appropriate permissions. When this has been completed, reactivate Forefront UAG.</p>
<p><strong>Cause 2</strong>—A general CA related OTP error occurred while trying to delete the DirectAccess OTP Workstation certificate.</p>
<p><strong>Solution 2</strong>— Use the CA error code specified in the message to investigate further.</p>
<p>For more information on error codes, see <a href="http://go.microsoft.com/fwlink/?LinkId=204483" target="_blank">
Common HRESULT values</a> (http://go.microsoft.com/fwlink/?LinkId=204483), and <a href="http://go.microsoft.com/fwlink/?LinkId=204484" target="_blank">
Winerror.h</a> (http://go.microsoft.com/fwlink/?LinkId=204484).<br />
<br />
</p>
<h2><a name="One_or_more_UAG_DirectAccess_OTP_configuration_settings_is_not_valid_CA_server_s_1_CA_to_which_the_OTP_CA_servers_chain_2_Workstation_template_name_3_User_template_name_4_Verify_OTP_settings_and_then_reactivate_the_configuration"></a>
<hr style="width:100%;" />
<a name="20508"></a>20508 - One or more UAG DirectAccess OTP configuration settings is not valid: CA server(s): %1; CA to which the OTP CA servers chain: %2; Workstation template name: %3; User template name: %4. Verify OTP settings, and then reactivate the
 configuration. </h2>
<p><strong>Cause</strong>—Some of the required OTP configuration settings are missing.
</p>
<div class="section" id="sectionSection8">
<p><strong>Solution</om/fwlink/?LinkId=204483" target="_blank">
Common HRESULT values</a> (http://go.microsoft.com/fwlink/?LinkId=204483), and <a href="http://go.microsoft.com/fwlink/?LinkId=204484" target="_blank">
Winerror.h</a> (http://go.microsoft.com/fwlink/?LinkId=204484).<br />
<br />
</p>
<h2><a name="One_or_more_UAG_DirectAccess_OTP_configurstrong>—In the Forefront UAG DirectAccess Configuration Wizard, reconfigure OTP Two-Factor Authentication, reapply the Forefront UAG DirectAccess policies and then reactivate Forefront UAG.<br />
<br />
</p>
<h2><a name="UAG_DirectAccess_OTP_cannot_be_configured_when_UAG_DirectAccess_is_deployed_for_remote_management_only"></a>
<hr style="width:100%;" />
<a name="20510"></a>20510 - UAG DirectAccess OTP cannot be configured when UAG DirectAccess is deployed for remote management only.
</h2>
<p>&nbsp;<strong>Cause</strong>—OTP <strong>Two-factor authentication</strong>, and <strong>
Allow DirectAccess clients to connect to internal networks, and enable remote managements of DirectAccess clients</strong> are configured, the Forefront UAG DirectAccess policies have been applied and a Forefront UAG activation is successful. You then change
 the deployment model to <strong>Enable remote management of DirectAccess clients only</strong> and leave OTP Two-factor authentication (it is disabled on the Forefront UAG DirectAccess Configuration Wizard), apply the Forefront UAG DirectAccess configuration
 and activate Forefront UAG.</p>
<div class="section" id="sectionSection9">
<p><strong>Solution</strong>—In the Forefront UAG DirectAccess Configuration Wizard, ensure that OTP Two-factor authentication is not configured together with
<strong>Enable remote management of DirectAccess clients only</strong>, apply the Forefront UAG DirectAccess configuration and reactivate Forefront UAG.<br />
<br />
</p>
<h2><a name="UAG_DirectAccess_OTP_configuration_settings_cannot_be_saved_to_disk_and_the_following_error_occurred_1_Ensure_that_disk_space_is_available_and_that_the_UAG_application_has_write_permissions_for_the_2_file"></a>
<hr style="width:100%;" />
<a name="20511"></a>20511 - UAG DirectAccess OTP configuration settings cannot be saved to disk, and the following error occurred: %1. Ensure that disk space is available, and that the UAG application has write permissions for the %2 file.
</h2>
<p>&nbsp;<strong>Cause</strong>—During a Forefront UAG activation, the OTP configuration settings are saved to the DaOtp.xml file on the Forefront UAG local disk. This event occurs when the file cannot be saved to disk.</p>
<p class="section"><strong>Solution</strong>—Verify the following and reactivate Forefront UAG.</p>
<div class="section">
<ol class="ordered">
<li>That the computer account activating Forefront UAG, has write permissions to the
<strong>&lt;Forefront UAG installation&gt;\von\conf</strong> folder. </li><li>That the DaOtp.xml file is not in use by another process. </li><li>That there is available disk space on the Forefront UAG server. </li></ol>
</div>
<h2><a name="Activation_failed_because_OTP_certificate_1_cannot_be_enrolled_from_configured_OTP_CA_servers_Check_the_event_log_for_specific_details"></a>
<hr style="width:100%;" />
<a name="20512"></a>
<p>20512 - Activation failed because OTP certificate %1 cannot be enrolled from configured OTP CA servers. Check the event log for specific details.
</p>
</h2>
<div class="section" id="sectionSection11">
<p><strong>Cause</strong>—This is a general error. During Forefront UAG activation the DirectAccess OTP Workstation certificate is enrolled from each specified OTP CA server. This message occurs if none of these enrollments succeeded.</p>
<p><strong>Solution</strong>—This event is accompanied by one of the warning messages above (20500-20511). By troubleshooting the related event, you can diagnose the reason for the enrollment failure.
</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>

</div>
    
    