---
layout: default
title: Changing The Lookup Reference When Loading Child Data Into Dynamics CRM 2011 With The Import Wizard - TechNet Articles - United States (English) - TechNet Wiki
weight: 3
---

<div class="post-content user-defined-markup">

Originally a blog article by Leon Tribe. Read the original here: <a href="http://leontribe.blogspot.com/2011/08/changing-lookup-reference-when.html">
http://leontribe.blogspot.com/2011/08/changing-lookup-reference-when.html</a>.&nbsp;
<p>This is a handy new feature for the import wizard where matching off the name of a parent is not sufficient to link records you are importing to other records in CRM, such as where the primary name of the parent record is not unique. We used to be able to
 do this with the old server-side migration manager in v4 but not in the v4 import wizard.</p>
<h3><a name="Step_1_Getting_a_Template_For_Our_Import"></a>Step 1: Getting a Template For Our Import</h3>
<p>A really nice feature of Dynamics CRM 2011 is the ability to generate templates for all the CRM entities straight from the client. To do this, click the drop-down arrow on the Import button in the ribbon for the entity you want to import records for.</p>
<p><a href="http://lh3.ggpht.com/-4yNUYFx45t8/TkaTiWMP6DI/AAAAAAAAAlo/lA9gZhfxW-s/s1600-h/image%25255B2%25255D.png"><img width="244" height="151" title="image" alt="image" src="http://lh4.ggpht.com/-wcDfVe0KIIk/TkaTjFF5r_I/AAAAAAAAAls/HWGQ_h9tLIY/image_thumb.png?imgmax=800" style="margin:0px;border:0px currentcolor;padding-top:0px;padding-right:0px;padding-left:0px;display:inline;" /></a><a></a></p>
<p>&nbsp;This generates an Excel-compatible XML file which has nice features like drop-downs for the pick list fields you need to fill in and tooltips to let you know the kind of information that needs to go into a field.</p>
<p><a href="http://lh6.ggpht.com/-DfkzQOn0p94/TkaTjrdN2DI/AAAAAAAAAlw/Vd9g2ho7wDE/s1600-h/image%25255B7%25255D.png"><img width="474" height="124" title="image" alt="image" src="http://lh5.ggpht.com/-Z00CfMQrHo0/TkaTkcIlarI/AAAAAAAAAl0/6578e1qUTSk/image_thumb%25255B3%25255D.png?imgmax=800" style="border:0px currentcolor;padding-top:0px;padding-right:0px;padding-left:0px;display:inline;" /></a></p>
<p>You will notice in the above image of the Contact import sheet that I have set the Parent Customer to ‘12345’. This is the Account Number for my parent customer, not their name, as would be traditionally used.</p>
<p><a href="http://lh5.ggpht.com/-uDu1AMi50ZU/TkaTkxK3XJI/AAAAAAAAAl4/Rct5qcrgRpc/s1600-h/image%25255B11%25255D.png"><img width="378" height="261" title="image" alt="image" src="http://lh4.ggpht.com/-21rqYzYYg8o/TkaTl57qrYI/AAAAAAAAAl8/z4CpPgfpZ2k/image_thumb%25255B5%25255D.png?imgmax=800" style="border:0px currentcolor;padding-top:0px;padding-right:0px;padding-left:0px;display:inline;" /></a></p>
<h3><a name="Setting_the_Lookup_in_the_Import_Wizard"></a>Setting the Lookup in the Import Wizard</h3>
<p>Importing the data into CRM is very easy with the Dynamics CRM 2011 Import Wizard but, by default, the wizard will try to link our Contact to an Account with the name, ‘12345’, not the Account Number ‘12345’.</p>
<p><a href="http://lh3.ggpht.com/-ZXqedvO5x4A/TkaTmXSrvLI/AAAAAAAAAmA/a2E0aRkphP0/s1600-h/image%25255B16%25255D.png"><img width="722" height="150" title="image" alt="image" src="http://lh6.ggpht.com/-ZxdkMOUxcOM/TkaTnBBbB7I/AAAAAAAAAmE/_oAGbCxB6TM/image_thumb%25255B8%25255D.png?imgmax=800" style="border:0px currentcolor;padding-top:0px;padding-right:0px;padding-left:0px;display:inline;" /></a></p>
<p>Therefore we have to adjust our mapping so it does not match on the Account Name but the Account Number. To do this we run the Import Wizard as usual by clicking the ‘Import Data’ button on the ribbon but when we get to the ‘Review Mapping Summary’ screen
 we click ‘Edit’.</p>
<p><a href="http://lh5.ggpht.com/-ll2P6oCCuOs/TkaTn_9_GBI/AAAAAAAAAmI/V45VFPzj5go/s1600-h/image%25255B21%25255D.png"><img width="475" height="485" title="image" alt="image" src="http://lh5.ggpht.com/-krAir7ZkWLA/TkaTo1FjcPI/AAAAAAAAAmM/XigOwKPf_VE/image_thumb%25255B11%25255D.png?imgmax=800" style="border:0px currentcolor;padding-top:0px;padding-right:0px;padding-left:0px;display:inline;" /></a></p>
<p>Skip setting the entity you are writing the records to and click ‘Next’. This will bring you to the mapping screen where we link the columns in our data source to fields in CRM. In our case we are interested in the ‘Parent Customer’ field.</p>
<p><a href="http://lh5.ggpht.com/-SMoNKRORz1M/TkaTpiFUefI/AAAAAAAAAmQ/b7Kt55rc0IE/s1600-h/image%25255B25%25255D.png"><img width="584" height="147" title="image" alt="image" src="http://lh5.ggpht.com/-KfLV93AaQrE/TkaTqbL1ChI/AAAAAAAAAmU/xTz1Oygr3ag/image_thumb%25255B13%25255D.png?imgmax=800" style="border:0px currentcolor;padding-top:0px;padding-right:0px;padding-left:0px;display:inline;" /></a></p>
<p>The magnifying glass means this is a lookup field and by clicking on the magnifying glass we can set the matching fields.</p>
<p><a href="http://lh3.ggpht.com/-JruUnjSDImM/TkaTq3rNfyI/AAAAAAAAAmY/GhVJDPvikRo/s1600-h/image%25255B30%25255D.png"><img width="479" height="305" title="image" alt="image" src="http://lh6.ggpht.com/-W3lwsDwZNQc/TkaTte9SyBI/AAAAAAAAAmc/P1nyy_XP11A/image_thumb%25255B16%25255D.png?imgmax=800" style="border:0px currentcolor;padding-top:0px;padding-right:0px;padding-left:0px;display:inline;" /></a></p>
<p>The Parent Customer field is an interesting one because it can point to either an Account or Contact. In our case we are only interested in modifying the Account referred field to be the Account Number. We modify it by clicking on the magnifying glass and
 setting Account fields to match on. In our case we might also untick the Contact as an option for the Parent Customer as we will only bringing in Contacts with a Parent Account.</p>
<p><a href="http://lh3.ggpht.com/-pOLnaGOyfEA/TkaTt89p0TI/AAAAAAAAAmg/NoFDaj1awt8/s1600-h/image%25255B34%25255D.png"><img width="370" height="126" title="image" alt="image" src="http://lh6.ggpht.com/-0pxf1cMK4RA/TkaTuutRHgI/AAAAAAAAAmk/WstGn6y0RuU/image_thumb%25255B18%25255D.png?imgmax=800" style="border:0px currentcolor;padding-top:0px;padding-right:0px;padding-left:0px;display:inline;" /></a></p>
<p>The good news is now when we import everything goes to plan.</p>
<p><a href="http://lh5.ggpht.com/-lz-fkNlJ61o/TkaTvUFFpSI/AAAAAAAAAmo/-0G350o-1-Y/s1600-h/image%25255B38%25255D.png"><img width="535" height="75" title="image" alt="image" src="http://lh6.ggpht.com/-IKHTqOdDQV4/TkaTv0IIweI/AAAAAAAAAms/I9GnSaok1As/image_thumb%25255B20%25255D.png?imgmax=800" style="border:0px currentcolor;padding-top:0px;padding-right:0px;padding-left:0px;display:inline;" /></a></p>
<p><a href="http://lh4.ggpht.com/-0SBoRJJ4Eso/TkaTwlo_C7I/AAAAAAAAAmw/b9947DHdO9M/s1600-h/image%25255B43%25255D.png"><img width="588" height="45" title="image" alt="image" src="http://lh4.ggpht.com/-divI0EoNyKM/TkaTxfckN9I/AAAAAAAAAm0/5Fum_h7YmlQ/image_thumb%25255B23%25255D.png?imgmax=800" style="border:0px currentcolor;padding-top:0px;padding-right:0px;padding-left:0px;display:inline;" /></a></p>
<p>Enjoy.</p>
<br />

</div>
    
    