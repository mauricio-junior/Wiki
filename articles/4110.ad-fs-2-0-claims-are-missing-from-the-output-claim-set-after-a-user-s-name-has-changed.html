---
layout: default
title: AD FS 2.0&#58; Claims Are Missing From The Output Claim Set After A Users Name Has Changed - TechNet Articles - United States (English) - TechNet Wiki
weight: 3
---

<div class="post-content user-defined-markup">

<div>
<h2 class="subHeading"><a name="Symptoms"></a>Symptoms<br />
</h2>
<div class="section">
<ul>
<li>A&nbsp;user has previously authenticated via AD FS 2.0 </li><li>The user&#39;s name has changed, such as samAccountName or UPN. </li><li>After the name change, the user does not receive the expected output set of claims from AD FS 2.0
</li></ul>
<br />
<br />
<br />
</div>
</div>
<div>
<h2 class="subHeading"><a name="Cause"></a>Cause<br />
</h2>
<div class="section">
<ul>
<li>The Local Security Authority (LSA) on the AD FS 2.0 server(s) holds a cache of user name to security identifier (SID) translation&nbsp;information. The&nbsp;entry for the old user name is present in the cache, which causes the change in output claim set from AD FS
 2.0 for this&nbsp;user.&nbsp; </li></ul>
<br />
<br />
</div>
</div>
<div>
<h2 class="subHeading"><a name="Resolution"></a>Resolution<br />
</h2>
<div class="section">
<ul>
<li>To clear the LSA user name to SID translation cache, either reboot the AD FS 2.0 server(s), or follow the guidance for the &nbsp;LsaLookupCacheMaxSize registry key per the following Knowledge Base article:
</li></ul>
<blockquote dir="ltr" style="margin-right:0px;">
<p>946358 The LsaLookupSids function may return the old user name instead of the new user name if the user name has changed on a domain controller<br />
<a href="http://support.microsoft.com/default.aspx?scid=kb;EN-US;946358">http://support.microsoft.com/default.aspx?scid=kb;EN-US;946358</a><br />
<br />
<br />
<br />
</p>
</blockquote>
</div>
</div>

</div>
    
    