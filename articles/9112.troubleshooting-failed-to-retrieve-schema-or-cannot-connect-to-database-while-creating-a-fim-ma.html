---
layout: default
title: 'TROUBLESHOOTING&#58; Failed to retrieve schema or cannot connect to database while creating a FIM MA - TechNet Articles - United States (English) - TechNet Wiki'
weight: 3
---

<div class="post-content user-defined-markup">

<div class="table-of-contents"><h2 class="title">Table of Contents</h2><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#PROBLEM_STATEMENT">PROBLEM STATEMENT</a></li><li class="hierarchy-item"><a href="#CAUSE">CAUSE</a></li><li class="hierarchy-item"><a href="#RESOLUTION">RESOLUTION</a></li><li class="hierarchy-item"><a href="#SEE_ALSO">SEE ALSO</a></li></ul><div class="hierarchy-list-footer"> </div></div>
<h2><a name="PROBLEM_STATEMENT"></a><span style="font-size:11pt;font-family:calibri,sans-serif;color:#1f497d;"><strong>PROBLEM STATEMENT</strong></span></h2>
<p><span style="font-size:11pt;font-family:calibri,sans-serif;color:#1f497d;">You recently installed FIM 2010 Update 2 (4.00.3606.2) with a SQL Server 2008 R2 backend.&nbsp; Everything seems good.&nbsp; You then attempt to create a FIM Service Management Agent.&nbsp; You
 receive an error message “Failed to retrieve schema” or “Cannot connect to Database”.</span></p>
<h2><a name="CAUSE"></a><span style="font-size:11pt;font-family:calibri,sans-serif;color:#1f497d;"><strong>CAUSE</strong></span></h2>
<p><span style="font-size:11pt;font-family:calibri,sans-serif;color:#1f497d;">The cause of this issue is that the .NET Framework v4.0 is not installed on the FIM Synchronization Service.&nbsp;
</span></p>
<h2><a name="RESOLUTION"></a><span style="font-size:11pt;font-family:calibri,sans-serif;color:#1f497d;"><strong>RESOLUTION</strong></span></h2>
<p><span style="font-size:11pt;font-family:calibri,sans-serif;color:#1f497d;">In this case, there are two possible solutions for this problem.
</span></p>
<h3><span style="font-size:11pt;font-family:calibri,sans-serif;color:#1f497d;"><strong>#1
</strong></span></h3>
<p><span style="font-size:11pt;font-family:wingdings;color:#1f497d;">è </span><span style="font-size:11pt;font-family:calibri,sans-serif;color:#1f497d;">Install the Microsoft .NET Framework v4.0</span></p>
<h3><span style="font-size:11pt;font-family:calibri,sans-serif;color:#1f497d;"><strong>#2</strong></span></h3>
<ol>
<li>On the FIM Synchronization Service Machine, Stop the FIM Synchronization Service
</li><li>Navigate to %programfiles%\Microsoft Forefront Identity Manager\2010\Synchronization Service\Bin
</li><li>Edit the miiserver.exe.config file </li><li>In the &lt;startup&gt; section, swap the order of the supportedRuntime </li></ol>
<blockquote dir="ltr" style="margin-right:0px;">
<blockquote dir="ltr" style="margin-right:0px;">
<p><strong><span style="text-decoration:underline;font-size:11pt;font-family:calibri,sans-serif;color:#1f497d;">FROM</span></strong></p>
<p><span style="font-size:11pt;font-family:calibri,sans-serif;color:#1f497d;">&nbsp; &lt;startup useLegacyV2RuntimeActivationPolicy=&quot;true&quot;&gt;</span></p>
<p><span style="font-size:11pt;font-family:calibri,sans-serif;color:#1f497d;">&nbsp;&nbsp;&nbsp; &lt;supportedRuntime version=&quot;v4.0.30319&quot;&gt;&lt;/supportedRuntime&gt;</span></p>
<p><span style="font-size:11pt;font-family:calibri,sans-serif;color:#1f497d;">&nbsp;&nbsp;&nbsp; &lt;supportedRuntime version=&quot;v2.0.50727&quot;&gt;&lt;/supportedRuntime&gt;</span></p>
<p><span style="font-size:11pt;font-family:calibri,sans-serif;color:#1f497d;">&nbsp; &lt;/startup&gt;</span></p>
<p><strong><span style="text-decoration:underline;font-size:11pt;font-family:calibri,sans-serif;color:#1f497d;">TO</span></strong></p>
<p><span style="font-size:11pt;font-family:calibri,sans-serif;color:#1f497d;">&nbsp; &lt;startup useLegacyV2RuntimeActivationPolicy=&quot;true&quot;&gt;</span></p>
<p><span style="font-size:11pt;font-family:calibri,sans-serif;color:#1f497d;">&nbsp;&nbsp;&nbsp; &lt;supportedRuntime version=&quot;v2.0.50727&quot;&gt;&lt;/supportedRuntime&gt;</span></p>
<p><span style="font-size:11pt;font-family:calibri,sans-serif;color:#1f497d;">&nbsp;&nbsp;&nbsp; &lt;supportedRuntime version=&quot;v4.0.30319&quot;&gt;&lt;/supportedRuntime&gt;</span></p>
<p><span style="font-size:11pt;font-family:calibri,sans-serif;color:#1f497d;">&nbsp; &lt;/startup&gt;</span></p>
</blockquote>
</blockquote>
<ol>
<li>Save the miiserver.exe.config file </li><li>Start the FIM Synchronization Service </li><li>Create the FIM Service Management Agent </li></ol>
<p>&nbsp;</p>
<h2><a name="SEE_ALSO"></a><span style="font-size:11pt;font-family:calibri,sans-serif;color:#1f497d;"><strong>SEE ALSO</strong></span></h2>
<ul style="list-style-type:disc;">
<li style="color:#333333;"><span style="font-size:9pt;font-family:&#39;segoe ui&#39;,sans-serif;">Current Forefront Identity Manager Resources:
<a href="http://social.technet.microsoft.com/wiki/contents/articles/forefront-identity-manager-resources.aspx">
<span style="text-decoration:none;color:#0066dd;">http://social.technet.microsoft.com/wiki/contents/articles/forefront-identity-manager-resources.aspx</span></a>
</span></li><li style="color:#333333;"><span style="font-size:9pt;font-family:&#39;segoe ui&#39;,sans-serif;">Current Certificate Lifecycle Manager Resources:
<a href="http://social.technet.microsoft.com/wiki/contents/articles/current-certificate-lifecycle-manager-resources.aspx">
<span style="text-decoration:none;color:#0066dd;">http://social.technet.microsoft.com/wiki/contents/articles/current-certificate-lifecycle-manager-resources.aspx</span></a>
</span></li><li style="color:#333333;"><span style="font-size:9pt;font-family:&#39;segoe ui&#39;,sans-serif;">Current GalSync Resources:
<a href="http://social.technet.microsoft.com/wiki/contents/articles/1726.global-address-list-synchronization-galsync-resources.aspx">
<span style="text-decoration:none;color:#0066dd;">http://social.technet.microsoft.com/wiki/contents/articles/1726.global-address-list-synchronization-galsync-resources.aspx</span></a>
</span></li><li style="color:#333333;"><span style="font-size:9pt;font-family:&#39;segoe ui&#39;,sans-serif;">Current PCNS – Password Synchronization Resources:
<a href="http://social.technet.microsoft.com/wiki/contents/articles/2762.pcns-password-synchronization-resourcet.microsoft.com/wiki/contents/articles/current-certificate-lifecycle-manager-resources.aspx">
<span style="text-decoration:none;color:#0066dd;">http://social.technet.microsoft.com/wiki/contents/articles/current-certificate-lifecycle-manager-resources.aspx</span></a>
</span></li><li style="color:#333333;"><span style="font-size:9pt;font-family:&#39;segoe ui&#39;,sans-serif;">Current GalSync Resources:
<a href="http://social.technet.microsoft.com/wiki/contents/articles/1726.global-address-list-synchronization-galsync-resources.aspx">
<span style="text-decoration:none;color:#0066dd;">http://social.technet.microsoft.com/wiki/contents/articles/1726.global-address-list-synchronization-galsync-resources.aspx</span></a>
</span></li><li style="color:#333333;"><spae-wiki.aspx">
<span style="text-decoration:none;color:#0066dd;">http://social.technet.microsoft.com/wiki/contents/articles/2762.pcns-password-synchronization-resource-wiki.aspx</span></a>
</span></li><li style="color:#333333;"><span style="font-size:9pt;font-family:&#39;segoe ui&#39;,sans-serif;">Extension-DLL-Exception Resources:
<a href="http://social.technet.microsoft.com/wiki/contents/articles/7515.sync-extension-dll-exception.aspx">
<span style="text-decoration:none;color:#0066dd;">http://social.technet.microsoft.com/wiki/contents/articles/7515.sync-extension-dll-exception.aspx</span></a></span>
</li></ul>
<p>&nbsp;</p>

</div>
    
    
