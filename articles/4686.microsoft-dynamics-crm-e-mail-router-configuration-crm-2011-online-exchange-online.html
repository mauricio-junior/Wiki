---
layout: default
title: Microsoft Dynamics CRM E-mail Router Configuration â€“ CRM 2011 Online & Exchange Online - TechNet Articles - United States (English) - TechNet Wiki
weight: 3
---

<div class="post-content user-defined-markup"><p><a href="http://edwardsdna.wordpress.com/2011/09/16/emailrouterconfigurationcrm2011exchangeonline/" target="_blank"><em>Original Article<br />
</em></a><br />
<br />
<a href="http://social.technet.microsoft.com/wiki/contents/articles/microsoft-dynamics-crm-overview.aspx" target="_blank"><strong><span style="color:#000000;">Back to Microsoft Dynamics CRM Overview<br />
</span></strong></a><br />
<br />
The CRM e-mail router is available for implementation with Exchange On-Premise, POP3 accounts, and Exchange Online.&nbsp; In this article my focus is on implementing the E-mail Router with Exchange Online.&nbsp;</p>
<p>For additional information regarding other available options and supporting resources, please see my article,</p>
<p><a href="http://edwardsdna.wordpress.com/2011/05/19/crm_online_emailrouter/"><span style="color:#2970a6;">CRM Online E-mail Router &ndash; Yes We Do That!</span></a></p>
<p>So let&rsquo;s get started.&nbsp; To begin, you&rsquo;ll want to ensure you understand the hardware / software requirements.&nbsp; These were pulled directly from the <a href="http://www.microsoft.com/download/en/details.aspx?id=4641"><span style="color:#2970a6;">E-mail Router Installation Guide</span></a>:</p>
<ul>
    <li>Windows 7, Windows Server 2008 </li>
</ul>
<p>Next, you&rsquo;ll want to consider a few configuration options and make decisions:</p>
<ul>
    <li>How do you want to handle Incoming mail for each user?&nbsp; </li>
    <li>How do you want to setup the Outgoing Mail Profile? </li>
</ul>
<p><strong>Incoming Mail Options</strong></p>
<p>You have a couple of options regarding the Incoming Mail Profile; do you want to have the e-mail router handle both outgoing and incoming or do you want to use the Forward Mailbox for Incoming.&nbsp; The benefit for using the Forward Mailbox is that you have only one point of failure to troubleshoot incoming mail issues, the Forward Mailbox.&nbsp; If each user is configured to use the E-mail Router to manage incoming e-mail then you might have to troubleshoot issues at the Outlook user mailbox level.&nbsp; The downside to this approach for some is it requires an additional mailbox setup for the Forward Mailbox and Rule Deployment to manage the forwarding mail process.&nbsp; The upside is that it scales well as organizations grow.</p>
<p>Additionally, you&rsquo;ll need to decide if you are going to setup one Incoming profile for each user or use one Incoming Profile for all.&nbsp; The most common approach is to use one Incoming Profile for all users.&nbsp; If that is the choice you make then the Access Credentials you choose to use for this profile must have full access to all user mailboxes.&nbsp; If you choose to setup one Incoming Profile for each user then you will need to know the Exchange Online password for each user.</p>
<p><strong>Outgoing Mail Options</strong></p>
<p>The option you want to focus on for the Outgoing Mail Profile is do you want to use an Administrator level account for Access or setup each user account.&nbsp; Generally, you&rsquo;ll want to use an Administrator level account for Access rather than setting up individual Outgoing profiles.&nbsp; An Administrator level account assumes full rights to all user&rsquo;s mailboxes.&nbsp; There will be some important items to pay close attention to when setting up this configuration to include a required call to Exchange Online support to complete a few configuration steps which I&rsquo;ll highlight later in the article.</p>
<p>After you&rsquo;ve identified the best configuration options for your organization and completed the preparation work required for the options you selected, you are ready to install the e-mail router.</p>
<p><strong>E-mail Router Installation</strong></p>
<p>One of the best resources I&rsquo;ve found for a detailed guide on installing the E-mail Router for CRM Online and Exchange Online is the article written a few years ago on the Dynamics CRM Team Blog,</p>
<p><a href="http://blogs.msdn.com/b/crm/archive/2009/12/07/configure-microsoft-dynamics-crm-online-e-mail-router-with-exchange-online.aspx"><span style="color:#2970a6;">Configure Microsoft Dynamics CRM Online E-mail Router with Exchange Online</span></a></p>
<p>Although some of this will be a repeat of the above article, the following steps are from a &lsquo;real-world&rsquo; installation, so here we go:</p>
<p>&nbsp;</p>
<p>First, ensure your CRM users have been configured to use the E-mail Router.&nbsp;</p>
<ul>
    <li>Go to CRM Online, select Settings, Administration, Users, select each User and update the E-mail Access Type Incoming and Outgoing fields under the Email Configuration section. </li>
    <li>Also ensure&nbsp; you&rsquo;ve that you&rsquo;ve selected the Approve E-mail button from the Ribbon. </li>
</ul>
<p><a href="http://edwardsdna.files.wordpress.com/2011/09/userimage.png"><img width="462" height="264" title="UserImage" style="background-image:none;padding-left:0px;padding-right:0px;display:inline;padding-top:0px;border:0px solid;" alt="UserImage" src="http://edwardsdna.files.wordpress.com/2011/09/userimage_thumb.png?w=462&amp;h=264" /></a></p>
<p>Now we are ready to install and test the E-mail Router</p>
<ul>
    <li>Download the <a href="http://www.microsoft.com/download/en/details.aspx?id=20548"><span style="color:#2970a6;">CRM 2011 E-mail Router</span></a> and run the installation package.&nbsp; You can choose from a 32 or 64 bit package depending on your machine setup.&nbsp; </li>
    <li>Select to Install any prerequisites required </li>
</ul>
<p><a href="http://edwardsdna.files.wordpress.com/2011/09/image5.png"><img width="375" height="334" title="image" style="background-image:none;padding-left:0px;padding-right:0px;display:inline;padding-top:0px;border:0px solid;" alt="image" src="http://edwardsdna.files.wordpress.com/2011/09/image_thumb5.png?w=375&amp;h=334" /></a></p>
<ul>
    <li>If you receiground-image:none;padding-left:0px;padding-right:0px;display:inline;padding-top:0px;border:0px solid;" alt="UserImage" src="http://edwardsdna.files.wordpress.com/2011/09/userimage_thumb.png?w=462&amp;h=264" /></a></p>
<p>Now we are ready to install and test the E-mail Router</p>
<ul>
    <li>Download the <a href="http://www.microsoft.com/download/en/details.aspx?id=20548"><span style="color:#2970a6;">CRM 2011 E-mail Router</span></a> and run the installation package.&nbsp; You can choose from a 32 or 64 bit package depending on your machine setup.&nbsp; </li>
    <li>Select to Install any prerequisites required </li>
</ul>
<p><a href="http://edwardsdna.files.wordpress.com/2011/09/image5.png"><img width="375" height="334" title="image" style="background-image:none;padding-left:0px;padding-right:0px;display:inline;padding-top:0px;border:0px solid;" alt="image" src="http://edwardsdna.files.wordpress.com/2011/09/image_thumb5.png?w=375&amp;h=334" /></ved the error message, the Microsoft Exchange Server MAPI subsystem is not installed on this system, please see this <a href="http://support.microsoft.com/kb/951401/en-us"><span style="color:#2970a6;">KB article</span></a> for the fix </li>
</ul>
<p><a href="http://edwardsdna.files.wordpress.com/2011/09/image6.png"><img width="473" height="233" title="image" style="background-image:none;padding-left:0px;padding-right:0px;display:inline;padding-top:0px;border:0px solid;" alt="image" src="http://edwardsdna.files.wordpress.com/2011/09/image_thumb6.png?w=473&amp;h=233" /></a></p>
<ul>
    <li>If you needed to apply the fix, select back once the fix is applied and select next.&nbsp; If no errors were encountered, select finish if the installation completed successfully.&nbsp; If the installation did not complete successfully, you need to resolve all error before proceeding. </li>
</ul>
<p><a href="http://edwardsdna.files.wordpress.com/2011/09/image7.png"><img width="389" height="334" title="image" style="background-image:none;padding-left:0px;padding-right:0px;display:inline;padding-top:0px;border:0px solid;" alt="image" src="http://edwardsdna.files.wordpress.com/2011/09/image_thumb7.png?w=389&amp;h=334" /></a></p>
<ul>
    <li>Next you&rsquo;ll go to Start Programs, Microsoft Dynamics CRM 2011 E-mail Router and open the Configuration Manager </li>
</ul>
<p><a href="http://edwardsdna.files.wordpress.com/2011/09/image8.png"><img width="404" height="334" title="image" style="background-image:none;padding-left:0px;padding-right:0px;display:inline;padding-top:0px;border:0px solid;" alt="image" src="http://edwardsdna.files.wordpress.com/2011/09/image_thumb8.png?w=404&amp;h=334" /></a></p>
<ul>
    <li>Remaining on the Configuration Profile tab, we&rsquo;ll create the Incoming and Outgoing profile.&nbsp; You may not need both depending on how you plan to use the e-mail router. </li>
</ul>
<p><strong>Outgoing Profile</strong></p>
<ul>
    <li>Enter a Profile Name, Select Outgoing for the Direction and Select Exchange Online from the E-mail Server Type </li>
    <li>Enter the Exchange Online Web Server URL which can be found in the <strong><a href="http://blogs.msdn.com/b/crm/archive/2009/12/07/configure-microsoft-dynamics-crm-online-e-mail-router-with-exchange-online.aspx"><span style="color:#2970a6;">Configure Microsoft Dynamics CRM Online E-mail Router with Exchange Online</span></a> </strong>article and documentation. </li>
    <li>Select Other Specified for the Access Credential, select Administrator for the User Type and enter the credentials of an Exchange Online Administrator account </li>
    <li>For Access Type, select the desired option.
    <ul>
        <li><strong>Note:</strong> the difference between Delegate Access and Send as Permission is Delegate Access causes e-mail to display &ldquo;Sent on behalf of (specified CRM User)&rdquo; and Send as Permission causes the e-mail to appear as though it was sent directly by the CRM User </li>
        <li><strong>Note: </strong>from the documentation: &ldquo;The Send As setting is currently not enabled by default for the Exchange Online Administrator. Please call Exchange Online Support to update the setting.&nbsp; This may change with future releases&rdquo; </li>
    </ul>
    </li>
</ul>
<p><a href="http://edwardsdna.files.wordpress.com/2011/09/image9.png"><img width="281" height="334" title="image" style="background-image:none;padding-left:0px;padding-right:0px;display:inline;padding-top:0px;border:0px solid;" alt="image" src="http://edwardsdna.files.wordpress.com/2011/09/image_thumb9.png?w=281&amp;h=334" /></a></p>
<p><strong>Incoming Profile</strong></p>
<ul>
    <li>Enter a Profile Name, Select Incoming for the Direction and Select Exchange Online from the E-mail Server Type </li>
    <li>Enter the Exchange Online Web Server URL which can be found in the <strong><a href="http://blogs.msdn.com/b/crm/archive/2009/12/07/configure-microsoft-dynamics-crm-online-e-mail-router-with-exchange-online.aspx"><span style="color:#2970a6;">Configure Microsoft Dynamics CRM Online E-mail Router with Exchange Online</span></a> </strong>article and documentation. </li>
    <li>Select Other Specified for the Access Credential, select Administrator for the User Type and enter the credentials of an Exchange Online Administrator account <!--EndFragment--></li>
</ul>
<p><a href="http://edwardsdna.files.wordpress.com/2011/09/incomingprofile.png"><img width="279" height="334" title="IncomingProfile" style="background-image:none;padding-left:0px;padding-right:0px;display:inline;padding-top:0px;border:0px solid;" alt="IncomingProfile" src="http://edwardsdna.files.wordpress.com/2011/09/incomingprofile_thumb.png?w=279&amp;h=334" /></a></p>
<p><strong>Deployment Profile</strong></p>
<ul>
    <li>Select the Deployments Tab and select the New button from the right navigation menu </li>
</ul>
<p><a href="http://edwardsdna.files.wordpress.com/2011/09/image10.png"><img width="464" height="305" title="image" style="background-image:none;padding-left:0px;padding-right:0px;display:inline;padding-top:0px;border:0px solid;" alt="image" src="http://edwardsdna.files.wordpress.com/2011/09/image_thumb10.png?w=464&amp;h=305" /></a></p>
<ul>
    <li>Select Microsoft Dynamics CRM Online and replace &lt;OrganizationName&gt; with Your Unique Org name.&nbsp;
    <ul>
        <li>You can find your CRM Online Unique Org Name by going to Settings, Customization, Developer Resources and copy the value found under the first entry, &ldquo;Organization Unique Name&rdquo; </li>
        <li>Do not replace the first part of the URL &ldquo;https://dev.CRM.dynamics.com/&rdquo;&nbsp; only replace this value &lt;OrganizationName&gt; with your unique organization name </li>
    </ul>
    </li>
</ul>
<p><a href="http://edwardsdna.files.wordpress.com/2011/09/image11.png"><img width="465" height="309" title="image" style="background-image:none;padding-left:0px;padding-right:0px;display:inline;padding-top:0px;border:0px solid;" alt="image" src="http://edwardsdna.files.wordpress.com/2011/09/image_thumb11.png?w=465&amp;h=309" /></a></p>
<p><a href="http://edwardsdna.files.wordpress.com/2011/09/orguniquename.png"><img width="346" height="226" title="OrgUniqueName" style="background-image:none;padding-left:0px;padding-right:0px;display:inline;padding-top:0px;border:0px solid;" alt="OrgUniqueName" src="http://edwardsdna.files.wordpress.com/2011/09/orguniquename_thumb.png?w=346&amp;h=226" /></a></p>
<ul>
    <li>Enter the Live ID in the User Name and related password that is used by a CRM User with the System Administration role to login into CRM Online.&nbsp; The user name should be in the same format as that used to log into CRM, <a href="mailto:crmuser@domain.com"><span style="color:#2970a6;">crmuser@domain.com</span></a> </li>
    <li>Select the Incoming and Outgoing profile for each of the applicable Default configuration profiles </li>
</ul>
<p><a href="http://edwardsdna.files.wordpress.com/2011/09/deploymentprofile.png"><img width="304" height="334" title="deploymentProfile" style="background-image:none;padding-left:0px;padding-right:0px;display:inline;padding-top:0px;border:0px solid;" alt="deploymentProfile" src="http://edwardsdna.files.wordpress.com/2011/09/deploymentprofile_thumb.png?w=304&amp;h=334" /></a></p>
<ul>
    <li>Select Ok and select the Publish button in the lower right-hand corner of the Window </li>
</ul>
<p><strong>Test the E-mail Router</strong></p>
<ul>
    <li>Go to the Users, Queues and Forward Mailbox tab and select the Load Data tab. </li>
    <li>If all configurations are correct to include passwords,&nbsp; you should see a list of your CRM users when the action is completed. </li>
    <li>Once the Users are loaded you can select the Test Access button from the right navigation menu </li>
</ul>
<p><a href="http://edwardsdna.files.wordpress.com/2011/09/image12.png"><img width="459" height="294" title="image" style="background-image:none;padding-left:0px;padding-right:0px;display:inline;padding-top:0px;border:0px solid;" alt="image" src="http://edwardsdna.files.wordpress.com/2011/09/image_thumb12.png?w=459&amp;h=294" /></a></p>
<p><strong>Forward Mailbox</strong></p>
<p>If you plan to use the Forward Mailbox to manage incoming mail, select the Forward Mailbox tab and select the New button.&nbsp; Enter a Name for the forward mailbox, enter the mailbox address for the forward mailbox and select Incoming.&nbsp;</p>
<p><a href="http://edwardsdna.files.wordpress.com/2011/09/forwardmailbox.png"><img width="288" height="334" title="ForwardMailbox" style="background-image:none;padding-left:0px;padding-right:0px;display:inline;padding-top:0px;border:0px solid;" alt="ForwardMailbox" src="http://edwardsdna.files.wordpress.com/2011/09/forwardmailbox_thumb.png?w=288&amp;h=334" /></a></p>
<ul>
    <li>If you choose to use a Forward mailbox, you&rsquo;ll need to change each User record in CRM to Forward Mailbox for Incoming Configuration and Deploy the Forward Mailbox rule. </li>
</ul>
<p><strong>E-mail Router Service</strong></p>
<p>In closing, the E-mail Router Service plays an important role in ensuring the everything works as expected.&nbsp; Therefore, it is important that you set the logon for the E-mail Router service to a logon that has sufficient rights.&nbsp; To do this, ensure that the user account that is running the E-mail Router Service is a member of the Active Directory directory service PrivUserGroup security group.</p></div>
    
    