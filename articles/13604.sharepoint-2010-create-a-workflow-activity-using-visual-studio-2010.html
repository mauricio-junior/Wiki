---
layout: default
title: 'SharePoint 2010&#58; Create a Workflow Activity using Visual Studio 2010 - TechNet Articles - United States (English) - TechNet Wiki'
weight: 3
---

<div class="post-content user-defined-markup">

<span style="font-family:&#39;trebuchet ms&#39;,sans-serif;">This article is regarding creating &quot;<       
</ul>
<strong>SharePoint Custom Workflow Activity</strong>&quot; through Visual Studio 2010. First, let&#39;s us have look on what is Custom Workflow Activity, what is need to create custom
 workflow activity?</span><br />
<br />
<span style="font-family:&#39;trebuchet ms&#39;,sans-serif;">When creating workflow, SharePoint designer supports out-of-box actions which can be easily used. Examples are Sending email, Creating item in List of same site, Log to history list, etc. Below are set of
 actions provided in Sharepoint designer:</span><br />
<span style="font-family:&#39;trebuchet ms&#39;,sans-serif;"><br />
</span>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote style="text-align:center;"><a href="http://3.bp.blogspot.com/-TSKuGz_PVEA/UFgiB_9Oc7I/AAAAAAAAAJY/TzJzriS98Hg/s1600/ParasSanghani_WorkflowActions.png" style="margin-left:auto;margin-right:auto;"><img alt=" " src="http://3.bp.blogspot.com/-TSKuGz_PVEA/UFgiB_9Oc7I/AAAAAAAAAJY/TzJzriS98Hg/s640/ParasSanghani_WorkflowActions.png" style="border-top:0px solid;height:640px;border-right:0px solid;border-bottom:0px solid;border-left:0px solid;width:393px;" /></a>
<span style="font-family:&#39;trebuchet ms&#39;,sans-serif;"><br />
&nbsp; Workflow Actions Out-of-box</span><br />
<br />
<br />
<br />
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<p style="text-align:left;"><span style="font-family:&#39;trebuchet ms&#39;,sans-serif;">SharePoint Designer supports only a subset of the workflow activities available from the workflow foundation. The two most notable workflow activities that SharePoint does not support
 are the WhileActivity, which is responsible for looping, and the ReplicatorActivity, which is responsible for iterating through a collection. Other activities, though supported, have limited functionality. For instance, the LogToHistoryActivity, which is used
 to log messages to the Workflow History list, cannot write to the</span><br />
<span style="font-family:&#39;trebuchet ms&#39;,sans-serif;"></span><br />
<span style="font-family:&#39;trebuchet ms&#39;,sans-serif;">Other Data field; therefore, messages from a SharePoint Designer–created workflow sent to the Workflow History list are capped at 256 characters.&nbsp;</span><br />
<br />
<span style="font-family:&#39;trebuchet ms&#39;,sans-serif;">If the limitations of SharePoint Designer are too restrictive, Visual Studio is the answer. With Visual Studio, you have complete access to the capabilities of the SharePoint Workflow host and workflow runtime.
 The designer in Visual Studio allows for looping and iteration—the two key reasons why most solutions require a Visual Studio workflow.&nbsp;</span><br />
<br />
<span style="font-family:&#39;trebuchet ms&#39;,sans-serif;">We need to go for creating SharePoint Custom Workflow activity when SharePoint designer does not support out-of-box inbuilt actions for workflow. We had requirement to add/create new item in sub site&#39;s list
 when workflow is triggered. SharePoint designer workflow actions support adding item in same site list but when it comes to adding item in sub site list it doesn&#39;t support, so we need to create SharePoint Custom Workflow activity.&nbsp;</span><br />
<br />
<span style="font-family:&#39;trebuchet ms&#39;,sans-serif;">Let&#39;s see how can we create Custom Workflow Activity:</span><br />
<br />
</p>
<ol>
<li><span style="font-family:&#39;trebuchet ms&#39;,sans-serif;">&nbsp;&nbsp; Create a new project, select “Empty SharePoint Project” as the template.</span>
<table class="tr-caption-container" cellspacing="0" cellpadding="0" align="center" style="text-align:center;margin-left:auto;margin-right:auto;">
<tbody>
<tr>
<td style="text-align:center;"><a href="http://3.bp.blogspot.com/--zu8lS_LN_A/UFgkSgPV5KI/AAAAAAAAAJo/n30pm5MScZs/s1600/ParasSanghani_SharepointEmptyProject.png" style="margin-left:auto;margin-right:auto;"><img alt=" " src="http://3.bp.blogspot.com/--zu8lS_LN_A/UFgkSgPV5KI/AAAAAAAAAJo/n30pm5MScZs/s640/ParasSanghani_SharepointEmptyProject.png" width="640" height="384" style="border-top:0px solid;border-right:0px solid;border-bottom:0px solid;border-left:0px solid;" /></a><br />
</td>
</tr>
</tbody>
</table>
</li></ol>
<span style="font-size:small;font-family:&#39;trebuchet ms&#39;,sans-serif;">2. Give the project a cool name and click “OK.”</span>
<div style="text-align:justify;"><span style="font-size:small;font-family:&#39;trebuchet ms&#39;,sans-serif;">3.&nbsp; Select “Deploy as farm solution” in the wizard window.</span></div>
<div style="text-align:justify;"></div>
<div style="text-align:justify;"><br />
<table class="tr-caption-container" cellspacing="0" cellpadding="0" align="center" style="text-align:center;margin-left:auto;margin-right:auto;">
<tbody>
<tr>
<td style="text-align:center;"><a href="http://1.bp.blogspot.com/-BPz-xMttquI/UFgmmKH-vCI/AAAAAAAAAJw/jWPPfgzlKGY/s1600/ParasSanghani_SiteDeploySettings.png" style="margin-left:auto;margin-right:auto;"><img alt=" " src="http://1.bp.blogspot.com/-BPz-xMttquI/UFgmmKH-vCI/AAAAAAAAAJw/jWPPfgzlKGY/s640/ParasSanghani_SiteDeploySettings.png" width="640" height="236" style="border-top:0px solid;border-right:0px solid;border-bottom:0px solid;border-left:0px solid;" /></a></td>
</tr>
<tr>
<td class="tr-caption" style="text-align:center;"><span style="font-family:&#39;trebuchet ms&#39;,sans-serif;">Sharepoint Deployment as Farm Solution</span></td>
</tr>
</tbody>
</table>
</div>
<div style="text-align:justify;"><span style="font-family:&#39;trebuchet ms&#39;,sans-serif;"><br />
</span></div>
<div style="text-align:left;"><span style="font-size:small;font-family:&#39;trebuchet ms&#39;,sans-serif;">4.&nbsp;&nbsp; Add a reference to “<strong>Microsoft.SharePoint.WorkflowActions</strong>” from the .NET tab in the Add Reference dialog.&nbsp;</span></div>
<div style="text-align:left;"><span style="font-size:small;font-family:&#39;trebuchet ms&#39;,sans-serif;">&nbsp;Add a reference to “<strong>System.Workflow.Activities</strong>”, “<strong>System.Workflow.ComponentModel</strong>” and “<strong>System.Workflow.Runtime</strong>”
 under “Browse” in the folder “Program Files (x86) Reference AssembliesMicrosoftFrm:0px solid;border-left:0px solid;" /></a></td>
</tr>
<tr>
<td class="tr-caption" style="text-align:center;"><span style="font-family:&#39;trebuchet ms&#39;,sans-serif;">Sharepoint Deployment as Farm Solution</span></td>
</tr>
</tbody>
</table>
</div>
<div style="text-align:justify;"><span style="font-family:&#39;trebuchet ms&#39;,sans-serif;"><br />
</span></div>
<div style="text-align:left;"><span style="font-size:small;font-family:&#39;trebuchet ms&#39;,sans-serif;">4.&nbsp;&nbsp; Add a reference to “<strong>Microsoft.SharePoint.WorkflowActions</strong>” from the .NET tab in the Add Reference dialog.&nbsp;</span></div>
<div style="text-align:left;"><span style="font-size:small;font-family:&#39;trebuchet ms&#39ameworkv3.0“</span></div>
<br />
<table class="tr-caption-container" cellspacing="0" cellpadding="0" align="center" style="text-align:center;margin-left:auto;margin-right:auto;">
<tbody>
<tr>
<td style="text-align:center;"><a href="http://2.bp.blogspot.com/-gJk-LcZAxlM/UFgnizm2VBI/AAAAAAAAAJ4/dCgnXU5UrhI/s1600/ParasSanghani_SharepointAddReference.png" style="margin-left:auto;margin-right:auto;"><img alt=" " src="http://2.bp.blogspot.com/-gJk-LcZAxlM/UFgnizm2VBI/AAAAAAAAAJ4/dCgnXU5UrhI/s400/ParasSanghani_SharepointAddReference.png" width="356" height="400" style="border-top:0px solid;border-right:0px solid;border-bottom:0px solid;border-left:0px solid;" /></a></td>
</tr>
<tr>
<td class="tr-caption" style="text-align:center;"><span style="font-family:&#39;trebuchet ms&#39;,sans-serif;"><strong>SharePoint Adding Reference</strong></span></td>
</tr>
</tbody>
</table>
<span style="font-family:&#39;trebuchet ms&#39;,sans-serif;"><br />
</span><span style="font-family:&#39;trebuchet ms&#39;,sans-serif;"><br />
</span><span style="font-family:&#39;trebuchet ms&#39;,sans-serif;">Once the project is configured, we will create the activity code as shown below:</span><br />
<span style="font-family:&#39;trebuchet ms&#39;,sans-serif;"><br />
</span><br />
<h3 style="text-align:left;"><a name="Creating_the_Activity_Code"></a><span style="font-family:&#39;trebuchet ms&#39;,sans-serif;">Creating the Activity Code
</span></h3>
<ol style="text-align:left;">
<li><span style="font-family:&#39;trebuchet ms&#39;,sans-serif;">You now have a SharePoint solution with the proper references set so that you can write an Activity. It is time to add the class and the first bit of code.</span>
</li><li><span style="font-family:&#39;trebuchet ms&#39;,sans-serif;">Add a new empty Class file to the project. In my case I given Class Name is “<strong>CustomSubsSiteAction</strong>” and that class Inherit with “<strong>Activity</strong>” Class.</span>
</li></ol>
<table class="tr-caption-container" cellspacing="0" cellpadding="0" align="center" style="text-align:center;margin-left:auto;margin-right:auto;">
<tbody>
<tr>
<td style="text-align:center;"><a href="http://1.bp.blogspot.com/-UE7aJwIrwZg/UFgqDtyvYZI/AAAAAAAAAKI/6eVtKQaTUZk/s1600/ParasSanghani_CreatingActivityCode.png" style="margin-left:auto;margin-right:auto;"><img alt=" " src="http://1.bp.blogspot.com/-UE7aJwIrwZg/UFgqDtyvYZI/AAAAAAAAAKI/6eVtKQaTUZk/s400/ParasSanghani_CreatingActivityCode.png" width="400" height="220" style="border-top:0px solid;border-right:0px solid;border-bottom:0px solid;border-left:0px solid;" /></a></td>
</tr>
<tr>
<td class="tr-caption" style="text-align:center;"><span style="font-size:small;font-family:&#39;trebuchet ms&#39;,sans-serif;">Sharepoint Creating Custom Activity</span></td>
</tr>
</tbody>
</table>
<br />
<br />
<span style="font-family:&#39;trebuchet ms&#39;,sans-serif;"><br />
</span><span style="font-family:&#39;trebuchet ms&#39;,sans-serif;">&nbsp;&nbsp; In order to allow properties to be passed in from SharePoint designer, you have to set up Dependency Properties.</span><br />
<br />
<span style="font-family:&#39;trebuchet ms&#39;,sans-serif;">2. Add a Property and Dependency Property for values that will come in from the Workflow. Below is code:&nbsp;</span><br />
<br />
<br />
<br />
<div><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">public</span><span style="font-size:9.5pt;font-family:consolas;">
<span style="color:#0000ff;">static</span> <span style="color:#4682b4;">DependencyProperty</span> DepartMentsProperty =
<span style="color:#4682b4;">DependencyProperty</span>.Register(<span style="color:#b22222;">&quot;DepartMents&quot;</span>,
<span style="color:#0000ff;">typeof</span>(<span style="color:#0000ff;">string</span>),
<span style="color:#0000ff;">typeof</span>(<span style="color:#4682b4;">CustomSubsSiteAction</span>));</span></div>
<div><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<span style="color:#4682b4;">Category</span>(<span style="color:#b22222;">&quot;Cross-Site Actions&quot;</span>),
<span style="color:#4682b4;">Browsable</span>(<span style="color:#0000ff;">true</span>)]</span></div>
<div><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<span style="color:#4682b4;">DesignerSerializationVisibility</span></span></div>
<div><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (<span style="color:#4682b4;">DesignerSerializationVisibility</span>.Visible)]</span></div>
<div><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#0000ff;">
public</span> <span style="color:#0000ff;">string</span> DepartMents</span></div>
<div><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></div>
<div><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get</span></div>
<div><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></div>
<div><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#0000ff;">
return</span> <span style="color:#4682b4;">Convert</span>.ToString(<span style="color:#0000ff;">base</span>.GetValue(DepartMentsProperty));</span></div>
<div><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></div>
<div><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set</span></div>
<div><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></div>
<div><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#0000ff;">
base</span>.SetValue(DepartMentsProperty, <span style="color:#0000ff;">value</span>);</span></div>
<div><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></div>
<div><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></div>
&nbsp; <br />
<br />
<span style="font-family:&#39;trebuchet ms&#39;,sans-serif;">When your activity starts, the Execute method is fired. This is where you will do the work in the Activity. So when can override Execute Method and Perform ours Operation.</span><br />
<br />
<br />
<div><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">protected</span><span style="font-size:9.5pt;font-family:consolas;">
<span style="color:#0000ff;">override</span> <span style="color:#4682b4;">ActivityExecutionStatus</span> Execute(<span style="color:#4682b4;">ActivityExecutionContext</span> executionContext)</span></div>
<div><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></div>
<div><span style="font-size:9.5pt;font-family:consolas;color:#008000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // do stuff here.</span></div>
<div><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#0000ff;">
return</span> <span style="color:#4682b4;">ActivityExecutionStatus</span>.Closed;</span></div>
<div><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></div>
<br />
<br />
<br />
<span style="font-family:&#39;trebuchet ms&#39;,sans-serif;">But If you want to Access Current Item Like: List ID, List Item, Current Web than add
<strong>Dependency Property </strong>for that.</span> <span style="font-size:small;font-family:&#39;trebuchet ms&#39;,sans-serif;">
For access current site Context than Register Property as shown in code below:</span><br />
<br />
<div><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">public</span><span style="font-size:9.5pt;font-family:consolas;">
<span style="color:#0000ff;">static</span> <span style="color:#4682b4;">DependencyProperty</span> __ContextProperty = System.Workflow.ComponentModel.<span style="color:#4682b4;">DependencyProperty</span>.Register(<span style="color:#b22222;">&quot;__Context&quot;</span>,
<span style="color:#0000ff;">typeof</span>(<span style="color:#4682b4;">WorkflowContext</span>),
<span style="color:#0000ff;">typeof</span>(<strong>CustomSubsSiteAction</strong>));</span></div>
<div style="margin-bottom:0in;"><br />
</div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<span style="color:#4682b4;">Description</span>(<span style="color:#b22222;">&quot;The site context&quot;</span>)]</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<span style="color:#4682b4;">Category</span>(<span style="color:#b22222;">&quot;User&quot;</span>)]</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<span style="color:#4682b4;">Browsable</span>(<span style="color:#0000ff;">true</span>)]</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<span style="color:#4682b4;">DesignerSerializationVisibility</span>(<span style="color:#4682b4;">DesignerSerializationVisibility</span>.Visible)]</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&="color:#4682b4;">Description</span>(<span style="color:#b22222;">&quot;The site context&quot;</span>)]</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<span style="color:#4682b4;">Category</span>(<span style="color:#b22222;">&quot;User&quot;</span>)]</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<span style="color:#4682b4;">Browsable</span>(<span style="color:#0000ff;">true</span>)]</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<span style="color:#4682b4;">DesignerSerializationVisibility</span>(<span style="color:#4682b4;">DesignerSerializationVisibility</span>.Visible)]</span></div>
<div style="margin-bottom:0in;"><span style="font-sinbsp;
<span style="color:#0000ff;">public</span> <span style="color:#4682b4;">WorkflowContext</span> __Context</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span style="color:#0000ff;">return</span> ((<span style="color:#4682b4;">WorkflowContext</span>)(<span style="color:#0000ff;">base</span>.GetValue(<span style="color:#4682b4;">CrossSubSiteAction</span>.__ContextProperty)));</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span style="color:#0000ff;">base</span>.SetValue(<span style="color:#4682b4;">CrossSubSiteAction</span>.__ContextProperty,
<span style="color:#0000ff;">value</span>);</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></div>
<div style="margin-bottom:0in;"><br />
</div>
&nbsp;<span style="font-family:&#39;trebuchet ms&#39;,sans-serif;"><strong>Same as Current List Item’s List ID:</strong></span><br />
<br />
<div><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">public</span><span style="font-size:9.5pt;font-family:consolas;">
<span style="color:#0000ff;">static</span> <span style="color:#4682b4;">DependencyProperty</span> __ListIdProperty = System.Workflow.ComponentModel.<span style="color:#4682b4;">DependencyProperty</span>.Register(<span style="color:#b22222;">&quot;__ListId&quot;</span>,
<span style="color:#0000ff;">typeof</span>(<span style="color:#0000ff;">string</span>),
<span style="color:#0000ff;">typeof</span>(<strong>CustomSubsSiteAction</strong>));</span></div>
<div style="margin-bottom:0in;"><br />
</div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<span style="color:#4682b4;">ValidationOption</span>(<span style="color:#4682b4;">ValidationOption</span>.Required)]</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span style="color:#0000ff;">public</span> <span style="color:#0000ff;">string</span> __ListId</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span style="color:#0000ff;">return</span> ((<span style="color:#0000ff;">string</span>)(<span style="color:#0000ff;">base</span>.GetValue(<span style="color:#4682b4;">CrossSubSiteAction</span>.__ListIdProperty)));</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span style="color:#0000ff;">base</span>.SetValue(<span style="color:#4682b4;">CrossSubSiteAction</span>.__ListIdProperty,
<span style="color:#0000ff;">value</span>);</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;}</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></div>
<div style="margin-bottom:0in;"><br />
</div>
<div style="margin-bottom:0in;"><br />
</div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:&#39;trebuchet ms&#39;,sans-serif;"><strong>For Current ListItem’s ID:</strong>
</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;"><br />
</span></div>
<div style="margin-bottom:0in;"></div>
<div><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">public</span><span style="font-size:9.5pt;font-family:consolas;">
<span style="color:#0color:#4682b4;">CrossSubSiteAction</span>.__ListIdProperty,
<span style="color:#0000ff;">value</span>);</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;}</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></div>
<div style="margin-bottom:0in;"><br />
</div>
<div style="margin-bottom:0in;"><br />
</div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:&#39;trebuchet ms&#39;,sans-serif;"><strong>For Current ListItem’s ID:</strong>
</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;"><br />
</span></000ff;">static</span> <span style="color:#4682b4;">DependencyProperty</span> __ListItemProperty = System.Workflow.ComponentModel.<span style="color:#4682b4;">DependencyProperty</span>.Register(<span style="color:#b22222;">&quot;__ItemID&quot;</span>,
<span style="color:#0000ff;">typeof</span>(<span style="color:#0000ff;">int</span>),
<span style="color:#0000ff;">typeof</span>(<strong>CustomSubsSiteAction</strong>));</span></div>
<div style="margin-bottom:0in;"><br />
</div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<span style="color:#4682b4;">ValidationOption</span>(<span style="color:#4682b4;">ValidationOption</span>.Required)]</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span style="color:#0000ff;">public</span> <span style="color:#0000ff;">int</span> __<span style="color:#b22222;"> ItemID</span></span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span style="color:#0000ff;">return</span> ((<span style="color:#0000ff;">int</span>)(<span style="color:#0000ff;">base</span>.GetValue(<span style="color:#4682b4;">CrossSubSiteAction</span>.__ListItemProperty)));</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span style="color:#0000ff;">base</span>.SetValue(<span style="color:#4682b4;">CrossSubSiteAction</span>.__ListItemProperty,
<span style="color:#0000ff;">value</span>);</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></div>
<div style="margin-bottom:0in;"><br />
<br />
</div>
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;"><strong><span style="font-family:&#39;trebuchet ms&#39;,sans-serif;">Also, Register Workflow Activationproperties for Action.</span></strong></span></div>
<br />
<div style="margin-bottom:0in;"><span style="font-size:9.5pt;font-family:consolas;"><strong></strong></span></div>
<div><strong><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">public</span><span style="font-size:9.5pt;font-family:consolas;">
<span style="color:#0000ff;">static</span> <span style="color:#4682b4;">DependencyProperty</span> __ActivationPropertiesProperty =
<span style="color:#4682b4;">DependencyProperty</span>.Register(<span style="color:#b22222;">&quot;__ActivationProperties&quot;</span>,
<span style="color:#0000ff;">typeof</span>(Microsoft.SharePoint.Workflow.<span style="color:#4682b4;">SPWorkflowActivationProperties</span>),
<span style="color:#0000ff;">typeof</span>(<strong>CustomSubsSiteAction</strong>));</span></strong></div>
<strong></strong><br />
<div><strong><br />
</strong></div>
<strong></strong><br />
<div><strong><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<span style="color:#4682b4;">ValidationOption</span>(<span style="color:#4682b4;">ValidationOption</span>.Required)]</span></strong></div>
<strong></strong><br />
<div><strong><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#0000ff;">
public</span> Microsoft.SharePoint.Workflow.<span style="color:#4682b4;">SPWorkflowActivationProperties</span> __ActivationProperties</span></strong></div>
<strong></strong><br />
<div><strong><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></strong></div>
<strong></strong><br />
<div><strong><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get</span></strong></div>
<strong></strong><br />
<div><strong><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></strong></div>
<strong></strong><br />
<div><strong><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#0000ff;">
return</span> (Microsoft.SharePoint.Workflow.<span style="color:#4682b4;">SPWorkflowActivationProperties</span>)<span style="color:#0000ff;">base</span>.GetValue(<span style="color:#4682b4;">CrossSubSiteAction</span>.__ActivationPropertiesProperty);</span></strong></div>
<strong></strong><br />
<div><strong><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></strong></div>
<strong></strong><br />
<div><strong><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set</span></strong></div>
<strong></strong><br />
<div><strong><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></strong></div>
<strong></strong><br />
<div><strong><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#0000ff;">
base</span>.SetValue(<span style="color:#4682b4;">CrossSubSiteAction</span>.__ActivationPropertiesProperty,
<span style="color:#0000ff;">value</span>);</span></strong></div>
<strong></strong><br />
<div><strong><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></strong></div>
<strong></strong><br />
<strong></strong><br />
<strong>
<div><span style="font-size:9.5pt;font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></div>
<div><br />
</div>
<div><br />
</div>
<div><span style="font-size:9.5pt;font-family:&#39;trebuchet ms&#39;,sans-serif;">Override Execute Method &amp; have custom action code as shown below:
</span></div>
<div><span style="font-size:9.5pt;font-family:consolas;"><br />
</span></div>
<table class="tr-caption-container" cellspacing="0" cellpadding="0" align="center" style="text-align:center;margin-left:auto;margin-right:auto;">
<tbody>
<tr>
<td style="text-align:center;"><a href="http://2.bp.blogspot.com/-F1ZKOPNRgzs/UFgsL_ldP9I/AAAAAAAAAKQ/-qIUDfRo0iQ/s1600/ParasSanghani_SharepointOverrideExecuteMethod.png" style="margin-left:auto;margin-right:auto;"><img alt=" " src="http://2.bp.blogspot.com/-F1ZKOPNRgzs/UFgsL_ldP9I/AAAAAAAAAKQ/-qIUDfRo0iQ/s640/ParasSanghani_SharepointOverrideExecuteMethod.png" width="640" height="339" style="border-top:0px solid;border-right:0px solid;border-bottom:0px solid;border-left:0px solid;" /></a></td>
</tr>
<tr>
<td class="tr-caption" style="text-align:center;"><strong><span style="font-family:&#39;trebuchet ms&#39;,sans-serif;">Sharepoint - Override Execute method of Action</span></strong></td>
<td class="tr-caption" style="text-align:center;"><br />
</td>
<td class="tr-caption" style="text-align:center;"><br />
</td>
<td class="tr-caption" style="text-align:center;"><br />
</td>
<td class="tr-caption" style="text-align:center;"><br />
</td>
<td class="tr-caption" style="text-align:center;"><br />
</td>
<td class="tr-caption" style="text-align:center;"><br />
</td>
<td class="tr-caption" style="text-align:center;"><br />
</td>
<td class="tr-caption" style="text-align:center;"><br />
</td>
<td class="tr-caption" style="text-align:center;"><strong><br />
</strong></td>
<td class="tr-caption" style="text-align:center;"><strong><br />
</strong></td>
<td class="tr-caption" style="text-align:center;"><strong><br />
</strong></td>
<td class="tr-caption" style="text-align:center;"><strong><br />
</strong></td>
<td class="tr-caption" style="text-align:center;"><strong><br />
</strong></td>
</tr>
</tbody>
</table>
</strong><br />
<h3><a name="Now_In_order_to_get_Action_in_the_Sharepoint_designer_in_Workflow_actions"></a><strong>
<div style="text-align:left;"><br />
<br />
<br />
</div>
<span style="font-size:small;font-family:&#39;trebuchet ms&#39;,sans-serif;">Now,In order to get Action in the Sharepoint designer in Workflow actions:</span></strong></h3>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong></strong><span style="font-family:&#39;trebuchet ms&#39;,sans-serif;">In order for SharePoint designer to know about the Activity, we have to add a special XML file to the Workflow folder in the SharePoint hive.</span><br />
<br />
<ol style="text-align:left;">
<div class="separator" style="text-align:center;clear:both;"><a href="http://1.bp.blogspot.com/-1KjQagcLLpk/UFgtF1V_kHI/AAAAAAAAAKY/6XO-Gwb0URA/s1600/ParasSanghani_AddingActiontoSharepoint.png" style="margin-left:1em;margin-right:1em;"></a><br />
</div>
<ol>
<li><span style="font-family:&#39;trebuchet ms&#39;,sans-serif;">Right-click on the Project and select Add -&gt; SharePoint Mapped Folder…”</span>
</li></ol>
</ol>
<div></div>
<span style="font-family:&#39;trebuchet ms&#39;,sans-serif;"><strong></strong></span><br />
<table class="tr-caption-container" cellspacing="0" cellpadding="0" align="center" style="text-align:center;margin-left:auto;margin-right:auto;">
<tbody>
<tr>
<td style="text-align:center;"><a href="http://1.bp.blogspot.com/-1KjQagcLLpk/UFgtF1V_kHI/AAAAAAAAAKY/6XO-Gwb0URA/s1600/ParasSanghani_AddingActiontoSharepoint.png" style="margin-left:auto;margin-right:auto;"><img alt=" " src="http://1.bp.blogspot.com/-1KjQagcLLpk/UFgtF1V_kHI/AAAAAAAAAKY/6XO-Gwb0URA/s400/ParasSanghani_AddingActiontoSharepoint.png" width="400" height="275" style="border-top:0px solid;border-right:0px solid;border-bottom:0px solid;border-left:0px solid;" /></a></td>
</tr>
<tr>
<td class="tr-caption" style="text-align:center;"><span style="font-family:&#39;trebuchet ms&#39;,sans-serif;">Adding Action to Sharepoint</span></td>
</tr>
</tbody>
</table>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<span style="font-family:&#39;trebuchet ms&#39;,sans-serif;"> &nbsp; From the folder list, select “TEMPLATE/1033/Workflow“</span><br />
<br />
<table class="tr-caption-container" cellspacing="0" cellpadding="0" align="center" style="text-align:center;margin-left:auto;margin-right:auto;">
<tbody>
<tr>
<td style="text-align:center;"><a href="http://3.bp.blogspot.com/-lZM3Jlz6dxA/UFgtqke_96I/AAAAAAAAAKg/Bmmntvw-LyU/s1600/ParasSanghani_SharepointMappedFolder.png" style="margin-left:auto;margin-right:auto;"><img alt=" " src="http://3.bp.blogspot.com/-lZM3Jlz6dxA/UFgtqke_96I/AAAAAAAAAKg/Bmmntvw-LyU/s1600/ParasSanghani_SharepointMappedFolder.png" style="border-top:0px solid;border-right:0px solid;border-bottom:0px solid;border-left:0px solid;" /></a></td>
</tr>
<tr>
<td class="tr-caption" style="text-align:center;"><span style="font-family:&#39;trebuchet ms&#39;,sans-serif;">Sharepoint Mapped Folder</span></td>
<td class="tr-caption" style="text-align:center;"><br />
</td>
<td class="tr-caption" style="text-align:center;"><br />
</td>
<td class="tr-caption" style="text-align:center;"><br />
</td>
</tr>
</tbody>
</table>
<span style="font-family:&#39;trebuchet ms&#39;,sans-serif;">In the Solution Explorer, right-click on the new Workflow folder and add an XML file (Add -&gt; New Item -&gt; DataXML File). And File name and file extension Must be “.actions”</span><br />
<br />
<table class="tr-caption-container" cellspacing="0" cellpadding="0" align="center" style="text-align:center;margin-left:auto;margin-right:auto;">
<tbody>
<tr>
<td style="text-align:center;"><a href="http://4.bp.blogspot.com/-u8liT0BehrA/UFguGw3TmZI/AAAAAAAAAKo/SwwuRSEzo_g/s1600/ParasSanghani_CustionActionxml.png" style="margin-left:auto;margin-right:auto;"><img alt=" " src="http://4.bp.blogspot.com/-u8liT0BehrA/UFguGw3TmZI/AAAAAAAAAKo/SwwuRSEzo_g/s1600/ParasSanghani_CustionActionxml.png" style="border-top:0px solid;border-right:0px solid;border-bottom:0px solid;border-left:0px solid;" />&nbsp;</a></td>
<td style="text-align:center;"><br />
</td>
<td style="text-align:center;"><br />
</td>
<td style="text-align:center;"><br />
</td>
</tr>
<tr>
<td class="tr-caption" style="text-align:center;"><span style="font-family:&#39;trebuchet ms&#39;,sans-serif;">Custom Actions XML</span></td>
</tr>
</tbody>
</table>
&nbsp;<strong><span style="font-family:&#39;trebuchet ms&#39;,sans-serif;">Open CrossSiteAction.actions File and Add RuleDesigner,Parameter</span></strong><br />
<br />
<strong></strong><br />
<strong></strong><br />
<div><span style="font-size:12pt;color:#000000;">Action Name :</span><strong><span style="font-size:12pt;color:#000000;">&nbsp;
</span><span style="font-size:9.5pt;font-family:consolas;color:#ff0000;">Name</span><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">=</span><span style="font-size:9.5pt;font-family:consolas;">&quot;<span style="color:#0000ff;">Access Cross Subs-Sites
 List</span>&quot;</span> </strong></div>
<strong></strong><br />
<div><span style="font-size:12pt;color:#000000;">Action showing In category</span><span style="font-size:12pt;color:#000000;">:</span><strong><span style="font-size:12pt;color:#000000;">&nbsp;
</span><span style="font-size:9.5pt;font-family:consolas;color:#ff0000;">Category</span><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">=</span><span style="font-size:9.5pt;font-family:consolas;">&quot;<span style="color:#0000ff;">Cross Sub-Site
 List</span>&quot;</span> </strong></div>
<strong></strong><br />
<div><span style="font-size:12pt;color:#000000;">In my case .actions file is </span>
</div>
<strong></strong><br />
<div><strong><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;"><span style="font-size:9.5pt;font-family:consolas;color:#b22222;">xml</span>
<span style="font-size:9.5pt;font-family:consolas;color:#ff0000;">version</span><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">=</span><span style="font-size:9.5pt;font-family:consolas;">&quot;<span style="color:#0000ff;">1.0</span>&quot;
<span style="color:#ff0000;">encoding</span><span style="color:#0000ff;">=</span>&quot;<span style="color:#0000ff;">utf-8</span>&quot;<span style="color:#0000ff;"> ?&gt;</span></span></span></strong></div>
<strong></strong><br />
<div><strong><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&lt;</span><span style="font-size:9.5pt;font-family:consolas;color:#b22222;">WorkflowInfo</span><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&gt;</span>
</strong></div>
<strong></strong><br />
<div><strong><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&nbsp; &lt;</span><span style="font-size:9.5pt;font-family:consolas;color:#b22222;">Actions</span><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&gt;</span>
</strong></div>
<strong></strong><br />
<div><strong><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&nbsp;&nbsp;&nbsp; &lt;</span><span style="font-size:9.5pt;font-family:consolas;color:#b22222;">Action</span>
<span style="font-size:9.5pt;font-family:consolas;color:#ff0000;">Name</span><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">=</span><span style="font-size:9.5pt;font-family:consolas;">&quot;<span style="color:#0000ff;">Access Cross Subs-Sites
 List</span>&quot;</span></strong></div>
<strong><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&nbsp;&nbsp;&nbsp; </span>
<span style="font-size:9.5pt;font-family:consolas;color:#ff0000;">ClassName</span><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">=</span><span style="font-size:9.5pt;font-family:consolas;">&quot;<span style="color:#0000ff;">CustomSubsSiteAction.CustomSubsSiteAction</span>&quot;</span></strong><strong><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&nbsp;&nbsp;
<br />
&nbsp; &nbsp;&nbsp;</span><span style="font-size:9.5pt;font-family:consolas;color:#ff0000;">Assembly</span><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">=</span><span style="font-size:9.5pt;font-family:consolas;">&quot;<span style="color:#0000ff;">CustomSubsSiteAction,
 Version=1.0.0.0, Culture=neutral,PublicKeyToken=7341b1706fa0e582</span>&quot;</span></strong><strong><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;"> &nbsp;
<br />
&nbsp; &nbsp; </span><span style="font-size:9.5pt;font-family:consolas;color:#ff0000;">AppliesTo</span><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">=</span><span style="font-size:9.5pt;font-family:consolas;">&quot;<span style="color:#0000ff;">all</span>&quot;
<span style="color:#ff0000;">Category</span><span style="color:#0000ff;">=</span>&quot;<span style="color:#0000ff;">Cross Sub-Site List</span>&quot;<span style="color:#0000ff;">&gt;</span></span></strong>
<strong></strong><br />
<div><strong><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;</span><span style="font-size:9.5pt;font-family:consolas;color:#b22222;">RuleDesigner</span>
<span style="font-size:9.5pt;font-family:consolas;color:#ff0000;">Sentence</span><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">=</span><span style="font-size:9.5pt;font-family:consolas;">&quot;<span style="color:#0000ff;">Add Current-Listitem
 to DepartMentName = %1 Task Listitem</span>&quot;<span style="color:#0000ff;">&gt;</span></span></strong></div>
<strong><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></strong><strong><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;</span><span style="font-size:9.5pt;font-family:consolas;color:#b22222;">FieldBind</span>
<span style="font-size:9.5pt;font-family:consolas;color:#ff0000;">Field</span><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">=</span><span style="font-size:9.5pt;font-family:consolas;">&quot;<span style="color:#0000ff;">DepartMents</span>&quot;
<span style="color:#ff0000;">DesignerType</span><span style="color:#0000ff;">=</span>&quot;<span style="color:#0000ff;">TextArea</span>&quot;
<span style="color:#ff0000;">Id</span><span style="color:#0000ff;">=</span>&quot;<span style="color:#0000ff;">1</span>&quot;<span style="color:#0000ff;"> /&gt;</span></span></strong><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>
<div></div>
<strong>
<div><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/</span><span style="font-size:9.5pt;font-family:consolas;color:#b22222;">RuleDesigner</span><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&gt;</span>
</div>
<div><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;</span><span style="font-size:9.5pt;font-family:consolas;color:#b22222;">Parameters</span><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&gt;</span>
</div>
<div><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;</span><span style="font-size:9.5pt;font-family:consolas;color:#b22222;">Parameter</span>
<span style="font-size:9.5pt;font-family:consolas;color:#ff0000;">Name</span><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">=</span><span style="font-size:9.5pt;font-family:consolas;">&quot;<span style="color:#0000ff;">__Context</span>&quot;
<span style="color:#ff0000;">Type</span><span style="color:#0000ff;">=</span>&quot;<span style="color:#0000ff;">Microsoft.SharePoint.WorkflowActions.WorkflowContext</span>&quot;
<span style="color:#ff0000;">Direction</span><span style="color:#0000ff;">=</span>&quot;<span style="color:#0000ff;">In</span>&quot;<span style="color:#0000ff;"> /&gt;</span></span></div>
<div><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;</span><span style="font-size:9.5pt;font-family:consolas;color:#b22222;">Parameter</span>
<span style="font-size:9.5pt;font-family:consolas;color:#ff0000;">Name</span><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">=</span><span style="font-size:9.5pt;font-family:consolas;">&quot;<span style="color:#0000ff;">__ListId</span>&quot;
<span style="color:#ff0000;">Type</span><span style="color:#0000ff;">=</span>&quot;<span style="color:#0000ff;">System.String, mscorlib</span>&quot;
<span style="color:#ff0000;">Direction</span><span style="color:#0000ff;">=</span>&quot;<span style="color:#0000ff;">In</span>&quot;<span style="color:#0000ff;"> /&gt;</span></span></div>
<div><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;</span><span style="font-size:9.5pt;font-family:consolas;color:#b22222;">Parameter</span>
<span style="font-size:9.5pt;font-family:consolas;color:#ff0000;">Name</span><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">=</span><span style="font-size:9.5pt;font-family:consolas;">&quot;<span style="color:#0000ff;">__ItemID</span>&quot;
<span style="color:#ff0000;">Type</span><span style="color:#0000ff;">=</span>&quot;<span style="color:#0000ff;">System.Int32, mscorlib</span>&quot;
<span style="color:#ff0000;">Direction</span><span style="color:#0000ff;">=</span>&quot;<span style="color:#0000ff;">In</span>&quot;<span style="color:#0000ff;"> /&gt;</span></span></div>
<div><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;</span><span style="font-size:9.5pt;font-family:consolas;color:#b22222;">Parameter</span>
<span style="font-size:9.5pt;font-family:consolas;color:#ff0000;">Name</span><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">=</span><span style="font-size:9.5pt;font-family:consolas;">&quot;<span style="color:#0000ff;">DepartMents</span>&quot;
<span style="color:#ff0000;">Type</span><span style="color:#0000ff;">=</span>&quot;<span style="color:#0000ff;">System.String, mscorlib</span>&quot;<span style="color:#0000ff;">&nbsp;
</span><span style="color:#ff0000;">Direction</span><span style="color:#0000ff;">=</span>&quot;<span style="color:#0000ff;">In</span>&quot;<span style="color:#0000ff;"> /&gt;</span></span></div>
<div><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;</span><span style="font-size:9.5pt;font-family:consolas;color:#b22222;">Parameter</span>
<span style="font-size:9.5pt;font-family:consolas;color:#ff0000;">Name</span><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">=</span><span style="font-size:9.5pt;font-family:consolas;">&quot;<span style="color:#0000ff;">__ActivationProperties</span>&quot;
<span style="color:#ff0000;">Type</span><span style="color:#0000ff;">=</span>&quot;<span style="color:#0000ff;">Microsoft.SharePoint.Workflow.SPWorkflowActivationProperties, Microsoft.SharePoint</span>&quot;
<span style="color:#ff0000;">Direction</span><span style="color:#0000ff;">=</span>&quot;<span style="color:#0000ff;">Out</span>&quot;<span style="color:#0000ff;"> /&gt;</span></span></div>
<div><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/</span><span style="font-size:9.5pt;font-family:consolas;color:#b22222;">Parameters</span><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&gt;</span>
</div>
<div><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&nbsp;&nbsp;&nbsp; &lt;/</span><span style="font-size:9.5pt;font-family:consolas;color:#b22222;">Action</span><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&gt;</span>
</div>
<div><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&nbsp; &lt;/</span><span style="font-size:9.5pt;font-family:consolas;color:#b22222;">Actions</span><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&gt;</span>
</div>
<div><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&lt;/</span><span style="font-size:9.5pt;font-family:consolas;color:#b22222;">WorkflowInfo</span><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&gt;</span>
</div>
<div style="margin-bottom:0in;"><br />
</div>
</strong><br />
<h3 style="text-align:left;"><a name="Deploying_amp_Register_your_Namespace_for_Authorization"></a><strong><span style="font-size:small;font-family:&#39;trebuchet ms&#39;,sans-serif;">Deploying &amp; Register your Namespace for Authorization&nbsp;</span></strong></h3>
<span style="font-family:&#39;trebuchet ms&#39;,sans-serif;">Deploy the solution &amp; </span>
<span style="font-size:small;font-family:&#39;trebuchet ms&#39;,sans-serif;">to register Custom Activities to Webapplication&#39;s Web.Con;/</span><span style="font-size:9.5pt;font-family:consolas;color:#b22222;">Actions</span><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&gt;</span>
</div>
<div><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&lt;/</span><span style="font-size:9.5pt;font-family:consolas;color:#b22222;">WorkflowInfo</span><span style="font-size:9.5pt;font-family:consolas;color:#0000ff;">&gt;</span>
</div>
<div style="margin-botfig File<br />
<br />
between tab <br />
&nbsp;</span><br />
<span style="font-size:small;"></span><a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/0827.ParasSanghani_5F00_WebconfigRegisteringnamespace.png"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x200/__key/communityserver-wikis-components-files/00-00-00-00-05/0827.ParasSanghani_5F00_WebconfigRegisteringnamespace.png" style="border-top:0px solid;border-right:0px solid;border-bottom:0px solid;border-left:0px solid;" /></a><br />
<span style="font-size:small;"></span><span style="font-size:small;font-family:&#39;trebuchet ms&#39;,sans-serif;"><br />
Than Restart IIS.<br />
<br />
Open run and just write IISreset and Ok.</span><br />
<br />
<h3 style="text-align:left;"><a name="Now_Open_Sharepoint_Designer_TwentyTen_amp_Go_to_workflow"></a><span style="font-size:small;font-family:&#39;trebuchet ms&#39;,sans-serif;">Now Open Sharepoint Designer 2010 &amp; Go to workflow
</span></h3>
<table class="tr-caption-container" cellspacing="0" cellpadding="0" align="center" style="text-align:center;margin-left:auto;margin-right:auto;">
<tbody>
<tr>
<td style="text-align:center;"><a href="http://3.bp.blogspot.com/-cjzL9KoVi24/UFgvmTtTzKI/AAAAAAAAAKw/otzhy_hSobQ/s1600/ParasSanghani_CrossSubsitelistWorkflowAction.png" style="margin-left:auto;margin-right:auto;"><img alt=" " src="http://3.bp.blogspot.com/-cjzL9KoVi24/UFgvmTtTzKI/AAAAAAAAAKw/otzhy_hSobQ/s640/ParasSanghani_CrossSubsitelistWorkflowAction.png" width="640" height="297" style="border-top:0px solid;border-right:0px solid;border-bottom:0px solid;border-left:0px solid;" /></a></td>
</tr>
<tr>
<td class="tr-caption" style="text-align:center;"><span style="font-family:&#39;trebuchet ms&#39;,sans-serif;">Sharepoint Custom workflow Action
</span></td>
</tr>
</tbody>
</table>
<h3 style="text-align:left;"><a name="Source_Code_http_gallery_technet_microsoft_com_Creating-Custom-Sharepoint-9445dac5"></a><span style="font-size:small;font-family:&#39;trebuchet ms&#39;,sans-serif;">&nbsp;<br />
Source Code: <a href="http://gallery.technet.microsoft.com/Creating-Custom-Sharepoint-9445dac5">
http://gallery.technet.microsoft.com/Creating-Custom-Sharepoint-9445dac5</a></span></h3>
<h3 style="text-align:left;"><span style="font-size:small;font-family:&#39;trebuchet ms&#39;,sans-serif;font-weight:normal;"></span>&nbsp;</h3>

</div>
    
    
