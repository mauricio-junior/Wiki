---
layout: default
title: 'SharePoint 2010&#58; PowerPivot Gallery Thumbnails/Snapshots Not Rendering - TechNet Articles - United States (English) - TechNet Wiki'
weight: 3
---

<div class="post-content user-defined-markup">

<p><span style="font-size:12px;font-family:verdana;">Here are some quick steps to hopefully resolve the below error:<br />
<br />
</span><a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/7103.Thumbnail.png"><span style="font-size:12px;font-family:verdana;"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/7103.Thumbnail.png" style="border:0px solid currentcolor;" /></span></a><br />
<span style="font-size:12px;font-family:verdana;"></span><span style="font-size:10px;"><br />
<span style="font-size:12px;font-family:verdana;"></span></span></p>
<span style="font-size:12px;font-family:verdana;"></span>
<p><span style="font-size:12px;font-family:verdana;color:#333333;">Snapshot will not work if you have chosen to open the workbooks in the Client application. Please refer to the below document on how to turn these features off:
</span></p>
<span style="font-size:12px;font-family:verdana;"></span>
<p><span style="font-size:12px;font-family:verdana;"><strong><span style="font-size:12px;color:#000000;">Configure the default open behavior for browser-enabled documents (Office Web Apps)<br />
</span></strong><span style="font-size:12px;color:#000000;"><a href="http://technet.microsoft.com/en-us/library/ee837425.aspx"><strong><span style="font-size:12px;text-decoration:none;color:#0066dd;">http://technet.microsoft.com/en-us/library/ee837425.aspx</span></strong></a></span></span></p>
<span style="font-size:12px;font-family:verdana;"><span style="font-size:12px;"></span><span style="font-size:12px;"></span><span style="font-size:12px;"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style="font-size:12px;font-family:verdana;"></span>
<p><strong><span style="font-size:12px;text-decoration:underline;font-family:verdana;color:#000000;">To set the default open behavior for site collections
</span></strong></p>
<span style="font-size:12px;font-family:verdana;"></span>
<ol>
<span style="font-size:12px;font-family:verdana;"></span>
<li style="color:#333333;"><span style="font-size:12px;font-family:verdana;color:#000000;">In the SharePoint site collection, click
<strong>Site Actions</strong>, and then click <strong>Site Settings</strong>. </span>
<span style="font-size:12px;font-family:verdana;"></span></li><li style="color:#333333;"><span style="font-size:12px;font-family:verdana;color:#000000;">On the Site Settings page, under
<strong>Site Collection Administration</strong>, click <strong>Site Collection Features</strong>.
</span><span style="font-size:12px;font-family:verdana;"></span></li><li style="color:#333333;"><span style="font-size:12px;font-family:verdana;"><span style="font-size:12px;color:#000000;">On the Features page, for the
<strong>Open Documents in Client Applications by Default</strong> feature, click <strong>
Activate</strong> (OpenInClient Feature is enabled) to open documents in the client application. Click</span>
<strong><span style="font-size:12px;background-color:yellow;color:#000000;">Deactivate</span></strong><span style="font-size:12px;color:#000000;"> (OpenInClient Feature is disabled) to open documents in the browser.</span>
</span><span style="font-size:12px;font-family:verdana;"></span></li></ol>
<span style="font-size:12px;font-family:verdana;"></span>
<p><span style="font-size:12px;font-family:verdana;">&nbsp;</span></p>
<span style="font-size:12px;font-family:verdana;"></span>
<p><strong><span style="font-size:12px;text-decoration:underline;font-family:verdana;color:#000000;">To set the default open behavior for a document library by using the document library settings page
</span></strong></p>
<span style="font-size:12px;font-family:verdana;"></span>
<ol>
<span style="font-size:12px;font-family:verdana;"></span>
<li style="color:#333333;"><span style="font-size:12px;font-family:verdana;color:#000000;">On the
<strong>&lt;document library&gt;: All Documents</strong> page, under <strong>Library Tools</strong>, click
<strong>Library</strong>. </span><span style="font-size:12px;font-family:verdana;"></span></li><li style="color:#333333;"><span style="font-size:12px;font-family:verdana;color:#000000;">In the library toolbar, click
<strong>Library Settings</strong>. </span><span style="font-size:12px;font-family:verdana;"></span></li><li style="color:#333333;"><span style="font-size:12px;font-family:verdana;color:#000000;">On the
<strong>Document Library Settings</strong> page, click <strong>Advanced Settings</strong>.
</span><span style="font-size:12px;font-family:verdana;"></span></li><li style="color:#333333;"><span style="font-size:12px;font-family:verdana;color:#000000;">On the
<strong>Advanced Settings</strong> page, in <strong>Opening Document in the Browser</strong>, select one of the following options:<br />
<strong>Open in the client application</strong> When a user clicks on a document in this library, the document will open in the corresponding client application (if available).
</span><span style="font-size:12px;font-family:verdana;"></span></li><li style="color:#333333;"><span style="font-size:12px;font-family:verdana;"><strong><span style="font-size:12px;background-color:yellow;color:#000000;">Open in the browser</span></strong><span style="font-size:12px;color:#000000;"> When a user clicks on a
 document in this library, the document will open in the Web browser Web app for that document type. When the document is opened in the Web app, the user can then decide to open the document in the client application
</span></span><span style="font-size:12px;font-family:verdana;"></span></li><li style="color:#333333;"><span style="font-size:12px;font-family:verdana;"><strong><span style="font-size:12px;color:#000000;">Use the server default</span></strong><span style="font-size:12px;color:#000000;"> When a user clicks on a document in this library,
 the document will open by using the default open behavior specified for the server on which SharePoint 2010 Products is installed.</span></span>
<span style="font-size:12px;font-family:verdana;"></span></li></ol>
<span style="font-family:verdana;"></span><span style="font-size:12px;font-family:verdana;"></span>
<p><span style="line-height:115%;font-size:12px;text-decoration:underline;font-family:verdana;"><strong>If the above do not work:</strong></span><span style="font-size:12px;font-family:verdana;"><strong><span style="text-decoration:underline;">
<br />
<br />
</span></strong>You need to invoke the Getshapshot.exe (which is located here: C:\inetpub\wwwroot\wss\VirtualDirectories\80\bin&gt;GetSnapshot.exe)<br />
<br />
*Note: Browse to C:\inetpub\wwwroot\wss\VirtualDirectories\80\bin&gt;GetSnapshot.exe and make sure it is 50/56kb.&nbsp; I have seen instances where is is corrupt 0kb and it needs to be replaced.<br />
<br />
</span><a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/2475.Getsnapshot.png"><span style="font-size:12px;font-family:verdana;"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/2475.Getsnapshot.png" style="border:0px solid currentcolor;" /></span></a><br />
<span style="font-family:verdana;"></span><span style="font-size:12px;font-family:verdana;"><br />
To invoke the Getsnaps"><strong><span style="text-decoration:underline;">
<br />
<br />
</span></strong>You need to invoke the Getshapshot.exe (which is located here: C:\inetpub\wwwroot\wss\VirtualDirectories\80\bin&gt;GetSnapshot.exe)<br />
<br />
*Note: Browse to C:\hot.exe (re-title a workbook) via:</span></p>
<span style="font-size:12px;font-family:verdana;"></span>
<p><span style="line-height:115%;font-size:12px;font-family:verdana;">PowerPivot Gallery &gt; Select a Report &gt; Documents &gt; Edit Properties &gt; Title (give the workbook a title) &nbsp;&nbsp;&nbsp;
</span></p>
<span style="font-size:12px;font-family:verdana;"></span>
<p><a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/3718.Thumbnails.png"><span style="font-size:12px;font-family:verdana;"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/3718.Thumbnails.png" style="border:0px solid currentcolor;" /></span></a><span style="font-size:12px;font-family:verdana;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></p>
<span style="font-size:12px;font-family:verdana;"></span>
<p><span style="font-size:12px;font-family:verdana;">If you have IE9 on SharePoint Server, thumbnails will not render. Uninstall IE9.<br />
<br />
<strong><span style="font-size:12px;color:#ff0000;">Update:</span></strong> This resolves the IE9 issue:</span></p>
<span style="font-size:12px;font-family:verdana;"></span>
<p><span style="font-size:12px;font-weight:bold;font-family:verdana;">Microsoft® SQL Server® 2008 R2 Service Pack 1<br />
</span><a href="http://www.microsoft.com/download/en/details.aspx?id=26727"><span style="font-size:12px;font-weight:bold;font-family:verdana;">http://www.microsoft.com/download/en/details.aspx?id=26727</span></a><span style="font-size:12px;font-family:verdana;"><span style="font-size:12px;font-weight:bold;">
<br />
<br />
</span><strong>IE9 workaround (if you cannot apply the above update):</strong></span></p>
<span style="font-size:12px;font-family:verdana;"></span>
<p><span style="font-size:12px;font-family:verdana;">In %Common Files%\Microsoft Shared\Web Server Extensions\14\Template\Layouts\PowerPivot you will find a file called ASRGLoader.htm.
</span></p>
<span style="font-size:12px;font-family:verdana;"></span>
<p><span style="font-size:12px;font-family:verdana;">Make a copy of the file and call it ASRGLoader.orig.htm (this is so that if you mess up anything you can revert :)</span></p>
<span style="font-size:12px;font-family:verdana;"></span>
<p><span style="font-size:12px;font-family:verdana;">Open asrgloader.html in notepad.
</span></p>
<span style="font-size:12px;font-family:verdana;"></span>
<p><span style="font-size:12px;font-family:verdana;">Search for a function called onXLFrameLoad
</span></p>
<span style="font-size:12px;font-family:verdana;"></span>
<p><span style="font-size:12px;font-family:verdana;">Replace the line<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:12px;font-family:verdana;"><strong>if (ewaFrame.document.readyState == ‘complete’) {<br />
</strong>with the line</span></p>
<span style="font-size:12px;font-family:verdana;"></span>
<p><span style="font-size:12px;font-family:verdana;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:12px;font-family:verdana;">if ( (ewaFrame.document.readyState == ‘complete’) || (ewaFrame.document.readyState == ‘interactive’) ) {<br />
</span></strong></p>
<span style="font-size:12px;font-family:verdana;"></span>
<p style="margin:0in;font-family:cambria;font-size:10pt;"><span style="font-size:12px;font-family:verdana;"><span style="font-family:verdana;font-size:13px;"><strong><span style="text-decoration:underline;">If the above do not work:</span></strong>
</span>You will need to&nbsp;DiasableLoopbackCheck (this is a security from Microsoft, be careful before doing this):</span></p>
<span style="font-size:12px;font-family:verdana;"></span>
<ol>
<span style="font-size:12px;font-family:verdana;"></span>
<li><span style="font-size:12px;font-family:verdana;">Click Start, click Run, type regedit, and then click OK.
</span><span style="font-size:12px;font-family:verdana;"></span></li><li><span style="font-size:12px;font-family:verdana;">In Registry Editor, locate and then click the following registry key: HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa
</span><span style="font-size:12px;font-family:verdana;"></span></li><li><span style="font-size:12px;font-family:verdana;">Right-click Lsa, point to New, and then click DWORD Value.
</span><span style="font-size:12px;font-family:verdana;"></span></li><li><span style="font-size:12px;font-family:verdana;">Type DisableLoopbackCheck, and then press ENTER.
</span><span style="font-size:12px;font-family:verdana;"></span></li><li><span style="font-size:12px;font-family:verdana;">Right-click DisableLoopbackCheck, and then click Modify.
</span><span style="font-size:12px;font-family:verdana;"></span></li><li><span style="font-size:12px;font-family:verdana;">In the Value data box, type 1, and then click OK.
</span><span style="font-size:12px;font-family:verdana;"></span></li><li><span style="font-size:12px;font-family:verdana;">Quit Registry Editor, and then restart your computer.
</span><span style="font-size:12px;font-family:verdana;"></span></li><li><span style="font-size:12px;font-family:verdana;">PowerPivot Gallery &gt; Select a Report &gt; Documents &gt; Edit Properties &gt; Title (give the workbook a title)</span>
<span style="font-size:12px;font-family:verdana;"></span></li></ol>
<span style="font-size:12px;font-family:verdana;"></span>
<p><span style="font-size:12px;font-family:verdana;"><strong><span style="font-size:12px;text-decoration:underline;">Additional Articles:</span></strong><strong>
</strong></span></p>
<span style="font-size:12px;font-family:verdana;"></span>
<p><span style="font-size:12px;font-family:verdana;"><strong><span style="font-size:12px;">Refreshing PowerPivot Gallery thumbnails<br />
</span></strong><strong><span style="font-size:12px;"><a href="http://blogs.msdn.com/b/mtn/archive/2010/10/15/how-to-manually-refresh-powerpivot-gallery-thumbnails.aspx"><span style="font-size:12px;text-decoration:none;color:#0066dd;">http://blogs.msdn.com/b/mtn/archive/2010/10/15/how-to-manually-refresh-powerpivot-gallery-thumbnails.aspx</span></a></span></strong></span></p>
<span style="font-size:12px;font-family:verdana;"></span>
<p><span style="font-size:12px;font-family:verdana;"><strong><span style="font-size:12px;">Snapshots not being taken<br />
</span></strong><strong><span style="font-size:12px;"><a href="http://powerpivotgeek.com/2010/10/24/snapshots-not-being-taken/"><span style="font-size:12px;text-decoration:none;color:#0066dd;">http://powerpivotgeek.com/2010/10/24/snapshots-not-being-taken/</span></a></span></strong></span><span style="font-size:12px;font-family:verdana;"><strong>
<br />
<br />
</strong><span style="font-size:12px;">There is another issue you might see is:</span></span></p>
<span style="font-size:12px;font-family:verdana;"></span>
<p><strong><span style="font-size:12px;font-family:verdana;color:#000000;">Gallery specific issues</span></strong><span style="font-size:12px;font-family:verdana;"><strong>
<br />
</strong><strong><span style="font-size:12px;"><a href="http://powerpivotgeek.com/troubleshooting/gallery-specific-issues/"><span style="font-size:12px;text-decoration:none;color:#0066dd;">http://powerpivotgeek.com/troubleshooting/gallery-specific-issues/</span></a></span></strong></span></p>
<span style="font-size:12px;font-family:verdana;"></span>
<p><a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/4454.clip_5F00_image002.jpg"><span style="font-size:12px;font-family:verdana;"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/4454.clip_5F00_image002.jpg" style="border:0px solid currentcolor;" /></span></a><br />
<span style="font-size:12px;font-family:verdana;"></span><span style="font-size:10px;"><br />
<span style="font-size:12px;font-family:verdana;"></span></span><em><span style="font-size:10pt;color:#000000;"><a href="http://msdn.microsoft.com/en-us/library/ee637435.aspx"><span style="font-size:12px;text-decoration:none;font-family:verdana;color:#333333;">Another
 problem with the Gallery is that a blank thumbnail might be generated and it contains a “lock” icon. In this scenario, GetSnapshot.exe has determined that their might be a possible information disclosure and will not generate the image. This is likely caused
 by one of the following conditions: </span></a></span></em></p>
<span style="font-<span style="font-size:12px;font-family:verdansize:12px;font-family:verdana;"></span>
<p><span style="font-size:10pt;color:#000000;"><a href="http://msdn.microsoft.com/en-us/library/ee637435.aspx"><span style="font-size:12px;text-decoration:none;font-family:verdana;color:#000000;">The workbook might not contain any embedded PowerPivot data.
 If so, a thumbnail will not be generated. </span></a></span></p>
<span style="font-size:12px;font-family:verdana;"></span>
<ol style="list-style-type:decimal;">
<span style="font-size:12px;font-family:verdana;"></span>
<li style="margin:0in 0in 10pt;color:#333333;"><span style="font-size:10pt;color:#000000;"><a href="http://msdn.microsoft.com/en-us/library/ee637435.aspx"><span style="font-size:12px;text-decoration:none;font-family:verdana;color:#000000;">The workbook might
 contain more than one data source. If so, a thumbnail will not be generated. </span>
</a></span><span style="font-size:12px;font-family:verdana;"></span></li><li style="margin:0in 0in 10pt;color:#333333;"><span style="font-size:10pt;color:#000000;"><a href="http://msdn.microsoft.com/en-us/library/ee637435.aspx"><span style="font-size:12px;text-decoration:none;font-family:verdana;color:#000000;">The single data
 source must point (via the “Server=” or “Data source=” property in the connection string) to either (a) the embedded PowerPivot database; or (b) to another workbook (.xlsx) that is contained in the same document library (i.e. the Gallery). If not, a thumbnail
 will not be generated. </span></a></span><span style="font-size:12px;font-family:verdana;"></span></li><li style="margin:0in 0in 10pt;color:#333333;"><span style="font-size:10pt;color:#000000;"><a href="http://msdn.microsoft.com/en-us/library/ee637435.aspx"><span style="font-size:12px;text-decoration:none;font-family:verdana;color:#000000;">If the file is
 a .rdl file, then the data source must be embedded in the report and it must use the PowerPivot OLEDB provider and point to a workbook (.xlsx) that is contained in the same document library (i.e. the Gallery). If not, a thumbnail will not be generated.
</span></a></span><span style="font-size:12px;font-family:verdana;"></span></li></ol>
<span style="font-size:12px;font-family:verdana;"></span>
<p><strong><span style="font-size:10pt;color:#0066dd;"><a href="http://msdn.microsoft.com/en-us/library/ee637435.aspx"><span style="font-size:12px;text-decoration:none;font-family:verdana;color:#000000;"><strong>SQL Server Reporting Services Reports in the
 PowerPivot Gallery<br />
</strong></span></a><a href="http://performancepointblog.com/2009/11/sql-server-reporting-services-reports-in-the-powerpivot-gallery/"><span style="font-size:12px;text-decoration:none;font-family:verdana;color:#0066dd;"><strong>http://performancepointblog.com/2009/11/sql-server-reporting-services-reports-in-the-powerpivot-gallery/</strong></span></a></span></strong><strong><span style="font-size:12px;font-family:verdana;">
</span></strong></p>
<span style="font-size:12px;font-family:verdana;"></span>
<p><span style="font-size:12px;font-family:verdana;color:#333333;"></span><span style="font-size:12px;font-family:verdana;"><strong><span style="font-size:12px;color:#000000;">How to: Use PowerPivot Gallery<br />
</span></strong><span style="font-size:12px;color:#000000;"><a href="http://msdn.microsoft.com/en-us/library/ee637435.aspx"><strong><span style="font-size:12px;text-decoration:none;color:#0066dd;">http://msdn.microsoft.com/en-us/library/ee637435.aspx</span></strong></a></span>
</span></p>
<span style="font-size:12px;font-family:verdana;"></span>
<p><span style="font-size:12px;font-family:verdana;">&nbsp;</span><span style="font-size:10px;"><br />
<span style="font-size:12px;font-family:verdana;"></span></span><a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/4682.Untitled-picture.png"><span style="font-size:12px;font-family:verdana;"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/4682.Untitled-picture.png" style="border:0px solid currentcolor;" /></span></a><span style="font-size:12px;font-family:verdana;">&nbsp;<br />
</span></p>

</div>
    
    
