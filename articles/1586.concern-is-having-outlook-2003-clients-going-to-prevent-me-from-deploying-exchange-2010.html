---
layout: default
title: 'Concern&#58; Is Having Outlook 2003 Clients Going to Prevent Me from Deploying Exchange 2010? - TechNet Articles - United States (English) - TechNet Wiki'
weight: 3
---

<div class="post-content user-defined-markup">

<p><img alt=" " src="http://social.technet.microsoft.com/wiki/contents/resized-image.ashx/__size/550x0/__key/CommunityServer-Wikis-Components-Files/00-00-00-00-05/4212.18_2D00_04_2D00_2010-15_2D00_39_2D00_47.png" style="float:right;border:0px solid;" /></p>
<p><strong>OVERALL STATUS:</strong> <em>No, having Outlook 2003 clients is not a deployment blocker. However, you need to understand the following sections and make configuration changes as applicable.</em></p>
<p>Back since November 9th, 2009 where Exchange Server 2010 released to manufacturing (RTM), there have been a growing concern around whether enterprises are prevented from upgrading or migrating their current Exchange 2003 or Exchange 2007 based messaging
 infrastructure to Exchange 2010, if Outlook 2003 clients is used within the organization.
</p>
<p>The intention with this Wiki page is to list the concerns that we have seen among our customers, partners, and in the miscellaneous Exchange communities.
</p>
<p>As some of you probably recall, we already blogged about some of the <a href="http://msexchangeteam.com/archive/2010/04/23/454711.aspx">
major considerations</a> on the Exchange team blog, but this article includes a few additional concerns and goes into more detail than the blog post.</p>
<p><div class="table-of-contents"><h2 class="title">Table of Contents</h2><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#RPC_Encryption_Requirement">RPC Encryption Requirement</a><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#Current_Status_Non-issue">Current Status: Non-issue</a></li></ul><div class="hierarchy-list-footer"> </div></li><li class="hierarchy-item"><a href="#Exchange_TwentyTen_lack_support_for_UDP_Notifications">Exchange 2010 lack support for UDP Notifications</a><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#Current_Status_Issue_with_mitigation">Current Status: Issue with mitigation</a></li></ul><div class="hierarchy-list-footer"> </div></li><li class="hierarchy-item"><a href="#Opening_multiple_shared_calendars_amp_additional_mailboxes">Opening multiple shared calendars &amp; additional mailboxes</a><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#Current_Status_Issue_with_mitigation">Current Status: Issue with mitigation</a></li></ul><div class="hierarchy-list-footer"> </div></li><li class="hierarchy-item"><a href="#Adding_multiple_shared_calendars_amp_additional_mailboxes">Adding multiple shared calendars &amp; additional mailboxes</a></li><li class="hierarchy-item"><a href="#Current_Status_Issue_with_mitigation">Current Status: Issue with mitigation</a></li><li class="hierarchy-item"><a href="#Viewing_and_Modification_of_Delegate_Information">Viewing and Modification of Delegate Information</a><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#Current_Status_Issue_with_mitigation">Current Status: Issue with mitigation</a></li></ul><div class="hierarchy-list-footer"> </div></li><li class="hierarchy-item"><a href="#Exchange_TwentyTen_Public_Folder_Database_requirement">Exchange 2010 Public Folder Database requirement</a><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#Current_Status_Issue_with_mitigation">Current Status: Issue with mitigation</a></li></ul><div class="hierarchy-list-footer"> </div></li><li class="hierarchy-item"><a href="#Offline_Address_Book_OAB">Offline Address Book (OAB)</a><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#Current_Status_Issue_with_mitigation">Current Status: Issue with mitigation</a></li></ul><div class="hierarchy-list-footer"> </div></li><li class="hierarchy-item"><a href="#Exchange_Server_name_appears_as_Instance-lt_GUID_gt">Exchange Server name appears as
 Instance-&lt;GUID&gt;</a><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#Current_Status_Issue_no_mitigation">Current Status: Issue - no mitigation</a></li></ul><div class="hierarchy-list-footer"> </div></li><li class="hierarchy-item"><a href="#RPC_over_HTTP_Connectivity">RPC over HTTP Connectivity</a><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#Current_Status_Issue_with_mitigation">Current Status: Issue with mitigation</a></li></ul><div class="hierarchy-list-footer"> </div></li><li class="hierarchy-item"><a href="#Unified_Communications">Unified Communications</a><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#Current_Status_Issue_ndash_no_mitigation">Current Status: Issue – no mitigation</a></li></ul><div class="hierarchy-list-footer"> </div></li></ul><div class="hierarchy-list-footer"> </div></div> <br />
<br />
</p>
<hr />
<h2><a name="RPC_Encryption_Requirement"></a><strong>RPC Encryption Requirement</strong></h2>
<h4><a name="Current_Status_Non-issue"></a><strong>Current Status:</strong> Non-issue
</h4>
<p><strong>Exchange 2010 SP1</strong><br />
With Exchange 2010 RTM, the RPC encryption requirement was an issue with mitigation. However, in Exchange Server 2010 Service Pack 1, the RPC encryption requirement has been disabled by default. This means that any new Exchange 2010 SP1 Client Access Servers&nbsp;(CAS)&nbsp;deployed
 in the organization won&#39;t require encryption and Outlook 2003 clients will connect without the need to enable the RPC encryption feature in the Outlook profile.
</p>
<span style="line-height:115%;font-size:9pt;font-family:&#39;segoe ui&#39;,sans-serif;color:#333333;"><br />
<table cellspacing="0" cellpadding="0" style="width:100%;border-collapse:collapse;">
<tbody>
<tr>
<th style="text-align:left;padding-bottom:5px;background-color:#c0c0c0;padding-left:5px;padding-top:5px;">
<img alt="note" src="http://apfhrw.bay.livefilestore.com/y1pCed6u9dxDV3LOdzgtYt8xFaDWmIf_thMiOiFb3SmUARdxwIei5b6sPCHGruZWYphrJEU8j2BZEd51ZoAkp_ONkG8moMODvLC/Note.gif" />
<strong>Note</strong> </th>
</tr>
<tr>
<td style="background-color:#f0f0f0;padding-left:5px;">
<p><span style="font-size:12px;">Having the RPC encryption requirement on an Exchange 2010 CAS server disabled doesn&#39;t lower the security between Outlook 2007/2010 and any Exchange 2010 CAS server. RPC communication for these Outlook versions will remain encrypted
 as long as the client has the RPC encryption feature enabled. It&#39;s only the requirement itself that is disabled on the Exchange 2010 CAS server.</span></p>
</td>
</tr>
</tbody>
</table>
</span><strong><span style="line-height:115%;font-size:9pt;font-family:&#39;segoe ui&#39;,sans-serif;color:#333333;"></span></strong>
<p>Exchange 2010 CAS servers&nbsp;deployed prior to Service Pack 1, or upgraded to Service Pack 1, will retain the existing RPC encryption requirement setting.
</p>
<p>&nbsp;</p>
<p><strong>Exchange 2010 RTM</strong><br />
When upgrading or migrating an organization that fully or partly uses Outlook 2003 to Exchange 2010, we hear there are out of the box problems, when trying to connect an Outlook 2003 client to an Exchange 2010 RTM mailbox? We heard this is because an Exchange
 2010 RTM Client Access Server by default requires an Outlook client to support RPC encrypted traffic in order to be able to connect.</p>
<p>While it’s true the default configuration of an Outlook 2003 client doesn’t have support for RPC encryption, this requirement is fully supported with Outlook 2003.
</p>
<p>There are two methods that can be used in order to have Outlook 2003 clients connect to an Exchange 2010 RTM mailbox:
</p>
<p><strong>Method 1: Enable the RPC encryption support in Outlook 2003</strong></p>
<p>If “Encrypt data between Microsoft Office Outlook and Microsoft Exchange Server” is enabled under the “Security” tab in the Outlook 2003 profile (see
<strong>figure 1</strong>), the client will be able to connect to an Exchange 2010 RTM mailbox.</p>
<p><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/CommunityServer-Wikis-Components-Files/00-00-00-00-05/7180.Fig_5F00_1.jpg" style="border:0px solid;" /><strong><br />
Figure 1:</strong> RPC Encryption enabled in Outlook 2003 </p>
<p>If you are working with or for a small organization, it may be acceptable the end user enables this feature manually, but if you have thousands of users in the organization, you would want to enable it using a group policy (GPO). The steps necessary to implement
 a GPO to enable this setting are included in <a href="http://support.microsoft.com/kb/2006508">
this KB article</a>.</p>
<p><strong><br />
Important</strong><br />
The “<strong>EnableRPCEncryption</strong>” registry key mentioned in the KB article was originally introduced via a hotfix for Outlook 2003 SP2. This means that clients that either runs Outlook 2003 SP2 or an older version of Outlook 2003 doesn’t respect this
 registry key. In addition, Outlook 2003 clients not running SP3 are not supported by Microsoft.</p>
<p>&nbsp;</p>
<p><strong>Method 2: Disable the RPC Encryption requirement on the Client Access Servers</strong></p>
<p>Instead of enabling support for RPC encryption in the Outlook 2003 profiles, you also have the option of disabling the requirement for RPC encryption on all Exchange 2010 RTM Client Access Servers in the organization.</p>
<p>This can be accomplished using the <strong><em>Set-RpcClientAccess</em></strong> cmdlet:
</p>
<p><strong>Set-RpcClientAccess –Server </strong><em>Exchange_server_name</em><strong> –EncryptionRequired $False</strong></p>
<p><strong><strong><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/CommunityServer-Wikis-Components-Files/00-00-00-00-05/5265.Fig_5F00_2.jpg" style="border:0px solid;" /></strong><br />
Figure 2:</strong> RPC Encryption requirement disabled on Exchange 2010 CAS servers</p>
<p>As mentioned earlier Exchange 2010 SP1 servers that hasn&#39;t been upgraded from Exchange 2010 RTM has the RPC encryption requirement disabled by default.
</p>
<p>The following KB article describes the symptoms and remediation in detail: </p>
<ul>
<li><a href="http://support.microsoft.com/kb/2006508">Outlook connection issues with Exchange 2010 mailboxes because of the RPC encryption requirement</a>
</li></ul>
<p>The core Exchange 2010 TechNet documentation also describes the configuration that can be used to remediate the issue:
</p>
<ul>
<li><a href="http://technet.microsoft.com/en-us/library/ee332317.aspx">Understanding RPC Client Access</a>
</li></ul>
<span style="line-height:115%;font-size:9pt;font-family:&#39;segoe ui&#39;,sans-serif;color:#333333;"><br />
<table cellspacing="0" cellpadding="0" style="width:100%;border-collapse:collapse;">
<tbody>
<tr>
<th style="text-align:left;padding-bottom:5px;background-color:#c0c0c0;padding-left:5px;padding-top:5px;">
<img alt="note" src="http://apfhrw.bay.livefilestore.com/y1pCed6u9dxDV3LOdzgtYt8xFaDWmIf_thMiOiFb3SmUARdxwIei5b6sPCHGruZWYphrJEU8j2BZEd51ZoAkp_ONkG8moMODvLC/Note.gif" />
<strong>Note</strong> </th>
</tr>
<tr>
<td style="background-color:#f0f0f0;padding-left:5px;">
<p><span style="font-size:12px;">Unmanaged client machines cannot be controlled using GPOs or login scripts. If you have unmanaged machines connecting to Exchange 2010 using Outlook 2003, one solution would be to send those users a script or a registry file
 which they can run manually on their machine to enable the RPC encryption setting.</span></p>
</td>
</tr>
</tbody>
</table>
</span><strong><span style="line-height:115%;font-size:9pt;font-family:&#39;segoe ui&#39;,sans-serif;color:#333333;"></span></strong>
<p><strong></strong></p>
<hr />
<h2><a name="Exchange_TwentyTen_lack_support_for_UDP_Notifications"></a>Exchange 2010 lack support for UDP Notifications</h2>
<h4><a name="Current_Status_Issue_with_mitigation"></a><strong>Current Status:</strong> Issue with mitigation
</h4>
<br />
<p><strong>Important News</strong></p>
<p><span style="background-color:#ffff00;">With Exchange 2010 SP1 RU3, UDP notifications has been re-added to Exchange 2010. This means that the below symptoms will be resolved once Exchange 2010 SP1 RU3 is applied in your Exchange 2010 SP1 environment. Roll-up
 update 3 for Exchange 2010 SP1 can be downloaded <a href="http://www.microsoft.com/downloads/en/details.aspx?FamilyID=413b8979-76b8-4be4-a18b-015d025eb368&amp;displaylang=en" target="_blank">
here</a>.</span><span style="background-color:#ffff00;"> Read more about how UDP support is enabled in the following KB article:
</span><a href="http://support.microsoft.com/?kbid=2511471" target="_blank" style="background-color:#ffff00;">Folders take a long time to update when an Exchange Server 2010 user uses Outlook 2003 in online mode</a><span style="background-color:#ffff00;">.<br />
</span><br />
<br />
<span style="background-color:#92d050;"><strong>A Further Update<br />
</strong>With Exchange 2010 Sp2 a lot of work was done to improve the UDP notification mechanism (which was added back as per the above news), this was done to improve the coexistence story with&nbsp;Outlook 2003 further. If you are planning to deploy Exchange 2010
 in an environment with older Outlook clients i.e. 2003, ensure that you are running Exchange 2010&nbsp;Sp2 &#43; latest&nbsp;RU. This will ensure the best possible experience and that none of the keys mentioned below are required. With 2010 Sp2 in place, the experience
 is as optimal as possible, however you do need to enable the UDP notifications by setting the
<span style="font-family:tahoma;font-size:13px;">EnablePushNotifications</span> key. This is discussed in detail in the following KB article;
<a href="http://support.microsoft.com/kb/2009942">http://support.microsoft.com/kb/2009942</a><br />
</span></p>
<p>With Exchange Server 2010, there is no longer support for User Datagram Protocol (UDP) notifications. When opening a mailbox using Outlook 2003, Outlook 2003 tries to register itself to receive new message notifications. By default Outlook 2003 tried to
 register for UDP notifications but since this notification method isn’t supported with Exchange 2010, Outlook 2003 will instead revert to polling the Exchange server for changes in the mailbox. Despite the fact that Outlook 2003 initiates the polling behavior,
 the Exchange server will dictate the polling frequency. By default Outlook 2003 polls the Exchange server every 60 seconds.
</p>
<p>Since Exchange 2010 doesn’t support UDP based notifications, Outlook 2003 won’t be able to register itself using this method, which means changes made to any of the folders in the mailbox won’t be reflected before Outlook 2003 polls the Exchange server for
 changes. The result of this is that notifications about new messages etc. will be reflected in the Outlook 2003 client with delays of up to 60 seconds.<br />
More specifically, you will see the following symptoms: </p>
<ul>
<li>Outgoing e-mail messages stay in the Outbox for up to 1 minute </li><li>New e-mail messages do not arrive in the Inbox for up to 1 minute </li><li>Items that are deleted from folders do not disappear from the folder for up to 1 minute
</li><li>Items&nbsp;that are moved from one folder to another folder take up to 1 minute to disappear from the original&nbsp;folder
</li></ul>
<p>Two methods exist to remediate the polling issue described above:</p>
<p><strong>Method 1: Change the Polling Frequency</strong></p>
<p>The issue can be remediated by installing Exchange 2010 Service Pack 1 which includes support for a new registry key that can be used to lower the polling frequency to 5 seconds.</p>
<p><img alt=" " src="http://social.technet.micrososerver for
 changes. The result of this is that notifications about new messages etc. will be reflected in the Outlook 2003 client with delays of up to 60 seconds.<br />
More specifically, you will see the following symptoms: </p>
<ul>
<li>Outgoing e-mail messages stay in the Outbox for up to 1 minute </li><li>New e-mail messages do not arrive in the Inbox for up to 1 minute </li><li>Items that are deleted from folders do not disappear from the folder for up to 1 minute
</li><li>Items&nbsp;that are moved from one folder to another folder take up to 1 minute to disappear from the original&nbsp;folder
</li></ul>
<p>Two methods exist to remediate the polling issue described above:</p>
<p><strong>Method 1: Change the Polling Frequency</strong></p>
<p>The issue can be remediated by installing Exchange 2010 Service Pack 1 which includes support for a new registry key that can be used to lower the polling frequency to 5 seconds.</p>
<p><img alt=" ft.com/wiki/resized-image.ashx/__size/550x0/__key/CommunityServer-Wikis-Components-Files/00-00-00-00-05/1212.Fig_5F00_10.jpg" style="border:0px solid;" /><strong><br />
Figure 3:</strong> Lowering the polling frequency value</p>
<p><strong>Note</strong> <br />
The registry key doesn’t reinstate UDP in Exchange 2010; it only lowers the polling frequency.
</p>
<p>&nbsp;</p>
<p><strong>Method 2: Enable Cached Mode in Outlook 2003 Clients</strong></p>
<p>The cached mode synchronization process uses a different architecture to update folders versus Outlook 2003 clients in online mode. So another option is to enable cached mode for all Outlook 2003 clients within the organization.
</p>
<p>The following KB article describes the symptoms and remediation in detail: </p>
<ul>
<li>
<p><span style="font-size:x-small;"><a href="http://support.microsoft.com/kb/2009942"><span style="font-size:small;font-weight:normal;">In Outlook 2003, e-mail messages take a long time to send and receive when you use an Exchange 2010 mailbox</span></a></span></p>
</li></ul>
<hr />
<h2><a name="Opening_multiple_shared_calendars_amp_additional_mailboxes"></a>Opening multiple shared calendars &amp; additional mailboxes</h2>
<h4><a name="Current_Status_Issue_with_mitigation"></a><strong>Current Status:</strong> Issue with mitigation
</h4>
<p>Exchange 2010 SP1 together with the resolutions mentioned later in this section, allows you to open as many as 16 shared calendars or additional mailboxes simultaneously independent on whether the mailboxes are located on Exchange 2003, 2007, or 2010. If
 you have more than 16 calendars or additional mailboxes opened, you may randomly see error message similar to the one shown in
<strong>Figure 4</strong>.<br />
<strong></strong></p>
<p><strong><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/CommunityServer-Wikis-Components-Files/00-00-00-00-05/6560.Fig_5F00_3.jpg" style="border:0px solid;" /><br />
Figure 4:</strong> Error message when opening more than 16 calendars </p>
<p>With Exchange Server 2010 RTM deployed into an Exchange 2003 or Exchange 2007 organization, it was a common issue that when an Exchange 2003 or Exchange 2007 user tried to open more than two additional Exchange 2010 mailboxes or shared calendars using Outlook
 2003, she would receive one of the following error messages:</p>
<ul>
<li>The set of folders could not be opened </li><li>The information store could not be opened </li><li>Unable to display the folder. The information store could not be opened </li></ul>
<p>When an Exchange 2007 user tried to send an e-mail using Outlook 2003, she would sometimes also receive the following error message:
</p>
<ul>
<li>Task ‘Microsoft Exchange Server – Sending’ reported error (0x800C8100): ‘Unknown Error 0x800c8100’
</li></ul>
<p>These issues were resolved with Update Rollup 2 for Exchange 2007 Service Pack 2 and a hotfix that were released for Exchange 2003 SP2. More information about the issues and how they are resolved can be found in the following KB articles:
</p>
<ul>
<li><a href="http://support.microsoft.com/kb/978777" target="_blank">Office Outlook 2003 does not connect to two or more additional mailboxes in a mixed Exchange Server 2007 and Exchange Server 2010 environment</a>
</li><li><a href="http://support.microsoft.com/kb/979690" target="_blank">An error occurs when an Exchange server 2003 user tries to open more than one delegate mailbox of Exchange Server 2010 in Outlook 2003</a>
</li></ul>
<ul>
</ul>
<p>Although the above mentioned issues were resolved, some customers, partners, and individuals in the Exchange communities reported they still experienced issues when trying to open approximately multiple shared calendars and/or additional mailboxes using
 Outlook 2003. </p>
<p>For most organizations, the issue can be remediated by installing Exchange 2010 SP1 as this service pack includes a fix that makes it possible for an Exchange 2003, 2007, or 2010 user to open as many as approximately 16 shared calendars or additional mailboxes
 using Outlook 2003.</p>
<p><strong><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/CommunityServer-Wikis-Components-Files/00-00-00-00-05/2234.Fig_5F00_4.jpg" style="border:0px solid;" /><br />
Figure 5:</strong> By default approximately 16 Calendars can be opened using Outlook 2003
</p>
<p>If you have users that needs to open more than 16 shared calendars or additional mailboxes using Outlook 2003, you can adjust the RPC related throttling policy settings using the
<a href="http://technet.microsoft.com/en-us/library/dd298094.aspx">Set-ThrottlingPolicy</a> cmdlet. Specifically, you need to increase the value for “RCAMaxConcurrency” which by default is set to “20”. The
<em>RCAMaxConcurrency</em><em> </em>parameter indicates how many concurrent connections an RPC Client Access user can have against a server running Exchange&nbsp;2010 at one time.</p>
<p><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/CommunityServer-Wikis-Components-Files/00-00-00-00-05/4278.Fig_5F00_5.jpg" style="border:0px solid;" /><strong><br />
Figure 6:</strong> Default setting for the RCAMaxConcurrency throttling policy value
</p>
<p>For instance, to increase the value of the “RCAMaxConcurrency” setting in the default throttling policy from 20 to 30, open the Exchange Management Shell and run the following command to first create a variable for the policy:
</p>
<p><strong><em>$a = Get-ThrottlingPolicy | where-object {$_.IsDefault -eq $true}</em></strong>
</p>
<p>Then pipe the variable to the Set-ThrottlingPolicy commandlet: </p>
<p><strong><em>$a | Set-ThrottlingPolicy -RCAMaxConcurrency 30</em></strong></p>
<p><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/CommunityServer-Wikis-Components-Files/00-00-00-00-05/0268.Fig_5F00_6.jpg" style="border:0px solid;" /><strong><br />
Figure 7:</strong> Increasing the value for the RCAMaxConcurrency throttling policy setting
</p>
<p>In order to apply the changes, restart the “Microsoft Exchange Throttling” service on each CAS server in the organization.
</p>
<p>You can read more about Exchange 2010 SP1 throttling policies in <a href="http://technet.microsoft.com/en-us/library/dd297964.aspx">
the Exchange 2010 documentation</a> on Microsothe Exchange Management Shell and run the following command to first create a variable for the policy:
</p>
<p><strong><em>$a = Get-ThrottlingPolicy | where-object {$_.IsDefault -eq $true}</em></strong>
</p>
<p>Then pipe the variable to the Set-ThrottlingPolicy commandlet: </p>
<p><strong><em>$a | Set-ThrottlingPolicy -RCAMaxConcurrency 30</em></strong></p>
<p><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/CommunityServer-Wikis-Components-Files/00-00-00-00-05/ft TechNet. </p>
<p>If you still have issues opening shared calendars or additional mailboxes, you may want to increase the value of the&nbsp;RCAMaxConcurrency throttling policy setting to 100 or even higher. Read more in
<a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;2299468&amp;sd=rss&amp;spid=13965" target="_blank">
Error message when Outlook 2003 clients try to open multiple shared calendars in Exchange Server 2010: &quot;The connection to the Microsoft Exchange server in unavailable. Outlook must be online or connected to complete this action&quot;</a>.</p>
<p>If you see event 4696 with a description similar to the following logged in the application log on the Mailbox servers in the organization:</p>
<p><em><span style="font-size:9pt;font-family:&#39;segoe ui&#39;,sans-serif;">&quot;Mapi session &quot;00cc8dde-64d7-4353-8050-00fc2057aae3: /O=xxxx/OU=xxxx/cn=Recipients/cn=John&quot; exceeded the maximum of 32 objects of type &quot;session&quot;.&quot;</span></em></p>
You need to increase the maximum allowed sessions per user and/or maximum allowed service sessions per user limit from &quot;32&quot; to &quot;64&quot; or even higher. See more information at:&nbsp;<a href="http://technet.microsoft.com/en-us/library/ff477612.aspx">http://technet.microsoft.com/en-us/library/ff477612.aspx</a>.<br />
<br />
Finally it should be mentioned that in some cases it is necessary to run “Outlook.exe /resetnavpane” on the affected machines running Outlook 2003. Bear in mind, that this switch will removed any shared calendars from the profile so these must be added manually
 afterwards.<br />
<hr />
<h2><a name="Adding_multiple_shared_calendars_amp_additional_mailboxes"></a><span style="font-size:20px;font-family:&#39;segoe ui&#39;;"><strong>Adding multiple shared calendars &amp; additional mailboxes</strong></span></h2>
<h2><a name="Current_Status_Issue_with_mitigation"></a><span style="font-size:16px;">Current Status: Issue with mitigation
</span></h2>
<p><span>In some cases you may have an issue adding shared calendars or additional mailboxes to an Outlook profile and is presented with the following dialog box.</span></p>
<p><span></span><span><a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/4604.Unable-to-display.jpg"><img alt=" " width="378" height="91" src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/4604.Unable-to-display.jpg" style="border:0px solid;" /></a><br />
<strong>Figure 8:</strong> Unable to display folder when adding shared calendar or additional mailbox</span></p>
<p><span>This may occur even when you have increased the throttling limit for “<strong><em>RcaMaxConcurrency</em></strong>” as well as added the maximum allowed sessions per user and/or maximum allowed service sessions per user limits.</span></p>
<p><span>A network trace using NetMon on the client where a user tries to add a shared calendar or additional mailbox shows that a DNS query for “<strong><em>Instance-GUID.contoso.com</em></strong>” is performed against a Global Catalog server in the Active
 Directory domain.</span></p>
<p><span></span><strong><span><a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/1460.NetMon3.JPG"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/1460.NetMon3.JPG" style="border:0px solid;" /></a><br />
Figure 9:</span></strong><span> DNS Query against </span></p>
<p><span>The response from the Global Catalog server returns a “<strong><em>Name Error</em></strong>” as shown in
<strong>Figure 10</strong> as the <strong><em>&lt;Instance- GUID&gt;</em></strong> cannot be resolved to the respective user’s alias.</span></p>
<p><span><a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/0268.NetMon4.JPG"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/0268.NetMon4.JPG" style="border:0px solid;" /></a><br />
</span><strong><span>Figure 10:</span></strong><span> DNS returns Name Error</span></p>
<p>To fix this issue, install the Outlook 2003 hotfix mentioned in <a href="http://support.microsoft.com/kb/2510153">
this</a> KB article.</p>
<p>&nbsp;</p>
<hr />
<h2><a name="Viewing_and_Modification_of_Delegate_Information"></a>Viewing and Modification of Delegate Information</h2>
<h4><a name="Current_Status_Issue_with_mitigation"></a><strong>Current Status:</strong> Issue with mitigation</h4>
<p>&nbsp;</p>
<p><span style="font-size:12px;"><span style="font-size:12px;">When reviewing or modifying delegate information via
<strong>Tools&gt;Options</strong> and choosing the <strong>Delegates</strong> tab, Outlook 2003 may exhibit some or all of the following symptoms:</span><br />
</span></p>
<p>&nbsp;</p>
<ul>
<li><span style="font-size:12px;">Choosing the Delegates tab causes Outlook 2003 to stop responding for upwards of 30 seconds to&nbsp;2 minutes&nbsp;before displaying information.</span>
</li><li><span style="font-size:12px;">When saving delegate information, Outlook 2003 stops responding for upwards of 30 seconds to 2 minutes&nbsp;before closing the
<strong>Options</strong> window.</span> </li><li><span style="font-size:12px;">The message &quot;Requesting data from the Exchange Server&quot; pop-up notification is displayed to the user.</span>
</li></ul>
<p>&nbsp;</p>
<p><span style="font-size:12px;"><span style="font-size:12px;"><span style="font-size:12px;">In previous versions of Exchange Server, the Outlook Client talked directly to a Global Catalog server after a DSProxy referral. In Exchange Server 2010, the Client Access
 Service runs the Address Book Service which provides the NSPI endpoint that Outlook clients connect to for accessing directory information.</span><br />
<br />
This issue is caused by the method Outlook 2003 requests data from the Address Book Service on the Client Access Serv<span style="font-size:12px;">er.
<span style="font-size:12px;">The issue is corrected in current versions of Outlook 2007 and 2010, but will not be corrected in Outlook 2003.</span></span><br />
</span><br />
The workaround to this issue is to limit which users should be delegates on mailboxes, and grant general calendar sharing permissions via the following method, which is also applicable to other Outlook folders.<br />
</span></p>
<p>&nbsp;</p>
<ol>
<li>Right-click the <strong>Calendar</strong> folder, and then click <strong>Properties</strong>.
</li><li>Click the <strong>Permissions</strong> tab. </li><li>Click <strong>Add</strong>. </li><li>Click the name of the user who you want to grant permissions to, click <strong>
Add</strong>, and then click <strong>OK</strong>. </li><li>In the <strong>Name</strong> box, click the user name, and then choose the permission level, for example
<strong>Editor</strong> in the<strong> Permission Level</strong> box. </li><li>Click <strong>Apply</strong>, and then click <strong>OK</strong>. </li></ol>
<p>&nbsp;</p>
<p>Methods to force Outlook 2003&nbsp;to contact a Global Catalog server directly are published in the Microsoft Knowledge Base article
<a href="http://support.microsoft.com/kb/319206" target="_blank"><strong>KB319206, How to configure Outlook to a specific global catalog server or to the closest global catalog server</strong></a>. This technique is not supported with Exchange Server 2010 unless
 advised to do so by a Microsoft support representative.</p>
<hr />
<h2><a name="Exchange_TwentyTen_Public_Folder_Database_requirement"></a>Exchange 2010 Public Folder Database requirement</h2>
<h4><a name="Current_Status_Issue_with_mitigation"></a><strong>Current Status:</strong> Issue with mitigation
</h4>
<p>Unlike Outlook 2007 and 2010, Outlook 2003 clients rely on public folders. If a public folder database doesn’t exist, Outlook 2003 users will be blocked from connecting to their Exchange 2010 mailbox and receive the error message shown in
<strong>Figure 11</strong>.</p>
<p><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/CommunityServer-Wikis-Components-Files/00-00-00-00-05/6305.Fig_5F00_7.jpg" style="border:0px solid;" /><strong><br />
Figure 11:</strong> Error message when an Outlook 2003 user connects to an Exchange 2010 mailbox
</p>
<p>There are several reasons why a public folder database is required for Outlook 2003 client. First, Outlook 2003 in cached mode uses the “OFFLINE ADDRESS BOOK” system folder to download the offline address book (OAB) and the “SCHEDULE&#43; FREE BUSY” to retrieve
 and update free/busy information.</p>
<p><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/CommunityServer-Wikis-Components-Files/00-00-00-00-05/1638.Fig_5F00_8.jpg" style="border:0px solid;" /><strong><br />
Figure 12:</strong> Offline Address Book and Schedule&#43; Free Busy system folders </p>
<p>Second, if you’re installing Exchange 2010 into an existing Exchange organization running Exchange 2007, it’s important you add the Exchange 2010 public folder database to the replica list of the “SCHEDULE&#43; FREE BUSY” folder. If this step isn’t completed,
 users who use Outlook 2003 cannot publish their free/busy data in Exchange Server 2010. Instead hash marks appear in the free/busy data for these users. More information as well as the steps that can be used to remediate this issue can be found in the following
 KB article: </p>
<ul>
<li><a href="http://support.microsoft.com/kb/945602">Users who use Outlook 2003 cannot publish their free/busy data in Exchange Server 2010 or in Exchange Server 2007</a>
</li></ul>
<hr />
<h2><a name="Offline_Address_Book_OAB"></a>Offline Address Book (OAB)</h2>
<h4><a name="Current_Status_Issue_with_mitigation"></a><strong>Current Status:</strong> Issue with mitigation
</h4>
<p>If the client machine on which Outlook 2003 is installed has been configured to use a proxy server, you must enable &quot;Bypass proxy server for local addresses&quot; under Internet Options &gt; Connections &gt; LAN settings or add the CAS server or CAS arrays to the exception
 list shown in <strong>Figure 13</strong>.</p>
<p><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/CommunityServer-Wikis-Components-Files/00-00-00-00-05/7446.Fig_5F00_9.jpg" style="border:0px solid;" /><strong><br />
Figure 13:</strong> Proxy server settings in Internet Explorer </p>
<p>If a proxy server is used in the organization and you haven’t done one of the following:
</p>
<ul>
<li>Enabled “Bypass proxy server for local addresses” </li></ul>
<ul>
<li>Added the CAS server or CAS array to the “Exceptions list” </li></ul>
<p>The Outlook 2003 clients will get an error when trying to download the offline address book (OAB). For more information about the error messages and the steps necessary to remediate the issue, see the following KB article:
</p>
<ul>
<li><a href="http://support.microsoft.com/kb/939765">Error message when Outlook synchronizes an offline address book with Exchange Server 2007 and Exchange Server 2010: &quot;0x8004010F&quot;</a>
</li></ul>
<p><strong><br />
Note<br />
</strong>This issue also affects Outlook 2007 and 2010 clients. </p>
<p>Outlook 2003 clients will also receive an error message when trying to download the OAB if the correct OAB hasn’t been specified for the Exchange 2010 database(s). For more information and steps required to remediate this issue, see the following KB article:
</p>
<ul>
<li><a href="http://support.microsoft.com/kb/905813">An error occurs when you try to synchronize the offline address list on an Exchange Server server while you are using Outlook 2003: &quot;0x8004010F&quot;</a>
</li></ul>
<hr />
<h2><a name="Exchange_Server_name_appears_as_Instance-lt_GUID_gt"></a><strong>Exchange Server name appears as
</strong><strong>Instance-&lt;GUID&gt;</strong> </h2>
<h4><a name="Current_Status_Issue_no_mitigation"></a><strong>Current Status:</strong> Issue - no mitigation
<br />
<br />
</h4>
<p><strong>Important News</strong></p>
<span style="background-color:#ffff00;">A hotfix for Outlook 2003 has been released to resolve this issue. For more information, see<a href="http://support.microsoft.com/kb/2510153" target="_blank"> this</a> KB article.</span><br />
<br />
<p>A few customers, partners, and individual folks in the Exchange community have reported that a few of the Exchange 2010 users running Outlook 2003 randomly have issues connecting to their mailbox. After examining the mail profile in Outlook 2003, you can
 see the Exchange server name appears as <strong><em>Instance-&lt;GUID&gt;</em></strong> where &lt;GUID&gt; is a randomly generated GUID (or number). Re-resolving (&#39;Check Name&#39;) the appropriate server name in the Outlook mail profile resolves the issue.</p>
<p><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/CommunityServer-Wikis-Components-Files/00-00-00-00-05/2248.FIg_5F00_11.jpg" style="border:0px solid;" /><br />
<strong>Figure 14:</strong> Instance-GUID issue in Outlook 2003</p>
<p>&nbsp;</p>
<p><strong>Note</strong><br />
Seeing <strong><em>Instance-&lt;GUID&gt;</em></strong> in conversation between an Outlook 2003 client and an Exchange 2010 server is normal (when
<strong><em>Instance-&lt;GUID&gt;</em></strong> appears inside Outlook in the folders list view on left hand side); It does NOT mean you are hitting this particular issue. You experience this issue if the Outlook mail profile gets updated to refer to the Exchange
 server as Instance-GUID.</p>
<p>&nbsp;</p>
<p>The problem behavior can be triggered by networking issues, patch applications, server reboots, etc. It requires Outlook 2003 to lose connectivity to Exchange and have a delegate mailbox logon attempted on a connection before the primary mailbox logon is
 attempted on that connection. This can affect users who are accessing shared mailboxes or folders of other users from their Outlook 2003 while connecting to Exchange 2010.
</p>
<p>Currently there is no proper resolution available for this issue. However, to remediate this issue temporarily, simply re-resolve the Exchange server name in the Outlook mail profile. If possible, you may also remove the shared mailboxes or shared folders
 (like calendars) from the profile, preventing this issue from occurring in the future or create a new mail profile in Outlook.
</p>
<p>Microsoft is working to investigate this issue for a fix. You can contact Microsoft Support to report this issue and request further assistance. Currently no KB article exists for this issue.
</p>
<hr />
<h2><a name="RPC_over_HTTP_Connectivity"></a><strong>RPC over HTTP Connectivity </strong>
</h2>
<h4><a name="Current_Status_Issue_with_mitigation"></a><strong>Current Status:</strong> Issue with mitigation
</h4>
<p>In some situations Outlook 2003 users connecting to an Exchange mailbox using RPC over HTTP receive the following error message:
</p>
<p><strong><em>“Server Unavailable”</em></strong> </p>
<p>Although this is an Outlook 2003 specific client issue, the issue is not specific for Exchange 2010 organizations. It could also appear in organizations running Exchange 2003 or 2007.
</p>
<p>The problem occurs if the RPC proxy server extensions do no load correctly. You can find more details and a description of how the issue can be remediated in the following KB article:
</p>
<ul>
<li><a href="http://support.microsoft.com/kb/919092">Error message when Outlook 2003 users connect to an Exchange server by using RPC over HTTP: &quot;Server Unavailable&quot;</a>
</li></ul>
<hr />
<h2><a name="Unified_Communications"></a><strong>Unified Communications</strong></h2>
<h4><a name="Current_Status_Issue_ndash_no_mitigation"></a><strong>Current Status:</strong> Issue – no mitigation
</h4>
<p>If the organization uses Office Communications Server (OCS), users running Outlook 2003 would the free/busy information for a meeting will not reflect in the Office Communicator client. This means that if a meeting is scheduled for a user, this isn’t showed
 via the Office Communicator presence status. For more details around this specific issue, see the following KB article:
</p>
<ul>
<li><a href="http://support.microsoft.com/kb/941103">Communicator does not update the free/busy information as scheduled</a>
</li></ul>
<p>This issue can only be remediated by upgrading clients to Outlook 2007 or later.
</p>
<p>In addition to the above issue, the presence information for a Microsoft Office Communications Server user may not appear, or may appear intermittently. This issue is not specific to Outlook 2003 but can also occur to Outlook 2007 and 2010 users. The behavior
 occurs when a user&#39;s Session Initiation Protocol (SIP) Uniform Resource Identifier (URI) does not match the user&#39;s primary email address or when the user has multiple email addresses and can be remediated by adding a SIP proxy address in Exchange for the user
 account that specifies the user’s SIP URI. In addition, when Outlook 2003 is used two registry entries must be added to the machines on which Outlook 2003 is installed. For more details around how this issue can be remediated, see the following KB article:
</p>
<ul>
<li><a href="http://support.microsoft.com/kb/968099" target="_blank">The presence information for a Communications Server user may not appear, or may appear intermittently, in Outlook 2010, in Outlook 2007, or in Outlook 2003 Service Pack 2</a>
</li></ul>

</div>
    
    
