---
layout: default
title: 'How to Use PowerShell to Initiate the Internal Synchronization of the Synchronization Configuration Data - TechNet Articles - United States (English) - TechNet Wiki'
weight: 3
---

<div class="post-content user-defined-markup">

<p style="border-bottom-color:#78acff;border-bottom-width:1px;border-bottom-style:solid;padding-bottom:5px;background-color:#eaf2ff;font-weight:bold;padding-top:5px;text-align:center;">
FIM ScriptBox Item</p>
<p style="font-weight:bold;text-decoration:underline;">Summary</p>
<p>The script initiates the internal synchronization of the synchronization configuration data.
</p>
<p style="font-weight:bold;text-decoration:underline;">Script Code</p>
<div style="border:1px solid black;padding:5px;width:560px;font-family:consolas,&#39;lucida console&#39;;height:500px;font-size:10pt;overflow:auto;">
<table border="0" cellspacing="0" cellpadding="5">
<tbody>
<tr>
<td valign="top">
<div style="padding:5px;font-family:consolas,&#39;lucida console&#39;;background-color:#cecece;font-size:10pt;">
001<br />
002<br />
003<br />
004<br />
005<br />
006<br />
007<br />
008<br />
009<br />
010<br />
011<br />
012<br />
013<br />
014<br />
015<br />
016<br />
</div>
</td>
<td valign="top" style="white-space:nowrap;">
<div style="padding:5px;font-family:consolas,&#39;lucida console&#39;;background-color:#fcfcfc;font-size:10pt;">
<span style="color:#006400;">#-------------------------------------------------------------------------------------------------
</span><br />
<span style="color:#000000;">&nbsp;</span><span style="color:#ff4500;">$lstMA</span><span style="color:#000000;">&nbsp;</span><span style="color:#a9a9a9;">=</span><span style="color:#000000;">&nbsp;</span><span style="color:#000000;">@(</span><span style="color:#0000ff;">get-wmiobject</span><span style="color:#000000;">&nbsp;</span><span style="color:#000080;">-Class</span><span style="color:#000000;">&nbsp;</span><span style="color:#8b0000;">&quot;MIIS_ManagementAgent&quot;</span><span style="color:#000000;">&nbsp;</span>`<br />
<span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000080;">-Namespace</span><span style="color:#000000;">&nbsp;</span><span style="color:#8b0000;">&quot;root\MicrosoftIdentityIntegrationServer&quot;</span><span style="color:#000000;">&nbsp;</span>`<br />
<span style="color:#000000;">&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000080;">-Filter</span><span style="color:#000000;">&nbsp;</span><span style="color:#8b0000;">&quot;Type=&#39;Forefront Identity Management (FIM)&#39;&quot;</span><span style="color:#000000;">&nbsp;</span>`<br />
<span style="color:#000000;">&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000080;">-Computername</span><span style="color:#000000;">&nbsp;</span><span style="color:#8b0000;">&quot;.&quot;</span><span style="color:#000000;">)</span><span style="color:#000000;">&nbsp;</span><br />
<span style="color:#000000;">&nbsp;</span><span style="color:#00008b;">If</span><span style="color:#000000;">(</span><span style="color:#ff4500;">$lstMA</span><span style="color:#a9a9a9;">.</span><span style="color:#000000;">count</span><span style="color:#000000;">&nbsp;</span><span style="color:#a9a9a9;">-eq</span><span style="color:#000000;">&nbsp;</span><span style="color:#800080;">0</span><span style="color:#000000;">)</span><span style="color:#000000;">&nbsp;</span><span style="color:#000000;">{</span><span style="color:#00008b;">throw</span><span style="color:#000000;">&nbsp;</span><span style="color:#8b0000;">&quot;There
 is no FIM management agent configured!&quot;</span><span style="color:#000000;">}</span><span style="color:#000000;">&nbsp;</span><br />
<span style="color:#000000;">&nbsp;</span><br />
<span style="color:#000000;">&nbsp;</span><span style="color:#0000ff;">Write-Host</span><span style="color:#000000;">&nbsp;</span><span style="color:#8b0000;">&quot;`nSynchronization in progress - please wait&quot;</span><span style="color:#000000;">&nbsp;</span><br />
<span style="color:#000000;">&nbsp;</span><span style="color:#000000;">(</span><span style="color:#ff4500;">$lstMA</span><span style="color:#a9a9a9;">[</span><span style="color:#800080;">0</span><span style="color:#a9a9a9;">]</span><span style="color:#a9a9a9;">.</span><span style="color:#000000;">ResyncSyncConfigObjects</span><span style="color:#000000;">(</span><span style="color:#000000;">)</span><span style="color:#000000;">)</span><span style="color:#a9a9a9;">.</span><span style="color:#000000;">ReturnValue</span><br />
<span style="color:#006400;">#-------------------------------------------------------------------------------------------------
</span><br />
<span style="color:#000000;">&nbsp;</span><span style="color:#00008b;">trap</span><span style="color:#000000;">&nbsp;</span><br />
<span style="color:#000000;">&nbsp;</span><span style="color:#000000;">{</span><br />
<span style="color:#000000;">&nbsp;&nbsp;</span><span style="color:#0000ff;">Write-Host</span><span style="color:#000000;">&nbsp;</span><span style="color:#8b0000;">&quot;`nError: $($_.Exception.Message)`n&quot;</span><span style="color:#000000;">&nbsp;</span><span style="color:#000080;">-foregroundcolor</span><span style="color:#000000;">&nbsp;</span><span style="color:#8a2be2;">white</span><span style="color:#000000;">&nbsp;</span><span style="color:#000080;">-backgroundcolor</span><span style="color:#000000;">&nbsp;</span><span style="color:#8a2be2;">darkred</span><span style="color:#000000;">&nbsp;&nbsp;</span><br />
<span style="color:#000000;">&nbsp;&nbsp;</span><span style="color:#00008b;">Exit</sp-------------------------------------------------
</span><br />
<span style="color:#000000;">&nbsp;</span><span style="color:#00008b;">trap</span><span style="color:#000000;">&nbsp;</span><br />
<span style="color:#000000;">&nbsp;</span><span style="color:#000000;">{</span><br />
<span style="color:#000000;">&nbsp;&nbsp;</span><span style="color:#0000ff;">Write-Host</span><span style="color:#000000;">&nbsp;</span><span style="color:#8b0000;">&quot;`nError: $($_.Exception.Message)`n&quot;</span><span style="color:#000000;">&nbsp;</span><span style="color:#000080;">-foregroundcolor</span><span style="color:#000000;">&nbsp;</span><span style="color:#8a2be2;">white</span><span style="color:#000000;">&nbsp;</span><span style="color:#000080;">-backgroundcolor</span><span style="color:#000000;">&nbsp;</span><span style="color:#8a2be2;">darkred</span><span style="color:#000000;">&nan><span style="color:#000000;">&nbsp;</span><span style="color:#800080;">1</span><br />
<span style="color:#000000;">&nbsp;</span><span style="color:#000000;">}</span><br />
<span style="color:#006400;">#-------------------------------------------------------------------------------------------------
</span></div>
</td>
</tr>
</tbody>
</table>
</div>
<p>&nbsp;</p>
<table cellspacing="0" cellpadding="0" style="width:100%;border-collapse:collapse;">
<tbody>
<tr>
<th style="text-align:left;padding-bottom:5px;background-color:#c0c0c0;padding-left:5px;padding-top:5px;">
<img alt="note" src="http://apfhrw.bay.livefilestore.com/y1pCed6u9dxDV3LOdzgtYt8xFaDWmIf_thMiOiFb3SmUARdxwIei5b6sPCHGruZWYphrJEU8j2BZEd51ZoAkp_ONkG8moMODvLC/Note.gif" />
<strong>Note</strong> </th>
</tr>
<tr>
<td style="background-color:#f0f0f0;padding-left:5px;">To provide feedback about this script, create a post on the
<a href="http://go.microsoft.com/fwlink/?LinkID=163230" target="_blank">FIM TechNet Forum</a>.<br />
For more FIM related Windows PowerShell scripts, see the <a href="http://go.microsoft.com/fwlink/?LinkID=160098" target="_blank">
FIM ScriptBox</a>. </td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>

</div>
    
    
