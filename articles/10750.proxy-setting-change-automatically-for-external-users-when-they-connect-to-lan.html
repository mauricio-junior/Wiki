---
layout: default
title: 'Proxy setting change automatically for external users when they connect to LAN - TechNet Articles - United States (English) - TechNet Wiki'
weight: 3
---

<div class="post-content user-defined-markup">

<br />
We have faced this problem in our environment:<br />
<br />
<span style="text-decoration:underline;"><strong>Problem :</strong></span> <br />
<span style="font-size:14pt;font-family:verdana,sans-serif;"><span style="font-size:12px;font-family:&#39;segoe ui&#39;;">Proxy</span>
<span style="font-family:&#39;segoe ui&#39;;"><span style="font-size:12px;">setting change automatically for external users when they connect to LAN<br />
</span><br />
</span><span style="text-decoration:underline;font-size:12px;font-family:&#39;segoe ui&#39;;"><strong>Solution :</strong> Run the command<br />
<br />
</span>
<ol>
<li style="color:black;"><span style="line-height:140%;font-size:8pt;font-family:verdana,sans-serif;color:black;"><em>Set-OutlookProvider EXPR -Server $null -CertPrincipalName none</em></span>
</li><li style="color:black;"><span style="line-height:140%;font-size:8pt;font-family:verdana,sans-serif;color:black;">Restart Internet Information Services IIS or recycle &quot;<strong><span style="font-family:verdana,sans-serif;">MSExchangeAutodiscoverAppPool&quot;</span></strong>
 on Exchange&nbsp;server that runs the Client Access server role for this change to take immediate effect.&nbsp;To recycle
<strong><span style="font-family:verdana,sans-serif;">MSExchangeAutodiscoverAppPool</span></strong>, which is the application pool for the Autodiscover service on the Exchange Client Access server, follow these steps:</span>
</li></ol>
</span>
<blockquote style="margin:0px 0px 0px 40px;border:none;padding:0px;">
<ul>
<li><span style="font-size:8pt;line-height:140%;font-family:verdana,sans-serif;color:black;">Open the Internet Information Server Management console.</span>
</li><li><span style="font-size:8pt;line-height:140%;font-family:verdana,sans-serif;color:black;">Expand the
</span><strong style="font-size:8pt;line-height:140%;color:black;font-family:verdana,sans-serif;"><span style="font-family:verdana,sans-serif;">Application Pools</span></strong><span style="font-size:8pt;line-height:140%;font-family:verdana,sans-serif;color:black;">
 container.</span> </li><li><span style="font-size:8pt;line-height:140%;font-family:verdana,sans-serif;color:black;">Right-click
</span><strong style="font-size:8pt;line-height:140%;color:black;font-family:verdana,sans-serif;"><span style="font-family:verdana,sans-serif;">MSExchangeAutodiscoverAppPool</span></strong><span style="font-size:8pt;line-height:140%;font-family:verdana,sans-serif;color:black;">,
 and then click </span><strong style="font-size:8pt;line-height:140%;color:black;font-family:verdana,sans-serif;"><span style="font-family:verdana,sans-serif;">Recycle</span></strong><span style="font-size:8pt;line-height:140%;font-family:verdana,sans-serif;color:black;">.</span>
</li></ul>
</blockquote>

</div>
    
    
