---
layout: default
title: 'SharePoint 2010&#58; PowerPivot - Scheduled Refresh to Netezza - TechNet Articles - United States (English) - TechNet Wiki'
weight: 3
---

<div class="post-content user-defined-markup">

<p><span style="font-size:10pt;font-family:calibri;color:#2a2a2a;">How to&nbsp;create a Scheduled Refresh to a Netezza Database&nbsp;in PowerPivot:</span></p>
<p><span style="font-size:14px;font-family:calibri;"><strong>Configure SSS target application in SharePoint</strong>
</span></p>
<blockquote dir="ltr" style="margin-right:0px;">
<p><span style="font-family:calibri;"><span style="font-size:10pt;color:#2a2a2a;">If you have not already created Secure Store Service (SSS) applications in SharePoint 2010, then refer to the
</span><span style="font-size:12pt;color:#2a2a2a;"><a href="http://technet.microsoft.com/en-us/library/ee806866.aspx"><span style="font-size:10pt;color:#0000ff;">MSDN article</span></a></span><span style="font-size:10pt;color:#2a2a2a;"> to configure it.</span>
</span></p>
<p><span style="font-size:10pt;font-family:calibri;color:#2a2a2a;">In Central Administrator under Application Management, click Manage service applications.<br />
</span><span style="font-size:10pt;font-family:calibri;color:#2a2a2a;">Open Secure Store services and create following SSS target application:</span></p>
<p><span style="font-family:calibri;"><strong><span style="font-size:10pt;color:#2a2a2a;">NetezzaProd
</span></strong><span style="font-size:10pt;color:#2a2a2a;">(i.e. only as an example)</span></span></p>
<ul>
<li style="color:#2a2a2a;"><span style="font-size:10pt;font-family:calibri;color:#2a2a2a;">Create a SSS application with Group as Target application type and leaving application Page URL to none.
</span></li><li style="color:#2a2a2a;"><span style="font-size:10pt;font-family:calibri;color:#2a2a2a;">Select Username/Password field types.
</span></li><li style="color:#2a2a2a;"><span style="font-size:10pt;font-family:calibri;color:#2a2a2a;">Setup members that need to access this SSS application ID.
</span></li><li style="color:#2a2a2a;"><span style="font-size:10pt;font-family:calibri;color:#2a2a2a;">Once application created, then set credentials with Netezza credentials.
</span></li></ul>
</blockquote>
<p dir="ltr"><span style="font-size:10pt;font-family:calibri;color:#2a2a2a;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/2703.SSS.png"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/2703.SSS.png" width="463" height="146" style="border-top:0px solid;height:88px;border-right:0px solid;border-bottom:0px solid;border-left:0px solid;width:398px;" /></a><br />
</span><span style="font-size:13px;font-family:calibri;"><span style="font-size:14px;"><strong><span style="font-size:14px;color:#2a2a2a;"><br />
Configure PowerPivot Workbook in Excel</span></strong>&nbsp;<br />
</span><br />
</span><span style="font-size:10pt;font-family:calibri;color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Open the workbook in<strong>&nbsp;Excel &gt; PowerPivot &gt; Home &gt; Other Data Sources &gt; Others (OLEDB/ODBC),&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;click Next and then Build.<br />
</strong></span><span style="font-size:10pt;font-family:calibri;color:#2a2a2a;"><span style="font-size:13px;font-family:calibri;color:#2a2a2a;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Under
<strong>Provider </strong>tab, select <strong>IBM Netezza OLE DB Data Provider </strong>
driver.<br />
</span>&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/2727.data.png"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/2727.data.png" width="392" height="563" style="border-top:0px solid;height:431px;border-right:0px solid;border-bottom:0px solid;border-left:0px solid;width:358px;" /></a></span></p>
<blockquote dir="ltr" style="margin-right:0px;">
<p>&nbsp;<span style="font-family:calibri;"><strong><span style="font-size:10pt;">Note:</span></strong><span style="font-size:10pt;"> If the Netezza driver is not listed under OLE DB providers then install Netezza OLEDB drivers to client server (where Excel is installed)
 and also make sure that it is installed on SharePoint server as well. You might need to ask your Netezza support person to provide drivers, as they might not be available to download publicly.
</span></span></p>
<p><span style="font-size:10pt;font-family:calibri;color:#2a2a2a;">After configuration the connection string should look like:<br />
</span><span style="font-family:calibri;"><strong><span style="font-size:10pt;">Provider=NZOLEDB;User ID=userName;Data Source=serverName;Initial Catalog=dBName;Persist Security Info=True</span></strong>
</span></p>
<p><span style="font-size:10pt;font-family:calibri;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/3683.conn.png"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/3683.conn.png" width="420" height="275" style="border-top:0px solid;height:257px;border-right:0px solid;border-bottom:0px solid;border-left:0px solid;width:450px;" /></a></span></p>
<p><span style="font-size:12pt;font-family:&#39;times new roman&#39;,serif;"></span></p>
<p><span style="font-size:10pt;font-family:calibri;">Save the workbook and upload it to PowerPivot gallery on SharePoint site.<br />
</span></p>
</blockquote>
<p><span style="font-size:14px;">Schedule PowerPivot Refresh in SharePoint</span></p>
<p>&nbsp;</p>
<blockquote dir="ltr" style="margin-right:0px;">
<p><span style="font-size:10pt;font-family:calibri;color:#2a2a2a;">Browse to the PowerPivot Gallery &gt; Locate the workbook you want to Schedule a Data Refresh for &gt; Click “<strong>Manage Data Refresh”</strong>:</span></p>
<p><span style="font-size:12pt;font-family:calibri;color:#2a2a2a;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/2402.refresh.png"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/2402.refresh.png" width="281" height="119" style="border-top:0px solid;height:55px;border-right:0px solid;border-bottom:0px solid;border-left:0px solid;width:181px;" /></a></span></p>
<p><span style="font-size:12pt;font-family:&#39;times new roman&#39;,serif;"></span></p>
<p><span style="font-size:12pt;font-family:calibri;color:#2a2a2a;">&nbsp;</span><span style="font-size:10pt;font-family:calibri;color:#2a2a2a;">For “<strong>Data Refresh</strong>” option check “<strong>Enable”</strong></span></p>
<p><span style="font-family:calibri;"><strong><span style="font-size:12pt;color:#2a2a2a;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></strong>
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/7762.enable.png">
<img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/7762.enable.png" style="border-top:0px solid;border-right:0px solid;border-bottom:0px solid;border-left:0px solid;" /></a></span></p>
<p><span style="font-size:12pt;font-family:&#39;times new roman&#39;,serif;"></span></p>
<p><span style="font-family:calibri;"><strong><span style="font-size:12pt;color:#2a2a2a;">&nbsp;</span></strong><span style="font-size:10pt;color:#2a2a2a;">For “<strong>Schedule Details</strong>” select “<strong>Also refresh as soon as possible</strong>”</span>
</span></p>
<p><span style="font-family:calibri;"><strong><span style="font-size:12pt;color:#2a2a2a;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></strong>
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/0243.also.png">
<img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/0243.also.png" width="434" height="55" style="border-top:0px solid;height:48px;border-right:0px solid;border-bottom:0px solid;border-left:0px solid;width:242px;" /></a></span></p>
<p><span style="font-size:12pt;font-family:&#39;times new roman&#39;,serif;"></span></p>
<p><span style="font-size:10pt;font-family:calibri;color:#2a2a2a;">&nbsp;</span><span style="font-size:10pt;font-family:calibri;color:#2a2a2a;">For Credentials &gt; Select &quot;<strong>Use the data refresh account configured by the administrator</strong>&quot;</span></p>
<p><span style="font-size:10pt;font-family:calibri;color:#2a2a2a;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/4721.option.png"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/4721.option.png" style="border-top:0px solid;border-right:0px solid;border-bottom:0px solid;border-left:0px solid;" /></a></span></p>
<p><a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/6177.Use-Data-Refresh.png"><span style="font-size:12pt;font-family:&#39;times new roman&#39;,serif;color:#0000ff;text-decoration:none;"></span></a></p>
<p><span style="font-size:10pt;font-family:calibri;color:#2a2a2a;"></span></p>
<p><span style="font-size:10pt;font-family:calibri;color:#2a2a2a;">Unselect &quot;<strong>All Data Sources</strong>&quot;</span></p>
<p><span style="font-size:10pt;font-family:calibri;color:#2a2a2a;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/4774.all.png"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/4774.all.png" width="221" height="55" style="border-top:0px solid;height:53px;border-right:0px solid;border-bottom:0px solid;border-left:0px solid;width:207px;" /></a></span></p>
<p><span style="font-size:12pt;font-family:&#39;times new roman&#39;,serif;"></span></p>
<p><span style="font-size:10pt;font-family:calibri;color:#2a2a2a;">Here, s</span><span style="font-size:10pt;font-family:calibri;color:#2a2a2a;">elect &quot;<strong>Netezza Prod</strong>&quot;<br />
</span></p>
<blockquote dir="ltr" style="margin-right:0px;">
<p><span style="font-size:10pt;font-family:calibri;color:#2a2a2a;">Under &quot;<strong>Data Source Schedule:</strong>&quot; &gt; Select &quot;<strong>Use Default Schedule</strong>&quot;<br />
</span><span style="font-size:10pt;font-family:calibri;color:#2a2a2a;">Under &quot;<strong>Data Source Credentials:</strong>&quot; &gt; Select &quot;<strong>Connect using the credentials saved in the Secure Store Service (SSS) to log on to the data source.&nbsp; Enter the ID used
 to look up the credentials in the SSS ID box.”</strong></span></p>
</blockquote>
<p><span style="font-size:10pt;font-family:calibri;color:#2a2a2a;"></span></p>
<blockquote dir="ltr" style="margin-right:0px;">
<p><span style="font-size:10pt;font-family:calibri;color:#2a2a2a;">ID:&nbsp;<strong>NetezzaProd</strong></span></p>
</blockquote>
<p dir="ltr">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/3036.Source.png"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/3036.Source.png" style="border-top:0px solid;border-right:0px solid;border-bottom:0px solid;border-left:0px solid;" /></a></p>
<p dir="ltr"><span style="font-size:10pt;font-family:calibri;color:#2a2a2a;"><br />
Click “<strong>OK</strong>”</span></p>
<p><span style="font-size:10pt;font-family:calibri;color:#2a2a2a;">Browse to the PowerPivot Gallery &gt; select the workbook you scheduled for a Data Refresh &gt; Click “<strong>Manage Data Refresh”</strong> to view the results.</span></p>
<p><span style="font-size:12pt;font-family:calibri;color:#2a2a2a;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/2402.refresh.png" width="281" height="119" style="border-top:0px solid;height:54px;border-right:0px solid;border-bottom:0px solid;border-left:0px solid;width:151px;" /></span></p>
<p><span style="font-size:12pt;font-family:&#39;times new roman&#39;,serif;"></span></p>
<p><span style="font-family:calibri;">&nbsp;</span><span style="font-size:10pt;font-family:calibri;color:#2a2a2a;">The results are displayed as:</span></p>
<p><span style="font-size:12pt;font-family:calibri;color:#2a2a2a;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/2388.result.png"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/2388.result.png" style="border-top:0px solid;border-right:0px solid;border-bottom:0px solid;border-left:0px solid;" /></a></span></p>
</blockquote>
<p><span style="font-size:12pt;font-family:&#39;times new roman&#39;,serif;"></span></p>
<p><span style="font-size:14px;"><span style="font-size:14px;font-family:calibri;color:#2a2a2a;"><br />
&nbsp;</span><span style="font-size:14px;font-family:calibri;">&nbsp;<strong><span style="font-size:14px;color:#2a2a2a;">Possible Errors:</span></strong><strong>
</strong></span></span></p>
<blockquote dir="ltr" style="margin-right:0px;">
<p><span style="font-size:11px;"><span style="font-size:11px;font-family:calibri;color:#2a2a2a;">&nbsp;</span><span style="font-size:11px;font-family:calibri;"><strong><span style="font-size:10pt;color:#2a2a2a;">If MS OLE DB provider for ODBC driver is selected
 instead:</span></strong> </span></span></p>
<p><span style="font-size:10pt;font-family:calibri;color:#2a2a2a;">In the results pane, below error is thrown:<br />
</span><span style="font-family:calibri;"><strong><em><span style="font-size:10pt;color:#000000;"><br />
The .Net Framework Data Provider for OLEDB (System.Data.OleDb) does not support the Microsoft OLE DB Provider for ODBC Drivers (MSDASQL). Use the .Net Framework Data Provider for ODBC (System.Data.Odbc).</span></em></strong>
</span></p>
<p><span style="font-size:12pt;font-family:calibri;color:#2a2a2a;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/6886.result1.png"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/6886.result1.png" width="557" height="38" style="border-top:0px solid;height:35px;border-right:0px solid;border-bottom:0px solid;border-left:0px solid;width:555px;" /></a></span></p>
<p><span style="font-size:10pt;font-family:calibri;color:#000000;">Open the workbook in<strong>&nbsp;Excel &gt; PowerPivot &gt; Design &gt; Existing Connections &gt;</strong>&nbsp;(In this case) “<strong><em>Netezza Prod</em>”</strong>:</span></p>
<p><span style="font-size:10pt;font-family:calibri;color:#000000;">The&nbsp;<strong>Connection String:</strong>&nbsp;shspan></em></strong>
</span></p>
<p><span style="font-size:12pt;font-family:calibri;color:#2a2a2a;">&nowed the user was using the (<strong>Microsoft OLE DB Provider for ODBC Drivers</strong>):</span></p>
<p><span style="font-size:10pt;font-family:calibri;color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/4135.source1.png"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/4135.source1.png" width="334" height="531" style="border-top:0px solid;height:424px;border-right:0px solid;border-bottom:0px solid;border-left:0px solid;width:336px;" /></a></span></p>
<p><span style="font-size:12pt;font-family:&#39;times new roman&#39;,serif;"></span></p>
<p><span style="font-size:10pt;font-family:calibri;color:#2a2a2a;">The connection string was:<br />
</span><span style="font-family:calibri;"><strong><em><span style="font-size:10pt;color:#000000;">Provider=MSDASQL;Persist Security Info=True;User ID=useName;Initial Catalog=dbName;DSN=NetezzSQL</span></em></strong>
</span></p>
<p><span style="font-family:calibri;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/6278.conn1.png"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/6278.conn1.png" width="484" height="318" style="border-top:0px solid;height:298px;border-right:0px solid;border-bottom:0px solid;border-left:0px solid;width:454px;" /></a></span></p>
<p><span style="font-family:calibri;"><span style="font-size:10pt;color:#000000;">To resolve the issue have user select the Netezza driver (</span><strong><span style="font-size:10pt;color:#2a2a2a;">IBM Netezza OLE DB Data Provider</span></strong><span style="font-size:10pt;color:#000000;">)
 and follow the above steps to properly&nbsp;configure and refresh data in scheduled PowerPivot.</span></span><span style="font-family:calibri;">&nbsp;</span></p>
</blockquote>

</div>
    
    
