---
layout: default
title: Troubleshooting Opening Office Documents Located on Web Servers - TechNet Articles - United States (English) - TechNet Wiki
weight: 3
---

<div class="post-content user-defined-markup">

<div class="table-of-contents"><h2 class="title">Table of Contents</h2><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#Introduction">Introduction</a></li><li class="hierarchy-item"><a href="#Understanding_More">Understandin"><div class="r1 fiji-r1"></div><div class="r2 fiji-r2"></div><div class="r3 fiji-r3"></div><div class="r4 fiji-r4"></div></div></div></div>
<div class="content-fragment page no-wrapper" id="fragment-6615">
<div class="content-fragment-inner fiji-content-fragment-inner"><div class="content-fragment-top fiji-content-fragment-top"><div class="r1 fiji-r1"></div><div class="r2 fiji-r2"></div><div class="r3 fiji-r3"></div><div class="r4 fiji-r4"></div></div><div class="content-fragment-content">

<div class="full-post-header"></div>
<div class="full-post">
    <h1 class="post-name">Troubleshooting Opening Office Documents Located on Web Servers</h1>
    

    <div class="post-g More</a></li><li class="hierarchy-item"><a href="#Related_Knowledgebase_Articles">Related Knowledgebase Articles</a></li><li class="hierarchy-item"><a href="#Environment_Information_to_Collect_and_Document">Environment Information to Collect and Document</a></li><li class="hierarchy-item"><a href="#Troubleshooting_Questions_and_Actions_to_Take">Troubleshooting Questions and Actions to Take</a></li></ul><div class="hierarchy-list-footer"> </div></div> <br />
<br />
<h2><a name="Introduction"></a>Introduction</h2>
<span style="font-size:12.1px;"><br />
When you open Office documents from a website you may experience odd behaviors that you wouldn&#39;t normally see opening other files that are not related to Office or would not notice if you were opening the documents from the local file system or a network share.
 Common issues involve clicking on a hyperlink to an Office document in a webpage and seeing an
</span><strong style="font-size:12.1px;">authentication prompt</strong><span style="font-size:12.1px;"> and not expecting one or
</span><strong style="font-size:12.1px;">files opening read-only</strong><span style="font-size:12.1px;"> when you are expecting to be able to edit them.</span><br />
<br />
This article describes what to look for and basic troubleshooting steps you can perform on the client machine and even some tips on what to look for on the web server side (or web application side) as well.<br />
<br />
<h2><a name="Understanding_More"></a>Understanding More</h2>
<br />
One important distinguishing piece of information to understand is the differentiation between going to just a plain
<strong>web server</strong> such as IIS or Apache with static web pages or accessing a file from a
<strong>web application </strong>or web solution such as <strong>SharePoint </strong>
because SharePoint handles things like WebDAV itself and uses certain protocols like WebDAV and FrontPage&nbsp;RPC or FPRPC for short. The reason it&#39;s important to know the difference is because you may not think (or want or have rights) to look on the server side.<br />
<br />
That&#39;s why the server information is important to collect right away. A networking trace just off the client sometimes can tell you the type of server and many times even the web application in the responses from the server.<br />
<br />
But that&#39;s getting a little ahead of ourselves, especially if you don&#39;t know how to read network traces or know anything about HTTP. But that&#39;s not hard to learn and is good if your job involves troubleshooting network problems.<br />
<br />
This article mainly targets opening <strong>Word, Excel, and PowerPoint</strong> documents from a web server. And in many scenarios
<strong>Visio and Publisher documents </strong>as well.<strong> OneNote</strong> has a known issue with SharePoint sites where requiring check-out or requiring columns on the document library will cause synchronization to fail in OneNote. The only way around
 that is to disable that setting in the SharePoint document library settings.<br />
<br />
The main issues I&#39;m targetting are focused on opening Office documents from a server with authentication prompts or as read-only. But that doesn&#39;t mean these steps won&#39;t help diagnose and resolve other integration issues with Office and a web server. Think
 of this as a general practice guide for troubleshooting Office interacting with a web&nbsp;server.<br />
<br />
<strong>
<h2><a name="Related_Knowledgebase_Articles"></a>Related Knowledgebase Articles</h2>
<ul>
<li><a href="http://support.microsoft.com/kb/2019105" target="_blank" style="font-size:12.1px;">2019105 Authentication requests when you open Office documents</a>
</li><li><a href="http://support.microsoft.com/kb/2019105" target="_blank" style="font-size:12.1px;"></a><a href="http://support.microsoft.com/kb/943280" target="_blank" style="font-size:12.1px;">943280 Prompt for Credentials When Accessing FQDN Sites From a Windows
 Vista or Windows 7 Computer</a> </li><li><a href="http://support.microsoft.com/kb/943280" target="_blank" style="font-size:12.1px;"></a><a href="http://support.microsoft.com/kb/838028" target="_blank" style="font-size:12.1px;">838028 How documents are opened from a Web site in Office 2003</a>
</li><li><a href="http://support.microsoft.com/kb/838028" target="_blank" style="font-size:12.1px;"></a><a href="http://support.microsoft.com/kb/2123563" target="_blank" style="font-size:12.1px;">2123563 You cannot open Office file types directly from a server that
 supports only Basic authentication over a non-SSL connection</a> </li><li><a href="http://support.microsoft.com/kb/2123563" target="_blank" style="font-size:12.1px;"></a><a href="http://support.microsoft.com/kb/218153" target="_blank" style="font-size:12.1px;">218153 Error message when clicking hyperlink in Office: &quot;Cannot locate
 the Internet server or proxy server&quot;</a> </li><li><a href="http://support.microsoft.com/kb/218153" target="_blank" style="font-size:12.1px;"></a><a href="http://support.microsoft.com/kb/932118" target="_blank" style="font-size:12.1px;">932118 Persistent cookies are not shared between Internet Explorer and
 Office applications</a> </li><li><a href="http://support.microsoft.com/kb/932118" target="_blank" style="font-size:12.1px;"></a><a href="http://support.microsoft.com/kb/982995" target="_blank" style="font-size:12.1px;">982995 A new application window opens when you try to view an Office
 2010 document in Internet Explorer 7 or in Internet Explorer 8</a> </li><li><a href="http://support.microsoft.com/kb/2459200" target="_blank" style="font-size:12.1px;">2459200 Microsoft Data Access Internet Publishing Provider configuration repair script</a>*
</li><li><a href="http://support.microsoft.com/kb/2459200" target="_blank" style="font-size:12.1px;"></a><a href="http://support.microsoft.com/kb/2121447" target="_blank" style="font-size:12.1px;">2121447 Information about how to use Office 2010 suites and programs
 on a computer that is running another version of Office</a> </li></ul>
</strong><br />
*MSDAIPP (aka Rosebud) was the WebDAV protocol provider in Windows XP but it also ships with Office. However, in Vista and Windows 7 it uses WebClient as the WebDAV protocol provider. So only consider using 2459200 if the client is running Windows XP.<br />
<br />
<h2><a name="Environment_Information_to_Collect_and_Document"></a>Environment Information to Collect and Document</h2>
<br />
What<strong> </strong>is the environment like?&nbsp;This information is important to collection and document to help IT and support staff troubleshoot the cause of the problem.
<ul>
<li><strong>Server OS</strong> version and service pack </li><li><strong>Web application</strong>, if any </li><li><strong>Client OS</strong> version and service pack </li><li><strong>Office</strong> version and service pack </li><li><strong>Authentie:12.1px;">2121447 Informacation</strong> on server (Integrated Windows authentication, anonymous, forms based authentication)
</li><li>Is <strong>anonymous</strong> authentication enabled? </li><li>Does the server have<strong> SSL</strong> enabled? (https://) </li><li>Any <strong>intermediate devices</strong> such as proxy servers, gateways, load balancers, or other network appliances the client has to traverse through to get to the server and vice versa?
</li><li><strong>Web browser</strong> (Internet Explorer, FireFox, Safari, Chrome) used if opening from webpage (as opposed to from Office application (File/Open)
</li></ul>
<strong>
<h2><a name="Troubleshooting_Questions_and_Actions_to_Take"></a>Troubleshooting Questions and Actions to Take</h2>
</strong>
<ul>
<li>Understand (clarify) and define the problem and scope (how many clients affected, how many users, servers, locations, internal, external)
</li><li>Search our knowledgebase <a href="http://support.microsoft.com/">http://support.microsoft.com/</a> for known issues.
</li><li><strong>When</strong> did the problem start? Has it ever worked? </li><li>What&#39;s the impact/severity? </li><li>Force a <strong>repair of Office</strong> or other standalone Office application on the client from Control Panel/Add or Remove Programs (now Programs and Features in Vista/Windows 7) May require a reboot.
</li><li>Is the site you are trying to access from the client an <strong>intranet</strong>&nbsp;name or
<strong>FQDN</strong>? <a href="http://servername/">http://servername/</a> or <a href="http://servername.contoso.com/">
http://servername.contoso.com/</a>? </li><li>Is the <strong>WebClient service</strong> enabled on the <strong>client</strong> machine? What is the startup type (Disabled, Manual, Automatic)? Is the service started or stopped? If disabled set to Manual.
</li><li>Do you need to be able to <strong>edit</strong> the document? Or is opening as
<strong>read-only </strong>fine? </li><li>Are the workstation (client) and user in the same <strong>domain </strong>as the web server? If not is there a
<strong>domain trust</strong>? </li><li>Is the site added to <strong>Trusted Sites</strong> zone in Internet Options on the client? If not, add it and see what happens.
</li><li><strong>How</strong> are you trying to <strong>open</strong> the file from the client? From a webpage, from Windows Explorer (WebDAV), from the Office application itself?
</li><li>Do you have <strong>permissions</strong> to the file on the server? In the web application?
</li><li>Is <strong>Windows Firewall</strong> enabled on the client or server? Try disabling on both.
</li><li>Are there any other Office versions installed on the client machine? Such as Visio, Project, or SharePoint Designer, or standalone application such as Office Standard 2010 with Access 2010?
<strong>Mixed versions</strong> like Office 2003 with Visio 2007 or Office XP with Office 2010? This can cause problems with SharePoint since Office installs client side components for SharePoint integration such as the Upload Multiple Documents ActiveX control.
</li><li>Is <strong>WebDAV enabled</strong> on the <strong>server</strong>? This doesn&#39;t apply to SharePoint because it handles WebDAV itself. You don&#39;t need to and shouldn&#39;t install WebDAV on the web front end in IIS. Doing so can cause problems, mainly opening
 files in edit mode. </li><li>If SharePoint, is <strong>Client Integration </strong>enabled or disabled in the web application&#39;s authentication settings?
<ul>
<li>What is <strong>Browser File Handling </strong>set to in the web application settings? Permissive or Strict?
</li></ul>
</li><li>Is URL Scan installed on the server? </li><li>Disable <strong>anti-virus</strong> and test. If possible, uninstall anti-virus and test.
</li><li>Disable any <strong>client-side firewalls</strong> </li><li>Check <strong>proxy settings in Internet Explorer</strong> (Tools, Internet Options, LAN settings). Try toggling Automatically detect settings. Try manually setting a proxy and adding an exception in Advanced proxy settings.
</li><li>Get a <strong>network trace </strong>of the problem from the client using a network capture tool such as Network Monitor or Wireshark. If site is over SSL it&#39;s better to get a Fiddler trace because it has the option Decrypt SSL Traffic.
</li><li>Run <strong>Process Monitor </strong>on the client and capture events during the problem.
</li><li>Disable any 3rd party service and startup applications using <strong>MSConfig.exe</strong>, restart and test.
</li><li>It may be necessary to get a simultaneous network trace from both client and server.
</li></ul>

</div>
    
    