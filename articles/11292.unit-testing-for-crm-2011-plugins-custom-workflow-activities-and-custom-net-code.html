---
layout: default
title: 'Unit Testing for CRM 2011; Plugins, Custom Workflow Activities and Custom .Net Code - TechNet Articles - United States (English) - TechNet Wiki'
weight: 3
---

<div class="post-content user-defined-markup"><p>Every time we write a plugin and a custom workflow activity, we
should make sure it works as desired. The business logic we write within
these plugins and custom workflow activities, should accept the
business confirmed parameters and should perform the agreed operations.</p>
<p>The
above holds true each time we change these plugins and custom workflow
activities. Every time we make a change, the plugins and custom workflow
activities again need to be tested and verified. Unit testing in Visual
Studio 2010 (out of the box) helps us achieve this process. In unit
testing we will always need to Mock the CRM contexts and the data.</p>
<p><strong>&quot;Moq&quot; mocking library</strong>
can help in writing unit tests for CRM 2011 plugins and custom workflow
activities, by mocking the CRM context and makes it easier to pass
parameters and define the results.</p>
<p>Moq (pronounced &quot;Mock-you&quot; or
just &quot;Mock&quot;) is the only mocking library for .NET developed from scratch
to take full advantage of .NET 3.5 (i.e. Linq expression trees) and C#
3.0 features (i.e. lambda expressions) that make it the most productive,
type-safe and refactoring-friendly mocking library available. And it
supports mocking interfaces as well as classes. Its API is extremely
simple and straightforward, and doesn&#39;t require any prior knowledge or
experience with mocking concepts.</p>
<div class="mceTemp mceIEcenter" style="text-align:left;">The
below screen shot shows the skeleton of how the MOQ can help us in
Mocking (the CRM 2011 context). After Mocking, we can unit test by
changing input parameters as we do with any other .Net unit testing.</div>
<div class="mceTemp mceIEcenter" style="text-align:left;"><br />
</div>
<div class="mceTemp mceIEcenter">
<div class="mceTemp mceIEcenter">
<dl id="attachment_73" class="wp-caption aligncenter" style="width:906px;">
    <dt class="wp-caption-dt"><a href="http://ashishmahajancrm.files.wordpress.com/2012/02/code-for-moq1.jpg"><img width="896" height="411" class=" wp-image-73  " title="MOQ: Mocking the CRM 2011 Context for Unit Testing in Visual Studio 2010" src="http://ashishmahajancrm.files.wordpress.com/2012/02/code-for-moq1.jpg" alt="MOQ: Mocking the CRM 2011 Context for Unit Testing in Visual Studio 2010" /></a><br />
    </dt>
    <dd class="wp-caption-dd">MOQ: Mocking the CRM 2011 Context for Unit Testing in Visual Studio 2010</dd>
</dl>
</div>
<p style="text-align:left;">I hope this blog about &#39;Unit Testing for CRM 2011; Plugins, Custom Workflow Activities and Custom .Net Code&#39; was informative. Please feel free to leave your comments. </p>
</div></div>
    
    
