---
layout: default
title: Send Email Class - TechNet Articles - United States (English) - TechNet Wiki
weight: 3
---

<div class="post-content user-defined-markup">

<strong>Description:</strong><br />
Generic class to send emails<br />
<br />
<strong>Code:</strong><br />
<br />
public class EmailManager<br />
{<br />
private string server = string.Empty;<br />
private string username = string.Empty;<br />
private string password = string.Empty;<br />
<br />
#region Properties<br />
public string Server<br />
{<br />
get<br />
{<br />
return this.server;<br />
}<br />
set<br />
{<br />
this.server = value;<br />
}<br />
}<br />
<br />
/// &lt;summary&gt;<br />
/// Gets and Sets the username.<br />
/// &lt;/summary&gt;<br />
public string Username<br />
{<br />
get<br />
{<br />
return this.username;<br />
}<br />
set<br />
{<br />
this.username = value;<br />
}<br />
}<br />
<br />
/// &lt;summary&gt;<br />
/// Gets and Set the password.<br />
/// &lt;/summary&gt;<br />
publiiv class="full-post">
    <h1 class="post-name">Send Email Classc string Password<br />
{<br />
get<br />
{<br />
return this.password;<br />
}<br />
set<br />
{<br />
this.password = value;<br />
}<br />
}<br />
#endregion<br />
<br />
#region Constructor<br />
public EmailManager(string server, string username, string password)<br />
{<br />
this.Server = server;<br />
this.Username = username;<br />
this.Password = password;<br />
}<br />
#endregion<br />
<br />
#region Public<br />
<br />
public void Send(List&lt;string&gt; sendTo, List&lt;string&gt; sendCC, string sendFrom, string subject, string body)<br />
{<br />
<br />
MailMessage message = new MailMessage();<br />
<br />
try<br />
{<br />
// Create a SMTP client object and set up credential properties <br />
SmtpClient smtpClient = new SmtpClient(Server);<br />
<br />
if (string.IsNullOrEmpty(username) || string.IsNullOrEmpty(password))<br />
smtpClient.UseDefaultCredentials = true;<br />
else<br />
{<br />
System.Net.NetworkCredential credentials = new System.Net.NetworkCredential(username, password);<br />
smtpClient.Credentials = credentials;<br />
}<br />
<br />
foreach (string to in sendTo)<br />
{<br />
message.To.Add(to);<br />
}<br />
<br />
foreach (string cc in sendCC)<br />
{<br />
message.CC.Add(cc);<br />
}<br />
<br />
message.Subject = subject;<br />
message.From = new System.Net.Mail.MailAddress(sendFrom);<br />
message.Body = body;<br />
<br />
message.IsBodyHtml = true;<br />
<br />
smtpClient.Send(message);<br />
<br />
message.Dispose();<br />
}<br />
catch (Exception ex)<br />
{<br />
throw ex;<br />
}<br />
finally<br />
{<br />
message.Dispose();<br />
}<br />
}<br />
#endregion<br />
}

</div>
    
    