---
layout: default
title: TechNet Wiki に整形された Windows PowerShell のコードを挿入する方法 (ja-JP) - TechNet Articles - United States (English) - TechNet Wiki
weight: 3
---

<div class="post-content user-defined-markup"><table align="center" style="border:1px solid #aaaaaa;width:80%;background-color:#eeeeee;">
    <tbody>
        <tr>
            <td style="text-align:center;">
            <p><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/CommunityServer.Wikis.Components.Files/articles/0474.howto03.png" /> </p>
            r3 fiji-r3"></div><div class="r4 fiji-r4"></div></div></div></div>
<div class="content-fragment page no-wrapper" id="fragment-6615">
<div class="content-fragment-inner fiji-content-fragment-inner"><div class="content-fragment-top fiji-content-fragment-top"><div class="r1 fiji-r1"></div><div class="r2 fiji-r2"></div><div class="r3 fiji-r3"></div><div class="r4 fiji-r4"></div></div><div class="content-fragment-content">

<div class="full-post-header"></div>
<div class="full-post">
    <h1 class="post-name">TechNet Wiki に整形された W</td>
            <td><strong>このトピックは <em>how to です。</em><br />
            </strong>可能な限り明瞭で簡潔な状態を維持してください。基礎的なメカニズムや関連技術に深く言及したり、推測に基づいた議論をすることも避けてください。 </td>
        </tr>
    </tbody>
</table>
<br />
整形し色付けされたコードを挿入したいと考えられるかもしれません。(整形し色付けされたスクリプトコードはWebページを読み易く目立たせてくれます。) これは、読み手が文法を早く理解するための手助けになります。<br />
<br />
<strong>
Windows PowerShell</strong> の整形したコードを Wiki エディタで挿入する方法は少しトリッキーです。この記事では、<strong>Windows PowerShell ISE </strong>(PowerShell V2 の一部分)か、もしくは <strong>Quest Software</strong> の <strong>PowerGUI Script Editor</strong> を利用することを想定します。<br />
<br />
<h2><a name="Using_PowerShell_ISE"></a>PowerShell ISE の利用</h2>
<ol>
    <li>ここをクリックして、<a href="http://archive.msdn.microsoft.com/PowerShellPack/Release/ProjectReleases.aspx?ReleaseId=3341">PowerShellPack</a> の Web サイトへ進み、<strong>PowerShellPack</strong> をダウンロードしてインストールします。</li>
    <li><strong>Windows PowerShell ISE</strong> を起動します。</li>
    <li><strong>Windows PowerShell ISE</strong> のコマンドペインで次のコマンドを入力します。<br />
    <strong>Import-Module -Name PowerShellPack</strong></li>
    <li>メニューバーに、<strong>アドオン</strong>というメニューが現れます。</li>
    <li><strong>Windows PowerShell ISE</strong> で、すでに作成済みの Windows PowerShell スクリプトを開くか、その場でスクリプトペインにコードを入力します。</li>
    <li>Wiki エディターに挿入したいコードの部分を選択します。</li>
    <li><strong>アドオン</strong>メニューから [<strong>IsePack</strong> -&gt; <strong>Edit</strong> -&gt; <strong>Copy-ColoredAsHtml</strong>] と順番にクリックします。</li>
    <li>これで、選択したコードの部分を HTML フォーマットにしたものがクリップボードに保存されます。</li>
    <li>Wiki エディターに戻ります。</li>
    <li>ツールバーの <strong>HTML</strong> ボタンをクリックし、ウィンドウの適切な位置へ HTML コードを貼り付けます。</li>
    <li>クリップボードからエディターへ HTML コードを貼り付けます。</li>
    <li>エディターにソースコードを適したフォントで貼り付けるのは良い考えです。そのため、最初の <strong>&lt;pre&gt;</strong> タグを次のように変更します。<br />
    &lt;pre style=&quot;font-family: consolas; font-size: 12px&quot; class=&quot;PowerShellColorizedScript&quot;&gt;</li>
    <li>結果はこのようになります。</li>
</ol>
<pre class="PowerShellColorizedScript" style="font-family:consolas;font-size:12px;"><span style="color:#006400;">#####################################################################</span>            
<span style="color:#006400;"># Test-Me.ps1</span>            
<span style="color:#006400;"># Version 0.63</span>            
<span style="color:#006400;">#</span>            
<span style="color:#006400;"># This script just tests something</span>            
<span style="color:#006400;">#</span>            
<span style="color:#006400;">#####################################################################</span>            
<span style="color:#006400;">#requires -Version 2.0</span>            
            
<span style="color:#00008b;">function</span> <span style="color:#8a2be2;">Test-Me</span> <span style="color:#000000;">{</span>            
<span style="color:#a9a9a9;">[</span><span style="color:#add8e6;">CmdletBinding</span><span style="color:#000000;">(</span><span style="color:#000000;">)</span><span style="color:#a9a9a9;">]</span>            
    <span style="color:#00008b;">param</span> <span style="color:#000000;">(</span>            
        <span style="color:#a9a9a9;">[</span><span style="color:#add8e6;">Parameter</span><span style="color:#000000;">(</span><span style="color:#000000;">Mandatory</span> <span style="color:#a9a9a9;">=</span> <span style="color:#ff4500;">$true</span><span style="color:#a9a9a9;">,</span> <span style="color:#000000;">ValueFromPipeline</span> <span style="color:#a9a9a9;">=</span> <span style="color:#ff4500;">$true</span><span style="color:#a9a9a9;">,</span> <span style="color:#000000;">Position</span> <span style="color:#a9a9a9;">=</span> <span style="color:#800080;">0</span><span style="color:#000000;">)</span><span style="color:#a9a9a9;">]</span>            
        <span style="color:#008080;">[string]</span><span style="color:#ff4500;">$Argument</span>            
    <span style="color:#000000;">)</span>            
    <span style="color:#0000ff;">Write-Host</span> <span style="color:#8b0000;">&quot;You have passed the following argument to me:&quot;</span>            
    <span style="color:#0000ff;">Write-Host</span> <span style="color:#ff4500;">$Argument</span>            
<span style="color:#000000;">}</span></pre>
<br />
<br />
<h2><a name="Using_PowerGUI"></a>PowerGUI の利用</h2>
<br />
<ol>
    <li>ここをクリックして、<a href="http://powergui.org/downloads.jspa">http://powergui.org/downloads.jspa</a> の Webサイトへ進み、<strong>PowerGUI Script Editor</strong> をダウンロードしてインストールします。</li>
    <li><strong>PowerGUI Script Editor</strong> を起動します。</li>
    <li><strong>PowerGUI Script Editor</strong> で、すでに作成済みの Windows PowerShell スクリプトを開くか、その場でスクリプトペインにコードを入力し���す。</li>
    <li>Wiki エディターに挿入したいコードの部分を選択します。</li>
    <li><strong>編集</strong>メニューから [<strong>名前を付けてコピー</strong> -&gt; <strong>HTML</strong>] と順番にクリックします。</li>
    <li>これで、選択したコードの部分を HTML フォーマットにしたものがクリップボードに保存されます。</li>
    <li>Wiki エディターに戻ります。</li>
    <li>ツールバーの <strong>HTML</strong> ボタンをクリックし、ウィンドウの適切な位置へ HTML コードを貼り0;">&quot;You have passed the following argument to me:&quot;</span>            
    <span style="color:#0000ff;">Write-Host</span> <span style="color:#ff4500;">$Argument</span>            
<span style="color:#000000;">}</span></pre>
<br />
<br />
<h2><a name="Using_PowerGUI"></a>PowerGUI の利用</h2>
<br />
<ol>
    <li>ここをクリックして、<a href="http://powergui.org/downloads.jspa">http://powergui.org/downloads.jspa</a> の Webサイトへ進み、<strong>PowerGUI Script Editor</strong> をダウンロードしてインストールします。</li>
    <li><strong>PowerGUI Script Editor</strong> を起動します。</li>
    <li><strong>PowerGUI Script Editor</strong> で、すでに作成済みの Windows PowerShell スクリプトを開くか、その場でスクリプトペインにコードを入力し���す。</li>
    <li>Wiki エディターに挿入したいコードの部分を選択します。</li>
    <li><strong>編集</strong>メニューから [<strong>名前を付けてコピー</strong> -&gt; <strong>HTML</strong>] と順番にクリックします。</li>
    <li>これで、選択したコードの部分を HTML フォーマットにしたものがクリップボードに保存されます。</li>
    <li>Wiki エディターに戻ります。</li>
    <li>ツールバーの <strong>HTML</strong> ボタンをクリックし、ウィンドウの適切な位置へ HTML コードを付けます。</li>
    <li>クリップボードからエディターへ HTML コードを貼り付けます。</li>
    <li>エディターにソースコードを適したフォントで貼り付けるのは良い考えです。そのため、最初の <strong>&lt;pre&gt;</strong> タグを次のように変更します。<br />
    &lt;pre style=&quot;font-family: consolas; font-size: 12px&quot;&gt;</li>
    <li>結果はこのようになります。</li>
</ol>
<pre style="font-family:consolas;font-size:12px;"><span style="color:#008000;">#</span><span style="color:#008000;">####################################################################</span><span style="color:#008000;">
#</span><span style="color:#008000;"> Test-Me.ps1</span><span style="color:#008000;">
#</span><span style="color:#008000;"> Version 0.63</span><span style="color:#008000;">
#
#</span><span style="color:#008000;"> This script just tests something</span><span style="color:#008000;">
#
#</span><span style="color:#008000;">####################################################################</span><span style="color:#008000;">
#</span><span style="color:#008000;">requires -Version 2.0</span><span style="color:#008000;">
</span><span style="color:#000000;">
</span><span style="color:#0000ff;">function</span><span style="color:#000000;"> </span><span style="color:#5f9ea0;">Test-Me</span><span style="color:#000000;"> {
[CmdletBinding()]
    </span><span style="color:#0000ff;">param</span><span style="color:#000000;"> (
        [Parameter(Mandatory </span><span style="color:#ff0000;">=</span><span style="color:#000000;"> </span><span style="color:#800080;">$true</span><span style="color:#000000;">, ValueFromPipeline </span><span style="color:#ff0000;">=</span><span style="color:#000000;"> </span><span style="color:#800080;">$true</span><span style="color:#000000;">, Position </span><span style="color:#ff0000;">=</span><span style="color:#000000;"> </span><span style="color:#000000;">0</span><span style="color:#000000;">)]
        [</span><span style="color:#008080;">string</span><span style="color:#000000;">]</span><span style="color:#800080;">$Argument</span><span style="color:#000000;">
    )
    </span><span style="font-weight:bold;color:#5f9ea0;">Write-Host</span><span style="color:#000000;"> </span><span style="color:#800000;">&quot;</span><span style="color:#800000;">You have passed the following argument to me:</span><span style="color:#800000;">&quot;</span><span style="color:#000000;">
    </span><span style="font-weight:bold;color:#5f9ea0;">Write-Host</span><span style="color:#000000;"> </span><span style="color:#800080;">$Argument</span><span style="color:#000000;">
}</span></pre>
<br />
<hr />
<h2><a name="See_Also"></a>関連項目</h2>
<ul>
    <li><a href="http://social.technet.microsoft.com/wiki/contents/articles/7609.wiki-ja-jp.aspx">Wiki: はじめに (ja-JP)</a></li>
    <li><a href="http://social.technet.microsoft.com/wiki/contents/articles/10113.wiki-ja-jp.aspx">Wiki: 開発ポータル (ja-JP)</a></li>
</ul>
<br />
<h2><a name="Other_Languages"></a>他の言語</h2>
<ul>
    <li><a href="http://social.technet.microsoft.com/wiki/contents/articles/256.how-to-insert-formatted-windows-powershell-code-on-technet-wiki.aspx">How to Insert Formatted Windows PowerShell Code on TechNet Wiki (en-US)</a></li>
    <li><a href="http://social.technet.microsoft.com/wiki/contents/articles/7088.wie-fugen-sie-formattierten-windows-powershell-code-im-technet-wiki-ein-de-de.aspx">Wie f&uuml;gen Sie formatierten Windows PowerShell-Code in TechNet Wiki ein (de-DE)</a></li>
    <li><a href="http://social.technet.microsoft.com/wiki/contents/articles/8196.como-inserir-codigo-formatado-do-windows-powershell-no-technet-wiki-pt-br.aspx">Como Inserir C&oacute;digo Formatado do Windows PowerShell no TechNet Wiki (pt-BR)</a></li>
    <li><a href="http://social.technet.microsoft.com/wiki/contents/articles/10815.jak-wstawic-sformatowany-kod-windows-powershell-na-technet-wiki-pl-pl.aspx">Jak wstawić sformatowany kod Windows PowerShell na TechNet Wiki (pl-PL)</a></li>
</ul></div>
    
    