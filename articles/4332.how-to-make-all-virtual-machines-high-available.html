---
layout: default
title: How to&#58; Make All Virtual Machines High Available - TechNet Articles - United States (English) - TechNet Wiki
weight: 3
---

<div class="post-content user-defined-markup">

<p>&nbsp;</p>
<table border="0" cellpadding="5" cellspacing="0">
<tbody>
<tr>
<td valign="Top">
<div style="background-color:#f0f0f0;padding:5px;color:#c0c0c0;font-family:consolas,&#39;lucida console&#39;;font-size:7pt;">
001<br />
002<br />
003<br />
004<br />
005<br />
006<br />
<br />
007<br />
<br />
008<br />
<br />
009<br />
010<br />
011<br />
012<br />
013<br />
<br />
014<br />
015<br />
</div>
</td>
<td valign="Top" style="white- no-wrapper" id="fragment-6615">
<div class="content-fragment-inner fiji-content-fragment-inner"><div class="content-fragment-top fiji-content-fragment-top"><div class="r1 fiji-r1"></div><div class="r2 fiji-r2"></div><div class="r3 fiji-r3"></div><div class="r4 fiji-r4"></dspace:nowrap;">
<div style="background-color:#fcfcfc;padding:5px;font-family:consolas,&#39;lucida console&#39;;font-size:9pt;">
<span style="color:#ff4500;">$Cluster</span><span style="color:#000000;">&nbsp;</span><span style="color:#a9a9a9;">=</span><span style="color:#000000;">&nbsp;</span><span style="color:#8b0000;">&quot;Cluster.contoso.com&quot;</span><br />
<span style="color:#ff4500;">$Node</span><span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#a9a9a9;">=</span><span style="color:#000000;">&nbsp;</span><span style="color:#8b0000;">&quot;Node1.contoso.com&quot;</span><br />
<br />
<span style="color:#0000ff;">Import-Module</span><span style="color:#000000;">&nbsp;</span><span style="color:#000080;">-Name</span><span style="color:#000000;">&nbsp;</span><span style="color:#8b0000;">&quot;FailoverClusters&quot;</span><br />
<br />
<span style="color:#ff4500;">$VM</span><span style="color:#000000;">&nbsp;</span><span style="color:#a9a9a9;">=</span><span style="color:#000000;">&nbsp;</span><span style="color:#0000ff;">Get-WmiObject</span><span style="color:#000000;">&nbsp;</span><span style="color:#000080;">-Namespace</span><span style="color:#000000;">&nbsp;</span><span style="color:#8b0000;">&quot;root/virtualization&quot;</span><span style="color:#000000;">&nbsp;</span>`<br />
<br />
<span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000080;">-Class</span><span style="color:#000000;">&nbsp;</span><span style="color:#8a2be2;">msvm_computersystem</span><span style="color:#000000;">&nbsp;</span>`&nbsp;<br />
&nbsp;<span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000080;">-Filter</span><span style="color:#000000;">&nbsp;</span><span style="color:#8b0000;">&quot;Caption = &#39;Virtual Machine&#39;&quot;</span><span style="color:#000000;">&nbsp;</span>`&nbsp;<br />
&nbsp;<span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000080;">-ComputerName</span><span style="color:#000000;">&nbsp;</span><span style="color:#ff4500;">$Node</span><span style="color:#000000;">&nbsp;</span><span style="color:#a9a9a9;">|</span><span style="color:#000000;">&nbsp;</span><br />
<span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">Select-Object</span><span style="color:#000000;">&nbsp;</span><span style="color:#000080;">-ExpandProperty</span><span style="color:#000000;">&nbsp;</span><span style="color:#8b0000;">&quot;ElementName&quot;</span><br />
<span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br />
<span style="color:#ff4500;">$VM</span><span style="color:#000000;">&nbsp;</span><span style="color:#a9a9a9;">|</span><span style="color:#000000;">&nbsp;</span><span style="color:#0000ff;">ForEach-Object</span><span style="color:#000000;">&nbsp;</span><span style="color:#000000;">{</span><br />
<span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">Add-ClusterVirtualMachineRole</span><span style="color:#000000;">&nbsp;</span><span style="color:#000080;">-Cluster</span><span style="color:#000000;">&nbsp;</span><span style="color:#ff4500;">$Cluster</span><span style="color:#000000;">&nbsp;</span>`<br />
<br />
<span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000080;">-VirtualMachine</span><span style="color:#000000;">&nbsp;</span><span style="color:#ff4500;">$_</span><span style="color:#000000;">&nbsp;</span><span style="color:#a9a9a9;">|</span><span style="color:#000000;">&nbsp;</span><span style="color:#0000ff;">Out-Null</span><br />
<span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000;">}</span> </div>
</td>
</tr>
</tbody>
</table>
<br />
<table border="0" cellpadding="5" cellspacing="0">
<tbody>
<tr>
<td valign="Top">
<div style="background-color:#f0f0f0;padding:5px;color:#c0c0c0;font-family:consolas,&#39;lucida console&#39;;font-size:7pt;">
001<br />
002<br />
003<br />
004<br />
005<br />
006<br />
</div>
</td>
<td valign="Top" style="white-space:nowrap;">
<div style="background-color:#fcfcfc;padding:5px;font-family:consolas,&#39;lucida console&#39;;font-size:9pt;">
<span style="color:#ff4500;">$Cluster</span><span style="color:#000000;">&nbsp;</span><span style="color:#a9a9a9;">=</span><span style="color:#000000;">&nbsp;</span><span style="color:#8b0000;">&quot;Cluster.contoso.corm&quot;</span><br />
<br />
<span style="color:#0000ff;">Get-Cluster</span><span style="color:#000000;">&nbsp;</span><span style="color:#000080;">-Name</span><span style="color:#000000;">&nbsp;</span><span style="color:#ff4500;">$Cluster</span><span style="color:#000000;">&nbsp;</span><span style="color:#a9a9a9;">|</span><span style="color:#000000;">&nbsp;</span><br />
<span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">Get-ClusterResource</span><span style="color:#000000;">&nbsp;</span><span style="color:#a9a9a9;">|</span><span style="color:#000000;">&nbsp;</span><br />
<span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">Where-Object</span><span style="color:#000000;">&nbsp;</span><span style="color:#000000;">{</span><span style="color:#000000;">&nbsp;</span><span style="color:#ff4500;">$_</span><span style="color:#a9a9a9;">.</span><span style="color:#000000;">ResourceType</span><span style="color:#a9a9a9;">.</span><span style="color:#000000;">Name</span><span style="color:#000000;">&nbsp;</span><span style="color:#a9a9a9;">-eq</span><span style="color:#000000;">&nbsp;</span><span style="color:#8b0000;">&quot;Virtual
 Machine&quot;</span><span style="color:#000000;">&nbsp;</span><span style="color:#000000;">}</span><span style="color:#000000;">&nbsp;</span><span style="color:#a9a9a9;">|</span><span style="color:#000000;">&nbsp;</span><br />
<span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">Start-ClusterResource</span>
</div>
</td>
</tr>
</tbody>
</table>

</div>
    
    