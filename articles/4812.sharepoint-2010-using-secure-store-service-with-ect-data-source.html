---
layout: default
title: SharePoint 2010&#58; Using Secure Store Service with ECT Data Source - TechNet Articles - United States (English) - TechNet Wiki
weight: 3
---

<div class="post-content user-defined-markup">

<p class="ms-rteThemeFontFace-1div class="r1 fiji-r1"></div><div class="r2 fiji-r2"></div><div class="r3 fiji-r3"></div><div class="r4 fiji-r4"></div></div></div></div>
<div class="content-fragment page no-wrapper" id="fragment-6615">
<div class="content-fragment-inner fiji-content-fragment-inner"><div class="content-fragment-top fiji-content-fragment-top"><div class="r1 fiji-r1"></div><div class="r2 fiji-r2"></div><div class="r3 fiji-r3"></div><div class="r4 fiji-r4"></div></div><div class="content-fragment-content">

<div class="full-post-header"></div>
<div class="full-post">
    <h1 class="post-name">SharePoint 2010: Using Secure Store Service with ECT Data Source</h1>
    <div class="post-rating"><span id="ctl00_ctl00_content_content_ctl00_w_6615__648663 ms-rteFontSize-2"><span style="font-family:calibri;">From this article you will be able to design External Content Type Connection&nbsp;on SharePoint 2010 with Impersonated Custom Identity<br />
&nbsp;via <strong>Secure Store Applications</strong>.<br />
<br />
<br />
</span><strong><span style="font-family:calibri;color:#0070c0;">On SharePoint Central Admin level:</span></strong></p>
<p class="ms-rteThemeFontFace-1 ms-rteFontSize-2"><strong><span style="font-family:calibri;">1.
</span></strong><strong><span style="font-family:calibri;">First of all, we have enable the “Secure Store Service” from the Central Admin:</span></strong></p>
<p class="ms-rteThemeFontFace-1 ms-rteFontSize-2"><span style="font-family:calibri;">Form Central Admin&nbsp;==&gt;</span><span style="font-family:calibri;"> Services on Server&nbsp;==&gt;</span><span style="font-family:calibri;"> start the Secure Store Service.</span><span style="font-family:calibri;">&nbsp;</span></p>
<p class="ms-rteThemeFontFace-1 ms-rteFontSize-2"><strong><span style="font-family:calibri;">2.
</span></strong><strong><span style="font-family:calibri;">Create &nbsp;new secure Store Target application:</span></strong></p>
<p class="ms-rteThemeFontFace-1 ms-rteFontSize-2"><strong><span style="font-family:calibri;">Form Central Admin&nbsp;==&gt;&nbsp;</span></strong><strong><span style="font-family:calibri;">&nbsp;Application Management&nbsp;&nbsp;==&gt;&nbsp;</span></strong><strong><span style="font-family:calibri;">&nbsp;Manage
 Service Applications</span></strong></p>
<p class="ms-rteThemeFontFace-1 ms-rteFontSize-2"><span style="font-family:calibri;"><span style="font-family:verdana;">==&gt;</span>&nbsp;Then select the “Secure Store Service Application&quot; =&gt;
</span>Click Manage form the ribbon menu.</p>
<p class="ms-rteThemeFontFace-1 ms-rteFontSize-2" style="text-align:center;"><a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/7065.1_5F00_store.png"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/7065.1_5F00_store.png" style="border:2px solid #ff0000;" /></a></p>
<p class="ms-rteThemeFontFace-1 ms-rteFontSize-2">&nbsp;</p>
<p>&nbsp;<span style="font-family:calibri;"><strong>3. Create new Secure Store for Target Application To set our credential on SharePoint</strong></span></p>
<p class="ms-rteThemeFontFace-1 ms-rteFontSize-2"><strong>So insert any name&nbsp;for Target Application ID, Contact E-mail and we will make the type to be Individual as snapshot below:</strong>
</p>
<div class="ms-rteThemeFontFace-1 ms-rteFontSize-2"><strong>&nbsp; </strong></div>
<p>&nbsp;</p>
<p class="ms-rteThemeFontFace-1 ms-rteFontSize-2" style="text-align:center;"><a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/1777.2_5F00_store.png"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/1777.2_5F00_store.png" style="border:2px solid #ff0000;width:351px;height:290px;" /></a></p>
<p class="ms-rteThemeFontFace-1 ms-rteFontSize-2">&nbsp;</p>
<p>&nbsp;</p>
<p class="ms-rteThemeFontFace-1 ms-rteFontSize-2"><strong><span class="ms-rteThemeFontFace-1 ms-rteFontSize-2"><strong><span style="font-family:calibri;">Click next to set the fields of credentials
</span></strong></span>&nbsp;<strong><span style="font-family:calibri;">4. S</span></strong><strong>et the credentials field type base the target application property So I’m going to change the filed to be User Name and Password For our external SQL server</strong><strong>&nbsp;
</strong></strong></p>
<p>&nbsp;&nbsp;</p>
<p class="ms-rteThemeFontFace-1 ms-rteFontSize-2" style="text-align:center;"><a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/3058.3_5F00_store.png"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/3058.3_5F00_store.png" style="border:2px solid #ff0000;" /></a></p>
<p>&nbsp;<strong><strong>5. Click Next to set the Target Application Administrator<br />
</strong></strong></p>
<p class="ms-rteThemeFontFace-1 ms-rteFontSize-2">&nbsp;</p>
<p>&nbsp;</p>
<p class="ms-rteThemeFontFace-1 ms-rteFontSize-2"><strong><strong>&nbsp;</strong></strong></p>
<p class="ms-rteThemeFontFace-1 ms-rteFontSize-2" style="text-align:center;"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/0334.4_5F00_store.png" style="border:2px solid #ff0000;" /></p>
<div style="text-align:left;">&nbsp;</div>
<p>&nbsp;</p>
<p class="ms-rteThemeFontFace-1 ms-rteFontSize-2" style="text-align:center;">&nbsp;</p>
<p><span style="font-family:calibri;">Click OK&nbsp;&nbsp;to save. <br />
</span><span style="font-family:calibri;">Then you’ll find the new Target Application Secure Store ID been created as below:</span>&nbsp;</p>
<p><a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/5023.5_5F00_store.png"></a></p>
<p class="ms-rteFontSize-2 ms-rteThemeFontFace-1" style="text-align:center;"><a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/7462.6_5F00_store.png"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/7462.6_5F00_store.png" style="border:2px solid #ff0000;" /></a></p>
<p class="ms-rteFontSize-2 ms-rteThemeFontFace-1">&nbsp;</p>
<p>&nbsp;<strong><span style="font-family:calibri;">6. Set the User Name and password for External SQL a</span></strong><strong>nd the Credential Owner by click on &quot;Set Button&quot;&nbsp;:<br />
</strong></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p class="ExternalClassB8E1848CDEE54F749E5F99175FC978BD" style="text-align:center;">
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/6574.7_5F00_store.png"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/6574.7_5F00_store.png" style="border:2px solid #ff0000;" /></a></p>
<p>&nbsp;</p>
<p class="ExternalClassB8E1848CDEE54F749E5F99175FC978BD"><strong><span style="font-family:calibri;">Then Save.</span></strong><strong><span style="font-family:calibri;">&nbsp;</span></strong></p>
<p class="ExternalClassB8E1848CDEE54F749E5F99175FC978BD"><strong><span style="font-family:calibri;">On this stage we have our External SQL credential Stored on SharePoint Farm.</span></strong><strong><span stylstrong>nd the Credential Owner by click on &quot;Set Button&quot;&nbsp;:<br />
</strong></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p class="ExternalClassB8E1848CDEE54F749E5F99175FC978BD" style="text-align:center;">
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/6574.7_5F00_store.png"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/6574.7_5F00_store.png" style="border:2px solid #ff0000;" /></a></p>
<p>&nbsp;</p>
<p class="ExternalClassB8E1848CDEE54F749E5F99175FC978BD"><strong><span style="font-family:calibri;">Then Save.</span></strong><strong><span style="font-family:calibri;">&nbsp;</span></strong></p>
<p class="ExternalClassB8E1848CDEE54F749E5F99175FC978BD"><strong><span style="font-family:calibri;">On this stage we have our External SQL credential Stored on SharePoint Farm.</span></strone="font-family:calibri;">&nbsp;</span></strong></p>
<p class="ms-rteFontSize-3 ms-rteForeColor-2"><strong><span style="font-size:14px;font-family:calibri;color:#0070c0;">On SharePoint Designer level :</span></strong></p>
<p class="ExternalClassB8E1848CDEE54F749E5F99175FC978BD"><strong><span style="font-family:calibri;">1.&nbsp;</span></strong><strong><span style="font-family:calibri;">Create new external content type.</span></strong></p>
<p class="ExternalClassB8E1848CDEE54F749E5F99175FC978BD" style="text-align:center;">
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/8623.8_5F00_store.png"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/8623.8_5F00_store.png" style="border:2px solid #ff0000;width:244px;height:530px;" /></a></p>
<p class="ExternalClassB8E1848CDEE54F749E5F99175FC978BD">&nbsp;<strong><span style="font-family:calibri;">2. Then let’s discover our external Content type.<br />
</span></strong>&nbsp;</p>
<p class="ExternalClassB8E1848CDEE54F749E5F99175FC978BD" style="text-align:center;">
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/6557.9_5F00_store.png"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/6557.9_5F00_store.png" style="border:2px solid #ff0000;" /></a></p>
<p class="ExternalClassB8E1848CDEE54F749E5F99175FC978BD">3. Add connection and select SQL type:&nbsp;</p>
<p class="ExternalClassB8E1848CDEE54F749E5F99175FC978BD" style="text-align:center;">
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/2084.10_5F00_store.png"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/2084.10_5F00_store.png" style="border:2px solid #ff0000;" /></a></p>
<p class="ExternalClassB8E1848CDEE54F749E5F99175FC978BD"><strong class="ms-rteFontSize-3" style="text-decoration:underline;"><span style="font-family:calibri;">Now it is the Showtime:</span></strong></p>
<p class="ExternalClassB8E1848CDEE54F749E5F99175FC978BD"><strong><span style="font-family:calibri;">In&nbsp;connection details we will use our Applications ID which we crated in pervious steps and saved on SharePoint to as Impersonated Custom Identity via Secure
 Store Applications.</span></strong><br />
<br />
</p>
<p class="ExternalClassB8E1848CDEE54F749E5F99175FC978BD" style="text-align:center;">
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/0876.11_5F00_store.png"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/0876.11_5F00_store.png" style="border:2px solid #ff0000;" /></a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>

</div>
    
    