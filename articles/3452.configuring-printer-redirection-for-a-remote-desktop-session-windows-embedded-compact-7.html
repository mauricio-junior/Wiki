---
layout: default
title: Configuring Printer Redirection for a Remote Desktop Session (Windows Embedded Compact 7) - TechNet Articles - United States (English) - TechNet Wiki
weight: 3
---

<div class="post-content user-defined-markup"><div id="mainBody">
<p>When you add the printer redirection feature in Remote Desktop Connection to your OS design, a printer connected to a Windows Embedded Compact powered device can print output from a server that is running Remote Desktop Services.</p>
<p>Users can use printer redirection to print to a local printer from a Windows Server 2008 R2, Windows Server 2008, or Windows Server 2003 server within a Remote Desktop Protocol (RDP) session. The local printer can be a printer directly connected to the device or a networked printer. The server detects the local printer that is connected to the Compact 7 powered device when the user initiates an RDP session from the device. If the driver for the local printer is not already installed on the server but is included in the OS setup files, the server automatically locates the driver and initiates driver installation. If the local printer requires a driver that is not installed or available on the version of the server that is hosting the remote connection, you must manually install the driver (the first time, only) on the server to make the printer available to the device from within the RDP session.</p>
<p>To add the printer redirection feature to the OS design, you select the SYSGEN_RDP_PRINTER catalog item in Platform Builder. For more information, see <a href="http://msdn.microsoft.com/en-us/library/ee483562.aspx" target="_self">Remote Desktop Connection Catalog Items and Sysgen Variables</a>.</p>
<p>To use printer redirection, you must configure both the Windows Embedded Compact powered device and the server.</p>
<p>In this article:</p>
<ul>
    <li class="unordered"><a href="#ConfiguringPrinterRedirectionInCompact7">Configuring printer redirection in Windows Embedded Compact 7</a> </li>
    <li class="unordered"><a href="#ConfiguringPrinterRedirectionOnTheServer">Configuring printer redirection on the server</a> </li>
    <li class="unordered"><a href="#KnownIssues">Known Issues</a> </li>
</ul>
<div>
<h2 class="heading"><hr />
</h2>
<h2 class="heading">Configuring printer redirection in Windows Embedded Compact 7<a name="ConfiguringPrinterRedirectionInCompact7"></a></h2>
<div class="section" id="sectionSection0">
<p>Use the following procedure to configure your Compact 7 device for printer redirection.</p>
<div>
<div><b>To configure your device for printer redirection</b></div>
<div class="subSection">

<ol class="ordered">
    <li>
    <p>Connect a printer directly to the Compact 7 powered device (through the USB or parallel port), or connect a networked printer to the Windows Embedded Compact 7 powered device.</p>
    </li>
    <li>
    <p>On the device, click <b>Start</b>, and then click <b>Remote Desktop Connection</b>. Your device may not have a <b>Start</b> button; it will depend on the device&rsquo;s configuration.</p>
    </li>
    <li>
    <p>In the <b>Remote Desktop Connection</b> dialog box, click the <b>Options</b> button.</p>
    </li>
    <li>
    <p>On the <b>Local Resources</b> tab, under <b>Local devices and resources</b>, select the <b>Printers</b> check box if it is not already selected, and then click the <b>Printers</b> button. </p>
    </li>
    <li>
    <p>In the <b>Printers</b> dialog box, double-click <b>Add Printer</b>. The Printer Wizard starts.</p>
    </li>
    <li>
    <p>On the <b>Printer Wizard</b> page, in the <b>Port</b> list, click the port that you want your printer to use, and then click <b>Next</b>.</p>
    <p>The following figure shows the Printer Wizard.</p>
    <p><a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/6518.PrinterRedirection.png"><img alt=" " style="border:0px solid currentcolor;" src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/6518.PrinterRedirection.png" /></a></p>
    </li>
    <li>
    <p>Select your printer model from the list of manufacturers and printers. If your printer model is not listed, select the <b>User Defined</b> check box, and then click <b>Next</b>.</p>
    </li>
    <li>
    <p>If you selected a printer from the list, type a name for the printer, and then click <b>Next</b>.</p>
    <p>If you selected the <b>User Defined</b> check box for the printer model name, type the name of the printer driver name, which must be installed on the server, and then click <b>Next</b>. Type a name for the printer, and then click <b>Next</b>.</p>
    <div class="alert" style="border:1px solid #bbbbbb;margin-bottom:10px;background-color:#fcfec5;">
    <table width="100%" style="border-width:0px;" cellspacing="0" cellpadding="0">
        <tbody>
            <tr>
                <th align="left" style="padding:10px 11px 1px;border:0px hidden currentcolor;border-collapse:collapse;background-color:#fcfec5;"><span style="font-size:12px;">Important: </span></th>
            </tr>
            <tr>
                <td style="border-width:0px;padding:1px 11px 10px;background-color:#fcfec5;"><span style="font-size:12px;">The printer model name must exactly match the name of the printer driver on the server. </span></td>
            </tr>
        </tbody>
    </table>
    </div>
    </li>
    <li>
    <p>When asked if you want to configure another printer, click <b>No</b>, click <b>Next</b>, and then click <b>Finish</b>.</p>
    </li>
    <li>
    <p>In the Remote Desktop Connection dialog box, continue connecting to the server. </p>
    </li>
</ol>

</div>
</div>
</div>
</div>
<div>
<h2 class="heading"><hr />
</h2>
<h2 class="heading">Configuring printer redirection on the server<a name="ConfiguringPrinterRedirectionOnTheServer"></a></h2>
<div class="section" id="sectionSection1">
<p>Use the following procedures to configure Windows Server 2;background-color:#fcfec5;"><span style="font-size:12px;">Important: </span></th>
            </tr>
            <tr>
                <td style="border-width:0px;padding:1px 11px 10px;background-color:#fcfec5;"><span style="font-size:12px;">The printer model name must exactly match the name of the printer driver on the server. </span></td>
            </tr>
        </tbody>
    </table>
    </div>
    </li>
    <li>
    <p>When asked if you want to configure another printer, click <b>No</b>, click <b>Next</b>, and then click <b>Finish</b>.</p>
    </li>
    <li>
    <p>In the Remote Desktop Connection dialog box, continue connecti008 R2, Windows Server 2008, or Windows Server 2003 for printer redirection.</p>
<p>The Compact 7 RDP client does not support Remote Desktop Easy Print. If there is no printer driver on the server, you will need to manually install drivers. For Windows Server 2008 R2, Windows Server 2008, or Windows Server 2003, if you can&rsquo;t find the printer driver online, you can install the printer driver by using Windows hardware updates. To do this, connect the printer to the server and configure the printer for updates by using the Add Hardware Wizard (hdwwiz.exe). For more information about installing the driver by using Windows hardware updates, see <a href="http://msdn.microsoft.com/en-us/library/ff553639(VS.85).aspx" target="_self">Using the Add Hardware Wizard to Install a Driver Package</a>.</p>
<div>
<div><b>To configure Windows Server 2008 R2 for printer redirection by disabling Group Policy settings</b></div>
<div class="subSection">

<ol class="ordered">
    <li>
    <p>To open Group Policy Editor, click <b>Start</b> , click <b>Run</b>, and in the <b>Open</b> box, type <b>gpedit.msc</b>.</p>
    </li>
    <li>
    <p>Expand <b>Computer Configuration</b>, then <b>Administrative Templates</b>, then <b>Windows Components</b>, then <b>Remote Desktop Services</b>, and then <b>Remote Desktop Session Host</b>.</p>
    </li>
    <li>
    <p>Under <b>Desktop Session Host</b>, click <b>Printer Redirection</b>.</p>
    </li>
    <li>
    <p>In the <b>Printer Redirection</b> pane, double-click <b>Do not allow client printer redirection</b>. </p>
    </li>
    <li>
    <p>In the <b>Do not allow client printer redirection</b> dialog box, select <b>Disabled</b>, and then click <b>OK</b>.</p>
    </li>
    <li>
    <p>In the <b>Printer Redirection</b> pane, double-click <b>Use Terminal Services Easy Print printer driver first</b>. </p>
    <p>In the <b>Use Terminal Services Easy Print driver first</b> dialog box, select <b>Disabled</b>, and then click <b>OK</b>.</p>
    </li>
</ol>

</div>
</div>
<div>
<div><b>To configure Windows Server 2008 for printer redirection by disabling Group Policy settings</b></div>
<div class="subSection">

<ol class="ordered">
    <li>
    <p>To open Group Policy Editor, click <b>Start</b>, click <b>Run</b>, and in the <b>Open</b> box, type <b>gpedit.msc</b>.</p>
    </li>
    <li>
    <p>Expand <b>Computer Configuration</b>, then <b>Administrative Templates</b>, then <b>Windows Components</b>, then <b>Terminal Services</b>, and then <b>Terminal Server</b>.</p>
    </li>
    <li>
    <p>Under <b>Terminal Server</b>, click <b>Printer Redirection</b>.</p>
    </li>
    <li>
    <p>In the <b>Printer Redirection</b> pane, double-click <b>Do not allow client printer redirection</b>. </p>
    </li>
    <li>
    <p>In the <b>Do not allow client printer redirection</b> dialog box, select <b>Disabled</b>, and then click <b>OK</b>.</p>
    </li>
    <li>
    <p>In the <b>Printer Redirection</b> pane, double-click <b>Use Terminal Services Easy Print printer driver first</b>. </p>
    </li>
    <li>
    <p>In the <b>Use Terminal Services Easy Print driver first</b> dialog box, select <b>Disabled</b>, and click <b>OK</b>.</p>
    </li>
</ol>

</div>
</div>
<div>
<div><b>To configure Windows Server 2003 for printer redirection by disabling Group Policy settings</b></div>
<div class="subSection">

<ol class="ordered">
    <li>
    <p>To open Group Policy Editor, click <b>Start</b>, click <b>Run</b>, and in the <b>Open</b> box, type <b>gpedit.msc</b>.</p>
    </li>
    <li>
    <p>Expand <b>Computer Configuration</b>, then <b>Administrative Templates</b>, then <b>Windows Components</b>, and then <b>Terminal Services</b>.</p>
    </li>
    <li>
    <p>Under <b>Terminal Services</b>, click <b>Client/Server Data Redirection</b>.</p>
    </li>
    <li>
    <p>In the <b>Client/Server Data Redirection</b> pane, double-click <b>Do not allow client printer redirection</b>. </p>
    <p>In <b>Client/Server Data Redirection</b>, select <b>Disabled</b> and click <b>OK</b>.</p>
    </li>
</ol>

</div>
</div>
<p>&nbsp;</p>
<hr />
</div>
<h2 class="section" id="sectionSection1">Known Issues<a name="KnownIssues"></a></h2>
</div>
<div>
<div class="section" id="sectionSection2">
<ul>
    <li class="unordered">In some cases, a print job does not run immediately after you configure printer redirection. It may take from 2 to 3 minutes for a print job to run the first time you send a print request from the server after you configure printer redirection. Subsequent print jobs will run as usual. </li>
    <li class="unordered">The Compact 7 RDP client does not support the XPS Printer Redirection feature of Windows Remote Desktop Services. </li>
</ul>
</div>
</div>
<div>
<h2 class="heading"><hr />
</h2>
<h2 class="heading"><a name="See_Also"></a>See Also</h2>
<div class="section" id="sectionSection3">
<ul>
    <li class="unordered"><a class="ExistingPageLink" href="/wiki/contents/articles/3451.remote-desktop-protocol-windows-embedded-compact-7.aspx" title="Click to view the page titled: Windows Embedded Compact 7: Remote Desktop Protocol">Windows Embedded Compact 7: Remote Desktop Protocol</a> </li>
</ul>
</div>
</div>
</div></div>
    
    