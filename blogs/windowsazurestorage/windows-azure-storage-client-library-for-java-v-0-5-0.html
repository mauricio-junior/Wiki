---
layout: windowsazurestorage
title: Windows Azure Storage Client Library for Java v. 0.5.0
weight: 3
---

<div id="site-content" class="site-content row">

	<div id="primary" class="content-area col-sm-9">
		<div id="single-content" class="div-content">

			
				
<article id="post-145" class="post-145 post type-post status-publish format-standard hentry category-uncategorized">

	<header class="entry-header single">
		<h1 class="entry-title">Windows Azure Storage Client Library for Java v. 0.5.0</h1>		<div class="rating-wrap">
		<div id="star-rating-145" class="wds-ratings" data-rating="5" data-userrating="0" data-postid="145" data-container="body" data-toggle="tooltip" title="1 user(s) rated">
			<div class="wds-ratings-inner-wrap">
				<div>
					<div aria-label="Select 5 star, this article is 5 star rated" tabindex="0" class="wds-ratings-stars wds-ratings-stars-enable-editing" data-stars="5"><span aria-hidden="true" class="star-1"><span>&#x2605;</span></span><span aria-hidden="true" class="star-2"><span>&#x2605;</span></span><span aria-hidden="true" class="star-3"><span>&#x2605;</span></span><span aria-hidden="true" class="star-4"><span>&#x2605;</span></span><span aria-hidden="true" class="star-5"><span>&#x2605;</span></span></div><div aria-label="Select 4 star, this article is 5 star rated" tabindex="0" class="wds-ratings-stars wds-ratings-stars-enable-editing" data-stars="4"><span aria-hidden="true" class="star-1"><span>&#x2605;</span></span><span aria-hidden="true" class="star-2"><span>&#x2605;</span></span><span aria-hidden="true" class="star-3"><span>&#x2605;</span></span><span aria-hidden="true" class="star-4"><span>&#x2605;</span></span></div><div aria-label="Select 3 star, this article is 5 star rated" tabindex="0" class="wds-ratings-stars wds-ratings-stars-enable-editing" data-stars="3"><span aria-hidden="true" class="star-1"><span>&#x2605;</span></span><span aria-hidden="true" class="star-2"><span>&#x2605;</span></span><span aria-hidden="true" class="star-3"><span>&#x2605;</span></span></div><div aria-label="Select 2 star, this article is 5 star rated" tabindex="0" class="wds-ratings-stars wds-ratings-stars-enable-editing" data-stars="2"><span aria-hidden="true" class="star-1"><span>&#x2605;</span></span><span aria-hidden="true" class="star-2"><span>&#x2605;</span></span></div><div aria-label="Select 1 star, this article is 5 star rated" tabindex="0" class="wds-ratings-stars wds-ratings-stars-enable-editing" data-stars="1"><span aria-hidden="true" class="star-1"><span>&#x2605;</span></span></div>
				</div>
			</div>
		</div>
		</div>		<div class="clear-both"></div>
		<div class="entry-meta">
			<img alt="avatar of windows-azure-storage" src="https://i1.social.s-msft.com/profile/u/avatar.jpg?displayname=Windows+Azure+Storage&amp;size=extralarge&amp;version=00000000-0000-0000-0000-000000000000" class="avatar avatar-22 photo" height="22" width="22"/><span class="byline"><span class="author vcard"><a class="url fn n profile-usercard-hover" data-profile-userid="59e1aedafa2d4428b7004b2c2fac4adc" href="https://social.msdn.microsoft.com/profile/Windows+Azure+Storage">Windows Azure Storage</a></span></span><span class="posted-on posted-on-margin"><span class="screen-reader-text"></span><time class="entry-date published updated" datetime="2013-12-19T08:42:57+00:00">December 19, 2013</time></span><span class="comments-link"><span class="glyphicon glyphicon-comment" aria-hidden="true"></span><a href="https://blogs.msdn.microsoft.com/windowsazurestorage/2013/12/19/windows-azure-storage-client-library-for-java-v-0-5-0/#comments">3</a></span>				<span class="social-icons-wrap">
		<ul class="social-icons">
			<li><div class="fb-share-button" data-href="https://blogs.msdn.microsoft.com/windowsazurestorage/2013/12/19/windows-azure-storage-client-library-for-java-v-0-5-0/" data-layout="button_count" data-size="large" data-mobile-iframe="true"><a class="fb-xfbml-parse-ignore" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blogs.msdn.microsoft.com/windowsazurestorage/2013/12/19/windows-azure-storage-client-library-for-java-v-0-5-0/&amp;src=sdkpreparse">Share</a></div></li>
			<div id="fb-root" style="display:none"></div>

			<li class="social-icon twitter"><a data-social="{&quot;type&quot;:&quot;twitter&quot;, &quot;url&quot;:&quot;https://blogs.msdn.microsoft.com/windowsazurestorage/2013/12/19/windows-azure-storage-client-library-for-java-v-0-5-0/&quot;, &quot;text&quot;: &quot;Windows Azure Storage Client Library for Java v. 0.5.0&quot;}" href="#" id="post_tweet_count">0</a></li>
			<li class="social-icon linkedin"><a data-social="{&quot;type&quot;:&quot;linkedin&quot;, &quot;url&quot;:&quot;https://blogs.msdn.microsoft.com/windowsazurestorage/2013/12/19/windows-azure-storage-client-library-for-java-v-0-5-0/&quot;, &quot;text&quot;: &quot;Windows Azure Storage Client Library for Java v. 0.5.0&quot;}" href="#" id="get_post_linkedin_count">0</a></li>
		</ul>
	</span><!-- .social-icons-wrap -->
	<script type="text/javascript">
		// Get social counts
		jQuery( window ).load(function () {
			jQuery.getScript('https://blogs.msdn.microsoft.com/windowsazurestorage/wp-content/themes/microsoft/js/social-counts.js?ver=02092017')
				.done(function(script,textStatus) {
					window.msdnsocial.ajax('https://blogs.msdn.microsoft.com/windowsazurestorage/2013/12/19/windows-azure-storage-client-library-for-java-v-0-5-0/');
				});
		});
	</script>
		</div>
		<hr>
	</header><!-- .entry-header -->

	<div class="entry-content single">
		<p>We are pleased to announce an updated release of the Windows Azure Storage Client for Java. This release includes several notable features such as logging support, new API overloads, and full support for the <a href="http://msdn.microsoft.com/en-us/library/windowsazure/dd894041.aspx" target="_blank">2013-08-15 REST</a> storage server version. (See <a href="http://blogs.msdn.com/b/windowsazurestorage/archive/2013/11/27/windows-azure-storage-release-introducing-cors-json-minute-metrics-and-more.aspx" target="_blank">here</a> for details). As usual all of the source code is available via <a href="https://github.com/WindowsAzure/azure-storage-java" target="_blank">github</a> (note the updated location). You can download the latest binaries via maven:</p>
<div id="codeSnippetWrapper">
<pre id="codeSnippet" style="margin: 0em; padding: 0px; width: 100%; text-align: left; color: black; line-height: 12pt; overflow: visible; font-family: &quot;Courier New&quot;, courier, monospace; font-size: 8pt; direction: ltr; background-color: rgb(244, 244, 244);"><span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">dependency</span><span style="color: rgb(0, 0, 255);">&gt;</span>  <br/>     <span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">groupId</span><span style="color: rgb(0, 0, 255);">&gt;</span>com.microsoft.windowsazure.storage<span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">groupId</span><span style="color: rgb(0, 0, 255);">&gt;</span><br/>     <span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">artifactId</span><span style="color: rgb(0, 0, 255);">&gt;</span>microsoft-windowsazure-storage-sdk<span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">artifactId</span><span style="color: rgb(0, 0, 255);">&gt;</span><br/>     <span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">version</span><span style="color: rgb(0, 0, 255);">&gt;</span>0.5.0<span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">version</span><span style="color: rgb(0, 0, 255);">&gt;</span><br/><span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">dependency</span><span style="color: rgb(0, 0, 255);">&gt;</span><br/></pre>
</div>
<h4>Emulator Guidance</h4>
<p>Please note, that the <a href="http://msdn.microsoft.com/en-us/library/windowsazure/dd894041.aspx" target="_blank">2013-08-15 REST</a> is currently unsupported by the storage emulator. An updated Windows Azure Storage Emulator is expected to ship with full support of these new features in the next couple of months. Users attempting to develop against the current version of the Storage emulator will receive Bad Request errors in the interim.&#160; Until then, users wanting to use the new features would need to develop and test against a Windows Azure Storage Account to leverage the <a href="http://msdn.microsoft.com/en-us/library/windowsazure/dd894041.aspx" target="_blank">2013-08-15 REST</a> version.</p>
<h4>Samples</h4>
<p>We have provided a series of <a href="https://github.com/WindowsAzure/azure-storage-java/tree/master/windowsazure-storage-samples" target="_blank">samples</a> on github to help clients get up and running with each storage abstraction and to illustrate some additional key scenarios. To run a given sample using Eclipse, simply load the samples project and update the following line in Utility.java to provide your storage credentials. </p>
<div id="codeSnippetWrapper">
<pre id="codeSnippet" style="margin: 0em; padding: 0px; width: 100%; text-align: left; color: black; line-height: 12pt; overflow: visible; font-family: &quot;Courier New&quot;, courier, monospace; font-size: 8pt; direction: ltr; background-color: rgb(244, 244, 244);"><span style="color: rgb(0, 0, 255);">public</span> <span style="color: rgb(0, 0, 255);">static</span> <span style="color: rgb(0, 0, 255);">final</span> String storageConnectionString = <span style="color: rgb(0, 96, 128);">&quot;DefaultEndpointsProtocol=http;AccountName=[ACCOUNT_NAME];AccountKey=[ACCOUNT_KEY]&quot;</span>;</pre>
<p>If you wish to use fiddler to inspect traffic while running the samples, please uncomment the following 2 lines in Utility.java.</div>
<div></div>
<div id="codeSnippetWrapper">
<pre id="codeSnippet" style="margin: 0em; padding: 0px; width: 100%; text-align: left; color: black; line-height: 12pt; overflow: visible; font-family: &quot;Courier New&quot;, courier, monospace; font-size: 8pt; direction: ltr; background-color: rgb(244, 244, 244);"><span style="color: rgb(0, 128, 0);">// System.setProperty(&quot;http.proxyHost&quot;, &quot;localhost&quot;);</span><br/><span style="color: rgb(0, 128, 0);">// System.setProperty(&quot;http.proxyPort&quot;, &quot;8888&quot;);</span><br/></pre>
<p>After updating Utiltity.java, right-click on the specific project you want to run and click on Run As Java Application. </div>
<h4> A Note about Packaging and Versioning</h4>
<p>We have migrated the Storage package out of the larger Windows Azure SDK for Java for this release. Developers who are currently leveraging the existing SDK will need to update their dependencies accordingly. Furthermore, the package names have been changed to reflect this new structure: </p>
<ul>
<li><b>com.microsoft.windowsazure</b>.<b>storage</b> – RetryPolicies, LocationMode, StorageException, Storage Credentials etc. All public classes that are common across services</li>
<li><b>com.microsoft.windowsazure.storage.blob </b>- Blob convenience implementation, applications utilizing Windows Azure Blobs should include this namespace in their import statements</li>
<li><b>com.microsoft.windowsazure.storage.queue - </b>Queue convenience implementation, applications utilizing Windows Azure Queues should include this namespace in their import statements</li>
<li><b>com.microsoft.windowsazure.storage.table - </b>Table convenience implementation, applications utilizing Windows Azure Tables should include this namespace in their import statements<b></b></li>
</ul>
<p>For a more detailed list of changes in this release, please see the Change Log &amp; Breaking Changes section below. </p>
<p>We are also adopting the <a href="http://semver.org/" target="_blank">SemVer</a> specification regarding all of the storage client sdk components we provide. This will help provide consistent and predictable versioning guidance to developers who leverage the sdk. </p>
<h4>Whats New</h4>
<p>The 0.5.0 version of the Java client library provides full support for the <a href="http://msdn.microsoft.com/en-us/library/windowsazure/dd894041.aspx" target="_blank">2013-08-15 REST</a> service version (you can read more about the supported features <a href="http://blogs.msdn.com/b/windowsazurestorage/archive/2013/11/27/windows-azure-storage-release-introducing-cors-json-minute-metrics-and-more.aspx" target="_blank">here</a>), as well as key client improvements listed below. </p>
<h5>Support for Read Access Geo Redundant Storage</h5>
<p>This release has full support for Read Access to the storage account data in the secondary region. This functionality needs to be enabled via the <a href="https://manage.windowsazure.com/" target="_blank">portal</a> for a given storage account. You can read more about RA-GRS <a href="http://blogs.msdn.com/b/windowsazurestorage/archive/2013/12/11/introducing-read-access-geo-replicated-storage-ra-grs-for-windows-azure-storage.aspx">here</a>. As mentioned in the blog, there is a getServiceStats API for Cloud[Blob|Table|Queue]Client that allows applications to easily retrieve the replication status and LastSyncTime for each service. Setting the location mode on the client object and invoking getServiceStats is shown in the example below. The LocationMode can also be configured on a per request basis by setting it on the RequestOptions object.</p>
<div id="codeSnippetWrapper">
<pre id="codeSnippet" style="margin: 0em; padding: 0px; width: 100%; text-align: left; color: black; line-height: 12pt; overflow: visible; font-family: &quot;Courier New&quot;, courier, monospace; font-size: 8pt; direction: ltr; background-color: rgb(244, 244, 244);">CloudStorageAccount httpAcc = CloudStorageAccount.parse(connectionString);<br/>CloudTableClient tClient = httpAcc.createCloudTableClient();<br/><br/><span style="color: rgb(0, 128, 0);">// Set the LocationMode to SECONDARY_ONLY since getServiceStats is supported only on the secondary endpoints.</span><br/>tClient.setLocationMode(LocationMode.SECONDARY_ONLY);<br/>ServiceStats stats = tClient.getServiceStats();<br/>Date lastSyncTime = stats.getGeoReplication().getLastSyncTime();<br/><br/>System.out.println(String.format(<span style="color: rgb(0, 96, 128);">&quot;Replication status = %s and LastSyncTime = %s&quot;</span>,stats.getGeoReplication().getStatus().toString(), lastSyncTime != null ? lastSyncTime.toString(): <span style="color: rgb(0, 96, 128);">&quot;empty&quot;</span>));<br/></pre>
</div>
<h5>Expanded Table Protocol Support (JSON)</h5>
<p>In the previous release all table traffic was sent using the AtomPub protocol. With the current release the default protocol is now JSON minimal metadata. (You can read more details regarding these protocols as well as view sample payloads <a href="http://blogs.msdn.com/b/windowsazurestorage/archive/2013/12/05/windows-azure-tables-introducing-json.aspx">here</a>) This improvement allows the client to dramatically reduce the payload size of the request as well as reduce the CPU required to process the request. These improvements allow client applications to scale higher and realize lower overall latencies for table operations. An example of setting the tablePayloadFormat on the client object is shown in the example below. The tablePayloadFormat can also be configured on a per request basis by setting it on the TableRequestOptions object.</p>
<div id="codeSnippetWrapper">
<pre id="codeSnippet" style="margin: 0em; padding: 0px; width: 100%; text-align: left; color: black; line-height: 12pt; overflow: visible; font-family: &quot;Courier New&quot;, courier, monospace; font-size: 8pt; direction: ltr; background-color: rgb(244, 244, 244);">CloudStorageAccount httpAcc = CloudStorageAccount.parse(connectionString);<br/>CloudTableClient tClient = httpAcc.createCloudTableClient();<br/><br/><span style="color: rgb(0, 128, 0);">// Set the payload format to JsonNoMetadata.</span><br/>tableClient.setTablePayloadFormat(TablePayloadFormat.JsonNoMetadata);<br/></pre>
<p>When using JsonNoMetadata the client library will “infer” the property types by inspecting the type information on the POJO entity type provided by the client. Additionally, in some scenarios clients may wish to provide the property type information at runtime such as when querying with the <em>DynamicTableEntity</em> or doing complex queries that may return heterogeneous entities. To support this scenario the user should implement PropertyResolver which allows users to return an <em>EdmType</em> for each property based on the data received from the service. The sample below illustrates a propertyResolver implementation. </div>
<div id="codeSnippetWrapper">
<pre id="codeSnippet" style="margin: 0em; padding: 0px; width: 100%; text-align: left; color: black; line-height: 12pt; overflow: visible; font-family: &quot;Courier New&quot;, courier, monospace; font-size: 8pt; direction: ltr; background-color: rgb(244, 244, 244);"><p><span style="color: rgb(0, 0, 255);">public</span> <span style="color: rgb(0, 0, 255);">static</span> <span style="color: rgb(0, 0, 255);">class</span> Class1 <span style="color: rgb(0, 0, 255);">extends</span> TableServiceEntity <span style="color: rgb(0, 0, 255);">implements</span> PropertyResolver {    <br/>        <span style="color: rgb(0, 0, 255);">private</span> String A;<br/>        <span style="color: rgb(0, 0, 255);">private</span> <span style="color: rgb(0, 0, 255);">byte</span>[] B;<br/><br/>        <span style="color: rgb(0, 0, 255);">public</span> String getA() {<br/>            <span style="color: rgb(0, 0, 255);">return</span> <span style="color: rgb(0, 0, 255);">this</span>.A;<br/>        }<br/><br/>        <span style="color: rgb(0, 0, 255);">public</span> <span style="color: rgb(0, 0, 255);">byte</span>[] getB() {<br/>            <span style="color: rgb(0, 0, 255);">return</span> <span style="color: rgb(0, 0, 255);">this</span>.B;<br/>        }<br/><br/>        <span style="color: rgb(0, 0, 255);">public</span> <span style="color: rgb(0, 0, 255);">void</span> setA(<span style="color: rgb(0, 0, 255);">final</span> String a) {<br/>            <span style="color: rgb(0, 0, 255);">this</span>.A = a;<br/>        }<br/><br/>        <span style="color: rgb(0, 0, 255);">public</span> <span style="color: rgb(0, 0, 255);">void</span> setB(<span style="color: rgb(0, 0, 255);">final</span> <span style="color: rgb(0, 0, 255);">byte</span>[] b) {<br/>            <span style="color: rgb(0, 0, 255);">this</span>.B = b;<br/>        }<br/><br/>    @Override<br/>    <span style="color: rgb(0, 0, 255);">public</span> EdmType propertyResolver(String pk, String rk, String key, String value) {<br/>            <span style="color: rgb(0, 0, 255);">if</span> (key.equals(<span style="color: rgb(0, 96, 128);">&quot;A&quot;</span>)) {<br/>                <span style="color: rgb(0, 0, 255);">return</span> EdmType.STRING;<br/>            }<br/>            <span style="color: rgb(0, 0, 255);">else</span> <span style="color: rgb(0, 0, 255);">if</span> (key.equals(<span style="color: rgb(0, 96, 128);">&quot;B&quot;</span>)) {<br/>                <span style="color: rgb(0, 0, 255);">return</span> EdmType.BINARY;<br/>            }<br/>            <span style="color: rgb(0, 0, 255);">return</span> null;<br/>        }</p><p>    }</p></pre>
</div>
<p>This propertyResolver is set on the TableRequestOptions as shown below.</p>
<div id="codeSnippetWrapper">
<pre id="codeSnippet" style="margin: 0em; padding: 0px; width: 100%; text-align: left; color: black; line-height: 12pt; overflow: visible; font-family: &quot;Courier New&quot;, courier, monospace; font-size: 8pt; direction: ltr; background-color: rgb(244, 244, 244);">Class1 ref = <span style="color: rgb(0, 0, 255);">new</span> Class1();<br/>ref.setA(<span style="color: rgb(0, 96, 128);">&quot;myPropVal&quot;</span>);<br/>ref.setB(<span style="color: rgb(0, 0, 255);">new</span> <span style="color: rgb(0, 0, 255);">byte</span>[] { 0, 1, 2 });<br/>ref.setPartitionKey(<span style="color: rgb(0, 96, 128);">&quot;testKey&quot;</span>);<br/>ref.setRowKey(UUID.randomUUID().toString());<br/><br/>options.setPropertyResolver(ref);<br/></pre>
<p></div>
<h5>Table Insert Optimizations</h5>
<p>In previous versions of the REST api the Prefer header was not supported for Insert operations. As a result, the service would “echo” back the entity content in the response body. With this release all Table Insert operations, including those executed as part of a batch operation, will send the Prefer: return-no-content header to avoid this behavior. This optimization can dramatically reduce latencies for insert operations. Please note that this will cause the resulting HTTP status code on the <i>TableResult</i> for successful inserts to be 204 (no-content) rather than 201 (Created). The echo content behavior can be re-enabled by using the <i>insert(TableEntity, boolean)</i> method and specifying true. </p>
<h5>Table Reflection Optimizations</h5>
<p>When clients are persisting POJO objects to the Table Service the client can now cache the type and property information to avoid repeated reflection calls. This optimization can dramatically reduce CPU during queries and other table operations. Note, clients can disable this cache by setting TableServiceEntity.setReflectedEntityCacheDisabled(true). </p>
<h5>New APIs and overloads</h5>
<p>In response to customer feedback we have expanded the api surface to add additional conveniences, including: </p>
<ul>
<li>CloudBlob.downloadRange </li>
<li>CloudBlob.downloadToByteArray</li>
<li>CloudBlob.downloadRangeToByteArray</li>
<li>CloudBlob.uploadFromByteArray</li>
<li>CloudBlob.uploadFromByteArray</li>
<li>CloudBlob.downloadToFile</li>
<li>CloudBlob.uploadFromFile</li>
<li>CloudBlockBlob.uploadText</li>
<li>CloudBlockBlob.downloadText</li>
</ul>
<h5>Logging</h5>
<p>The 0.5.0 release supports logging via the <a href="http://www.slf4j.org/" target="_blank">SLF4J</a> logging facade. This allows users to utilize various logging frameworks in conjunction with the storage api in order to log information regarding request execution (See below for a table of what information is logged). We plan on providing additional rich logging information in subsequent releases to further assist clients in debugging their applications.</p>
<h6>Logged Data</h6>
<p>Each log line will include the following data:</p>
<ul>
<li>Client Request ID: Per request ID that is specified by the user in OperationContext</li>
<li>Event: Free-form text</li>
<li>Any other information, as determined by the user-chosen underlying logging framework</li>
</ul>
<p>For example, if the underlying logging framework chosen is <a href="http://www.slf4j.org/apidocs/org/slf4j/impl/SimpleLogger.html" target="_blank">Simple</a>, the log line might look something like the following:</p>
<p>[main] INFO ROOT - {c88f2fe5-7150-467b-8571-7aa40a9a3e27}: {Starting operation.}</p>
<h6>Trace Levels</h6>
<table cellspacing="0" cellpadding="0" border="1">
<tbody>
<tr>
<td valign="top" width="59">
<p><b>Level</b></p>
</td>
<td valign="top" width="618">
<p><b>Events</b></p>
</td>
</tr>
<tr>
<td valign="top" width="59">
<p><b>ERROR</b></p>
</td>
<td valign="top" width="618">
<p>If an exception cannot or will not be handled internally and will be thrown to the user; it will be logged as an error.</p>
</td>
</tr>
<tr>
<td valign="top" width="59">
<p><b>WARN</b></p>
</td>
<td valign="top" width="618">
<p>If an exception is caught and might be handled internally, it will be logged as a warning. Primary use case for this is the retry scenario, where an exception is not thrown back to the user to be able to retry. It can also happen in operations such as CreateIfNotExists, where we handle the 404 error silently.</p>
</td>
</tr>
<tr>
<td valign="top" width="59">
<p><b>INFO</b></p>
</td>
<td valign="top" width="618">
<p>The following info will be logged:</p>
<ul>
<li>Right after the user calls a method to start an operation, request details such as URI* and client request ID will be logged.</li>
<li>Important milestones such as Sending Request Start/End, Upload Data Start/End, Receive Response Start/End, Download Data Start/End will be logged to mark the timestamps.</li>
<li>Right after the headers are received, response details such as request ID and HTTP status code will be logged.</li>
<li>If an operation fails and the storage client decides to retry, the reason for that decision will be logged along with when the next retry is going to happen.</li>
<li>All client-side timeouts will be logged when storage client decides to abort a pending request.</li>
</ul>
</td>
</tr>
<tr>
<td valign="top" width="59">
<p><b>DEBUG</b></p>
</td>
<td valign="top" width="618">
<p>Nothing logged at this level currently.</p>
</td>
</tr>
<tr>
<td valign="top" width="59">
<p><b>TRACE</b></p>
</td>
<td valign="top" width="618">
<p>Nothing logged at this level currently.</p>
</td>
</tr>
</tbody>
</table>
<p>*Please take care when enabling logging while using SAS as the SAS tokens themselves will be logged. As such, clients using SAS with logging enabled should take care to protect the logging output of their application.</p>
<h6>Enabling Logging</h6>
<p>A key concept is the opt-in / opt-out model that the client provides to tracing. In typical applications it is customary to enable tracing at a given verbosity for a specific class. This works fine for many client applications, however for cloud applications that are executing at scale, this approach may generate much more data than what is required by the user. As such we have provided an opt-in model for logging which allows clients to configure listeners at a given verbosity, but only log specific requests if and when they choose. Essentially this design provides the ability for users to perform “vertical” logging across layers of the stack targeted at specific requests rather than “horizontal” logging which would record all traffic seen by a specific class or layer.</p>
<p>Another key concept is the facade logging model. <a href="http://www.slf4j.org/" target="_blank">SLF4J</a> is a facade and does not provide a logging framework. Instead, the user may choose the underlying logging system, whether it be the built in jdk logger or one of the many open-source alternatives (see the <a href="http://www.slf4j.org/" target="_blank">SLF4J</a> site for a list of compatible loggers). Once a logger is selected clients can add the corresponding jar which binds the facade to the chosen framework and the application will log using the settings specific to that framework. As a result, if the user has already chosen a logging framework for their application the storage sdk will work with that framework rather than requiring a separate one. The façade model allows users to change the logging framework easily throughout the development process and avoid any framework lock in.</p>
<p><b>Choose a Logging Framework</b></p>
<p>To enable logging, first choose a logging framework. If you already have one, simply add the corresponding <a href="http://www.slf4j.org/download.html" target="_blank">SLF4J binding jar</a> to your classpath or add a dependency to it in Maven. If you do not already have a logging framework, you will need to choose one and add it to your classpath or add a dependency to it in Maven. If it does not natively implement SLF4J you will also need to add the corresponding <a href="http://www.slf4j.org/download.html" target="_blank">SLF4J binding jar</a>. SLF4J comes with its own logger implementation called <a href="http://www.slf4j.org/apidocs/org/slf4j/impl/SimpleLogger.html" target="_blank">Simple</a>, so we will use that in our example below. Either download the <i>slf4j-simple-1.7.5.jar</i> from <a href="http://www.slf4j.org/download.html" target="_blank">SLF4J</a> and add it to your classpath or include the following Maven dependency:</p>
<div id="codeSnippetWrapper">
<pre id="codeSnippet" style="margin: 0em; padding: 0px; width: 100%; text-align: left; color: black; line-height: 12pt; overflow: visible; font-family: &quot;Courier New&quot;, courier, monospace; font-size: 8pt; direction: ltr; background-color: rgb(244, 244, 244);"><span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">dependency</span><span style="color: rgb(0, 0, 255);">&gt;</span><br/>    <span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">groupId</span><span style="color: rgb(0, 0, 255);">&gt;</span>org.slf4j<span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">groupId</span><span style="color: rgb(0, 0, 255);">&gt;</span><br/>    <span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">artifactId</span><span style="color: rgb(0, 0, 255);">&gt;</span>slf4j-simple<span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">artifactId</span><span style="color: rgb(0, 0, 255);">&gt;</span><br/>    <span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">version</span><span style="color: rgb(0, 0, 255);">&gt;</span>1.7.5<span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">version</span><span style="color: rgb(0, 0, 255);">&gt;</span><br/><span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">dependency</span><span style="color: rgb(0, 0, 255);">&gt;</span><br/></pre>
<p></div>
<div id="codeSnippetWrapper">
  <br/>This will enable logging to the console with a default log level of info. To change the logging settings, follow the directions for <a href="http://www.slf4j.org/apidocs/org/slf4j/impl/SimpleLogger.html" target="_blank">Simple</a>. </div>
<p><b>1. </b><b>Turn Logging on in the SDK</b></p>
<p>By default, the Azure Storage Java SDK will not produce any logs, even if it finds a logging framework and corresponding SLF4J binding. This way, the user is not forced to edit any log framework settings if they do not want Azure Storage logs. If logging is turned on, the root logger settings will be used by default. A different logger may be specified on a per request basis.</p>
<p><strong>Example 1: </strong>Enable logging on for every request:</p>
<div id="codeSnippetWrapper">
<pre id="codeSnippet" style="margin: 0em; padding: 0px; width: 100%; text-align: left; color: black; line-height: 12pt; overflow: visible; font-family: &quot;Courier New&quot;, courier, monospace; font-size: 8pt; direction: ltr; background-color: rgb(244, 244, 244);">OperationContext.setLoggingEnabledByDefault(true);</pre>
<p><strong>Example 2</strong>: Enable logging for a single request:</div>
<div></div>
<div id="codeSnippetWrapper">
<pre id="codeSnippet" style="margin: 0em; padding: 0px; width: 100%; text-align: left; color: black; line-height: 12pt; overflow: visible; font-family: &quot;Courier New&quot;, courier, monospace; font-size: 8pt; direction: ltr; background-color: rgb(244, 244, 244);">OperationContext ctx = <span style="color: rgb(0, 0, 255);">new</span> OperationContext();<br/>ctx.setLoggingEnabled(true);<br/>blockBlobRef.upload(srcStream, -1, null <span style="color: rgb(0, 128, 0);">/* accessCondition */</span>, null <span style="color: rgb(0, 128, 0);">/* requestOptions */</span>, ctx);<br/></pre>
<p><strong>Example 3:</strong> To use a specific logger for a request:</div>
<div id="codeSnippetWrapper">
<pre id="codeSnippet" style="margin: 0em; padding: 0px; width: 100%; text-align: left; color: black; line-height: 12pt; overflow: visible; font-family: &quot;Courier New&quot;, courier, monospace; font-size: 8pt; direction: ltr; background-color: rgb(244, 244, 244);">OperationContext ctx = <span style="color: rgb(0, 0, 255);">new</span> OperationContext();<br/><br/><span style="color: rgb(0, 128, 0);">// turn logging on for that operation context</span><br/>ctx.setLoggingEnabled(true);<br/><br/><span style="color: rgb(0, 128, 0);">// the slf4j logger factory will get the logger with this name and use</span><br/><span style="color: rgb(0, 128, 0);">// this logger’s settings include location to log and log level</span><br/>ctx.setLogger(LoggerFactory.getLogger(“MyLogger”));<br/>blockBlobRef.upload(srcStream, -1, null <span style="color: rgb(0, 128, 0);">/* accessCondition */</span>, null <span style="color: rgb(0, 128, 0);">/* requestOptions */</span>, ctx);<br/></pre>
<p>With client side logging used in conjunction with storage service logging clients can now get a complete view of their application from both the client and server perspectives.</div>
<h4>Change Log &amp; Breaking Changes</h4>
<p>As mentioned above, this release supports the 2013-08-15 REST service version and details of features and changes in the version can be found in <a href="http://msdn.microsoft.com/en-us/library/windowsazure/dd894041.aspx" target="_blank">MSDN</a> and also blogged <a href="http://blogs.msdn.com/b/windowsazurestorage/archive/2013/11/27/windows-azure-storage-release-introducing-cors-json-minute-metrics-and-more.aspx" target="_blank">here</a>. In addition to the REST changes, this release includes several client side changes and features. Key changes to note for this release are highlighted below. You can view the complete <a href="https://github.com/WindowsAzure/azure-storage-java/blob/master/ChangeLog.txt" target="_blank">ChangeLog</a> and <a href="https://github.com/WindowsAzure/azure-storage-java/blob/master/BreakingChanges.txt" target="_blank">BreakingChanges</a> log on github. </p>
<p>Common</p>
<ul>
<li>Package Restructure</li>
<li>RetryResult has been replaced by RetryInfo which provides additional functionality</li>
<li>Event operations (including event firing) that occur during a request are no longer synchronized, (thread safety is now guaranteed by a CopyOnWriteArrayList of the event listeners)</li>
<li>OperationContext.sendingRequest event is now fired prior to the connection being established, allowing users to alter headers</li>
</ul>
<p>Blob</p>
<ul>
<li>Blob downloadRange now downloads to a Stream. The previous downloadRange has been renamed to downloadRangeToByteArray. </li>
<li>Removed sparse page blob feature</li>
<li>CloudBlobContainer.createIfNotExist was renamed to CloudBlobContainer.createIfNotExist<b>s</b></li>
<li><i>CloudBlobClient.streamMinimumReadSizeInBytes</i> has been removed. This functionality is now provided by <i>CloudBlob.streamMinimumReadSizeInBytes</i> (settable per-blob, not per-client.)</li>
<li><i>CloudBlobClient.pageBlobStreamWriteSizeInBytes</i> and <i>CloudBlobClient.writeBlockSizeInBytes</i> have been removed. This functionality is now provided by <i>CloudBlob.streamWriteSizeInBytes</i>.</li>
</ul>
<p>Table</p>
<ul>
<li>Removed id field (along with getId, setId) from TableResult</li>
<li><i>CloudTable.createIfNotExist</i> was renamed to <i>CloudTable.createIfNotExist<b>s</b></i></li>
<li>Inserts in operations no longer echo content. Echo content can be re-enabled by using the <i>insert(TableEntity, boolean)</i> method and specifying true. This will cause the resulting HTTP status code on the <i>TableResult</i> for successful inserts to be 204 (no-content) rather than 201 (Created).</li>
<li>JsonMinimalMetadata is now the default payload format (rather than AtomPub). Payload format can be specified for all table requests by using <i>CloudTableClient.setTablePayloadFormat</i> or for an individual table request by using <i>TableRequestOptions.setTablePayloadFormat</i>.</li>
</ul>
<p>Queue</p>
<ul>
<li><i>CloudQueue.createIfNotExist</i> was renamed to <i>CloudQueue.createIfNotExist<b>s</b></i></li>
</ul>
<h4>Summary</h4>
<p>We are continuously making improvements to the developer experience for Windows Azure Storage and very much value your feedback in the comments section below, the forums, or GitHub. If you hit any issues, filing them on GitHub will also allow you to track the resolution.</p>
<p>Joe Giardino, Veena Udayabhanu, Emily Gerner, and Adam Sorrin</p>
<h4>Resources</h4>
<p><a href="https://github.com/WindowsAzure/azure-storage-java" target="_blank">Source (github)</a></p>
<p><a href="http://search.maven.org/#search%7Cga%7C1%7Cg%3A%22com.microsoft.windowsazure.storage%22" target="_blank">Maven</a></p>
<p><a href="https://github.com/WindowsAzure/azure-storage-java/blob/master/BreakingChanges.txt" target="_blank">BreakingChanges</a></p>
<p><a href="https://github.com/WindowsAzure/azure-storage-java/blob/master/ChangeLog.txt" target="_blank">ChangeLog</a></p>
<p><a href="http://blogs.msdn.com/b/windowsazurestorage/archive/2013/11/27/windows-azure-storage-release-introducing-cors-json-minute-metrics-and-more.aspx" target="_blank">Windows Azure Storage Release - Introducing CORS, JSON, Minute Metrics, and More</a></p>
<p><a href="http://blogs.msdn.com/b/windowsazurestorage/archive/2013/12/05/windows-azure-tables-introducing-json.aspx" target="_blank">Windows Azure Tables: Introducing JSON</a></p>
<p><a href="http://blogs.msdn.com/b/windowsazurestorage/archive/2013/12/11/introducing-read-access-geo-replicated-storage-ra-grs-for-windows-azure-storage.aspx" target="_blank">Windows Azure Storage Redundancy Options and Read Access Geo Redundant Storage</a></p>
<p><a href="http://semver.org/" target="_blank">SemVer Specification</a></p>
	</div><!-- .entry-content -->


	<footer class="entry-footer single">
				<hr>
	</footer><!-- .entry-footer -->

</article><!-- #post-## -->

			
		</div><!-- #single-content -->

		
<div id="comments" class="comments-area">
	<div class="comments-title">
		Comments (3)	</div>

		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title"> <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://blogs.msdn.microsoft.com/windowsazurestorage/2013/12/19/windows-azure-storage-client-library-for-java-v-0-5-0/#respond" style="display:none;">Cancel reply</a></small></h3><p class="must-log-in">You must be <a href="https://blogs.msdn.microsoft.com/windowsazurestorage/wp-login.php?redirect_to=https%3A%2F%2Fblogs.msdn.microsoft.com%2Fwindowsazurestorage%2F2013%2F12%2F19%2Fwindows-azure-storage-client-library-for-java-v-0-5-0%2F">logged in</a> to post a comment.</p>	</div><!-- #respond -->
	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-374">
				<div id="div-comment-374" class="comment-body">
				<div class="comment-author vcard">
			<img alt="" src="https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=56&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=112&amp;d=mm&amp;r=g 2x" class="avatar avatar-56 photo" height="56" width="56"/>			<cite class="fn">Takekazu Omi</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/windowsazurestorage/2013/12/19/windows-azure-storage-client-library-for-java-v-0-5-0/#comment-374">
			December 21, 2013 at 5:21 am</a>		</div>

		<p>&quot;CloudBlob.uploadFromByteArray&quot; is duplicated. </p>

		<div class="reply"><a rel="nofollow" class="comment-reply-login" href="https://blogs.msdn.microsoft.com/windowsazurestorage/wp-login.php?redirect_to=https%3A%2F%2Fblogs.msdn.microsoft.com%2Fwindowsazurestorage%2F2013%2F12%2F19%2Fwindows-azure-storage-client-library-for-java-v-0-5-0%2F">Log in to Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-416">
				<div id="div-comment-416" class="comment-body">
				<div class="comment-author vcard">
			<img alt="" src="https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=56&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=112&amp;d=mm&amp;r=g 2x" class="avatar avatar-56 photo" height="56" width="56"/>			<cite class="fn">API User</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/windowsazurestorage/2013/12/19/windows-azure-storage-client-library-for-java-v-0-5-0/#comment-416">
			March 24, 2014 at 1:57 pm</a>		</div>

		<p>Using this API to download Page Blobs &#8211; VHDs (&gt;2GB): downloadToFile.</p>
<p>Download API returns back with a Storage Exception (An incorrect number of bytes was read from the connection. The connection may have been closed). Reading from source input stream and writing back to output stream is not completing properly and before that it exits. </p>
<p>Setting default timeout value to 0 &#8211; options.setTimeoutIntervalInMs(0);</p>
<p>Am I missing something anywhere ? Is that related to HttpConnectionUrl settings/timeout ? </p>

		<div class="reply"><a rel="nofollow" class="comment-reply-login" href="https://blogs.msdn.microsoft.com/windowsazurestorage/wp-login.php?redirect_to=https%3A%2F%2Fblogs.msdn.microsoft.com%2Fwindowsazurestorage%2F2013%2F12%2F19%2Fwindows-azure-storage-client-library-for-java-v-0-5-0%2F">Log in to Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-420">
				<div id="div-comment-420" class="comment-body">
				<div class="comment-author vcard">
			<img alt="" src="https://secure.gravatar.com/avatar/f2923a77d45ac29d069430a6d810e51f?s=56&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f2923a77d45ac29d069430a6d810e51f?s=112&amp;d=mm&amp;r=g 2x" class="avatar avatar-56 photo" height="56" width="56"/>			<cite class="fn">veena_udayabhanu@hotmail.com</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/windowsazurestorage/2013/12/19/windows-azure-storage-client-library-for-java-v-0-5-0/#comment-420">
			March 27, 2014 at 4:25 pm</a>		</div>

		<p>This is a known issue in version 0.5.0. Blob downloads are not retried by default and therefore if you hit an exception while downloading a blob due to a network issue, you would get a non-retryable exception. We have fixed this in our latest release (0.6.0). You can grab it from here &#8211; <a rel="nofollow" target="_new" href="http://mvnrepository.com/artifact/com.microsoft.windowsazure.storage/microsoft-windowsazure-storage-sdk/0.6.0">mvnrepository.com/&#8230;/0.6.0</a></p>

		<div class="reply"><a rel="nofollow" class="comment-reply-login" href="https://blogs.msdn.microsoft.com/windowsazurestorage/wp-login.php?redirect_to=https%3A%2F%2Fblogs.msdn.microsoft.com%2Fwindowsazurestorage%2F2013%2F12%2F19%2Fwindows-azure-storage-client-library-for-java-v-0-5-0%2F">Log in to Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
	
</div><!-- .comments-area -->
	</div><!-- #primary -->