---
layout: windowsazurestorage
title: Client-Side Encryption for Microsoft Azure Storage – Preview
weight: 3
---

<div id="site-content" class="site-content row">

	<div id="primary" class="content-area col-sm-9">
		<div id="single-content" class="div-content">

			
				
<article id="post-264" class="post-264 post type-post status-publish format-standard hentry category-uncategorized">

	<header class="entry-header single">
		<h1 class="entry-title">Client-Side Encryption for Microsoft Azure Storage &ndash; Preview</h1>		<div class="rating-wrap">
		<div id="star-rating-264" class="wds-ratings" data-rating="4" data-userrating="0" data-postid="264" data-container="body" data-toggle="tooltip" title="1 user(s) rated">
			<div class="wds-ratings-inner-wrap">
				<div>
					<div aria-label="Select 5 star, this article is 4 star rated" tabindex="0" class="wds-ratings-stars wds-ratings-stars-enable-editing" data-stars="5"><span aria-hidden="true" class="star-1"><span>&#x2605;</span></span><span aria-hidden="true" class="star-2"><span>&#x2605;</span></span><span aria-hidden="true" class="star-3"><span>&#x2605;</span></span><span aria-hidden="true" class="star-4"><span>&#x2605;</span></span><span aria-hidden="true" class="star-5"><span>&#x2605;</span></span></div><div aria-label="Select 4 star, this article is 4 star rated" tabindex="0" class="wds-ratings-stars wds-ratings-stars-enable-editing" data-stars="4"><span aria-hidden="true" class="star-1"><span>&#x2605;</span></span><span aria-hidden="true" class="star-2"><span>&#x2605;</span></span><span aria-hidden="true" class="star-3"><span>&#x2605;</span></span><span aria-hidden="true" class="star-4"><span>&#x2605;</span></span></div><div aria-label="Select 3 star, this article is 4 star rated" tabindex="0" class="wds-ratings-stars wds-ratings-stars-enable-editing" data-stars="3"><span aria-hidden="true" class="star-1"><span>&#x2605;</span></span><span aria-hidden="true" class="star-2"><span>&#x2605;</span></span><span aria-hidden="true" class="star-3"><span>&#x2605;</span></span></div><div aria-label="Select 2 star, this article is 4 star rated" tabindex="0" class="wds-ratings-stars wds-ratings-stars-enable-editing" data-stars="2"><span aria-hidden="true" class="star-1"><span>&#x2605;</span></span><span aria-hidden="true" class="star-2"><span>&#x2605;</span></span></div><div aria-label="Select 1 star, this article is 4 star rated" tabindex="0" class="wds-ratings-stars wds-ratings-stars-enable-editing" data-stars="1"><span aria-hidden="true" class="star-1"><span>&#x2605;</span></span></div>
				</div>
			</div>
		</div>
		</div>		<div class="clear-both"></div>
		<div class="entry-meta">
			<img alt="avatar of windows-azure-storage" src="https://i1.social.s-msft.com/profile/u/avatar.jpg?displayname=Windows+Azure+Storage&amp;size=extralarge&amp;version=00000000-0000-0000-0000-000000000000" class="avatar avatar-22 photo" height="22" width="22"/><span class="byline"><span class="author vcard"><a class="url fn n profile-usercard-hover" data-profile-userid="59e1aedafa2d4428b7004b2c2fac4adc" href="https://social.msdn.microsoft.com/profile/Windows+Azure+Storage">Windows Azure Storage</a></span></span><span class="posted-on posted-on-margin"><span class="screen-reader-text"></span><time class="entry-date published updated" datetime="2015-04-28T14:39:00+00:00">April 28, 2015</time></span><span class="comments-link"><span class="glyphicon glyphicon-comment" aria-hidden="true"></span><a href="https://blogs.msdn.microsoft.com/windowsazurestorage/2015/04/28/client-side-encryption-for-microsoft-azure-storage-preview/#comments">3</a></span>				<span class="social-icons-wrap">
		<ul class="social-icons">
			<li><div class="fb-share-button" data-href="https://blogs.msdn.microsoft.com/windowsazurestorage/2015/04/28/client-side-encryption-for-microsoft-azure-storage-preview/" data-layout="button_count" data-size="large" data-mobile-iframe="true"><a class="fb-xfbml-parse-ignore" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blogs.msdn.microsoft.com/windowsazurestorage/2015/04/28/client-side-encryption-for-microsoft-azure-storage-preview/&amp;src=sdkpreparse">Share</a></div></li>
			<div id="fb-root" style="display:none"></div>

			<li class="social-icon twitter"><a data-social="{&quot;type&quot;:&quot;twitter&quot;, &quot;url&quot;:&quot;https://blogs.msdn.microsoft.com/windowsazurestorage/2015/04/28/client-side-encryption-for-microsoft-azure-storage-preview/&quot;, &quot;text&quot;: &quot;Client-Side Encryption for Microsoft Azure Storage – Preview&quot;}" href="#" id="post_tweet_count">0</a></li>
			<li class="social-icon linkedin"><a data-social="{&quot;type&quot;:&quot;linkedin&quot;, &quot;url&quot;:&quot;https://blogs.msdn.microsoft.com/windowsazurestorage/2015/04/28/client-side-encryption-for-microsoft-azure-storage-preview/&quot;, &quot;text&quot;: &quot;Client-Side Encryption for Microsoft Azure Storage – Preview&quot;}" href="#" id="get_post_linkedin_count">0</a></li>
		</ul>
	</span><!-- .social-icons-wrap -->
	<script type="text/javascript">
		// Get social counts
		jQuery( window ).load(function () {
			jQuery.getScript('https://blogs.msdn.microsoft.com/windowsazurestorage/wp-content/themes/microsoft/js/social-counts.js?ver=02092017')
				.done(function(script,textStatus) {
					window.msdnsocial.ajax('https://blogs.msdn.microsoft.com/windowsazurestorage/2015/04/28/client-side-encryption-for-microsoft-azure-storage-preview/');
				});
		});
	</script>
		</div>
		<hr>
	</header><!-- .entry-header -->

	<div class="entry-content single">
		<p>Welcome to the preview of the new Azure Storage Client Library for .NET.&nbsp; This preview contains new functionality to help developers encrypt their data inside client applications before uploading to Azure Storage, and also to decrypt it while downloading. We also support integration with Azure <a href="http://azure.microsoft.com/en-us/services/key-vault/" target="_blank">Key Vault</a> in order to let you store and manage your keys. Client-side encryption has been a common request from the Azure Storage developer community, and so we are happy to put it in your hands for feedback.</p>
<p><strong>Why use client-side encryption?</strong></p>
<p>Client-side encryption offers one significant advantage that server side encryption cannot guarantee: you (the user) completely control the keys.&nbsp; In fact, the storage service never sees the keys and is incapable of decrypting the data.&nbsp; This gives you the most control you can have.&nbsp; It&rsquo;s also fully transparent &ndash; our library is open source and on <a href="https://github.com/Azure/azure-storage-net/tree/preview" target="_blank">GitHub</a>, and so you can inspect exactly how the library is encrypting your data to ensure that it meets your standards.</p>
<p><strong>Why are we delivering a library with client-side encryption support?</strong></p>
<p>While any developer can encrypt their data client side prior to uploading it, each developer would have to become an encryption expert.&nbsp; Not only that, but they would need to design for performance and security.&nbsp; In the end, a lot of developers would have to do the same work repeatedly.&nbsp; Not only that, but in the end, since each solution would be different, none of them would work together.</p>
<p>We wanted to provide a library that would accomplish the following:</p>
<ul>
<li>Implement Security Best Practices.&nbsp; This library has been thoroughly reviewed for its security, so that you can use it with confidence.</li>
<li>Design for Performance.&nbsp; We&rsquo;ve designed to keep your application running quick.</li>
<li>Ease of use for common scenarios: We&rsquo;ve tried to cover the most common scenarios in a way that would be easy for developers to pick up.&nbsp; While we may support more scenarios in the future, we won&rsquo;t do it at the expense of usability of the library.</li>
<li>Interoperability across languages.&nbsp; Many users use more than one of our client libraries, and our goal is to use the same technical design across implementations, so that data encrypted using the .NET library can be decrypted using the Java library.&nbsp; This first preview is focused on .NET, but we will add this support to more languages as we move forward.</li>
</ul>
<p><strong>What&rsquo;s available now?</strong></p>
<p>In our first release, we support encryption for blobs, tables, and queues.&nbsp; All of them use the envelope technique. Encryption and decryption with asymmetric keys is computationally expensive. Therefore, in the envelope technique, the data itself is not encrypted directly with such keys but instead encrypted using a random symmetric content encryption key. This content encryption key is then encrypted using a public key.&nbsp;We also have support for integrating with Azure Key Vault so you can manage your keys efficiently.</p>
<p>Using client-side encryption is easy. All you need to do is hook up request options with the appropriate encryption policy (Blob, Queue, and Table) and pass it to data upload/download APIs. The client library will internally take care of encrypting data on the client when uploading to Azure Storage, and automatically decrypts it when data is retrieved. You can find more details and code samples in the <a href="http://blogs.msdn.com/b/windowsazurestorage/archive/2015/04/29/getting-started-with-client-side-encryption-for-microsoft-azure-storage.aspx" target="_blank">Getting Started with Client-Side Encryption for Microsoft Azure Storage</a> article.</p>
<p>Goodness &ndash;</p>
<ul>
<li>Security &ndash; Encrypted data is not readable even if the customers storage account keys are compromised</li>
<li>Fixed overhead encryption &ndash; We have used a technique where there is a fixed overhead so that your encrypted data will have a predictable size based on the original size.</li>
<li>Self-contained encryption &ndash; Every blob, table entity, or queue message has all encryption metadata stored in either the object or its metadata.&nbsp; There is no need to get any additional data from anywhere else, except for the key you used.</li>
<li>Interoperability &ndash; Data encrypted using .NET client can be decrypted by clients using other languages like Java, Node.js, C++.&nbsp; We will be providing support in languages beyond .NET in the future.</li>
<li>Blobs
<ul>
<li>Full blob upload &ndash; Files like documents, photos, and videos that are going to be uploaded in entirety are supported.</li>
<li>Full or Range blob download &ndash; Of course, you can also download the blob in its entirety, but sometimes, files like mp3 are downloaded in ranges depending on the part that is to be played. Therefore, range downloads are allowed and are entirely taken care of by the SDK internally.</li>
<li>Key Rotation &ndash; We&rsquo;ve made it simple and straightforward for users to rotate keys themselves. i.e. multiple keys will be supported during the key rotation timeframe.</li>
<li>Clean upgrade path &ndash; Additional encryption algorithms and protocol versions can be supported in the future without needing significant changes &ndash; the design expects these to happen.</li>
</ul>
</li>
</ul>
<p>Points to be aware of &ndash;</p>
<ul>
<li>This is a preview!&nbsp; It should not be used for production data.&nbsp; You should expect that changes will be made that will affect the schemas to be used and therefore not be able to read data written with the first preview.</li>
<li>It is easy to corrupt data on the blob service or make it un-readable &ndash; If you do blob update operations WritePages/ClearPages, PutBlock etc once you have written an encrypted blob, you may end up corrupting the encrypted blob making it unreadable.&nbsp; For encryption, you should only use full blob upload commands and range/full blob download commands.</li>
<li>For tables, a similar constraint exists &ndash; be careful to not update encrypted properties without updating the encryption metadata.</li>
<li>Also, if you do a SetMetadata on the encrypted blob (since set metadata is not additive), it can wipe out all encryption related metadata required for decryption. Same with snapshots - specifying metadata while creating a snapshot of an encrypted blob.</li>
</ul>
<p><strong>Why a preview?</strong></p>
<p>We want to get your feedback on design, ease of use and any additional scenarios you would like to tell us about.&nbsp; This will enable us to actually use that feedback in shaping the final library.&nbsp; We are open to your feedback and want to know where we can improve this functionality before releasing it.&nbsp; Requests for additional functionality may not be reflected in the first release, but we want those too!</p>
<p><strong>References</strong></p>
<p><a href="http://blogs.msdn.com/b/windowsazurestorage/archive/2015/04/29/getting-started-with-client-side-encryption-for-microsoft-azure-storage.aspx" target="_blank">Getting Started with Client-Side Encryption for Microsoft Azure Storage</a><br/> Download the<span style="background-color: #ffffff;"> <a href="http://www.nuget.org/packages/WindowsAzure.Storage/4.4.0-preview" target="_blank"><span style="background-color: #ffffff;">Azure Storage Client Library for .NET NuGet package</span></a></span><br/> Download th<span style="background-color: #ffffff;">e <a href="https://github.com/Azure/azure-storage-net/tree/preview" target="_blank"><span style="background-color: #ffffff;">Azure Storage Client Library for .NET Source Code</span></a></span> from GitHub</p>
<p>Thanks!</p>
<p>The Azure Storage Team</p>
	</div><!-- .entry-content -->


	<footer class="entry-footer single">
				<hr>
	</footer><!-- .entry-footer -->

</article><!-- #post-## -->

			
		</div><!-- #single-content -->

		
<div id="comments" class="comments-area">
	<div class="comments-title">
		Comments (3)	</div>

		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title"> <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://blogs.msdn.microsoft.com/windowsazurestorage/2015/04/28/client-side-encryption-for-microsoft-azure-storage-preview/#respond" style="display:none;">Cancel reply</a></small></h3><p class="must-log-in">You must be <a href="https://blogs.msdn.microsoft.com/windowsazurestorage/wp-login.php?redirect_to=https%3A%2F%2Fblogs.msdn.microsoft.com%2Fwindowsazurestorage%2F2015%2F04%2F28%2Fclient-side-encryption-for-microsoft-azure-storage-preview%2F">logged in</a> to post a comment.</p>	</div><!-- #respond -->
	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-944">
				<div id="div-comment-944" class="comment-body">
				<div class="comment-author vcard">
			<img alt="" src="https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=56&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=112&amp;d=mm&amp;r=g 2x" class="avatar avatar-56 photo" height="56" width="56"/>			<cite class="fn">Rohit</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/windowsazurestorage/2015/04/28/client-side-encryption-for-microsoft-azure-storage-preview/#comment-944">
			April 30, 2015 at 3:37 am</a>		</div>

		<p>Is there any plan to enable encryption  decryption functionality from JS?</p>

		<div class="reply"><a rel="nofollow" class="comment-reply-login" href="https://blogs.msdn.microsoft.com/windowsazurestorage/wp-login.php?redirect_to=https%3A%2F%2Fblogs.msdn.microsoft.com%2Fwindowsazurestorage%2F2015%2F04%2F28%2Fclient-side-encryption-for-microsoft-azure-storage-preview%2F">Log in to Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1004">
				<div id="div-comment-1004" class="comment-body">
				<div class="comment-author vcard">
			<img alt="" src="https://secure.gravatar.com/avatar/c1df91e4121b265140d75568e2740e04?s=56&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c1df91e4121b265140d75568e2740e04?s=112&amp;d=mm&amp;r=g 2x" class="avatar avatar-56 photo" height="56" width="56"/>			<cite class="fn">Jason Hogg</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/windowsazurestorage/2015/04/28/client-side-encryption-for-microsoft-azure-storage-preview/#comment-1004">
			May 6, 2015 at 4:57 pm</a>		</div>

		<p>Hi Rohit. Not write now. Can you provide more information on your scenario please or email me at JAHOGG at Microsoft.com.</p>

		<div class="reply"><a rel="nofollow" class="comment-reply-login" href="https://blogs.msdn.microsoft.com/windowsazurestorage/wp-login.php?redirect_to=https%3A%2F%2Fblogs.msdn.microsoft.com%2Fwindowsazurestorage%2F2015%2F04%2F28%2Fclient-side-encryption-for-microsoft-azure-storage-preview%2F">Log in to Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1481">
				<div id="div-comment-1481" class="comment-body">
				<div class="comment-author vcard">
			<img alt="" src="https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=56&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=112&amp;d=mm&amp;r=g 2x" class="avatar avatar-56 photo" height="56" width="56"/>			<cite class="fn">Maarten</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/windowsazurestorage/2015/04/28/client-side-encryption-for-microsoft-azure-storage-preview/#comment-1481">
			August 3, 2015 at 12:34 am</a>		</div>

		<p>This is great! I&#39;m actually missing one thing though. We have a scenario where users don&#39;t use the client SDK, but just use their browser and other tools to download blobs. It would be great to use this library to encrypt blobs &quot;at rest&quot;. However for users to consume these blobs, we&#39;d have to decrypt them on our webserver and then stream them to the clients that have no SDK. Will there be support for some sort of shared access token so downloads can be handled by the blob storage service directly? (ping me on corpnet if needed, maballia)</p>

		<div class="reply"><a rel="nofollow" class="comment-reply-login" href="https://blogs.msdn.microsoft.com/windowsazurestorage/wp-login.php?redirect_to=https%3A%2F%2Fblogs.msdn.microsoft.com%2Fwindowsazurestorage%2F2015%2F04%2F28%2Fclient-side-encryption-for-microsoft-azure-storage-preview%2F">Log in to Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
	
</div><!-- .comments-area -->
	</div><!-- #primary -->