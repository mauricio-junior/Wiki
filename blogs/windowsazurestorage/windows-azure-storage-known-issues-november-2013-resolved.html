---
layout: windowsazurestorage
title: Windows Azure Storage Known Issues (November 2013) [Resolved]
weight: 3
---

<div id="site-content" class="site-content row">

	<div id="primary" class="content-area col-sm-9">
		<div id="single-content" class="div-content">

			
				
<article id="post-141" class="post-141 post type-post status-publish format-standard hentry category-uncategorized tag-issues-known">

	<header class="entry-header single">
		<h1 class="entry-title">Windows Azure Storage Known Issues (November 2013) [Resolved]</h1>		<div class="rating-wrap">
		<div id="star-rating-141" class="wds-ratings" data-rating="5" data-userrating="0" data-postid="141" data-container="body" data-toggle="tooltip" title="2 user(s) rated">
			<div class="wds-ratings-inner-wrap">
				<div>
					<div aria-label="Select 5 star, this article is 5 star rated" tabindex="0" class="wds-ratings-stars wds-ratings-stars-enable-editing" data-stars="5"><span aria-hidden="true" class="star-1"><span>&#x2605;</span></span><span aria-hidden="true" class="star-2"><span>&#x2605;</span></span><span aria-hidden="true" class="star-3"><span>&#x2605;</span></span><span aria-hidden="true" class="star-4"><span>&#x2605;</span></span><span aria-hidden="true" class="star-5"><span>&#x2605;</span></span></div><div aria-label="Select 4 star, this article is 5 star rated" tabindex="0" class="wds-ratings-stars wds-ratings-stars-enable-editing" data-stars="4"><span aria-hidden="true" class="star-1"><span>&#x2605;</span></span><span aria-hidden="true" class="star-2"><span>&#x2605;</span></span><span aria-hidden="true" class="star-3"><span>&#x2605;</span></span><span aria-hidden="true" class="star-4"><span>&#x2605;</span></span></div><div aria-label="Select 3 star, this article is 5 star rated" tabindex="0" class="wds-ratings-stars wds-ratings-stars-enable-editing" data-stars="3"><span aria-hidden="true" class="star-1"><span>&#x2605;</span></span><span aria-hidden="true" class="star-2"><span>&#x2605;</span></span><span aria-hidden="true" class="star-3"><span>&#x2605;</span></span></div><div aria-label="Select 2 star, this article is 5 star rated" tabindex="0" class="wds-ratings-stars wds-ratings-stars-enable-editing" data-stars="2"><span aria-hidden="true" class="star-1"><span>&#x2605;</span></span><span aria-hidden="true" class="star-2"><span>&#x2605;</span></span></div><div aria-label="Select 1 star, this article is 5 star rated" tabindex="0" class="wds-ratings-stars wds-ratings-stars-enable-editing" data-stars="1"><span aria-hidden="true" class="star-1"><span>&#x2605;</span></span></div>
				</div>
			</div>
		</div>
		</div>		<div class="clear-both"></div>
		<div class="entry-meta">
			<img alt="avatar of windows-azure-storage" src="https://i1.social.s-msft.com/profile/u/avatar.jpg?displayname=Windows+Azure+Storage&amp;size=extralarge&amp;version=00000000-0000-0000-0000-000000000000" class="avatar avatar-22 photo" height="22" width="22"/><span class="byline"><span class="author vcard"><a class="url fn n profile-usercard-hover" data-profile-userid="59e1aedafa2d4428b7004b2c2fac4adc" href="https://social.msdn.microsoft.com/profile/Windows+Azure+Storage">Windows Azure Storage</a></span></span><span class="posted-on posted-on-margin"><span class="screen-reader-text"></span><time class="entry-date published updated" datetime="2013-11-23T15:05:00+00:00">November 23, 2013</time></span><span class="comments-link"><span class="glyphicon glyphicon-comment" aria-hidden="true"></span><a href="https://blogs.msdn.microsoft.com/windowsazurestorage/2013/11/23/windows-azure-storage-known-issues-november-2013-resolved/#comments">2</a></span>				<span class="social-icons-wrap">
		<ul class="social-icons">
			<li><div class="fb-share-button" data-href="https://blogs.msdn.microsoft.com/windowsazurestorage/2013/11/23/windows-azure-storage-known-issues-november-2013-resolved/" data-layout="button_count" data-size="large" data-mobile-iframe="true"><a class="fb-xfbml-parse-ignore" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blogs.msdn.microsoft.com/windowsazurestorage/2013/11/23/windows-azure-storage-known-issues-november-2013-resolved/&amp;src=sdkpreparse">Share</a></div></li>
			<div id="fb-root" style="display:none"></div>

			<li class="social-icon twitter"><a data-social="{&quot;type&quot;:&quot;twitter&quot;, &quot;url&quot;:&quot;https://blogs.msdn.microsoft.com/windowsazurestorage/2013/11/23/windows-azure-storage-known-issues-november-2013-resolved/&quot;, &quot;text&quot;: &quot;Windows Azure Storage Known Issues (November 2013) [Resolved]&quot;}" href="#" id="post_tweet_count">0</a></li>
			<li class="social-icon linkedin"><a data-social="{&quot;type&quot;:&quot;linkedin&quot;, &quot;url&quot;:&quot;https://blogs.msdn.microsoft.com/windowsazurestorage/2013/11/23/windows-azure-storage-known-issues-november-2013-resolved/&quot;, &quot;text&quot;: &quot;Windows Azure Storage Known Issues (November 2013) [Resolved]&quot;}" href="#" id="get_post_linkedin_count">0</a></li>
		</ul>
	</span><!-- .social-icons-wrap -->
	<script type="text/javascript">
		// Get social counts
		jQuery( window ).load(function () {
			jQuery.getScript('https://blogs.msdn.microsoft.com/windowsazurestorage/wp-content/themes/microsoft/js/social-counts.js?ver=02092017')
				.done(function(script,textStatus) {
					window.msdnsocial.ajax('https://blogs.msdn.microsoft.com/windowsazurestorage/2013/11/23/windows-azure-storage-known-issues-november-2013-resolved/');
				});
		});
	</script>
		</div>
		<hr>
	</header><!-- .entry-header -->

	<div class="entry-content single">
		<p><span style="font-size: large;"><em><strong><span style="font-size: large;"><strong>Updated [12/10/13] </strong></span>: The issues detailed in this blog have been resolved via updates to the service and the client library. The client table issue regarding the cast operator (issue 2 below) has been addressed in the <a href="https://www.nuget.org/packages/WindowsAzure.Storage/2.1.0.4">2.1.0.4</a> and <a href="https://www.nuget.org/packages/WindowsAzure.Storage/">3.x</a> client releases which are currently available on </strong></em><em><strong><a href="https://www.nuget.org/packages/WindowsAzure.Storage/">nuget</a></strong></em><em><strong> and <a href="https://github.com/WindowsAzure/azure-storage-net">github</a>. </strong></em></span></p>
<p>In preparation for a major feature release such as CORS, JSON etc. we are pushing an update to production that introduced some bugs. We were notified recently about these bugs and plan to address in an upcoming hotfix. We will update this blog once the fixes are pushed out.</p>
<h4>Windows Azure Blobs, Tables and Queue Shared Access Signature (SAS)</h4>
<p>One of our customers reported an issue that SAS with version 2012-02-12 failed with HTTP Status Code 400 (Bad Request). Upon investigation, the issue is caused by the fact that our service had a change in how &ldquo;//&rdquo; gets interpreted when such sequence of characters appear before the container.</p>
<p>Example: <a href="http://myaccount.blob.core.windows.net/container/blob?sv=2012-02-12&amp;si=sasid&amp;sx=xxxx">http://myaccount.blob.core.windows.net</a><a href="http://myaccount.blob.core.windows.net/container/blob?sv=2012-02-12&amp;si=sasid&amp;sx=xxxx"><strong>//</strong></a><a href="http://myaccount.blob.core.windows.net/container/blob?sv=2012-02-12&amp;si=sasid&amp;sx=xxxx"><strong></strong>container/blob?sv=2012-02-12&amp;si=sasid&amp;sx=xxxx</a></p>
<p>Whenever it receives a SAS request with version 2012-02-12 or prior, the previous version of our service collapses the &lsquo;//&rsquo; into &lsquo;/&rsquo; and hence things worked fine. However, the new service update returns 400 (Bad Request) because it interprets the above Uri as if the container name is null which is invalid. We will be fixing our service to revert back to the old behavior and collapse &lsquo;//&rsquo; into &lsquo;/&rsquo; for 2012-02-12 version of SAS. In the meantime, we advise our customers to refrain from sending &lsquo;//&rsquo; at the start of the container name portion of the URI.</p>
<h4>Windows Azure Tables</h4>
<p>Below are 2 known issues that we intend to hotfix either on the service side or as part of our client library as noted below:</p>
<p>1. When clients define <a href="http://msdn.microsoft.com/en-us/library/system.data.services.client.dataservicecontext.resolvename(v=vs.113).aspx">DataServiceContext.ResolveName</a> and in case they provide a type name other than &lt;Account Name&gt;.&lt;Table Name&gt;, the CUD operations will return 400 (Bad Request). This is because ATOM &ldquo;Category&rdquo; element with &ldquo;term&rdquo; must either be omitted or be equal to the &lt;Account Name&gt;.&lt;Table Name&gt; as part of the new update. Previous version of the service used to ignore any type name being sent. We will be fixing this to again ignore what is being sent, but until then client applications would need to consider the below workaround. The ResolveName is not required for Azure Tables and client application can remove it to ensure that OData does not send &ldquo;category&rdquo; element.</p>
<p>Here is an example of a code snippet that would generate a request that fails on the service side:</p>
<div id="codeSnippetWrapper">
<pre style="margin: 0em; padding: 0px; width: 100%; text-align: left; color: black; line-height: 12pt; overflow: visible; font-family: 'Courier New', courier, monospace; font-size: 8pt; direction: ltr; background-color: #f4f4f4;">CloudTableClient cloudTableClient = storageAccount.CreateCloudTableClient();<br/>TableServiceContext tableServiceContext = cloudTableClient.GetDataServiceContext();</pre>
<p><span style="background-color: #ffff00;">tableServiceContext.ResolveName = <span style="color: #0000ff;">delegate</span>(Type entityType)<br/> {<br/> <span style="color: #008000;">// This would cause class name to be sent as the value for term in the category element and service would return Bad Request. </span><br/> <span style="color: #0000ff;">return</span> entityType.FullName;<br/> };</span></p>
<pre id="codeSnippet" style="margin: 0em; padding: 0px; width: 100%; text-align: left; color: black; line-height: 12pt; overflow: visible; font-family: 'Courier New', courier, monospace; font-size: 8pt; direction: ltr; background-color: #f4f4f4;"><br/><br/>SimpleEntity entity = <span style="color: #0000ff;">new</span> SimpleEntity(<span style="color: #006080;">"somePK"</span>, <span style="color: #006080;">"someRK"</span>);<br/>tableServiceContext.AddObject(<span style="color: #006080;">"sometable"</span>, entity);<br/>tableServiceContext.SaveChanges();</pre>
</div>
<p>To mitigate the issue on the client side, <span style="background-color: #ffff00;">please remove the highlighted &ldquo;tableServiceContext.ResolveName&rdquo; delegate.</span></p>
<p>We would like to thank <a href="http://www.restaurant.com/">restaurant.com</a> for bringing this to our attention and helping us in investigating this issue.</p>
<p>2. The new .NET WCF Data Services library used on the server side as part of the service update rejects empty &ldquo;cast&rdquo; as part of the $filter query with 400 (Bad Request) whereas the older .NET framework library did not. This impacts Windows Azure Storage Client Library 2.1 since the IQueryable implementation (see <a href="http://blogs.msdn.com/b/windowsazurestorage/archive/2013/09/07/announcing-storage-client-library-2-1-rtm.aspx">this</a> post for details) sends the <em>cast</em> operator in certain scenarios.</p>
<p>We are working on fixing the client library to match .NET&rsquo;s DataServiceContext behavior which does not send the <em>cast</em> operator and this should be available in the next couple of weeks. In the meantime we advise our customers to consider the following workaround.</p>
<p>This client library issue can be avoided by ensuring you do not constrain the type of enumerable to the ITableEntity interface but to the exact type that needs to be instantiated.</p>
<p>The current behavior is described by the following example:</p>
<div id="codeSnippetWrapper" style="margin: 20px 0px 10px; padding: 4px; border: 1px solid silver; width: 97.5%; height: 82px; text-align: left; line-height: 12pt; overflow: auto; font-family: 'Courier New', courier, monospace; font-size: 8pt; cursor: text; direction: ltr; max-height: 200px; background-color: #f4f4f4;">
<pre id="codeSnippet" style="margin: 0em; padding: 0px; width: 100%; text-align: left; color: black; line-height: 12pt; overflow: visible; font-family: 'Courier New', courier, monospace; font-size: 8pt; direction: ltr; background-color: #f4f4f4;"><span style="color: #0000ff;">static</span> IEnumerable&lt;T&gt; GetEntities&lt;T&gt;(CloudTable table)  <span style="color: #0000ff;">where</span> T : ITableEntity, <span style="color: #0000ff;">new</span>()<br/>{<br/>    IQueryable&lt;T&gt; query = table.CreateQuery&lt;T&gt;().Where(x =&gt; x.PartitionKey == <span style="color: #006080;">"mypk"</span>);<br/>    <span style="color: #0000ff;">return</span> query.ToList();<br/>}</pre>
</div>
<p>The above code in 2.1 storage client library&rsquo;s <em>IQueryable</em> interface will dispatch a query that looks like the below Uri that is rejected by the new service update with 400 (Bad Request).</p>
<blockquote>
<p>http://myaccount.table.core.windows.net/invalidfiltertable?$filter=<strong><span style="text-decoration: underline;">cast%28%27%27%29%</span></strong>2FPartitionKey%20eq%20%27mypk%27&amp;timeout=90 HTTP/1.1</p>
</blockquote>
<p>As a mitigation, consider replacing the above code with the below query. In this case the <strong><em>cast</em></strong> operator will not be sent.</p>
<div id="codeSnippetWrapper" style="margin: 20px 0px 10px; padding: 4px; border: 1px solid silver; width: 97.5%; height: 38px; text-align: left; line-height: 12pt; overflow: auto; font-family: 'Courier New', courier, monospace; font-size: 8pt; cursor: text; direction: ltr; max-height: 200px; background-color: #f4f4f4;">
<pre id="codeSnippet" style="margin: 0em; padding: 0px; width: 100%; text-align: left; color: black; line-height: 12pt; overflow: visible; font-family: 'Courier New', courier, monospace; font-size: 8pt; direction: ltr; background-color: #f4f4f4;">    IQueryable&lt;SimpleEntity&gt; query = table.CreateQuery&lt;SimpleEntity&gt;().Where(x =&gt; x.PartitionKey == <span style="color: #006080;">"mypk"</span>);<br/>   <span style="color: #0000ff;">return</span> query.ToList(); <br/> <br/> </pre>
</div>
<p>The Uri for the request looks like the following and is accepted by the service.</p>
<p><a href="http://myaccount.table.core.windows.net/validfiltertable?$filter=PartitionKey%20eq%20%27mypk%27&amp;timeout=90">http://myaccount.table.core.windows.net/validfiltertable?$filter=PartitionKey%20eq%20%27mypk%27&amp;timeout=90</a></p>
<p>We apologize for these issues and we are working on a hotfix to address them.</p>
<p>Windows Azure Storage Team</p>
	</div><!-- .entry-content -->


	<footer class="entry-footer single">
					<div class="tags">
				<span>Tags </span>
				<span>
					<a href="https://blogs.msdn.microsoft.com/windowsazurestorage/tag/issues-known/" rel="tag">Issues - Known</a>				</span>
			</div>
				<hr>
	</footer><!-- .entry-footer -->

</article><!-- #post-## -->

			
		</div><!-- #single-content -->

		
<div id="comments" class="comments-area">
	<div class="comments-title">
		Comments (2)	</div>

		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title"> <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://blogs.msdn.microsoft.com/windowsazurestorage/2013/11/23/windows-azure-storage-known-issues-november-2013-resolved/#respond" style="display:none;">Cancel reply</a></small></h3><p class="must-log-in">You must be <a href="https://blogs.msdn.microsoft.com/windowsazurestorage/wp-login.php?redirect_to=https%3A%2F%2Fblogs.msdn.microsoft.com%2Fwindowsazurestorage%2F2013%2F11%2F23%2Fwindows-azure-storage-known-issues-november-2013-resolved%2F">logged in</a> to post a comment.</p>	</div><!-- #respond -->
	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-367">
				<div id="div-comment-367" class="comment-body">
				<div class="comment-author vcard">
			<img alt="" src="https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=56&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=112&amp;d=mm&amp;r=g 2x" class="avatar avatar-56 photo" height="56" width="56"/>			<cite class="fn">John K</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/windowsazurestorage/2013/11/23/windows-azure-storage-known-issues-november-2013-resolved/#comment-367">
			December 5, 2013 at 2:36 pm</a>		</div>

		<p>I am running elmah on table storage and initializing like this:</p>
<p>// this.connectionString = UseDevelopmentStorage=true</p>
<p>CloudStorageAccount.Parse(this.connectionString).CreateCloudTableClient().GetTableReference(&quot;elmaherrors&quot;).CreateIfNotExists();</p>
<p>I am also seeing the 400 error but everything was working fine with v2.3. Would this workaround also apply to me?</p>

		<div class="reply"><a rel="nofollow" class="comment-reply-login" href="https://blogs.msdn.microsoft.com/windowsazurestorage/wp-login.php?redirect_to=https%3A%2F%2Fblogs.msdn.microsoft.com%2Fwindowsazurestorage%2F2013%2F11%2F23%2Fwindows-azure-storage-known-issues-november-2013-resolved%2F">Log in to Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-368">
				<div id="div-comment-368" class="comment-body">
				<div class="comment-author vcard">
			<img alt="" src="https://secure.gravatar.com/avatar/b596cd385878c1dc59067dc534e2ab25?s=56&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b596cd385878c1dc59067dc534e2ab25?s=112&amp;d=mm&amp;r=g 2x" class="avatar avatar-56 photo" height="56" width="56"/>			<cite class="fn">joegiardino@live.com</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/windowsazurestorage/2013/11/23/windows-azure-storage-known-issues-november-2013-resolved/#comment-368">
			December 5, 2013 at 4:52 pm</a>		</div>

		<p>@John K</p>
<p>Please see &nbsp;<a href="http://blogs.msdn.com/b/windowsazurestorage/archive/2013/11/27/windows-azure-storage-release-introducing-cors-json-minute-metrics-and-more.aspx" rel="nofollow" target="_new">blogs.msdn.com/&#8230;/windows-azure-storage-release-introducing-cors-json-minute-metrics-and-more.aspx</a></p>
<p>Storage Emulator Guidance</p>
<p>As mentioned above an updated Windows Azure Storage Emulator is expected to ship with full support of these new features in the next couple of months. Users attempting to develop against the current version of the Storage emulator will receive Bad Request errors as the protocol version (2013-08-15) is unsupported. &nbsp;Until then, users wanting to use the new features would need to develop and test against a Windows Azure Storage Account to leverage the 2013-08-15 REST version.</p>
<p>For users developing against the Storage Emulator in Windows Azure SDK 2.2 you will need to utilize a 2.x version of the Storage Client assembly. Windows Azure SDK 2.2 shipped with Storage Client Library version 2.1.0.2, however we recommend updating that to 2.1.0.4 (using this command in the Package manager console : Install-Package WindowsAzure.Storage &ndash;Version 2.1.0.4) as it contains important fixes for the table issue described here: <a href="http://blogs.msdn.com/b/windowsazurestorage/archive/2013/11/23/windows-azure-storage-known-issues-november-2013.aspx" rel="nofollow" target="_new">blogs.msdn.com/&#8230;/windows-azure-storage-known-issues-november-2013.aspx</a></p>

		<div class="reply"><a rel="nofollow" class="comment-reply-login" href="https://blogs.msdn.microsoft.com/windowsazurestorage/wp-login.php?redirect_to=https%3A%2F%2Fblogs.msdn.microsoft.com%2Fwindowsazurestorage%2F2013%2F11%2F23%2Fwindows-azure-storage-known-issues-november-2013-resolved%2F">Log in to Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
	
</div><!-- .comments-area -->
	</div><!-- #primary -->